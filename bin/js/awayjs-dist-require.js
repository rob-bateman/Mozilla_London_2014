require=function t(e,i,r){function a(n,o){if(!i[n]){if(!e[n]){var h=typeof require=="function"&&require;if(!o&&h)return h(n,!0);if(s)return s(n,!0);var l=new Error("Cannot find module '"+n+"'");throw l.code="MODULE_NOT_FOUND",l}var u=i[n]={exports:{}};e[n][0].call(u.exports,function(t){var i=e[n][1][t];return a(i?i:t)},u,u.exports,t,e,i,r)}return i[n].exports}var s=typeof require=="function"&&require;for(var n=0;n<r.length;n++)a(r[n]);return a}({"awayjs-core/lib/base/BitmapDataChannel":[function(t,e,i){var r=function(){function t(){}t.ALPHA=8;t.BLUE=4;t.GREEN=2;t.RED=1;return t}();e.exports=r},{}],"awayjs-core/lib/base/BitmapData":[function(t,e,i){var r=t("awayjs-core/lib/geom/Rectangle");var a=t("awayjs-core/lib/utils/ColorUtils");var s=function(){function t(t,e,i,s){if(i===void 0){i=true}if(s===void 0){s=null}this._alpha=0;this._locked=false;this._transparent=i;this._imageCanvas=document.createElement("canvas");this._imageCanvas.width=t;this._imageCanvas.height=e;this._context=this._imageCanvas.getContext("2d");this._rect=new r(0,0,t,e);if(s!=null){if(this._transparent){this._alpha=a.float32ColorToARGB(s)[0]/255}else{this._alpha=1}this.fillRect(this._rect,s)}}t.prototype.dispose=function(){this._context=null;this._imageCanvas=null;this._imageData=null;this._rect=null;this._transparent=null;this._locked=null};t.prototype.lock=function(){this._locked=true;this._imageData=this._context.getImageData(0,0,this._rect.width,this._rect.height)};t.prototype.unlock=function(){this._locked=false;if(this._imageData){this._context.putImageData(this._imageData,0,0);this._imageData=null}};t.prototype.getPixel=function(t,e){var i;var r;var a;var s;if(!this._locked){var n=this._context.getImageData(t,e,1,1);i=n.data[0];r=n.data[1];a=n.data[2];s=n.data[3]}else{var o=(t+e*this._imageCanvas.width)*4;if(!this._imageData)this._imageData=this._context.getImageData(0,0,this._rect.width,this._rect.height);i=this._imageData.data[o+0];r=this._imageData.data[o+1];a=this._imageData.data[o+2];s=this._imageData.data[o+3]}if(!this._locked){this._imageData=null}return s<<24|i<<16|r<<8|a};t.prototype.setPixel=function(t,e,i){var r=a.float32ColorToARGB(i);if(!this._locked)this._imageData=this._context.getImageData(0,0,this._rect.width,this._rect.height);if(this._imageData){var s=(t+e*this._imageCanvas.width)*4;this._imageData.data[s+0]=r[1];this._imageData.data[s+1]=r[2];this._imageData.data[s+2]=r[3];this._imageData.data[s+3]=255}if(!this._locked){this._context.putImageData(this._imageData,0,0);this._imageData=null}};t.prototype.setPixels=function(t,e){if(!this._locked)this._imageData=this._context.getImageData(0,0,this._rect.width,this._rect.height);if(this._imageData){e.position=0;var i,r,a;for(i=0;i<t.width;++i){for(r=0;r<t.height;++r){a=(i+t.x+(r+t.y)*this._imageCanvas.width)*4;this._imageData.data[a+0]=e.readUnsignedInt();this._imageData.data[a+1]=e.readUnsignedInt();this._imageData.data[a+2]=e.readUnsignedInt();this._imageData.data[a+3]=e.readUnsignedInt()}}}if(!this._locked){this._context.putImageData(this._imageData,0,0);this._imageData=null}};t.prototype.setPixel32=function(t,e,i){var r=a.float32ColorToARGB(i);if(!this._locked)this._imageData=this._context.getImageData(0,0,this._rect.width,this._rect.height);if(this._imageData){var s=(t+e*this._imageCanvas.width)*4;this._imageData.data[s+0]=r[1];this._imageData.data[s+1]=r[2];this._imageData.data[s+2]=r[3];this._imageData.data[s+3]=r[0]}if(!this._locked){this._context.putImageData(this._imageData,0,0);this._imageData=null}};t.prototype.setVector=function(t,e){if(!this._locked)this._imageData=this._context.getImageData(0,0,this._rect.width,this._rect.height);if(this._imageData){var i,r,s,n;for(i=0;i<t.width;++i){for(r=0;r<t.height;++r){n=a.float32ColorToARGB(e[i+r*t.width]);s=(i+t.x+(r+t.y)*this._imageCanvas.width)*4;this._imageData.data[s+0]=n[1];this._imageData.data[s+1]=n[2];this._imageData.data[s+2]=n[3];this._imageData.data[s+3]=n[0]}}}if(!this._locked){this._context.putImageData(this._imageData,0,0);this._imageData=null}};t.prototype.drawImage=function(t,e,i){if(this._locked){if(this._imageData){this._context.putImageData(this._imageData,0,0)}this._drawImage(t,e,i);if(this._imageData){this._imageData=this._context.getImageData(0,0,this._rect.width,this._rect.height)}}else{this._drawImage(t,e,i)}};t.prototype._drawImage=function(e,i,r){if(e instanceof t)this._context.drawImage(e.canvas,i.x,i.y,i.width,i.height,r.x,r.y,r.width,r.height);else if(e instanceof HTMLImageElement)this._context.drawImage(e,i.x,i.y,i.width,i.height,r.x,r.y,r.width,r.height)};t.prototype.copyPixels=function(t,e,i){if(this._locked){if(this._imageData){this._context.putImageData(this._imageData,0,0)}this._copyPixels(t,e,i);if(this._imageData){this._imageData=this._context.getImageData(0,0,this._rect.width,this._rect.height)}}else{this._copyPixels(t,e,i)}};t.prototype._copyPixels=function(e,i,r){if(e instanceof t){this._context.drawImage(e.canvas,i.x,i.y,i.width,i.height,r.x,r.y,r.width,r.height)}else if(e instanceof HTMLImageElement){this._context.drawImage(e,i.x,i.y,i.width,i.height,r.x,r.y,r.width,r.height)}};t.prototype.fillRect=function(t,e){if(this._locked){if(this._imageData)this._context.putImageData(this._imageData,0,0);this._context.fillStyle=this.hexToRGBACSS(e);this._context.fillRect(t.x,t.y,t.width,t.height);if(this._imageData)this._imageData=this._context.getImageData(0,0,this._rect.width,this._rect.height)}else{this._context.fillStyle=this.hexToRGBACSS(e);this._context.fillRect(t.x,t.y,t.width,t.height)}};t.prototype.draw=function(t,e){if(this._locked){if(this._imageData)this._context.putImageData(this._imageData,0,0);this._draw(t,e);if(this._imageData)this._imageData=this._context.getImageData(0,0,this._rect.width,this._rect.height)}else{this._draw(t,e)}};t.prototype._draw=function(e,i){if(e instanceof t){this._context.save();if(i!=null)this._context.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty);this._context.drawImage(e.canvas,0,0);this._context.restore()}else if(e instanceof HTMLImageElement){this._context.save();if(i!=null)this._context.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty);this._context.drawImage(e,0,0);this._context.restore()}};t.prototype.copyChannel=function(t,e,i,r,a){var s=t.imageData;if(!this._locked)this._imageData=this._context.getImageData(0,0,this._rect.width,this._rect.height);if(this._imageData){var n=t.imageData.data;var o=this._imageData.data;var h=Math.round(Math.log(r)/Math.log(2));var l=Math.round(Math.log(a)/Math.log(2));var u,p,c,d;for(u=0;u<e.width;++u){for(p=0;p<e.height;++p){c=(u+e.x+(p+e.y)*t.width)*4;d=(u+i.x+(p+i.y)*this.width)*4;o[d+l]=n[c+h]}}}if(!this._locked){this._context.putImageData(this._imageData,0,0);this._imageData=null}};t.prototype.colorTransform=function(t,e){if(!this._locked)this._imageData=this._context.getImageData(0,0,this._rect.width,this._rect.height);if(this._imageData){var i=this._imageData.data;var r,a,s;for(r=0;r<t.width;++r){for(a=0;a<t.height;++a){s=(r+t.x+(a+t.y)*this.width)*4;i[s]=i[s]*e.redMultiplier+e.redOffset;i[s+1]=i[s+1]*e.greenMultiplier+e.greenOffset;i[s+2]=i[s+2]*e.blueMultiplier+e.blueOffset;i[s+3]=i[s+3]*e.alphaMultiplier+e.alphaOffset}}}if(!this._locked){this._context.putImageData(this._imageData,0,0);this._imageData=null}};Object.defineProperty(t.prototype,"imageData",{get:function(){return this._context.getImageData(0,0,this._rect.width,this._rect.height)},set:function(t){this._context.putImageData(t,0,0)},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"width",{get:function(){return this._imageCanvas.width},set:function(t){this._rect.width=t;this._imageCanvas.width=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"height",{get:function(){return this._imageCanvas.height},set:function(t){this._rect.height=t;this._imageCanvas.height=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"rect",{get:function(){return this._rect},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"canvas",{get:function(){return this._imageCanvas},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"context",{get:function(){return this._context},enumerable:true,configurable:true});t.prototype.hexToRGBACSS=function(t){var e=a.float32ColorToARGB(t);if(this._transparent==false){e[0]=1;return"rgba("+e[1]+","+e[2]+","+e[3]+","+e[0]+")"}return"rgba("+e[1]+","+e[2]+","+e[3]+","+e[0]/255+")"};return t}();e.exports=s},{"awayjs-core/lib/geom/Rectangle":undefined,"awayjs-core/lib/utils/ColorUtils":undefined}],"awayjs-core/lib/bounds/AxisAlignedBoundingBox":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/bounds/BoundingVolumeBase");var s=t("awayjs-core/lib/geom/Matrix3DUtils");var n=t("awayjs-core/lib/geom/PlaneClassification");var o=t("awayjs-core/lib/geom/Vector3D");var h=function(t){r(e,t);function e(){t.call(this);this._centerX=0;this._centerY=0;this._centerZ=0;this._halfExtentsX=0;this._halfExtentsY=0;this._halfExtentsZ=0}e.prototype.nullify=function(){t.prototype.nullify.call(this);this._centerX=this._centerY=this._centerZ=0;this._halfExtentsX=this._halfExtentsY=this._halfExtentsZ=0};e.prototype.isInFrustum=function(t,e){for(var i=0;i<e;++i){var r=t[i];var a=r.a;var s=r.b;var n=r.c;var o=a<0?-this._halfExtentsX:this._halfExtentsX;var h=s<0?-this._halfExtentsY:this._halfExtentsY;var l=n<0?-this._halfExtentsZ:this._halfExtentsZ;var u=a*(this._centerX+o)+s*(this._centerY+h)+n*(this._centerZ+l)-r.d;if(u<0)return false}return true};e.prototype.rayIntersection=function(t,e,i){if(this.containsPoint(t))return 0;var r=t.x-this._centerX;var a=t.y-this._centerY;var s=t.z-this._centerZ;var n=e.x;var o=e.y;var h=e.z;var l;var u;var p;var c;var d;if(n<0){c=(this._halfExtentsX-r)/n;if(c>0){u=a+c*o;p=s+c*h;if(u>-this._halfExtentsY&&u<this._halfExtentsY&&p>-this._halfExtentsZ&&p<this._halfExtentsZ){i.x=1;i.y=0;i.z=0;d=true}}}if(!d&&n>0){c=(-this._halfExtentsX-r)/n;if(c>0){u=a+c*o;p=s+c*h;if(u>-this._halfExtentsY&&u<this._halfExtentsY&&p>-this._halfExtentsZ&&p<this._halfExtentsZ){i.x=-1;i.y=0;i.z=0;d=true}}}if(!d&&o<0){c=(this._halfExtentsY-a)/o;if(c>0){l=r+c*n;p=s+c*h;if(l>-this._halfExtentsX&&l<this._halfExtentsX&&p>-this._halfExtentsZ&&p<this._halfExtentsZ){i.x=0;i.y=1;i.z=0;d=true}}}if(!d&&o>0){c=(-this._halfExtentsY-a)/o;if(c>0){l=r+c*n;p=s+c*h;if(l>-this._halfExtentsX&&l<this._halfExtentsX&&p>-this._halfExtentsZ&&p<this._halfExtentsZ){i.x=0;i.y=-1;i.z=0;d=true}}}if(!d&&h<0){c=(this._halfExtentsZ-s)/h;if(c>0){l=r+c*n;u=a+c*o;if(u>-this._halfExtentsY&&u<this._halfExtentsY&&l>-this._halfExtentsX&&l<this._halfExtentsX){i.x=0;i.y=0;i.z=1;d=true}}}if(!d&&h>0){c=(-this._halfExtentsZ-s)/h;if(c>0){l=r+c*n;u=a+c*o;if(u>-this._halfExtentsY&&u<this._halfExtentsY&&l>-this._halfExtentsX&&l<this._halfExtentsX){i.x=0;i.y=0;i.z=-1;d=true}}}return d?c:-1};e.prototype.containsPoint=function(t){var e=t.x-this._centerX,i=t.y-this._centerY,r=t.z-this._centerZ;return e<=this._halfExtentsX&&e>=-this._halfExtentsX&&i<=this._halfExtentsY&&i>=-this._halfExtentsY&&r<=this._halfExtentsZ&&r>=-this._halfExtentsZ};e.prototype.fromExtremes=function(e,i,r,a,s,n){this._centerX=(a+e)*.5;this._centerY=(s+i)*.5;this._centerZ=(n+r)*.5;this._halfExtentsX=(a-e)*.5;this._halfExtentsY=(s-i)*.5;this._halfExtentsZ=(n-r)*.5;t.prototype.fromExtremes.call(this,e,i,r,a,s,n)};e.prototype.clone=function(){var t=new e;t.fromExtremes(this._aabb.x,this._aabb.y+this._aabb.height,this._aabb.z,this._aabb.x+this._aabb.width,this._aabb.y,this._aabb.z+this._aabb.depth);return t};Object.defineProperty(e.prototype,"halfExtentsX",{get:function(){return this._halfExtentsX},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"halfExtentsY",{get:function(){return this._halfExtentsY},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"halfExtentsZ",{get:function(){return this._halfExtentsZ},enumerable:true,configurable:true});e.prototype.closestPointToPoint=function(t,e){if(e===void 0){e=null}var i;if(e==null)e=new o;i=t.x;if(i<this._aabb.x)i=this._aabb.x;if(i>this._aabb.x+this._aabb.width)i=this._aabb.x+this._aabb.width;e.x=i;i=t.y;if(i<this._aabb.y+this._aabb.height)i=this._aabb.y+this._aabb.height;if(i>this._aabb.y)i=this._aabb.y;e.y=i;i=t.z;if(i<this._aabb.z)i=this._aabb.z;if(i>this._aabb.z+this._aabb.depth)i=this._aabb.z+this._aabb.depth;e.z=i;return e};e.prototype.classifyToPlane=function(t){var e=t.a;var i=t.b;var r=t.c;var a=e*this._centerX+i*this._centerY+r*this._centerZ-t.d;if(e<0)e=-e;if(i<0)i=-i;if(r<0)r=-r;var s=e*this._halfExtentsX+i*this._halfExtentsY+r*this._halfExtentsZ;return a>s?n.FRONT:a<-s?n.BACK:n.INTERSECT};e.prototype.transformFrom=function(t,e){var i=t;var r=i._centerX;var a=i._centerY;var n=i._centerZ;var o=s.RAW_DATA_CONTAINER;e.copyRawDataTo(o);var h=o[0],l=o[4],u=o[8],p=o[12];var c=o[1],d=o[5],f=o[9],_=o[13];var y=o[2],g=o[6],m=o[10],b=o[14];this._centerX=r*h+a*l+n*u+p;this._centerY=r*c+a*d+n*f+_;this._centerZ=r*y+a*g+n*m+b;if(h<0)h=-h;if(l<0)l=-l;if(u<0)u=-u;if(c<0)c=-c;if(d<0)d=-d;if(f<0)f=-f;if(y<0)y=-y;if(g<0)g=-g;if(m<0)m=-m;var v=i._halfExtentsX;var w=i._halfExtentsY;var x=i._halfExtentsZ;this._halfExtentsX=v*h+w*l+x*u;this._halfExtentsY=v*c+w*d+x*f;this._halfExtentsZ=v*y+w*g+x*m;this._aabb.width=this._aabb.height=this._aabb.depth=this._halfExtentsX*2;this._aabb.x=this._centerX-this._halfExtentsX;this._aabb.y=this._centerY+this._halfExtentsY;this._aabb.z=this._centerZ-this._halfExtentsZ};return e}(a);e.exports=h},{"awayjs-core/lib/bounds/BoundingVolumeBase":undefined,"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-core/lib/geom/PlaneClassification":undefined,"awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-core/lib/bounds/BoundingSphere":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/bounds/BoundingVolumeBase");var s=t("awayjs-core/lib/geom/PlaneClassification");var n=t("awayjs-core/lib/geom/Vector3D");var o=function(t){r(e,t);function e(){t.call(this);this._radius=0;this._centerX=0;this._centerY=0;this._centerZ=0}Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},enumerable:true,configurable:true});e.prototype.nullify=function(){t.prototype.nullify.call(this);this._centerX=this._centerY=this._centerZ=0;this._radius=0};e.prototype.isInFrustum=function(t,e){for(var i=0;i<e;++i){var r=t[i];var a=r.a<0?-this._radius:this._radius;var s=r.b<0?-this._radius:this._radius;var n=r.c<0?-this._radius:this._radius;var o=r.a*(this._centerX+a)+r.b*(this._centerY+s)+r.c*(this._centerZ+n)-r.d;if(o<0){return false}}return true};e.prototype.fromSphere=function(t,e){this._centerX=t.x;this._centerY=t.y;this._centerZ=t.z;this._radius=e;this._aabb.width=this._aabb.height=this._aabb.depth=e*2;this._aabb.x=this._centerX-e;this._aabb.y=this._centerY+e;this._aabb.z=this._centerZ-e;this._pAabbPointsDirty=true};e.prototype.fromExtremes=function(e,i,r,a,s,n){this._centerX=(a+e)*.5;this._centerY=(s+i)*.5;this._centerZ=(n+r)*.5;var o=a-e;var h=s-i;var l=n-r;if(h>o)o=h;if(l>o)o=l;this._radius=o*Math.sqrt(.5);t.prototype.fromExtremes.call(this,e,i,r,a,s,n)};e.prototype.clone=function(){var t=new e;t.fromSphere(new n(this._centerX,this._centerY,this._centerZ),this._radius);return t};e.prototype.rayIntersection=function(t,e,i){if(this.containsPoint(t)){return 0}var r=t.x-this._centerX,a=t.y-this._centerY,s=t.z-this._centerZ;var n=e.x,o=e.y,h=e.z;var l;var u=n*n+o*o+h*h;var p=2*(r*n+a*o+s*h);var c=r*r+a*a+s*s-this._radius*this._radius;var d=p*p-4*u*c;if(d>=0){var f=Math.sqrt(d);l=(-p-f)/(2*u);if(l>=0){i.x=r+l*n;i.y=a+l*o;i.z=s+l*h;i.normalize();return l}}return-1};e.prototype.containsPoint=function(t){var e=t.x-this._centerX;var i=t.y-this._centerY;var r=t.z-this._centerZ;var a=Math.sqrt(e*e+i*i+r*r);return a<=this._radius};e.prototype.classifyToPlane=function(t){var e=t.a;var i=t.b;var r=t.c;var a=e*this._centerX+i*this._centerY+r*this._centerZ-t.d;if(e<0)e=-e;if(i<0)i=-i;if(r<0)r=-r;var n=(e+i+r)*this._radius;return a>n?s.FRONT:a<-n?s.BACK:s.INTERSECT};e.prototype.transformFrom=function(t,e){var i=t;var r=i._centerX;var a=i._centerY;var s=i._centerZ;var n=new Array(16);e.copyRawDataTo(n);var o=n[0],h=n[4],l=n[8],u=n[12];var p=n[1],c=n[5],d=n[9],f=n[13];var _=n[2],y=n[6],g=n[10],m=n[14];this._centerX=r*o+a*h+s*l+u;this._centerY=r*p+a*c+s*d+f;this._centerZ=r*_+a*y+s*g+m;if(o<0)o=-o;if(h<0)h=-h;if(l<0)l=-l;if(p<0)p=-p;if(c<0)c=-c;if(d<0)d=-d;if(_<0)_=-_;if(y<0)y=-y;if(g<0)g=-g;var b=i._radius;var v=o+h+l;var w=p+c+d;var x=_+y+g;this._radius=b*Math.sqrt(v*v+w*w+x*x);this._aabb.width=this._aabb.height=this._aabb.depth=this._radius*2;this._aabb.x=this._centerX-this._radius;this._aabb.y=this._centerY+this._radius;this._aabb.z=this._centerZ-this._radius};return e}(a);e.exports=o},{"awayjs-core/lib/bounds/BoundingVolumeBase":undefined,"awayjs-core/lib/geom/PlaneClassification":undefined,"awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-core/lib/bounds/BoundingVolumeBase":[function(t,e,i){var r=t("awayjs-core/lib/geom/Box");var a=t("awayjs-core/lib/errors/AbstractMethodError");var s=function(){function t(){this._pAabbPoints=new Array;this._pAabbPointsDirty=true;this._aabb=new r}Object.defineProperty(t.prototype,"aabb",{get:function(){return this._aabb},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"aabbPoints",{get:function(){if(this._pAabbPointsDirty)this.pUpdateAABBPoints();return this._pAabbPoints},enumerable:true,configurable:true});t.prototype.nullify=function(){this._aabb.x=this._aabb.y=this._aabb.z=0;this._aabb.width=this._aabb.height=this._aabb.depth=0;this._pAabbPointsDirty=true};t.prototype.fromVertices=function(t){var e;var i=t.length;var r,a,s;var n,o,h;if(i==0){this.nullify();return}var l;r=n=t[e++];a=o=t[e++];s=h=t[e++];while(e<i){l=t[e++];if(l<r)r=l;else if(l>n)n=l;l=t[e++];if(l<a)a=l;else if(l>o)o=l;l=t[e++];if(l<s)s=l;else if(l>h)h=l}this.fromExtremes(r,a,s,n,o,h)};t.prototype.fromSphere=function(t,e){this.fromExtremes(t.x-e,t.y-e,t.z-e,t.x+e,t.y+e,t.z+e)};t.prototype.fromExtremes=function(t,e,i,r,a,s){this._aabb.x=t;this._aabb.y=a;this._aabb.z=i;this._aabb.width=r-t;this._aabb.height=a-e;this._aabb.depth=s-i;this._pAabbPointsDirty=true};t.prototype.isInFrustum=function(t,e){throw new a};t.prototype.overlaps=function(t){return this._aabb.intersects(t.aabb)};t.prototype.clone=function(){throw new a};t.prototype.rayIntersection=function(t,e,i){return-1};t.prototype.containsPoint=function(t){return false};t.prototype.pUpdateAABBPoints=function(){var t=this._aabb.x;var e=this._aabb.y-this._aabb.height;var i=this._aabb.z;var r=this._aabb.x+this._aabb.width;var a=this._aabb.y;var s=this._aabb.z+this._aabb.depth;this._pAabbPoints[0]=t;this._pAabbPoints[1]=e;this._pAabbPoints[2]=i;this._pAabbPoints[3]=r;this._pAabbPoints[4]=e;this._pAabbPoints[5]=i;this._pAabbPoints[6]=t;this._pAabbPoints[7]=a;this._pAabbPoints[8]=i;this._pAabbPoints[9]=r;this._pAabbPoints[10]=a;this._pAabbPoints[11]=i;this._pAabbPoints[12]=t;this._pAabbPoints[13]=e;this._pAabbPoints[14]=s;this._pAabbPoints[15]=r;this._pAabbPoints[16]=e;this._pAabbPoints[17]=s;this._pAabbPoints[18]=t;this._pAabbPoints[19]=a;this._pAabbPoints[20]=s;this._pAabbPoints[21]=r;this._pAabbPoints[22]=a;this._pAabbPoints[23]=s;this._pAabbPointsDirty=false};t.prototype.classifyToPlane=function(t){throw new a};t.prototype.transformFrom=function(t,e){throw new a};return t}();e.exports=s},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/geom/Box":undefined}],"awayjs-core/lib/bounds/NullBounds":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/bounds/BoundingVolumeBase");var s=t("awayjs-core/lib/geom/PlaneClassification");var n=function(t){r(e,t);function e(e){if(e===void 0){e=true}t.call(this);this._alwaysIn=e;this._aabb.width=this._aabb.height=this._aabb.depth=Number.POSITIVE_INFINITY;this._aabb.x=this._aabb.y=this._aabb.z=this._alwaysIn?Number.NEGATIVE_INFINITY/2:Number.POSITIVE_INFINITY}e.prototype.clone=function(){return new e(this._alwaysIn)};e.prototype.isInFrustum=function(t,e){return this._alwaysIn};e.prototype.fromSphere=function(t,e){};e.prototype.fromExtremes=function(t,e,i,r,a,s){};e.prototype.classifyToPlane=function(t){return s.INTERSECT};e.prototype.transformFrom=function(t,e){this._alwaysIn=t._alwaysIn};return e}(a);e.exports=n},{"awayjs-core/lib/bounds/BoundingVolumeBase":undefined,"awayjs-core/lib/geom/PlaneClassification":undefined}],"awayjs-core/lib/errors/AbstractMethodError":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/Error");var s=function(t){r(e,t);function e(e,i){if(e===void 0){e=null}if(i===void 0){i=0}t.call(this,e||"An abstract method was called! Either an instance of an abstract class was created, or an abstract method was not overridden by the subclass.",i)}return e}(a);e.exports=s},{"awayjs-core/lib/errors/Error":undefined}],"awayjs-core/lib/errors/ArgumentError":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/Error");var s=function(t){r(e,t);function e(e,i){if(e===void 0){e=null}if(i===void 0){i=0}t.call(this,e||"ArgumentError",i)}return e}(a);e.exports=s},{"awayjs-core/lib/errors/Error":undefined}],"awayjs-core/lib/errors/DocumentError":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/Error");var s=function(t){r(e,t);function e(e,i){if(e===void 0){e="DocumentError"}if(i===void 0){i=0}t.call(this,e,i)}e.DOCUMENT_DOES_NOT_EXIST="documentDoesNotExist";return e}(a);e.exports=s},{"awayjs-core/lib/errors/Error":undefined}],"awayjs-core/lib/errors/Error":[function(t,e,i){var r=function(){function t(t,e,i){if(t===void 0){t=""}if(e===void 0){e=0}if(i===void 0){i=""}this._errorID=0;this._messsage="";this._name="";this._messsage=t;this._name=name;this._errorID=e}Object.defineProperty(t.prototype,"message",{get:function(){return this._messsage},set:function(t){this._messsage=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"name",{get:function(){return this._name},set:function(t){this._name=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"errorID",{get:function(){return this._errorID},enumerable:true,configurable:true});return t}();e.exports=r},{}],"awayjs-core/lib/errors/PartialImplementationError":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/Error");var s=function(t){r(e,t);function e(e,i){if(e===void 0){e=""}if(i===void 0){i=0}t.call(this,"PartialImplementationError - this function is in development. Required Dependency: "+e,i)}return e}(a);e.exports=s},{"awayjs-core/lib/errors/Error":undefined}],"awayjs-core/lib/errors/RangeError":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/Error");var s=function(t){r(e,t);function e(e,i){if(e===void 0){e=null}if(i===void 0){i=0}t.call(this,e||"RangeError",i)}return e}(a);e.exports=s},{"awayjs-core/lib/errors/Error":undefined}],"awayjs-core/lib/events/AssetEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e,i,r){if(i===void 0){i=null}if(r===void 0){r=null}t.call(this,e);this._asset=i;this._prevName=r||(this._asset?this._asset.name:null)}Object.defineProperty(e.prototype,"asset",{get:function(){return this._asset},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"assetPrevName",{get:function(){return this._prevName},enumerable:true,configurable:true});e.prototype.clone=function(){return new e(this.type,this.asset,this.assetPrevName)};e.ASSET_COMPLETE="assetComplete";e.ASSET_RENAME="assetRename";e.ASSET_CONFLICT_RESOLVED="assetConflictResolved";e.TEXTURE_SIZE_ERROR="textureSizeError";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":undefined}],"awayjs-core/lib/events/EventDispatcher":[function(t,e,i){var r=function(){function t(t){if(t===void 0){t=null}this.listeners=new Array;this.target=t||this}t.prototype.addEventListener=function(t,e){if(this.listeners[t]===undefined)this.listeners[t]=new Array;if(this.getEventListenerIndex(t,e)===-1)this.listeners[t].push(e)};t.prototype.removeEventListener=function(t,e){var i=this.getEventListenerIndex(t,e);if(i!==-1)this.listeners[t].splice(i,1)};t.prototype.dispatchEvent=function(t){var e=this.listeners[t.type];if(e!==undefined){var i=e.length;t.target=this.target;for(var r=0;r<i;r++)e[r](t)}};t.prototype.getEventListenerIndex=function(t,e){if(this.listeners[t]!==undefined){var i=this.listeners[t];var r=i.length;for(var a=0;a<r;a++)if(e==i[a])return a}return-1};t.prototype.hasEventListener=function(t,e){if(e!=null){return this.getEventListenerIndex(t,e)!==-1}else{if(this.listeners[t]!==undefined)return this.listeners[t].length>0;return false}return false};return t}();e.exports=r},{}],"awayjs-core/lib/events/Event":[function(t,e,i){var r=function(){function t(t){this.type=undefined;this.target=undefined;this.type=t}t.prototype.clone=function(){return new t(this.type)};t.COMPLETE="complete";t.OPEN="open";t.ENTER_FRAME="enterFrame";t.EXIT_FRAME="exitFrame";t.RESIZE="resize";t.ERROR="error";t.CHANGE="change";return t}();e.exports=r},{}],"awayjs-core/lib/events/HTTPStatusEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e,i){if(i===void 0){i=null}t.call(this,e);this.status=i}e.HTTP_STATUS="httpStatus";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":undefined}],"awayjs-core/lib/events/IEventDispatcher":[function(t,e,i){},{}],"awayjs-core/lib/events/IOErrorEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e){t.call(this,e)}e.IO_ERROR="ioError";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":undefined}],"awayjs-core/lib/events/LoaderEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e,i,r,a){if(i===void 0){i=null}if(r===void 0){r=null}if(a===void 0){a=null}t.call(this,e);this._url=i;this._content=r;this._assets=a}Object.defineProperty(e.prototype,"content",{get:function(){return this._content},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"url",{get:function(){return this._url},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"assets",{get:function(){return this._assets},enumerable:true,configurable:true});e.prototype.clone=function(){return new e(this.type,this._url,this._content,this._assets)};e.RESOURCE_COMPLETE="resourceComplete";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":undefined}],"awayjs-core/lib/events/ParserEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e,i){if(i===void 0){i=""}t.call(this,e);this._message=i}Object.defineProperty(e.prototype,"message",{get:function(){return this._message},enumerable:true,configurable:true});e.prototype.clone=function(){return new e(this.type,this.message)};e.PARSE_COMPLETE="parseComplete";e.PARSE_ERROR="parseError";e.READY_FOR_DEPENDENCIES="readyForDependencies";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":undefined}],"awayjs-core/lib/events/ProgressEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e){t.call(this,e)}e.PROGRESS="progress";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":undefined}],"awayjs-core/lib/events/ProjectionEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e,i){t.call(this,e);this._projection=i}Object.defineProperty(e.prototype,"projection",{get:function(){return this._projection},enumerable:true,configurable:true});e.MATRIX_CHANGED="matrixChanged";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":undefined}],"awayjs-core/lib/events/TimerEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e){t.call(this,e)}e.TIMER="timer";e.TIMER_COMPLETE="timerComplete";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":undefined}],"awayjs-core/lib/geom/Box":[function(t,e,i){var r=t("awayjs-core/lib/geom/Vector3D");var a=function(){function t(t,e,i,r,a,s){if(t===void 0){t=0}if(e===void 0){e=0}if(i===void 0){i=0}if(r===void 0){r=0}if(a===void 0){a=0}if(s===void 0){s=0}this.x=t;this.y=e;this.z=i;this.width=r;this.height=a;this.depth=s}Object.defineProperty(t.prototype,"back",{get:function(){return this.z+this.depth},set:function(t){this.depth=t-this.z},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},set:function(t){this.height=t-this.y},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"bottomRightBack",{get:function(){if(this._bottomRightBack==null)this._bottomRightBack=new r;this._bottomRightBack.x=this.x+this.width;this._bottomRightBack.y=this.y+this.height;this._bottomRightBack.z=this.z+this.depth;return this._bottomRightBack},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"front",{get:function(){return this.z},set:function(t){this.depth+=this.z-t;this.z=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"left",{get:function(){return this.x},set:function(t){this.width+=this.x-t;this.x=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},set:function(t){this.width=t-this.x},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"size",{get:function(){if(this._size==null)this._size=new r;this._size.x=this.width;this._size.y=this.height;this._size.z=this.depth;return this._size},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"top",{get:function(){return this.y},set:function(t){this.height+=this.y-t;this.y=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"topLeftFront",{get:function(){if(this._topLeftFront==null)this._topLeftFront=new r;
this._topLeftFront.x=this.x;this._topLeftFront.y=this.y;this._topLeftFront.z=this.z;return this._topLeftFront},enumerable:true,configurable:true});t.prototype.clone=function(){return new t(this.x,this.y,this.z,this.width,this.height,this.depth)};t.prototype.contains=function(t,e,i){return this.x<=t&&this.x+this.width>=t&&this.y<=e&&this.y+this.height>=e&&this.z<=i&&this.z+this.depth>=i};t.prototype.containsPoint=function(t){return this.x<=t.x&&this.x+this.width>=t.x&&this.y<=t.y&&this.y+this.height>=t.y&&this.z<=t.z&&this.z+this.depth>=t.z};t.prototype.containsRect=function(t){return this.x<=t.x&&this.x+this.width>=t.x+t.width&&this.y<=t.y&&this.y+this.height>=t.y+t.height&&this.z<=t.z&&this.z+this.depth>=t.z+t.depth};t.prototype.copyFrom=function(t){};t.prototype.equals=function(t){return this.x==t.x&&this.y==t.y&&this.z==t.z&&this.width==t.width&&this.height==t.height&&this.depth==t.depth};t.prototype.inflate=function(t,e,i){this.x-=t/2;this.y-=e/2;this.z-=i/2;this.width+=t/2;this.height+=e/2;this.depth+=i/2};t.prototype.inflatePoint=function(t){this.x-=t.x/2;this.y-=t.y/2;this.z-=t.z/2;this.width+=t.x/2;this.height+=t.y/2;this.depth+=t.z/2};t.prototype.intersection=function(e){if(this.intersects(e)){var i=new t;if(this.x>e.x){i.x=this.x;i.width=e.x-this.x+e.width;if(i.width>this.width)i.width=this.width}else{i.x=e.x;i.width=this.x-e.x+this.width;if(i.width>e.width)i.width=e.width}if(this.y>e.y){i.y=this.y;i.height=e.y-this.y+e.height;if(i.height>this.height)i.height=this.height}else{i.y=e.y;i.height=this.y-e.y+this.height;if(i.height>e.height)i.height=e.height}if(this.z>e.z){i.z=this.z;i.depth=e.z-this.z+e.depth;if(i.depth>this.depth)i.depth=this.depth}else{i.z=e.z;i.depth=this.z-e.z+this.depth;if(i.depth>e.depth)i.depth=e.depth}return i}return new t};t.prototype.intersects=function(t){return this.x+this.width>t.x&&this.x<t.x+t.width&&this.y+this.height>t.y&&this.y<t.y+t.height&&this.z+this.depth>t.z&&this.z<t.z+t.depth};t.prototype.isEmpty=function(){return this.x==0&&this.y==0&&this.z==0&&this.width==0&&this.height==0&&this.depth==0};t.prototype.offset=function(t,e,i){this.x+=t;this.y+=e;this.z+=i};t.prototype.offsetPosition=function(t){this.x+=t.x;this.y+=t.y;this.z+=t.z};t.prototype.setEmpty=function(){this.x=0;this.y=0;this.z=0;this.width=0;this.height=0;this.depth=0};t.prototype.setTo=function(t,e,i,r,a,s){this.x=t;this.y=e;this.z=i;this.width=r;this.height=a;this.depth=s};t.prototype.toString=function(){return"[Box] (x="+this.x+", y="+this.y+", z="+this.z+", width="+this.width+", height="+this.height+", depth="+this.depth+")"};t.prototype.union=function(e){var i=new t;if(this.x<e.x){i.x=this.x;i.width=e.x-this.x+e.width;if(i.width<this.width)i.width=this.width}else{i.x=e.x;i.width=this.x-e.x+this.width;if(i.width<e.width)i.width=e.width}if(this.y<e.y){i.y=this.y;i.height=e.y-this.y+e.height;if(i.height<this.height)i.height=this.height}else{i.y=e.y;i.height=this.y-e.y+this.height;if(i.height<e.height)i.height=e.height}if(this.z<e.z){i.z=this.z;i.depth=e.z-this.z+e.depth;if(i.depth<this.depth)i.depth=this.depth}else{i.z=e.z;i.depth=this.z-e.z+this.depth;if(i.depth<e.depth)i.depth=e.depth}return i};return t}();e.exports=a},{"awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-core/lib/geom/ColorTransform":[function(t,e,i){var r=t("awayjs-core/lib/utils/ColorUtils");var a=function(){function t(t,e,i,r,a,s,n,o){if(t===void 0){t=1}if(e===void 0){e=1}if(i===void 0){i=1}if(r===void 0){r=1}if(a===void 0){a=0}if(s===void 0){s=0}if(n===void 0){n=0}if(o===void 0){o=0}this.redMultiplier=t;this.greenMultiplier=e;this.blueMultiplier=i;this.alphaMultiplier=r;this.redOffset=a;this.greenOffset=s;this.blueOffset=n;this.alphaOffset=o}Object.defineProperty(t.prototype,"color",{get:function(){return this.redOffset<<16|this.greenOffset<<8|this.blueOffset},set:function(t){var e=r.float32ColorToARGB(t);this.redOffset=e[1];this.greenOffset=e[2];this.blueOffset=e[3];this.redMultiplier=0;this.greenMultiplier=0;this.blueMultiplier=0},enumerable:true,configurable:true});t.prototype.concat=function(t){this.redMultiplier+=t.redMultiplier;this.greenMultiplier+=t.greenMultiplier;this.blueMultiplier+=t.blueMultiplier;this.alphaMultiplier+=t.alphaMultiplier};return t}();e.exports=a},{"awayjs-core/lib/utils/ColorUtils":undefined}],"awayjs-core/lib/geom/MathConsts":[function(t,e,i){var r=function(){function t(){}t.RADIANS_TO_DEGREES=180/Math.PI;t.DEGREES_TO_RADIANS=Math.PI/180;return t}();e.exports=r},{}],"awayjs-core/lib/geom/Matrix3DUtils":[function(t,e,i){var r=t("awayjs-core/lib/geom/Matrix3D");var a=t("awayjs-core/lib/geom/Vector3D");var s=function(){function t(){}t.quaternion2matrix=function(e,i){if(i===void 0){i=null}var a=e.x;var s=e.y;var n=e.z;var o=e.w;var h=a*a;var l=a*s;var u=a*n;var p=a*o;var c=s*s;var d=s*n;var f=s*o;var _=n*n;var y=n*o;var g=t.RAW_DATA_CONTAINER;g[0]=1-2*(c+_);g[1]=2*(l+y);g[2]=2*(u-f);g[4]=2*(l-y);g[5]=1-2*(h+_);g[6]=2*(d+p);g[8]=2*(u+f);g[9]=2*(d-p);g[10]=1-2*(h+c);g[3]=g[7]=g[11]=g[12]=g[13]=g[14]=0;g[15]=1;if(i){i.copyRawDataFrom(g);return i}else return new r(g)};t.getForward=function(t,e){if(e===void 0){e=null}if(e===null){e=new a(0,0,0)}t.copyColumnTo(2,e);e.normalize();return e};t.getUp=function(t,e){if(e===void 0){e=null}if(e===null){e=new a(0,0,0)}t.copyColumnTo(1,e);e.normalize();return e};t.getRight=function(t,e){if(e===void 0){e=null}if(e===null){e=new a(0,0,0)}t.copyColumnTo(0,e);e.normalize();return e};t.compare=function(e,i){var r=t.RAW_DATA_CONTAINER;var a=i.rawData;e.copyRawDataTo(r);for(var s=0;s<16;++s){if(r[s]!=a[s])return false}return true};t.lookAt=function(e,i,r,a){var s;var n;var o;var h=t.RAW_DATA_CONTAINER;o=r.crossProduct(a);o.normalize();n=o.crossProduct(r);n.normalize();s=r.clone();s.normalize();h[0]=o.x;h[1]=n.x;h[2]=-s.x;h[3]=0;h[4]=o.y;h[5]=n.y;h[6]=-s.y;h[7]=0;h[8]=o.z;h[9]=n.z;h[10]=-s.z;h[11]=0;h[12]=-o.dotProduct(i);h[13]=-n.dotProduct(i);h[14]=s.dotProduct(i);h[15]=1;e.copyRawDataFrom(h)};t.reflection=function(e,i){if(i===void 0){i=null}if(i===null)i=new r;var a=e.a,s=e.b,n=e.c,o=e.d;var h=t.RAW_DATA_CONTAINER;var l=-2*a*s;var u=-2*a*n;var p=-2*s*n;h[0]=1-2*a*a;h[4]=l;h[8]=u;h[12]=-2*a*o;h[1]=l;h[5]=1-2*s*s;h[9]=p;h[13]=-2*s*o;h[2]=u;h[6]=p;h[10]=1-2*n*n;h[14]=-2*n*o;h[3]=0;h[7]=0;h[11]=0;h[15]=1;i.copyRawDataFrom(h);return i};t.transformVector=function(e,i,r){if(r===void 0){r=null}if(!r)r=new a;var s=t.RAW_DATA_CONTAINER;e.copyRawDataTo(s);var n=s[0];var o=s[1];var h=s[2];var l=s[3];var u=s[4];var p=s[5];var c=s[6];var d=s[7];var f=s[8];var _=s[9];var y=s[10];var g=s[11];var m=s[12];var b=s[13];var v=s[14];var w=s[15];var x=i.x;var P=i.y;var D=i.z;r.x=n*x+u*P+f*D+m;r.y=o*x+p*P+_*D+b;r.z=h*x+c*P+y*D+v;r.w=l*x+d*P+g*D+w;return r};t.deltaTransformVector=function(e,i,r){if(r===void 0){r=null}if(!r)r=new a;var s=t.RAW_DATA_CONTAINER;e.copyRawDataTo(s);var n=s[0];var o=s[1];var h=s[2];var l=s[3];var u=s[4];var p=s[5];var c=s[6];var d=s[7];var f=s[8];var _=s[9];var y=s[10];var g=s[11];var m=i.x;var b=i.y;var v=i.z;r.x=n*m+u*b+f*v;r.y=o*m+p*b+_*v;r.z=h*m+c*b+y*v;r.w=l*m+d*b+g*v;return r};t.getTranslation=function(t,e){if(e===void 0){e=null}if(!e)e=new a;t.copyColumnTo(3,e);return e};t.deltaTransformVectors=function(e,i,r){var a=t.RAW_DATA_CONTAINER;e.copyRawDataTo(a);var s=a[0];var n=a[1];var o=a[2];var h=a[3];var l=a[4];var u=a[5];var p=a[6];var c=a[7];var d=a[8];var f=a[9];var _=a[10];var y=a[11];var g=0;var m=i.length;for(var b=0;b<m;b+=3){var v=i[b];var w=i[b+1];var x=i[b+2];r[g++]=s*v+l*w+d*x;r[g++]=n*v+u*w+f*x;r[g++]=o*v+p*w+_*x}};t.RAW_DATA_CONTAINER=new Array(16);t.CALCULATION_MATRIX=new r;return t}();e.exports=s},{"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-core/lib/geom/Matrix3D":[function(t,e,i){var r=t("awayjs-core/lib/geom/Orientation3D");var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-core/lib/errors/ArgumentError");var n=function(){function t(t){if(t===void 0){t=null}if(t!=null&&t.length==16)this.rawData=t.concat();else this.rawData=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}t.prototype.append=function(t){var e=this.rawData[0],i=this.rawData[4],r=this.rawData[8],a=this.rawData[12],s=this.rawData[1],n=this.rawData[5],o=this.rawData[9],h=this.rawData[13],l=this.rawData[2],u=this.rawData[6],p=this.rawData[10],c=this.rawData[14],d=this.rawData[3],f=this.rawData[7],_=this.rawData[11],y=this.rawData[15],g=t.rawData[0],m=t.rawData[4],b=t.rawData[8],v=t.rawData[12],w=t.rawData[1],x=t.rawData[5],P=t.rawData[9],D=t.rawData[13],C=t.rawData[2],T=t.rawData[6],A=t.rawData[10],S=t.rawData[14],j=t.rawData[3],O=t.rawData[7],E=t.rawData[11],M=t.rawData[15];this.rawData[0]=e*g+s*m+l*b+d*v;this.rawData[1]=e*w+s*x+l*P+d*D;this.rawData[2]=e*C+s*T+l*A+d*S;this.rawData[3]=e*j+s*O+l*E+d*M;this.rawData[4]=i*g+n*m+u*b+f*v;this.rawData[5]=i*w+n*x+u*P+f*D;this.rawData[6]=i*C+n*T+u*A+f*S;this.rawData[7]=i*j+n*O+u*E+f*M;this.rawData[8]=r*g+o*m+p*b+_*v;this.rawData[9]=r*w+o*x+p*P+_*D;this.rawData[10]=r*C+o*T+p*A+_*S;this.rawData[11]=r*j+o*O+p*E+_*M;this.rawData[12]=a*g+h*m+c*b+y*v;this.rawData[13]=a*w+h*x+c*P+y*D;this.rawData[14]=a*C+h*T+c*A+y*S;this.rawData[15]=a*j+h*O+c*E+y*M};t.prototype.appendRotation=function(e,i){var r=t.getAxisRotation(i.x,i.y,i.z,e);this.append(r)};t.prototype.appendScale=function(e,i,r){this.append(new t([e,0,0,0,0,i,0,0,0,0,r,0,0,0,0,1]))};t.prototype.appendTranslation=function(t,e,i){this.rawData[12]+=t;this.rawData[13]+=e;this.rawData[14]+=i};t.prototype.clone=function(){return new t(this.rawData.slice(0))};t.prototype.copyColumnFrom=function(t,e){switch(t){case 0:this.rawData[0]=e.x;this.rawData[1]=e.y;this.rawData[2]=e.z;this.rawData[3]=e.w;break;case 1:this.rawData[4]=e.x;this.rawData[5]=e.y;this.rawData[6]=e.z;this.rawData[7]=e.w;break;case 2:this.rawData[8]=e.x;this.rawData[9]=e.y;this.rawData[10]=e.z;this.rawData[11]=e.w;break;case 3:this.rawData[12]=e.x;this.rawData[13]=e.y;this.rawData[14]=e.z;this.rawData[15]=e.w;break;default:throw new s("ArgumentError, Column "+t+" out of bounds [0, ..., 3]")}};t.prototype.copyColumnTo=function(t,e){switch(t){case 0:e.x=this.rawData[0];e.y=this.rawData[1];e.z=this.rawData[2];e.w=this.rawData[3];break;case 1:e.x=this.rawData[4];e.y=this.rawData[5];e.z=this.rawData[6];e.w=this.rawData[7];break;case 2:e.x=this.rawData[8];e.y=this.rawData[9];e.z=this.rawData[10];e.w=this.rawData[11];break;case 3:e.x=this.rawData[12];e.y=this.rawData[13];e.z=this.rawData[14];e.w=this.rawData[15];break;default:throw new s("ArgumentError, Column "+t+" out of bounds [0, ..., 3]")}};t.prototype.copyFrom=function(t){var e=t.rawData.length;for(var i=0;i<e;i++)this.rawData[i]=t.rawData[i]};t.prototype.copyRawDataFrom=function(t,e,i){if(e===void 0){e=0}if(i===void 0){i=false}if(i)this.transpose();var r=t.length-e;for(var a=0;a<r;a++)this.rawData[a]=t[a+e];if(i)this.transpose()};t.prototype.copyRawDataTo=function(t,e,i){if(e===void 0){e=0}if(i===void 0){i=false}if(i)this.transpose();var r=this.rawData.length;for(var a=0;a<r;a++)t[a+e]=this.rawData[a];if(i)this.transpose()};t.prototype.copyRowFrom=function(t,e){switch(t){case 0:this.rawData[0]=e.x;this.rawData[4]=e.y;this.rawData[8]=e.z;this.rawData[12]=e.w;break;case 1:this.rawData[1]=e.x;this.rawData[5]=e.y;this.rawData[9]=e.z;this.rawData[13]=e.w;break;case 2:this.rawData[2]=e.x;this.rawData[6]=e.y;this.rawData[10]=e.z;this.rawData[14]=e.w;break;case 3:this.rawData[3]=e.x;this.rawData[7]=e.y;this.rawData[11]=e.z;this.rawData[15]=e.w;break;default:throw new s("ArgumentError, Row "+t+" out of bounds [0, ..., 3]")}};t.prototype.copyRowTo=function(t,e){switch(t){case 0:e.x=this.rawData[0];e.y=this.rawData[4];e.z=this.rawData[8];e.w=this.rawData[12];break;case 1:e.x=this.rawData[1];e.y=this.rawData[5];e.z=this.rawData[9];e.w=this.rawData[13];break;case 2:e.x=this.rawData[2];e.y=this.rawData[6];e.z=this.rawData[10];e.w=this.rawData[14];break;case 3:e.x=this.rawData[3];e.y=this.rawData[7];e.z=this.rawData[11];e.w=this.rawData[15];break;default:throw new s("ArgumentError, Row "+t+" out of bounds [0, ..., 3]")}};t.prototype.copyToMatrix3D=function(t){t.rawData=this.rawData.slice(0)};t.prototype.decompose=function(t){if(t===void 0){t="eulerAngles"}var e;var i=[];var s=this.clone();var n=s.rawData;var o=new a(n[12],n[13],n[14]);n[12]=0;n[13]=0;n[14]=0;var h=new a;h.x=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);h.y=Math.sqrt(n[4]*n[4]+n[5]*n[5]+n[6]*n[6]);h.z=Math.sqrt(n[8]*n[8]+n[9]*n[9]+n[10]*n[10]);if(n[0]*(n[5]*n[10]-n[6]*n[9])-n[1]*(n[4]*n[10]-n[6]*n[8])+n[2]*(n[4]*n[9]-n[5]*n[8])<0)h.z=-h.z;n[0]/=h.x;n[1]/=h.x;n[2]/=h.x;n[4]/=h.y;n[5]/=h.y;n[6]/=h.y;n[8]/=h.z;n[9]/=h.z;n[10]/=h.z;var l=new a;switch(t){case r.AXIS_ANGLE:l.w=Math.acos((n[0]+n[5]+n[10]-1)/2);var u=Math.sqrt((n[6]-n[9])*(n[6]-n[9])+(n[8]-n[2])*(n[8]-n[2])+(n[1]-n[4])*(n[1]-n[4]));l.x=(n[6]-n[9])/u;l.y=(n[8]-n[2])/u;l.z=(n[1]-n[4])/u;break;case r.QUATERNION:var p=n[0]+n[5]+n[10];if(p>0){l.w=Math.sqrt(1+p)/2;l.x=(n[6]-n[9])/(4*l.w);l.y=(n[8]-n[2])/(4*l.w);l.z=(n[1]-n[4])/(4*l.w)}else if(n[0]>n[5]&&n[0]>n[10]){l.x=Math.sqrt(1+n[0]-n[5]-n[10])/2;l.w=(n[6]-n[9])/(4*l.x);l.y=(n[1]+n[4])/(4*l.x);l.z=(n[8]+n[2])/(4*l.x)}else if(n[5]>n[10]){l.y=Math.sqrt(1+n[5]-n[0]-n[10])/2;l.x=(n[1]+n[4])/(4*l.y);l.w=(n[8]-n[2])/(4*l.y);l.z=(n[6]+n[9])/(4*l.y)}else{l.z=Math.sqrt(1+n[10]-n[0]-n[5])/2;l.x=(n[8]+n[2])/(4*l.z);l.y=(n[6]+n[9])/(4*l.z);l.w=(n[1]-n[4])/(4*l.z)}break;case r.EULER_ANGLES:l.y=Math.asin(-n[2]);if(n[2]!=1&&n[2]!=-1){l.x=Math.atan2(n[6],n[10]);l.z=Math.atan2(n[1],n[0])}else{l.z=0;l.x=Math.atan2(n[4],n[5])}break}i.push(o);i.push(l);i.push(h);return i};t.prototype.deltaTransformVector=function(t){var e=t.x;var i=t.y;var r=t.z;return new a(e*this.rawData[0]+i*this.rawData[4]+r*this.rawData[8],e*this.rawData[1]+i*this.rawData[5]+r*this.rawData[9],e*this.rawData[2]+i*this.rawData[6]+r*this.rawData[10],e*this.rawData[3]+i*this.rawData[7]+r*this.rawData[11])};t.prototype.identity=function(){this.rawData=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};t.interpolate=function(e,i,r){var a=new t;for(var s=0;s<16;++s)a.rawData[s]=e.rawData[s]+(i.rawData[s]-e.rawData[s])*r;return a};t.prototype.interpolateTo=function(t,e){for(var i=0;i<16;++i)this.rawData[i]=this.rawData[i]+(t.rawData[i]-this.rawData[i])*e};t.prototype.invert=function(){var t=this.determinant;var e=Math.abs(t)>1e-11;if(e){t=1/t;var i=this.rawData[0];var r=this.rawData[4];var a=this.rawData[8];var s=this.rawData[12];var n=this.rawData[1];var o=this.rawData[5];var h=this.rawData[9];var l=this.rawData[13];var u=this.rawData[2];var p=this.rawData[6];var c=this.rawData[10];var d=this.rawData[14];var f=this.rawData[3];var _=this.rawData[7];var y=this.rawData[11];var g=this.rawData[15];this.rawData[0]=t*(o*(c*g-d*y)-h*(p*g-d*_)+l*(p*y-c*_));this.rawData[1]=-t*(n*(c*g-d*y)-h*(u*g-d*f)+l*(u*y-c*f));this.rawData[2]=t*(n*(p*g-d*_)-o*(u*g-d*f)+l*(u*_-p*f));this.rawData[3]=-t*(n*(p*y-c*_)-o*(u*y-c*f)+h*(u*_-p*f));this.rawData[4]=-t*(r*(c*g-d*y)-a*(p*g-d*_)+s*(p*y-c*_));this.rawData[5]=t*(i*(c*g-d*y)-a*(u*g-d*f)+s*(u*y-c*f));this.rawData[6]=-t*(i*(p*g-d*_)-r*(u*g-d*f)+s*(u*_-p*f));this.rawData[7]=t*(i*(p*y-c*_)-r*(u*y-c*f)+a*(u*_-p*f));this.rawData[8]=t*(r*(h*g-l*y)-a*(o*g-l*_)+s*(o*y-h*_));this.rawData[9]=-t*(i*(h*g-l*y)-a*(n*g-l*f)+s*(n*y-h*f));this.rawData[10]=t*(i*(o*g-l*_)-r*(n*g-l*f)+s*(n*_-o*f));this.rawData[11]=-t*(i*(o*y-h*_)-r*(n*y-h*f)+a*(n*_-o*f));this.rawData[12]=-t*(r*(h*d-l*c)-a*(o*d-l*p)+s*(o*c-h*p));this.rawData[13]=t*(i*(h*d-l*c)-a*(n*d-l*u)+s*(n*c-h*u));this.rawData[14]=-t*(i*(o*d-l*p)-r*(n*d-l*u)+s*(n*p-o*u));this.rawData[15]=t*(i*(o*c-h*p)-r*(n*c-h*u)+a*(n*p-o*u))}return e};t.prototype.prepend=function(t){var e=t.rawData[0],i=t.rawData[4],r=t.rawData[8],a=t.rawData[12],s=t.rawData[1],n=t.rawData[5],o=t.rawData[9],h=t.rawData[13],l=t.rawData[2],u=t.rawData[6],p=t.rawData[10],c=t.rawData[14],d=t.rawData[3],f=t.rawData[7],_=t.rawData[11],y=t.rawData[15],g=this.rawData[0],m=this.rawData[4],b=this.rawData[8],v=this.rawData[12],w=this.rawData[1],x=this.rawData[5],P=this.rawData[9],D=this.rawData[13],C=this.rawData[2],T=this.rawData[6],A=this.rawData[10],S=this.rawData[14],j=this.rawData[3],O=this.rawData[7],E=this.rawData[11],M=this.rawData[15];this.rawData[0]=e*g+s*m+l*b+d*v;this.rawData[1]=e*w+s*x+l*P+d*D;this.rawData[2]=e*C+s*T+l*A+d*S;this.rawData[3]=e*j+s*O+l*E+d*M;this.rawData[4]=i*g+n*m+u*b+f*v;this.rawData[5]=i*w+n*x+u*P+f*D;this.rawData[6]=i*C+n*T+u*A+f*S;this.rawData[7]=i*j+n*O+u*E+f*M;this.rawData[8]=r*g+o*m+p*b+_*v;this.rawData[9]=r*w+o*x+p*P+_*D;this.rawData[10]=r*C+o*T+p*A+_*S;this.rawData[11]=r*j+o*O+p*E+_*M;this.rawData[12]=a*g+h*m+c*b+y*v;this.rawData[13]=a*w+h*x+c*P+y*D;this.rawData[14]=a*C+h*T+c*A+y*S;this.rawData[15]=a*j+h*O+c*E+y*M};t.prototype.prependRotation=function(e,i){var r=t.getAxisRotation(i.x,i.y,i.z,e);this.prepend(r)};t.prototype.prependScale=function(e,i,r){this.prepend(new t([e,0,0,0,0,i,0,0,0,0,r,0,0,0,0,1]))};t.prototype.prependTranslation=function(e,i,r){var s=new t;s.position=new a(e,i,r);this.prepend(s)};t.prototype.recompose=function(e){if(e.length<3)return false;this.identity();this.appendScale(e[2].x,e[2].y,e[2].z);var i;i=-e[1].x;this.append(new t([1,0,0,0,0,Math.cos(i),-Math.sin(i),0,0,Math.sin(i),Math.cos(i),0,0,0,0,0]));i=-e[1].y;this.append(new t([Math.cos(i),0,Math.sin(i),0,0,1,0,0,-Math.sin(i),0,Math.cos(i),0,0,0,0,0]));i=-e[1].z;this.append(new t([Math.cos(i),-Math.sin(i),0,0,Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,0]));this.position=e[0];this.rawData[15]=1;return true};t.prototype.transformVector=function(t){var e=t.x;var i=t.y;var r=t.z;return new a(e*this.rawData[0]+i*this.rawData[4]+r*this.rawData[8]+this.rawData[12],e*this.rawData[1]+i*this.rawData[5]+r*this.rawData[9]+this.rawData[13],e*this.rawData[2]+i*this.rawData[6]+r*this.rawData[10]+this.rawData[14],e*this.rawData[3]+i*this.rawData[7]+r*this.rawData[11]+this.rawData[15])};t.prototype.transformVectors=function(t,e){var i=0;var r=0,a=0,s=0;while(i+3<=t.length){r=t[i];a=t[i+1];s=t[i+2];e[i]=r*this.rawData[0]+a*this.rawData[4]+s*this.rawData[8]+this.rawData[12];e[i+1]=r*this.rawData[1]+a*this.rawData[5]+s*this.rawData[9]+this.rawData[13];e[i+2]=r*this.rawData[2]+a*this.rawData[6]+s*this.rawData[10]+this.rawData[14];i+=3}};t.prototype.transpose=function(){var t=this.rawData.slice(0);this.rawData[1]=t[4];this.rawData[2]=t[8];this.rawData[3]=t[12];this.rawData[4]=t[1];this.rawData[6]=t[9];this.rawData[7]=t[13];this.rawData[8]=t[2];this.rawData[9]=t[6];this.rawData[11]=t[14];this.rawData[12]=t[3];this.rawData[13]=t[7];this.rawData[14]=t[11]};t.getAxisRotation=function(e,i,r,a){var s=new t;var n=a*(Math.PI/180);var o=Math.cos(n);var h=Math.sin(n);var l=1-o;var u,p;s.rawData[0]=o+e*e*l;s.rawData[5]=o+i*i*l;s.rawData[10]=o+r*r*l;u=e*i*l;p=r*h;s.rawData[1]=u+p;s.rawData[4]=u-p;u=e*r*l;p=i*h;s.rawData[8]=u+p;s.rawData[2]=u-p;u=i*r*l;p=e*h;s.rawData[9]=u-p;s.rawData[6]=u+p;return s};Object.defineProperty(t.prototype,"determinant",{get:function(){return(this.rawData[0]*this.rawData[5]-this.rawData[4]*this.rawData[1])*(this.rawData[10]*this.rawData[15]-this.rawData[14]*this.rawData[11])-(this.rawData[0]*this.rawData[9]-this.rawData[8]*this.rawData[1])*(this.rawData[6]*this.rawData[15]-this.rawData[14]*this.rawData[7])+(this.rawData[0]*this.rawData[13]-this.rawData[12]*this.rawData[1])*(this.rawData[6]*this.rawData[11]-this.rawData[10]*this.rawData[7])+(this.rawData[4]*this.rawData[9]-this.rawData[8]*this.rawData[5])*(this.rawData[2]*this.rawData[15]-this.rawData[14]*this.rawData[3])-(this.rawData[4]*this.rawData[13]-this.rawData[12]*this.rawData[5])*(this.rawData[2]*this.rawData[11]-this.rawData[10]*this.rawData[3])+(this.rawData[8]*this.rawData[13]-this.rawData[12]*this.rawData[9])*(this.rawData[2]*this.rawData[7]-this.rawData[6]*this.rawData[3])},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"position",{get:function(){return new a(this.rawData[12],this.rawData[13],this.rawData[14])},set:function(t){this.rawData[12]=t.x;this.rawData[13]=t.y;this.rawData[14]=t.z},enumerable:true,configurable:true});t.prototype.toFixed=function(t){var e=Math.pow(10,t);return"matrix3d("+Math.round(this.rawData[0]*e)/e+","+Math.round(this.rawData[1]*e)/e+","+Math.round(this.rawData[2]*e)/e+","+Math.round(this.rawData[3]*e)/e+","+Math.round(this.rawData[4]*e)/e+","+Math.round(this.rawData[5]*e)/e+","+Math.round(this.rawData[6]*e)/e+","+Math.round(this.rawData[7]*e)/e+","+Math.round(this.rawData[8]*e)/e+","+Math.round(this.rawData[9]*e)/e+","+Math.round(this.rawData[10]*e)/e+","+Math.round(this.rawData[11]*e)/e+","+Math.round(this.rawData[12]*e)/e+","+Math.round(this.rawData[13]*e)/e+","+Math.round(this.rawData[14]*e)/e+","+Math.round(this.rawData[15]*e)/e+")"};t.prototype.toString=function(){return"matrix3d("+Math.round(this.rawData[0]*1e3)/1e3+","+Math.round(this.rawData[1]*1e3)/1e3+","+Math.round(this.rawData[2]*1e3)/1e3+","+Math.round(this.rawData[3]*1e3)/1e3+","+Math.round(this.rawData[4]*1e3)/1e3+","+Math.round(this.rawData[5]*1e3)/1e3+","+Math.round(this.rawData[6]*1e3)/1e3+","+Math.round(this.rawData[7]*1e3)/1e3+","+Math.round(this.rawData[8]*1e3)/1e3+","+Math.round(this.rawData[9]*1e3)/1e3+","+Math.round(this.rawData[10]*1e3)/1e3+","+Math.round(this.rawData[11]*1e3)/1e3+","+Math.round(this.rawData[12]*1e3)/1e3+","+Math.round(this.rawData[13]*1e3)/1e3+","+Math.round(this.rawData[14]*1e3)/1e3+","+Math.round(this.rawData[15]*1e3)/1e3+")"};return t}();e.exports=n},{"awayjs-core/lib/errors/ArgumentError":undefined,"awayjs-core/lib/geom/Orientation3D":undefined,"awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-core/lib/geom/Matrix":[function(t,e,i){var r=t("awayjs-core/lib/geom/Point");var a=t("awayjs-core/lib/errors/ArgumentError");var s=function(){function t(t,e,i,r,a,s){if(t===void 0){t=1}if(e===void 0){e=0}if(i===void 0){i=0}if(r===void 0){r=1}if(a===void 0){a=0}if(s===void 0){s=0}this.a=t;this.b=e;this.c=i;this.d=r;this.tx=a;this.ty=s}t.prototype.clone=function(){return new t(this.a,this.b,this.c,this.d,this.tx,this.ty)};t.prototype.concat=function(t){var e=this.a*t.a+this.b*t.c;this.b=this.a*t.b+this.b*t.d;this.a=e;var i=this.c*t.a+this.d*t.c;this.d=this.c*t.b+this.d*t.d;this.c=i;var r=this.tx*t.a+this.ty*t.c+t.tx;this.ty=this.tx*t.b+this.ty*t.d+t.ty;this.tx=r};t.prototype.copyColumnFrom=function(t,e){if(t>2){throw"Column "+t+" out of bounds (2)"}else if(t==0){this.a=e.x;this.c=e.y}else if(t==1){this.b=e.x;this.d=e.y}else{this.tx=e.x;this.ty=e.y}};t.prototype.copyColumnTo=function(t,e){if(t>2){throw new a("ArgumentError, Column "+t+" out of bounds [0, ..., 2]")}else if(t==0){e.x=this.a;e.y=this.c;e.z=0}else if(t==1){e.x=this.b;e.y=this.d;e.z=0}else{e.x=this.tx;e.y=this.ty;e.z=1}};t.prototype.copyFrom=function(t){this.a=t.a;this.b=t.b;this.c=t.c;this.d=t.d;this.tx=t.tx;this.ty=t.ty};t.prototype.copyRowFrom=function(t,e){if(t>2){throw new a("ArgumentError, Row "+t+" out of bounds [0, ..., 2]")}else if(t==0){this.a=e.x;this.c=e.y}else if(t==1){this.b=e.x;this.d=e.y}else{this.tx=e.x;this.ty=e.y}};t.prototype.copyRowTo=function(t,e){if(t>2){throw new a("ArgumentError, Row "+t+" out of bounds [0, ..., 2]")}else if(t==0){e.x=this.a;e.y=this.b;e.z=this.tx}else if(t==1){e.x=this.c;e.y=this.d;e.z=this.ty}else{e.setTo(0,0,1)}};t.prototype.createBox=function(t,e,i,r,a){if(i===void 0){i=0}if(r===void 0){r=0}if(a===void 0){a=0}this.a=t;this.d=e;this.b=i;this.tx=r;this.ty=a};t.prototype.createGradientBox=function(t,e,i,r,a){if(i===void 0){i=0}if(r===void 0){r=0}if(a===void 0){a=0}this.a=t/1638.4;this.d=e/1638.4;if(i!=0){var s=Math.cos(i);var n=Math.sin(i);this.b=n*this.d;this.c=-n*this.a;this.a*=s;this.d*=s}else{this.b=this.c=0}this.tx=r+t/2;this.ty=a+e/2};t.prototype.deltaTransformPoint=function(t){return new r(t.x*this.a+t.y*this.c,t.x*this.b+t.y*this.d)};t.prototype.identity=function(){this.a=1;this.b=0;this.c=0;this.d=1;this.tx=0;this.ty=0};t.prototype.invert=function(){var t=this.a*this.d-this.b*this.c;if(t==0){this.a=this.b=this.c=this.d=0;this.tx=-this.tx;this.ty=-this.ty}else{t=1/t;var e=this.d*t;this.d=this.a*t;this.a=e;this.b*=-t;this.c*=-t;var i=-this.a*this.tx-this.c*this.ty;this.ty=-this.b*this.tx-this.d*this.ty;this.tx=i}};t.prototype.multiply=function(e){var i=new t;i.a=this.a*e.a+this.b*e.c;i.b=this.a*e.b+this.b*e.d;i.c=this.c*e.a+this.d*e.c;i.d=this.c*e.b+this.d*e.d;i.tx=this.tx*e.a+this.ty*e.c+e.tx;i.ty=this.tx*e.b+this.ty*e.d+e.ty;return i};t.prototype.rotate=function(t){var e=Math.cos(t);var i=Math.sin(t);var r=this.a*e-this.b*i;this.b=this.a*i+this.b*e;this.a=r;var a=this.c*e-this.d*i;this.d=this.c*i+this.d*e;this.c=a;var s=this.tx*e-this.ty*i;this.ty=this.tx*i+this.ty*e;this.tx=s};t.prototype.scale=function(t,e){this.a*=t;this.b*=e;this.c*=t;this.d*=e;this.tx*=t;this.ty*=e};t.prototype.setTo=function(t,e,i,r,a,s){this.a=t;this.b=e;this.c=i;this.d=r;this.tx=a;this.ty=s};t.prototype.toString=function(){return"[Matrix] (a="+this.a+", b="+this.b+", c="+this.c+", d="+this.d+", tx="+this.tx+", ty="+this.ty+")"};t.prototype.transformPoint=function(t){return new r(t.x*this.a+t.y*this.c+this.tx,t.x*this.b+t.y*this.d+this.ty)};t.prototype.translate=function(t,e){this.tx+=t;this.ty+=e};return t}();e.exports=s},{"awayjs-core/lib/errors/ArgumentError":undefined,"awayjs-core/lib/geom/Point":undefined}],"awayjs-core/lib/geom/Orientation3D":[function(t,e,i){var r=function(){function t(){}t.AXIS_ANGLE="axisAngle";t.EULER_ANGLES="eulerAngles";t.QUATERNION="quaternion";return t}();e.exports=r},{}],"awayjs-core/lib/geom/PerspectiveProjection":[function(t,e,i){var r=function(){function t(){}t.prototype.toMatrix3D=function(){return this._matrix3D};return t}();e.exports=r},{}],"awayjs-core/lib/geom/Plane3D":[function(t,e,i){var r=t("awayjs-core/lib/geom/PlaneClassification");var a=function(){function t(e,i,r,a){if(e===void 0){e=0}if(i===void 0){i=0}if(r===void 0){r=0}if(a===void 0){a=0}this.a=e;this.b=i;this.c=r;this.d=a;if(e==0&&i==0){this._iAlignment=t.ALIGN_XY_AXIS}else if(i==0&&r==0){this._iAlignment=t.ALIGN_YZ_AXIS}else if(e==0&&r==0){this._iAlignment=t.ALIGN_XZ_AXIS}else{this._iAlignment=t.ALIGN_ANY}}t.prototype.fromPoints=function(e,i,r){var a=i.x-e.x;var s=i.y-e.y;var n=i.z-e.z;var o=r.x-e.x;var h=r.y-e.y;var l=r.z-e.z;this.a=s*l-n*h;this.b=n*o-a*l;this.c=a*h-s*o;this.d=this.a*e.x+this.b*e.y+this.c*e.z;if(this.a==0&&this.b==0){this._iAlignment=t.ALIGN_XY_AXIS}else if(this.b==0&&this.c==0){this._iAlignment=t.ALIGN_YZ_AXIS}else if(this.a==0&&this.c==0){this._iAlignment=t.ALIGN_XZ_AXIS}else{this._iAlignment=t.ALIGN_ANY}};t.prototype.fromNormalAndPoint=function(e,i){this.a=e.x;this.b=e.y;this.c=e.z;this.d=this.a*i.x+this.b*i.y+this.c*i.z;if(this.a==0&&this.b==0){this._iAlignment=t.ALIGN_XY_AXIS}else if(this.b==0&&this.c==0){this._iAlignment=t.ALIGN_YZ_AXIS}else if(this.a==0&&this.c==0){this._iAlignment=t.ALIGN_XZ_AXIS}else{this._iAlignment=t.ALIGN_ANY}};t.prototype.normalize=function(){var t=1/Math.sqrt(this.a*this.a+this.b*this.b+this.c*this.c);this.a*=t;this.b*=t;this.c*=t;this.d*=t;return this};t.prototype.distance=function(e){if(this._iAlignment==t.ALIGN_YZ_AXIS){return this.a*e.x-this.d}else if(this._iAlignment==t.ALIGN_XZ_AXIS){return this.b*e.y-this.d}else if(this._iAlignment==t.ALIGN_XY_AXIS){return this.c*e.z-this.d}else{return this.a*e.x+this.b*e.y+this.c*e.z-this.d}};t.prototype.classifyPoint=function(e,i){if(i===void 0){i=.01}if(this.d!=this.d)return r.FRONT;var a;if(this._iAlignment==t.ALIGN_YZ_AXIS)a=this.a*e.x-this.d;else if(this._iAlignment==t.ALIGN_XZ_AXIS)a=this.b*e.y-this.d;else if(this._iAlignment==t.ALIGN_XY_AXIS)a=this.c*e.z-this.d;else a=this.a*e.x+this.b*e.y+this.c*e.z-this.d;if(a<-i)return r.BACK;else if(a>i)return r.FRONT;else return r.INTERSECT};t.prototype.toString=function(){return"Plane3D [a:"+this.a+", b:"+this.b+", c:"+this.c+", d:"+this.d+"]"};t.ALIGN_ANY=0;t.ALIGN_XY_AXIS=1;t.ALIGN_YZ_AXIS=2;t.ALIGN_XZ_AXIS=3;return t}();e.exports=a},{"awayjs-core/lib/geom/PlaneClassification":undefined}],"awayjs-core/lib/geom/PlaneClassification":[function(t,e,i){var r=function(){function t(){}t.BACK=0;t.FRONT=1;t.IN=0;t.OUT=1;t.INTERSECT=2;return t}();e.exports=r},{}],"awayjs-core/lib/geom/Point":[function(t,e,i){var r=function(){function t(t,e){if(t===void 0){t=0}if(e===void 0){e=0}this.x=t;this.y=e}Object.defineProperty(t.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},enumerable:true,configurable:true});t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y)};t.prototype.clone=function(){return new t(this.x,this.y)};t.prototype.copyFrom=function(t){};t.prototype.equals=function(t){return this.x==t.x&&this.y==t.y};t.prototype.normalize=function(t){if(t===void 0){t=1}if(this.length!=0){var e=t/this.length;this.x*=e;this.y*=e;return}throw"Cannot divide by zero length."};t.prototype.offset=function(t,e){this.x+=t;this.y+=e};t.prototype.setTo=function(t,e){};t.prototype.subtract=function(e){return new t(this.x-e.x,this.y-e.y)};t.prototype.toString=function(){return"[Point] (x="+this.x+", y="+this.y+")"};t.distance=function(t,e){var i=e.x-t.x;var r=e.y-t.y;return Math.sqrt(i*i+r*r)};t.interpolate=function(e,i,r){return new t(i.x+(e.x-i.x)*r,i.y+(e.y-i.y)*r)};t.polar=function(e,i){return new t(e*Math.cos(i),e*Math.sin(i))};return t}();e.exports=r},{}],"awayjs-core/lib/geom/PoissonLookup":[function(t,e,i){var r=function(){function t(){}t.initDistributions=function(){this._distributions=new Array;this._distributions[0]=new Array(.3082841,.4320919);this._distributions[1]=new Array(.3082841,.4320919,-.2274942,-.6640266);this._distributions[2]=new Array(.8742689,.0009265686,-.6864116,-.5536607,-.2325206,.7678371);this._distributions[3]=new Array(.3913446,-.7084417,-.7511101,-.5935929,-.2323436,.5320091,.8435315,.5035911);this._distributions[4]=new Array(.2122471,-.5771395,-.8543506,-.1763534,.5189021,.8323698,-.3616908,.5865368,.9523004,-.04948437);this._distributions[5]=new Array(.5791035,.3496495,.2959551,-.6006749,-.2419119,-.06879545,-.7403072,.6110353,-.04555973,.8059174,-.5275017,-.737129);this._distributions[6]=new Array(.06941478,.8519508,-.7441907,.2426432,.6439992,-.2405252,-.1007523,-.2327587,-.6427067,-.7248485,.8050759,.5492936,.3573822,-.8824506);this._distributions[7]=new Array(.8509863,.4452587,-.09507271,.2073005,.1706571,-.6434793,.8029777,-.2718274,-.4401725,.8196304,.2715359,.8598521,-.8121575,-.006447683,-.6486837,-.7237598);this._distributions[8]=new Array(.6951686,-.2680728,-.04933243,.3710589,.6592212,.3661054,-.01579228,-.6909603,-.3275101,-.1756866,.3811549,.9218544,-.216032,.9755028,-.7065172,.3355389,-.6579109,-.6798355);this._distributions[9]=new Array(.6181276,-.09790418,-.2537868,-.5570995,-.1964931,.3459414,.3474613,-.8885581,.5135743,.5753114,-.9549091,.1480672,-.8711916,-.4293123,-.6928071,.6190156,-.13369,.8892705,.0548224,-.1246777);this._distributions[10]=new Array(.4853027,-.5080479,-.1331675,-.506597,.139575,.01316885,.803486,-.07568797,.5240274,.4883182,-.4334005,.1207938,-.7794577,-.3985141,.1576432,-.9861221,-.3712867,.6959021,.1517378,.9847429,-.9762396,.1661073);this._distributions[11]=new Array(-.2790166,-.01252619,.3389016,.3921154,.2408341,-.313211,-.8151779,-.3898362,-.6347761,.3486495,.09471484,-.7722448,-.1385674,.6364574,.2456331,.9295807,-.3864306,-.8247881,.6111673,-.7164014,.8287669,.05466961,.837706,.5415626);this._distributions[12]=new Array(.056417,.3185693,-.8245888,.1882799,.8575996,.1136829,.1070375,.875332,.4076743,-.06000621,-.4311306,.7239349,.2677574,-.538472,-.08486642,-.2083647,-.888989,-.3906443,-.4768958,-.6664082,.09334993,-.9861541,.808736,-.455949,.5889823,.7660807);this._distributions[13]=new Array(-.2681346,-.3955857,-.1315102,-.8852947,-.5143692,.09551838,.4344836,-.546945,-.8620899,-.3813288,.1650431,.02034803,-.1543657,.3842218,-.828457,.5376903,-.6145,-.7818927,-.2639062,.8784655,.1912684,.9720125,.3135219,.5224229,.7850655,.4592297,.7465045,-.1368916);this._distributions[14]=new Array(.4241029,.695281,.150511,-.02304107,-.2482675,.9120338,.8057325,.2622084,-.2445909,.2765962,.8588713,-.1772072,.3117845,-.4385471,-.3923851,-.3298936,-.1751254,-.7405846,.6926506,-.684163,-.9304563,-.3254691,-.8533293,.1523024,.2510415,-.917345,-.6239773,-.7105472,-.6104624,.6041355);
this._distributions[15]=new Array(.5844554,.06651045,.1343258,.6756578,.3799674,-.6301104,.5590436,.7940555,.09574714,.02262517,.8697868,.393301,.003945862,-.421735,.9043913,-.2432393,-.4844007,.7190998,-.3201078,.2972371,-.3852352,-.6341155,-.5413069,-.09223081,-.8468984,-.5126905,.004156174,-.8633173,-.9681889,-.03305046,-.846509,.4414353);this._distributions[16]=new Array(.4506488,.657668,.4621297,.07441051,-.2782125,.6201044,.9750003,.09110117,.1019436,.2986514,.03457398,.9631706,.542098,-.5505635,.8675668,.4938077,-.5414361,.2655292,-.7941836,.6003053,-.09847672,-.1001604,-.9316511,-.08572888,.07286467,-.611899,-.5232627,-.4082253,-.5481608,-.827938,-.1551939,-.9621193,.9220031,-.3315949);this._distributions[17]=new Array(.197908,-.4697656,-.4474689,-.3428435,.8529873,-.2228634,.6022478,-.5469642,.2545276,-.931133,-.1507547,-.7855865,-.07606658,.1011628,.3046715,.2785755,.4698432,-.1064076,.6831254,.4152522,.1374381,.8363233,-.2166121,.6682042,.5511393,.7996449,-.4278994,.28836,-.8875198,.2181732,-.8772842,-.2818254,-.7000262,.5762185,-.6062385,-.7439126);this._distributions[18]=new Array(.6645703,-.05678739,.5720971,.4533803,-.07660709,.08802763,.5163431,-.4426552,.1163455,-.3404382,-.4004807,-.5046007,.2932099,-.8201418,-.5322125,.03834766,-.1490209,-.8817304,-.8000439,-.3509448,.5260983,.8421043,.1197811,.6963812,.9498612,.3122156,-.9285746,.02120355,-.6670724,.7217396,.9155889,-.3510147,-.271941,.4727852,.318879,.1634057,-.2686755,.9253026);this._distributions[19]=new Array(.5064292,.422527,.8935515,-.06610427,.1199719,.175568,.403388,-.2003276,.1657927,.8154403,.9301245,.2929218,-.1644068,.6201534,.7113559,-.6589743,-.3364046,-.1799502,.02109996,-.392765,-.382213,.3219992,-.9201946,.1207967,-.726185,.4291916,-.7443482,-.2480059,-.5147594,.7418784,.1935272,-.7406143,-.3643523,-.5559214,-.7147766,-.6326278,-.2524151,-.9096627,.5161405,.7908453);this._distributions[20]=new Array(.7921003,-.3032096,.5992879,-.009052323,.2538549,-.1872749,.7053444,.3677175,.5417761,-.8170255,.9749611,.1210478,.1969143,-.6117041,-.1824499,-.4634196,-.1181338,-.8668742,-.3050112,-.1352596,-.4409327,-.7082354,-.03225285,.1171548,.3113096,.3250439,-.8166144,-.463995,-.01014475,.4715334,-.6868284,.05091889,-.4011163,.2717285,-.06756835,.8307694,-.7938535,.4352129,-.4663842,.7165329,.559729,.8093995);this._distributions[21]=new Array(.07832243,.426151,-.3856795,.5799953,.01970797,.06706189,.4822682,.3014512,-.1532982,.87485,-.4959527,.07888043,.260601,-.2304784,.4996209,.7167382,.585986,-.04265174,-.7679967,.5509416,-.9041753,.1802134,-.8407655,-.4442826,-.2058258,-.2636995,-.4984115,-.5928579,.2926032,-.7886473,-.06933882,-.621177,.578115,-.4813387,.8981777,-.3291056,.1942733,.9255584,.8084362,.5066984,.9920095,.03103104,-.2403206,-.9389018);this._distributions[22]=new Array(-.5691095,.1014316,-.7788262,.384012,-.8253665,-.1645582,-.1830993,.002997211,-.2555013,-.4177977,-.6640869,-.4794711,-.2351242,.5850121,.02436554,.2825883,.006061143,-.8200245,.1618791,-.3063331,-.3765897,-.7249815,.6092919,-.6769328,-.5956934,.6957655,.5383642,.4522677,-.1489165,.9125596,.4167473,.1335986,.1898309,.5874342,.2288171,.9624356,.7540846,-.07672304,.8986252,.2788797,.3555991,-.9262139,.8454325,-.4027667,.4945236,-.2935512);this._distributions[23]=new Array(-.4481403,-.3758374,-.8877251,.08739938,.05015831,-.1339983,-.4070427,-.8534173,.1019274,-.5503222,-.445998,.1997541,-.8686263,-.2788867,-.7695944,-.6033704,-.05515742,-.885711,-.7714347,.5790485,.3466263,-.8799297,.4487582,-.5321087,-.2461368,.6053771,-.05568117,.2457351,-.4668669,.8523816,.8103387,-.4255538,.4054182,-.175663,-.2802011,-.08920153,.2665959,.382935,.555679,.1621837,.105246,.8420411,.6921161,.6902903,.880946,.2483067,.9699264,-.1021767);this._distributions[24]=new Array(-.1703323,-.3119385,.2916039,-.2988263,-.008472982,-.9277695,-.7730271,-.3277904,.3440474,-.6815342,-.2910278,.03461745,-.6764899,-.657078,-.3505501,-.7311988,-.03478927,.3258755,-.6048835,.159423,.2035525,.02212214,.5116573,.2226856,.6664805,-.2500189,.7147882,-.6609634,.03030632,-.5763278,-.2516585,.6116219,-.9434413,-.0116792,.9061816,.2491155,.182867,.6076167,.286593,.9485695,-.5992439,.6970096,-.2082874,.9416641,.9880044,-.1541709,-.9122881,.331555,.7324886,.6725098);this._distributions[25]=new Array(.3869598,-.04974834,.7168844,-.0693711,-.07166742,.1725325,.4599592,.3232779,.5872094,-.4198674,.2442266,-.625667,.1254557,.4500048,-.2290154,-.1803567,.890583,.3373493,.1256081,.7853789,-.2676466,.5305805,-.7063224,.252168,-.3989835,.1189921,.09617215,-.2451447,.6302541,.6085876,.9380925,-.3234899,.5086241,-.8573482,.03576187,-.9876697,-.0876712,-.6365195,-.5276513,.823456,-.6935764,-.2240411,-.5212318,-.5383121,-.2116208,.9639363,-.9840096,.02743555,-.3991577,-.8994547,-.7830126,.614068);this._distributions[26]=new Array(-.8366601,.4464895,-.5917366,-.02073906,-.9845258,.1635625,-.3097973,.4379579,-.5478154,.7173221,-.1685888,.9261969,.01503595,.6046097,.4452421,.5449086,.0315687,.1944619,.3753404,.8688548,.4143643,.1396648,.8711032,.4304703,.7328773,.1461501,.6374492,-.3521495,.145613,-.1341466,.9040975,-.135123,-.7839059,-.5450199,-.516019,-.3320859,-.206158,-.4431106,-.9703014,-.2368356,-.2473119,-.0864351,.2130725,-.4604077,-.003726701,-.7122303,-.4072131,-.6833169,.1632999,-.9776646,.4686888,-.680495,-.2293511,-.9509777);this._distributions[27]=new Array(.107311,-.1311369,-.4194764,-.3148777,.6171439,-.2745973,.2796618,.1937153,-.09106886,.4180236,.6044006,.05577846,.02927299,-.6738263,-.2580845,.1179939,-.09023564,-.3830024,.3570953,-.5000587,.81591,-.5518309,.9300217,-.1257987,.4904627,-.8381903,-.3163182,-.8632009,.1137595,-.9875998,.8390043,.3538185,.2149114,.4993694,.5191584,.3833552,.5002763,.7061465,-.2567276,.9068756,-.5197366,.3467845,.03668867,.9734009,-.5347553,.66747,-.9028882,.1023768,-.8967977,.412834,-.5821944,.0426479,-.8032165,-.2397038,-.5597343,-.6358021);this._distributions[28]=new Array(-.6562496,-.1781036,-.9301494,.1185208,-.3861143,-.4153562,-.1560799,-.1099607,-.5587025,.395218,-.5322112,-.699701,-.5008639,.08726846,-.970524,-.1963461,-.813577,-.5185111,-.1644458,.298,-.3216791,.639982,.3315373,.3339162,.2383235,-.00105722,.1137828,.5450742,-.01899921,.8798413,.2849685,.8255596,.6974412,.2123175,.7588523,.5470437,.5102502,-.1687844,.5853448,.8033476,.2590716,-.5262504,.5607718,-.6342825,.8666443,-.1491841,.8341052,-.4935003,-.1568441,-.6634066,.2512113,-.8769391,-.2559827,-.9572457,-.01928852,-.3966542,-.750667,.6409678);this._distributions[29]=new Array(.3454786,-.04837726,.2649553,.2406852,.5599093,-.3839145,-.1111814,-.05502108,.7586042,-.05818377,.2519488,-.4665135,-.1264972,.2602723,-.08766216,-.3671907,.6428129,.3999204,-.6105871,-.1246869,-.4589451,-.7646643,-.03021116,-.7899352,-.6036922,-.4293956,-.2481938,.6534185,.102798,.6784465,-.6392644,.4821358,-.6789002,.1779133,-.9140783,-.1989647,-.9262617,.3381507,.4794891,-.8093274,.3959447,.668478,.9602883,.2272305,-.123672,.9210883,.2375148,.9523395,-.52898,.7973378,-.382433,.1228794,.695015,.6948439,.7530277,-.6458191,.8777987,-.3272956,.2318525,-.962768);this._distributions[30]=new Array(.4518921,-.1146195,.4720805,-.4238748,.3655423,.1806341,.1589939,-.23568,.7673324,-.5149941,.01163658,.09045836,.7010971,.1245747,.7518286,-.1855433,.4960719,.4601022,.2566979,-.6308268,-.0654714,-.5126389,-.1823319,-.1343282,-.1464312,.4883236,-.3858738,.203523,.1484799,.4432284,-.477109,-.116241,.2719092,.7208626,.9104174,.3578536,-.5956199,.7662588,-.6996251,.3678654,-.2514512,.9251933,.1275825,-.9478135,-.204608,-.8611552,.4264838,-.877443,.9854161,.05521112,.5912951,.7997434,.1140349,.982093,-.9324368,-.2094094,-.42436,-.6441524,-.6722705,-.3554261,-.7844236,.08587621);this._distributions[31]=new Array(-.4206714,-.5613642,-.8733016,-.3373051,-.1046226,-.2902999,-.1318562,-.8434365,.1145093,-.5962623,-.4965627,-.1873259,-.5011808,-.8546229,-.7165636,-.5743566,.1090901,.2017643,.3404809,-.220455,-.1989015,.2372122,-.4538706,.0979171,.4514146,-.572846,.2314168,-.8514503,-.4247236,.5650803,-.943347,.04514639,-.1309718,.5221877,-.7004157,.4561877,.6306441,.04448673,.4301621,.5766876,.1078042,.7245752,.3875354,.2794483,.702876,-.2924213,.7360667,-.6210318,.7486517,.6531103,.4898235,.8591025,.6549174,.3854057,-.2596106,.7916998,.9251194,-.05296265,-.5620695,.820877,-.01228026,.9937211,.9612103,.2628758)};t.getDistribution=function(t){if(!this._distributions)this.initDistributions();if(t<2||t>32)return null;return this._distributions[t-1]};return t}();e.exports=r},{}],"awayjs-core/lib/geom/Quaternion":[function(t,e,i){var r=t("awayjs-core/lib/geom/Matrix3DUtils");var a=t("awayjs-core/lib/geom/Orientation3D");var s=t("awayjs-core/lib/geom/Matrix3D");var n=t("awayjs-core/lib/geom/Vector3D");var o=function(){function t(t,e,i,r){if(t===void 0){t=0}if(e===void 0){e=0}if(i===void 0){i=0}if(r===void 0){r=1}this.x=0;this.y=0;this.z=0;this.w=1;this.x=t;this.y=e;this.z=i;this.w=r}Object.defineProperty(t.prototype,"magnitude",{get:function(){return Math.sqrt(this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z)},enumerable:true,configurable:true});t.prototype.multiply=function(t,e){var i=t.w,r=t.x,a=t.y,s=t.z;var n=e.w,o=e.x,h=e.y,l=e.z;this.w=i*n-r*o-a*h-s*l;this.x=i*o+r*n+a*l-s*h;this.y=i*h-r*l+a*n+s*o;this.z=i*l+r*h-a*o+s*n};t.prototype.multiplyVector=function(e,i){if(i===void 0){i=null}if(i===null){i=new t}var r=e.x;var a=e.y;var s=e.z;i.w=-this.x*r-this.y*a-this.z*s;i.x=this.w*r+this.y*s-this.z*a;i.y=this.w*a-this.x*s+this.z*r;i.z=this.w*s+this.x*a-this.y*r;return i};t.prototype.fromAxisAngle=function(t,e){var i=Math.sin(e/2);var r=Math.cos(e/2);this.x=t.x*i;this.y=t.y*i;this.z=t.z*i;this.w=r;this.normalize()};t.prototype.slerp=function(t,e,i){var r=t.w,a=t.x,s=t.y,n=t.z;var o=e.w,h=e.x,l=e.y,u=e.z;var p=r*o+a*h+s*l+n*u;if(p<0){p=-p;o=-o;h=-h;l=-l;u=-u}if(p<.95){var c=Math.acos(p);var d=1/Math.sin(c);var f=Math.sin(c*(1-i))*d;var _=Math.sin(c*i)*d;this.w=r*f+o*_;this.x=a*f+h*_;this.y=s*f+l*_;this.z=n*f+u*_}else{this.w=r+i*(o-r);this.x=a+i*(h-a);this.y=s+i*(l-s);this.z=n+i*(u-n);var y=1/Math.sqrt(this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z);this.w*=y;this.x*=y;this.y*=y;this.z*=y}};t.prototype.lerp=function(t,e,i){var r=t.w,a=t.x,s=t.y,n=t.z;var o=e.w,h=e.x,l=e.y,u=e.z;var p;if(r*o+a*h+s*l+n*u<0){o=-o;h=-h;l=-l;u=-u}this.w=r+i*(o-r);this.x=a+i*(h-a);this.y=s+i*(l-s);this.z=n+i*(u-n);p=1/Math.sqrt(this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z);this.w*=p;this.x*=p;this.y*=p;this.z*=p};t.prototype.fromEulerAngles=function(t,e,i){var r=t*.5,a=e*.5,s=i*.5;var n=Math.cos(r),o=Math.sin(r);var h=Math.cos(a),l=Math.sin(a);var u=Math.cos(s),p=Math.sin(s);this.w=n*h*u+o*l*p;this.x=o*h*u-n*l*p;this.y=n*l*u+o*h*p;this.z=n*h*p-o*l*u};t.prototype.toEulerAngles=function(t){if(t===void 0){t=null}if(t===null){t=new n}t.x=Math.atan2(2*(this.w*this.x+this.y*this.z),1-2*(this.x*this.x+this.y*this.y));t.y=Math.asin(2*(this.w*this.y-this.z*this.x));t.z=Math.atan2(2*(this.w*this.z+this.x*this.y),1-2*(this.y*this.y+this.z*this.z));return t};t.prototype.normalize=function(t){if(t===void 0){t=1}var e=t/Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);this.x*=e;this.y*=e;this.z*=e;this.w*=e};t.prototype.toString=function(){return"{x:"+this.x+" y:"+this.y+" z:"+this.z+" w:"+this.w+"}"};t.prototype.toMatrix3D=function(t){if(t===void 0){t=null}var e=r.RAW_DATA_CONTAINER;var i=2*this.x*this.y,a=2*this.x*this.z,n=2*this.x*this.w;var o=2*this.y*this.z,h=2*this.y*this.w,l=2*this.z*this.w;var u=this.x*this.x,p=this.y*this.y,c=this.z*this.z,d=this.w*this.w;e[0]=u-p-c+d;e[4]=i-l;e[8]=a+h;e[12]=0;e[1]=i+l;e[5]=-u+p-c+d;e[9]=o-n;e[13]=0;e[2]=a-h;e[6]=o+n;e[10]=-u-p+c+d;e[14]=0;e[3]=0;e[7]=0;e[11]=0;e[15]=1;if(!t)return new s(e);t.copyRawDataFrom(e);return t};t.prototype.fromMatrix=function(t){var e=t.decompose(a.QUATERNION)[1];this.x=e.x;this.y=e.y;this.z=e.z;this.w=e.w};t.prototype.toRawData=function(t,e){if(e===void 0){e=false}var i=2*this.x*this.y,r=2*this.x*this.z,a=2*this.x*this.w;var s=2*this.y*this.z,n=2*this.y*this.w,o=2*this.z*this.w;var h=this.x*this.x,l=this.y*this.y,u=this.z*this.z,p=this.w*this.w;t[0]=h-l-u+p;t[1]=i-o;t[2]=r+n;t[4]=i+o;t[5]=-h+l-u+p;t[6]=s-a;t[8]=r-n;t[9]=s+a;t[10]=-h-l+u+p;t[3]=t[7]=t[11]=0;if(!e){t[12]=t[13]=t[14]=0;t[15]=1}};t.prototype.clone=function(){return new t(this.x,this.y,this.z,this.w)};t.prototype.rotatePoint=function(t,e){if(e===void 0){e=null}var i,r,a,s;var o=t.x,h=t.y,l=t.z;if(e===null){e=new n}s=-this.x*o-this.y*h-this.z*l;i=this.w*o+this.y*l-this.z*h;r=this.w*h-this.x*l+this.z*o;a=this.w*l+this.x*h-this.y*o;e.x=-s*this.x+i*this.w-r*this.z+a*this.y;e.y=-s*this.y+i*this.z+r*this.w-a*this.x;e.z=-s*this.z-i*this.y+r*this.x+a*this.w;return e};t.prototype.copyFrom=function(t){this.x=t.x;this.y=t.y;this.z=t.z;this.w=t.w};return t}();e.exports=o},{"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-core/lib/geom/Orientation3D":undefined,"awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-core/lib/geom/Rectangle":[function(t,e,i){var r=t("awayjs-core/lib/geom/Point");var a=function(){function t(t,e,i,r){if(t===void 0){t=0}if(e===void 0){e=0}if(i===void 0){i=0}if(r===void 0){r=0}this.x=t;this.y=e;this.width=i;this.height=r}Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"bottomRight",{get:function(){if(this._bottomRight==null)this._bottomRight=new r;this._bottomRight.x=this.x+this.width;this._bottomRight.y=this.y+this.height;return this._bottomRight},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"size",{get:function(){if(this._size==null)this._size=new r;this._size.x=this.width;this._size.y=this.height;return this._size},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"topLeft",{get:function(){if(this._topLeft==null)this._topLeft=new r;this._topLeft.x=this.x;this._topLeft.y=this.y;return this._topLeft},enumerable:true,configurable:true});t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)};t.prototype.contains=function(t,e){return this.x<=t&&this.x+this.width>=t&&this.y<=e&&this.y+this.height>=e};t.prototype.containsPoint=function(t){return this.x<=t.x&&this.x+this.width>=t.x&&this.y<=t.y&&this.y+this.height>=t.y};t.prototype.containsRect=function(t){return this.x<=t.x&&this.x+this.width>=t.x+t.width&&this.y<=t.y&&this.y+this.height>=t.y+t.height};t.prototype.copyFrom=function(t){};t.prototype.equals=function(t){return this.x==t.x&&this.y==t.y&&this.width==t.width&&this.height==t.height};t.prototype.inflate=function(t,e){this.x-=t/2;this.y-=e/2;this.width+=t/2;this.height+=e/2};t.prototype.inflatePoint=function(t){this.x-=t.x/2;this.y-=t.y/2;this.width+=t.x/2;this.height+=t.y/2};t.prototype.intersection=function(e){if(this.intersects(e)){var i=new t;if(this.x>e.x){i.x=this.x;i.width=e.x-this.x+e.width;if(i.width>this.width)i.width=this.width}else{i.x=e.x;i.width=this.x-e.x+this.width;if(i.width>e.width)i.width=e.width}if(this.y>e.y){i.y=this.y;i.height=e.y-this.y+e.height;if(i.height>this.height)i.height=this.height}else{i.y=e.y;i.height=this.y-e.y+this.height;if(i.height>e.height)i.height=e.height}return i}return new t};t.prototype.intersects=function(t){return this.x+this.width>t.x&&this.x<t.x+t.width&&this.y+this.height>t.y&&this.y<t.y+t.height};t.prototype.isEmpty=function(){return this.x==0&&this.y==0&&this.width==0&&this.height==0};t.prototype.offset=function(t,e){this.x+=t;this.y+=e};t.prototype.offsetPoint=function(t){this.x+=t.x;this.y+=t.y};t.prototype.setEmpty=function(){this.x=0;this.y=0;this.width=0;this.height=0};t.prototype.setTo=function(t,e,i,r){this.x=t;this.y=e;this.width=i;this.height=r};t.prototype.toString=function(){return"[Rectangle] (x="+this.x+", y="+this.y+", width="+this.width+", height="+this.height+")"};t.prototype.union=function(e){var i=new t;if(this.x<e.x){i.x=this.x;i.width=e.x-this.x+e.width;if(i.width<this.width)i.width=this.width}else{i.x=e.x;i.width=this.x-e.x+this.width;if(i.width<e.width)i.width=e.width}if(this.y<e.y){i.y=this.y;i.height=e.y-this.y+e.height;if(i.height<this.height)i.height=this.height}else{i.y=e.y;i.height=this.y-e.y+this.height;if(i.height<e.height)i.height=e.height}return i};return t}();e.exports=a},{"awayjs-core/lib/geom/Point":undefined}],"awayjs-core/lib/geom/UVTransform":[function(t,e,i){var r=t("awayjs-core/lib/geom/Matrix");var a=function(){function t(){this._uvMatrix=new r;this._rotation=0;this._scaleU=1;this._scaleV=1;this._offsetU=0;this._offsetV=0}Object.defineProperty(t.prototype,"offsetU",{get:function(){return this._offsetU},set:function(t){if(t==this._offsetU)return;this._offsetU=t;this._uvMatrixDirty=true},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"offsetV",{get:function(){return this._offsetV},set:function(t){if(t==this._offsetV)return;this._offsetV=t;this._uvMatrixDirty=true},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){if(t==this._rotation)return;this._rotation=t;this._uvMatrixDirty=true},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"scaleU",{get:function(){return this._scaleU},set:function(t){if(t==this._scaleU)return;this._scaleU=t;this._uvMatrixDirty=true},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"scaleV",{get:function(){return this._scaleV},set:function(t){if(t==this._scaleV)return;this._scaleV=t;this._uvMatrixDirty=true},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"matrix",{get:function(){if(this._uvMatrixDirty)this.updateUVMatrix();return this._uvMatrix},enumerable:true,configurable:true});t.prototype.updateUVMatrix=function(){this._uvMatrix.identity();if(this._rotation!=0)this._uvMatrix.rotate(this._rotation);if(this._scaleU!=1||this._scaleV!=1)this._uvMatrix.scale(this._scaleU,this._scaleV);this._uvMatrix.translate(this._offsetU,this._offsetV);this._uvMatrixDirty=false};return t}();e.exports=a},{"awayjs-core/lib/geom/Matrix":undefined}],"awayjs-core/lib/geom/Vector3D":[function(t,e,i){var r=function(){function t(t,e,i,r){if(t===void 0){t=0}if(e===void 0){e=0}if(i===void 0){i=0}if(r===void 0){r=0}this.x=t;this.y=e;this.z=i;this.w=r}Object.defineProperty(t.prototype,"length",{get:function(){return Math.sqrt(this.lengthSquared)},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"lengthSquared",{get:function(){return this.x*this.x+this.y*this.y+this.z*this.z},enumerable:true,configurable:true});t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y,this.z+e.z,this.w+e.w)};t.angleBetween=function(t,e){return Math.acos(t.dotProduct(e)/(t.length*e.length))};t.prototype.clone=function(){return new t(this.x,this.y,this.z,this.w)};t.prototype.copyFrom=function(t){this.x=t.x;this.y=t.y;this.z=t.z;this.w=t.w};t.prototype.crossProduct=function(e){return new t(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x,1)};t.prototype.decrementBy=function(t){this.x-=t.x;this.y-=t.y;this.z-=t.z};t.distance=function(t,e){var i=t.x-e.x;var r=t.y-e.y;var a=t.z-e.z;return Math.sqrt(i*i+r*r+a*a)};t.prototype.dotProduct=function(t){return this.x*t.x+this.y*t.y+this.z*t.z};t.prototype.equals=function(t,e){if(e===void 0){e=false}return this.x==t.x&&this.y==t.y&&this.z==t.z&&(!e||this.w==t.w)};t.prototype.incrementBy=function(t){this.x+=t.x;this.y+=t.y;this.z+=t.z};t.prototype.nearEquals=function(t,e,i){if(i===void 0){i=true}return Math.abs(this.x-t.x)<e&&Math.abs(this.y-t.y)<e&&Math.abs(this.z-t.z)<e&&(!i||Math.abs(this.w-t.w)<e)};t.prototype.negate=function(){this.x=-this.x;this.y=-this.y;this.z=-this.z};t.prototype.normalize=function(t){if(t===void 0){t=1}if(this.length!=0){var e=t/this.length;this.x*=e;this.y*=e;this.z*=e;return}};t.prototype.project=function(){this.x/=this.w;this.y/=this.w;this.z/=this.w};t.prototype.scaleBy=function(t){this.x*=t;this.y*=t;this.z*=t};t.prototype.setTo=function(t,e,i){this.x=t;this.y=e;this.z=i};t.prototype.subtract=function(e){return new t(this.x-e.x,this.y-e.y,this.z-e.z)};t.prototype.toString=function(){return"[Vector3D] (x:"+this.x+" ,y:"+this.y+", z"+this.z+", w:"+this.w+")"};t.X_AXIS=new t(1,0,0);t.Y_AXIS=new t(0,1,0);t.Z_AXIS=new t(0,0,1);return t}();e.exports=r},{}],"awayjs-core/lib/library/AssetLibraryBundle":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetLibraryIterator");var s=t("awayjs-core/lib/library/AssetLoader");var n=t("awayjs-core/lib/library/ConflictPrecedence");var o=t("awayjs-core/lib/library/ConflictStrategy");var h=t("awayjs-core/lib/library/NamedAssetBase");var l=t("awayjs-core/lib/errors/Error");var u=t("awayjs-core/lib/events/AssetEvent");var p=t("awayjs-core/lib/events/IOErrorEvent");var c=t("awayjs-core/lib/events/LoaderEvent");var d=t("awayjs-core/lib/events/EventDispatcher");var f=t("awayjs-core/lib/events/ParserEvent");var _=function(t){r(e,t);function e(){var e=this;t.call(this);this._loadingSessionsGarbage=new Array;this._assets=new Array;this._assetDictionary=new Object;this._loadingSessions=new Array;this.conflictStrategy=o.IGNORE.create();this.conflictPrecedence=n.FAVOR_NEW;this._onAssetRenameDelegate=function(t){return e.onAssetRename(t)};this._onAssetConflictResolvedDelegate=function(t){return e.onAssetConflictResolved(t)};this._onResourceCompleteDelegate=function(t){return e.onResourceComplete(t)};this._onTextureSizeErrorDelegate=function(t){return e.onTextureSizeError(t)};this._onAssetCompleteDelegate=function(t){return e.onAssetComplete(t)};this._onLoadErrorDelegate=function(t){return e.onLoadError(t)};this._onParseErrorDelegate=function(t){return e.onParseError(t)}}e.getInstance=function(t){if(t===void 0){t="default"}if(!t)t="default";if(!e._iInstances.hasOwnProperty(t))e._iInstances[t]=new e;return e._iInstances[t]};e.prototype.enableParser=function(t){s.enableParser(t)};e.prototype.enableParsers=function(t){s.enableParsers(t)};Object.defineProperty(e.prototype,"conflictStrategy",{get:function(){return this._strategy},set:function(t){if(!t)throw new l("namingStrategy must not be null. To ignore naming, use AssetLibrary.IGNORE");this._strategy=t.create()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"conflictPrecedence",{get:function(){return this._strategyPreference},set:function(t){this._strategyPreference=t},enumerable:true,configurable:true});e.prototype.createIterator=function(t,e,i){if(t===void 0){t=null}if(e===void 0){e=null}if(i===void 0){i=null}return new a(this._assets,t,e,i)};e.prototype.load=function(t,e,i,r){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=null}var a=new s;if(!this._loadingSessions)this._loadingSessions=new Array;this._loadingSessions.push(a);a.addEventListener(c.RESOURCE_COMPLETE,this._onResourceCompleteDelegate);a.addEventListener(u.TEXTURE_SIZE_ERROR,this._onTextureSizeErrorDelegate);a.addEventListener(u.ASSET_COMPLETE,this._onAssetCompleteDelegate);a._iAddErrorHandler(this._onLoadErrorDelegate);a._iAddParseErrorHandler(this._onParseErrorDelegate);return a.load(t,e,i,r)};e.prototype.loadData=function(t,e,i,r){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=null}var a=new s;if(!this._loadingSessions)this._loadingSessions=new Array;this._loadingSessions.push(a);a.addEventListener(c.RESOURCE_COMPLETE,this._onResourceCompleteDelegate);a.addEventListener(u.TEXTURE_SIZE_ERROR,this._onTextureSizeErrorDelegate);a.addEventListener(u.ASSET_COMPLETE,this._onAssetCompleteDelegate);a._iAddErrorHandler(this._onLoadErrorDelegate);a._iAddParseErrorHandler(this._onParseErrorDelegate);return a.loadData(t,"",e,i,r)};e.prototype.getAsset=function(t,e){if(e===void 0){e=null}if(this._assetDictDirty)this.rehashAssetDict();if(e==null)e=h.DEFAULT_NAMESPACE;if(!this._assetDictionary.hasOwnProperty(e))return null;return this._assetDictionary[e][t]};e.prototype.addAsset=function(t){var e;var i;if(this._assets.indexOf(t)>=0)return;i=this.getAsset(t.name,t.assetNamespace);e=t.assetNamespace||h.DEFAULT_NAMESPACE;if(i!=null)this._strategy.resolveConflict(t,i,this._assetDictionary[e],this._strategyPreference);this._assets.push(t);if(!this._assetDictionary.hasOwnProperty(e))this._assetDictionary[e]=new Object;this._assetDictionary[e][t.name]=t;t.addEventListener(u.ASSET_RENAME,this._onAssetRenameDelegate);t.addEventListener(u.ASSET_CONFLICT_RESOLVED,this._onAssetConflictResolvedDelegate)};e.prototype.removeAsset=function(t,e){if(e===void 0){e=true}var i;this.removeAssetFromDict(t);t.removeEventListener(u.ASSET_RENAME,this._onAssetRenameDelegate);t.removeEventListener(u.ASSET_CONFLICT_RESOLVED,this._onAssetConflictResolvedDelegate);i=this._assets.indexOf(t);if(i>=0)this._assets.splice(i,1);if(e)t.dispose()};e.prototype.removeAssetByName=function(t,e,i){if(e===void 0){e=null}if(i===void 0){i=true}var r=this.getAsset(t,e);if(r)this.removeAsset(r,i);return r};e.prototype.removeAllAssets=function(t){if(t===void 0){t=true}if(t){var e;for(var i=0;i<this._assets.length;i++){e=this._assets[i];e.dispose()}}this._assets.length=0;this.rehashAssetDict()};e.prototype.removeNamespaceAssets=function(t,e){if(t===void 0){t=null}if(e===void 0){e=true}var i=0;var r;var a;a=this._assets.concat();this._assets.length=0;if(t==null)t=h.DEFAULT_NAMESPACE;for(var s=0;s<a.length;s++){r=a[s];if(r.assetNamespace==t){if(e)r.dispose();this.removeAssetFromDict(r,false)}else{this._assets[i++]=r}}if(this._assetDictionary.hasOwnProperty(t))delete this._assetDictionary[t]};e.prototype.removeAssetFromDict=function(t,e){if(e===void 0){e=true}if(this._assetDictDirty)this.rehashAssetDict();if(this._assetDictionary.hasOwnProperty(t.assetNamespace)){if(this._assetDictionary[t.assetNamespace].hasOwnProperty(t.name))delete this._assetDictionary[t.assetNamespace][t.name];if(e){var i;var r=true;for(i in this._assetDictionary[t.assetNamespace]){r=false;break}if(r)delete this._assetDictionary[t.assetNamespace]}}};e.prototype.stopAllLoadingSessions=function(){var t;if(!this._loadingSessions)this._loadingSessions=new Array;var e=this._loadingSessions.length;for(t=0;t<e;t++)this.killLoadingSession(this._loadingSessions[t]);this._loadingSessions=null};e.prototype.rehashAssetDict=function(){var t;this._assetDictionary={};var e=this._assets.length;for(var i=0;i<e;i++){t=this._assets[i];if(!this._assetDictionary.hasOwnProperty(t.assetNamespace))this._assetDictionary[t.assetNamespace]={};this._assetDictionary[t.assetNamespace][t.name]=t}this._assetDictDirty=false};e.prototype.onLoadError=function(t){if(this.hasEventListener(p.IO_ERROR)){this.dispatchEvent(t);return true}else{return false}};e.prototype.onParseError=function(t){if(this.hasEventListener(f.PARSE_ERROR)){this.dispatchEvent(t);return true}else{return false}};e.prototype.onAssetComplete=function(t){if(t.type==u.ASSET_COMPLETE)this.addAsset(t.asset);this.dispatchEvent(t)};e.prototype.onTextureSizeError=function(t){this.dispatchEvent(t)};e.prototype.onResourceComplete=function(t){var e=this;var i=t.target;this.dispatchEvent(t);var r=this._loadingSessions.indexOf(i);this._loadingSessions.splice(r,1);this._loadingSessionsGarbage.push(i);this._gcTimeoutIID=setTimeout(function(){e.loadingSessionGC()},100)};e.prototype.loadingSessionGC=function(){var t;while(this._loadingSessionsGarbage.length>0){t=this._loadingSessionsGarbage.pop();this.killLoadingSession(t)}clearTimeout(this._gcTimeoutIID);this._gcTimeoutIID=null};e.prototype.killLoadingSession=function(t){t.removeEventListener(c.RESOURCE_COMPLETE,this._onResourceCompleteDelegate);t.removeEventListener(u.TEXTURE_SIZE_ERROR,this._onTextureSizeErrorDelegate);t.removeEventListener(u.ASSET_COMPLETE,this._onAssetCompleteDelegate);t.stop()};e.prototype.onAssetRename=function(t){var e=t.target;var i=this.getAsset(e.assetNamespace,e.name);if(i!=null){this._strategy.resolveConflict(e,i,this._assetDictionary[e.assetNamespace],this._strategyPreference)}else{var r=this._assetDictionary[t.asset.assetNamespace];if(r==null)return;r[t.assetPrevName]=null;r[t.asset.name]=t.asset}};e.prototype.onAssetConflictResolved=function(t){this.dispatchEvent(t.clone())};e._iInstances=new Object;return e}(d);e.exports=_},{"awayjs-core/lib/errors/Error":undefined,"awayjs-core/lib/events/AssetEvent":undefined,"awayjs-core/lib/events/EventDispatcher":undefined,"awayjs-core/lib/events/IOErrorEvent":undefined,"awayjs-core/lib/events/LoaderEvent":undefined,"awayjs-core/lib/events/ParserEvent":undefined,"awayjs-core/lib/library/AssetLibraryIterator":undefined,"awayjs-core/lib/library/AssetLoader":undefined,"awayjs-core/lib/library/ConflictPrecedence":undefined,"awayjs-core/lib/library/ConflictStrategy":undefined,"awayjs-core/lib/library/NamedAssetBase":undefined}],"awayjs-core/lib/library/AssetLibraryIterator":[function(t,e,i){var r=function(){function t(t,e,i,r){this._assets=t;this.filter(e,i,r)}Object.defineProperty(t.prototype,"currentAsset",{get:function(){return this._idx<this._filtered.length?this._filtered[this._idx]:null},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"numAssets",{get:function(){return this._filtered.length},enumerable:true,configurable:true});t.prototype.next=function(){var t=null;if(this._idx<this._filtered.length)t=this._filtered[this._idx];this._idx++;return t};t.prototype.reset=function(){this._idx=0};t.prototype.setIndex=function(t){this._idx=t};t.prototype.filter=function(t,e,i){if(t||e){var r;var a;r=0;this._filtered=new Array;var s=this._assets.length;for(var n=0;n<s;n++){a=this._assets[n];if(t&&a.assetType!=t)continue;if(e&&a.assetNamespace!=e)continue;if(i!=null&&!i(a))continue;this._filtered[r++]=a}}else{this._filtered=this._assets}};return t}();e.exports=r},{}],"awayjs-core/lib/library/AssetLibrary":[function(t,e,i){var r=t("awayjs-core/lib/library/AssetLibraryBundle");var a=t("awayjs-core/lib/library/AssetLoader");var s=function(){function t(){}t.getBundle=function(t){if(t===void 0){t="default"}return r.getInstance(t)};t.enableParser=function(t){a.enableParser(t)};t.enableParsers=function(t){a.enableParsers(t)};Object.defineProperty(t,"conflictStrategy",{get:function(){return t.getBundle().conflictStrategy},set:function(e){t.getBundle().conflictStrategy=e},enumerable:true,configurable:true});Object.defineProperty(t,"conflictPrecedence",{get:function(){return t.getBundle().conflictPrecedence},set:function(e){t.getBundle().conflictPrecedence=e},enumerable:true,configurable:true});t.createIterator=function(e,i,r){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=null}return t.getBundle().createIterator(e,i,r)};t.load=function(e,i,r,a){if(i===void 0){i=null}if(r===void 0){r=null}if(a===void 0){a=null}return t.getBundle().load(e,i,r,a)};t.loadData=function(e,i,r,a){if(i===void 0){i=null}if(r===void 0){r=null}if(a===void 0){a=null}return t.getBundle().loadData(e,i,r,a)};t.stopLoad=function(){t.getBundle().stopAllLoadingSessions()};t.getAsset=function(e,i){if(i===void 0){i=null}return t.getBundle().getAsset(e,i)};t.addEventListener=function(e,i){t.getBundle().addEventListener(e,i)};t.removeEventListener=function(e,i){t.getBundle().removeEventListener(e,i)};t.addAsset=function(e){t.getBundle().addAsset(e)};t.removeAsset=function(e,i){if(i===void 0){i=true}t.getBundle().removeAsset(e,i)};t.removeAssetByName=function(e,i,r){if(i===void 0){i=null}if(r===void 0){r=true}return t.getBundle().removeAssetByName(e,i,r)};t.removeAllAssets=function(e){if(e===void 0){e=true}t.getBundle().removeAllAssets(e)};t.removeNamespaceAssets=function(e,i){if(e===void 0){e=null}if(i===void 0){i=true
}t.getBundle().removeNamespaceAssets(e,i)};return t}();e.exports=s},{"awayjs-core/lib/library/AssetLibraryBundle":undefined,"awayjs-core/lib/library/AssetLoader":undefined}],"awayjs-core/lib/library/AssetLoaderContext":[function(t,e,i){var r=function(){function t(e,i){if(e===void 0){e=true}if(i===void 0){i=null}this._includeDependencies=e;this._dependencyBaseUrl=i||"";this._embeddedDataByUrl={};this._remappedUrls={};this._materialMode=t.UNDEFINED}Object.defineProperty(t.prototype,"includeDependencies",{get:function(){return this._includeDependencies},set:function(t){this._includeDependencies=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"materialMode",{get:function(){return this._materialMode},set:function(t){this._materialMode=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"dependencyBaseUrl",{get:function(){return this._dependencyBaseUrl},set:function(t){this._dependencyBaseUrl=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"overrideAbsolutePaths",{get:function(){return this._overrideAbsPath},set:function(t){this._overrideAbsPath=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"overrideFullURLs",{get:function(){return this._overrideFullUrls},set:function(t){this._overrideFullUrls=t},enumerable:true,configurable:true});t.prototype.mapUrl=function(t,e){this._remappedUrls[t]=e};t.prototype.mapUrlToData=function(t,e){this._embeddedDataByUrl[t]=e};t.prototype._iHasDataForUrl=function(t){return this._embeddedDataByUrl.hasOwnProperty(t)};t.prototype._iGetDataForUrl=function(t){return this._embeddedDataByUrl[t]};t.prototype._iHasMappingForUrl=function(t){return this._remappedUrls.hasOwnProperty(t)};t.prototype._iGetRemappedUrl=function(t){return this._remappedUrls[t]};t.UNDEFINED=0;t.SINGLEPASS_MATERIALS=1;t.MULTIPASS_MATERIALS=2;return t}();e.exports=r},{}],"awayjs-core/lib/library/AssetLoaderToken":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/EventDispatcher");var s=function(t){r(e,t);function e(e){t.call(this);this._iLoader=e}e.prototype.addEventListener=function(t,e){this._iLoader.addEventListener(t,e)};e.prototype.removeEventListener=function(t,e){this._iLoader.removeEventListener(t,e)};e.prototype.hasEventListener=function(t,e){if(e===void 0){e=null}return this._iLoader.hasEventListener(t,e)};return e}(a);e.exports=s},{"awayjs-core/lib/events/EventDispatcher":undefined}],"awayjs-core/lib/library/AssetLoader":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetLoaderToken");var s=t("awayjs-core/lib/net/URLLoader");var n=t("awayjs-core/lib/net/URLLoaderDataFormat");var o=t("awayjs-core/lib/errors/Error");var h=t("awayjs-core/lib/events/AssetEvent");var l=t("awayjs-core/lib/events/Event");var u=t("awayjs-core/lib/events/EventDispatcher");var p=t("awayjs-core/lib/events/IOErrorEvent");var c=t("awayjs-core/lib/events/LoaderEvent");var d=t("awayjs-core/lib/events/ParserEvent");var f=t("awayjs-core/lib/parsers/CubeTextureParser");var _=t("awayjs-core/lib/parsers/ResourceDependency");var y=t("awayjs-core/lib/parsers/Texture2DParser");var g=function(t){r(e,t);function e(e){var i=this;if(e===void 0){e=0}t.call(this);this._materialMode=e;this._stack=new Array;this._errorHandlers=new Array;this._parseErrorHandlers=new Array;this._onReadyForDependenciesDelegate=function(t){return i.onReadyForDependencies(t)};this._onParseCompleteDelegate=function(t){return i.onParseComplete(t)};this._onParseErrorDelegate=function(t){return i.onParseError(t)};this._onLoadCompleteDelegate=function(t){return i.onLoadComplete(t)};this._onLoadErrorDelegate=function(t){return i.onLoadError(t)};this._onTextureSizeErrorDelegate=function(t){return i.onTextureSizeError(t)};this._onAssetCompleteDelegate=function(t){return i.onAssetComplete(t)}}e.enableParser=function(t){if(e._parsers.indexOf(t)<0)e._parsers.push(t)};e.enableParsers=function(t){for(var i=0;i<t.length;i++)e.enableParser(t[i])};Object.defineProperty(e.prototype,"baseDependency",{get:function(){return this._baseDependency},enumerable:true,configurable:true});e.prototype.load=function(t,e,i,r){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=null}if(!this._token){this._token=new a(this);this._uri=t.url=t.url.replace(/\\/g,"/");this._context=e;this._namespace=i;this._baseDependency=new _("",t,null,r,null);this.retrieveDependency(this._baseDependency);return this._token}return null};e.prototype.loadData=function(t,e,i,r,s){if(i===void 0){i=null}if(r===void 0){r=null}if(s===void 0){s=null}if(!this._token){this._token=new a(this);this._uri=e;this._context=i;this._namespace=r;this._baseDependency=new _(e,null,t,s,null);this.retrieveDependency(this._baseDependency);return this._token}return null};e.prototype.retrieveNext=function(t){if(t===void 0){t=null}if(this._currentDependency.dependencies.length){var e=this._currentDependency.dependencies.pop();this._stack.push(this._currentDependency);this.retrieveDependency(e)}else if(this._currentDependency.parser&&this._currentDependency.parser.parsingPaused){this._currentDependency.parser._iResumeParsingAfterDependencies();this._stack.pop()}else if(this._stack.length){var i=this._currentDependency;this._currentDependency=this._stack.pop();if(i._iSuccess)i.resolve();this.retrieveNext(t)}else{this.dispatchEvent(new c(c.RESOURCE_COMPLETE,this._uri,this._baseDependency.parser.content,this._baseDependency.assets))}};e.prototype.retrieveDependency=function(t){var e;if(this._context&&this._context.materialMode!=0)this._materialMode=this._context.materialMode;this._currentDependency=t;t._iLoader=new s;this.addEventListeners(t._iLoader);e=t.data;if(this._context&&t.request&&this._context._iHasDataForUrl(t.request.url))e=this._context._iGetDataForUrl(t.request.url);if(e){if(e.constructor===Function)e=new e;t._iSetData(e);if(t.retrieveAsRawData){t.resolve();this.retrieveNext()}else{this.parseDependency(t)}}else{t.request.url=this.resolveDependencyUrl(t);if(t.retrieveAsRawData){t._iLoader.dataFormat=n.BINARY}else{if(!t.parser)t._iSetParser(this.getParserFromSuffix(t.request.url));if(t.parser){t._iLoader.dataFormat=t.parser.dataFormat}else{t._iLoader.dataFormat=n.BINARY}}t._iLoader.load(t.request)}};e.prototype.joinUrl=function(t,e){if(e.charAt(0)=="/")e=e.substr(1);if(t.length==0)return e;if(t.charAt(t.length-1)=="/")t=t.substr(0,t.length-1);return t.concat("/",e)};e.prototype.resolveDependencyUrl=function(t){var e;var i;var r=t.request.url;if(this._context&&this._context._iHasMappingForUrl(r))return this._context._iGetRemappedUrl(r);if(r==this._uri)return r;e=new RegExp("/^[a-zA-Z]{3,4}:///");if(r.charAt(0)=="/"){if(this._context&&this._context.overrideAbsolutePaths)return this.joinUrl(this._context.dependencyBaseUrl,r);else return r}else if(e.test(r)){if(this._context&&this._context.overrideFullURLs){var a=r.replace(e,"");return this.joinUrl(this._context.dependencyBaseUrl,a)}}if(this._context&&this._context.dependencyBaseUrl){i=this._context.dependencyBaseUrl;return this.joinUrl(i,r)}else{i=this._uri.substring(0,this._uri.lastIndexOf("/")+1);return this.joinUrl(i,r)}};e.prototype.retrieveParserDependencies=function(){if(!this._currentDependency)return;var t=this._currentDependency.parser.dependencies;var e,i=t.length;for(e=0;e<i;e++)this._currentDependency.dependencies[e]=t[e];t.length=0;this._stack.push(this._currentDependency);this.retrieveNext()};e.prototype.resolveParserDependencies=function(){this._currentDependency._iSuccess=true;if(this._currentDependency.parser&&this._currentDependency.parser.dependencies.length&&(!this._context||this._context.includeDependencies))this.retrieveParserDependencies();else this.retrieveNext()};e.prototype.onLoadError=function(t){var e;var i=this._currentDependency!=this._baseDependency;var r=t.target;this.removeEventListeners(r);if(this.hasEventListener(p.IO_ERROR)){this.dispatchEvent(t);e=true}else{var a,s=this._errorHandlers.length;for(a=0;a<s;a++)if(!e)e=this._errorHandlers[a](t)}if(e){if(i){this._currentDependency.resolveFailure();this.retrieveNext()}else{this.dispose();return}}else{throw new o}};e.prototype.onParseError=function(t){var e;var i=this._currentDependency!=this._baseDependency;var r=t.target;this.removeEventListeners(r);if(this.hasEventListener(d.PARSE_ERROR)){this.dispatchEvent(t);e=true}else{var a,s=this._parseErrorHandlers.length;for(a=0;a<s;a++)if(!e)e=this._parseErrorHandlers[a](t)}if(e){this.dispose();return}else{throw new o(t.message)}};e.prototype.onAssetComplete=function(t){if(this._currentDependency)this._currentDependency.assets.push(t.asset);t.asset.resetAssetPath(t.asset.name,this._namespace);if(!this._currentDependency.suppresAssetEvents)this.dispatchEvent(t)};e.prototype.onReadyForDependencies=function(t){var e=t.target;if(this._context&&!this._context.includeDependencies)e._iResumeParsingAfterDependencies();else this.retrieveParserDependencies()};e.prototype.onLoadComplete=function(t){var e=t.target;this.removeEventListeners(e);this._currentDependency._iSetData(e.data);if(this._currentDependency.retrieveAsRawData){this.resolveParserDependencies()}else{this.parseDependency(this._currentDependency)}};e.prototype.onParseComplete=function(t){var e=t.target;this.resolveParserDependencies();e.removeEventListener(d.READY_FOR_DEPENDENCIES,this._onReadyForDependenciesDelegate);e.removeEventListener(d.PARSE_COMPLETE,this._onParseCompleteDelegate);e.removeEventListener(d.PARSE_ERROR,this._onParseErrorDelegate);e.removeEventListener(h.TEXTURE_SIZE_ERROR,this._onTextureSizeErrorDelegate);e.removeEventListener(h.ASSET_COMPLETE,this._onAssetCompleteDelegate)};e.prototype.onTextureSizeError=function(t){t.asset.name=this._currentDependency.resolveName(t.asset);this.dispatchEvent(t)};e.prototype.addEventListeners=function(t){t.addEventListener(l.COMPLETE,this._onLoadCompleteDelegate);t.addEventListener(p.IO_ERROR,this._onLoadErrorDelegate)};e.prototype.removeEventListeners=function(t){t.removeEventListener(l.COMPLETE,this._onLoadCompleteDelegate);t.removeEventListener(p.IO_ERROR,this._onLoadErrorDelegate)};e.prototype.stop=function(){this.dispose()};e.prototype.dispose=function(){this._errorHandlers=null;this._parseErrorHandlers=null;this._context=null;this._token=null;this._stack=null;if(this._currentDependency&&this._currentDependency._iLoader)this.removeEventListeners(this._currentDependency._iLoader);this._currentDependency=null};e.prototype._iAddParseErrorHandler=function(t){if(this._parseErrorHandlers.indexOf(t)<0)this._parseErrorHandlers.push(t)};e.prototype._iAddErrorHandler=function(t){if(this._errorHandlers.indexOf(t)<0)this._errorHandlers.push(t)};e.prototype.getParserFromData=function(t){var i=e._parsers.length;for(var r=i-1;r>=0;r--)if(e._parsers[r].supportsData(t))return new e._parsers[r];return null};e.prototype.parseDependency=function(t){var e=t.parser;if(!e)t._iSetParser(e=this.getParserFromData(t.data));if(e){e.addEventListener(d.READY_FOR_DEPENDENCIES,this._onReadyForDependenciesDelegate);e.addEventListener(d.PARSE_COMPLETE,this._onParseCompleteDelegate);e.addEventListener(d.PARSE_ERROR,this._onParseErrorDelegate);e.addEventListener(h.TEXTURE_SIZE_ERROR,this._onTextureSizeErrorDelegate);e.addEventListener(h.ASSET_COMPLETE,this._onAssetCompleteDelegate);if(t.request&&t.request.url)e._iFileName=t.request.url;e.materialMode=this._materialMode;e.parseAsync(t.data)}else{var i="No parser defined. To enable all parsers for auto-detection, use Parsers.enableAllBundled()";if(this.hasEventListener(d.PARSE_ERROR))this.dispatchEvent(new d(d.PARSE_ERROR,i));else throw new o(i)}};e.prototype.getParserFromSuffix=function(t){var i=t.indexOf("?")>0?t.split("?")[0]:t;var r=i.substr(i.lastIndexOf(".")+1).toLowerCase();var a=e._parsers.length;for(var s=a-1;s>=0;s--){var n=e._parsers[s];if(n.supportsType(r))return new n}return null};e._parsers=new Array(y,f);return e}(u);e.exports=g},{"awayjs-core/lib/errors/Error":undefined,"awayjs-core/lib/events/AssetEvent":undefined,"awayjs-core/lib/events/Event":undefined,"awayjs-core/lib/events/EventDispatcher":undefined,"awayjs-core/lib/events/IOErrorEvent":undefined,"awayjs-core/lib/events/LoaderEvent":undefined,"awayjs-core/lib/events/ParserEvent":undefined,"awayjs-core/lib/library/AssetLoaderToken":undefined,"awayjs-core/lib/net/URLLoader":undefined,"awayjs-core/lib/net/URLLoaderDataFormat":undefined,"awayjs-core/lib/parsers/CubeTextureParser":undefined,"awayjs-core/lib/parsers/ResourceDependency":undefined,"awayjs-core/lib/parsers/Texture2DParser":undefined}],"awayjs-core/lib/library/AssetType":[function(t,e,i){var r=function(){function t(){}t.ANIMATION_NODE="animationNode";t.ANIMATION_SET="animationSet";t.ANIMATION_STATE="animationState";t.ANIMATOR="animator";t.BILLBOARD="billboard";t.CAMERA="camera";t.CONTAINER="container";t.EFFECTS_METHOD="effectsMethod";t.GEOMETRY="geometry";t.LINE_SEGMENT="lineSegment";t.LIGHT="light";t.LIGHT_PICKER="lightPicker";t.MATERIAL="material";t.MESH="mesh";t.TRIANGLE_SUB_MESH="triangleSubMesh";t.LINE_SUB_MESH="lineSubMesh";t.PRIMITIVE_PREFAB="primitivePrefab";t.SHADOW_MAP_METHOD="shadowMapMethod";t.SKELETON="skeleton";t.SKELETON_POSE="skeletonPose";t.SKYBOX="skybox";t.STATE_TRANSITION="stateTransition";t.TEXTURE="texture";t.TEXTURE_PROJECTOR="textureProjector";return t}();e.exports=r},{}],"awayjs-core/lib/library/ConflictPrecedence":[function(t,e,i){var r=function(){function t(){}t.FAVOR_OLD="favorOld";t.FAVOR_NEW="favorNew";return t}();e.exports=r},{}],"awayjs-core/lib/library/ConflictStrategyBase":[function(t,e,i){var r=t("awayjs-core/lib/library/ConflictPrecedence");var a=t("awayjs-core/lib/errors/AbstractMethodError");var s=t("awayjs-core/lib/events/AssetEvent");var n=function(){function t(){}t.prototype.resolveConflict=function(t,e,i,r){throw new a};t.prototype.create=function(){throw new a};t.prototype._pUpdateNames=function(t,e,i,a,n,o){var h;var l;var u;l=o===r.FAVOR_NEW?a:i;u=o===r.FAVOR_NEW?i:a;h=u.name;n[l.name]=l;n[e]=u;u.resetAssetPath(e,t,false);u.dispatchEvent(new s(s.ASSET_CONFLICT_RESOLVED,u,h))};return t}();e.exports=n},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/events/AssetEvent":undefined,"awayjs-core/lib/library/ConflictPrecedence":undefined}],"awayjs-core/lib/library/ConflictStrategy":[function(t,e,i){var r=t("awayjs-core/lib/library/ErrorConflictStrategy");var a=t("awayjs-core/lib/library/IgnoreConflictStrategy");var s=t("awayjs-core/lib/library/NumSuffixConflictStrategy");var n=function(){function t(t){}t.APPEND_NUM_SUFFIX=new s;t.IGNORE=new a;t.THROW_ERROR=new r;return t}();e.exports=n},{"awayjs-core/lib/library/ErrorConflictStrategy":undefined,"awayjs-core/lib/library/IgnoreConflictStrategy":undefined,"awayjs-core/lib/library/NumSuffixConflictStrategy":undefined}],"awayjs-core/lib/library/ErrorConflictStrategy":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/ConflictStrategyBase");var s=t("awayjs-core/lib/errors/Error");var n=function(t){r(e,t);function e(){t.call(this)}e.prototype.resolveConflict=function(t,e,i,r){throw new s("Asset name collision while AssetLibrary.namingStrategy set to AssetLibrary.THROW_ERROR. Asset path: "+t.assetFullPath)};e.prototype.create=function(){return new e};return e}(a);e.exports=n},{"awayjs-core/lib/errors/Error":undefined,"awayjs-core/lib/library/ConflictStrategyBase":undefined}],"awayjs-core/lib/library/IAsset":[function(t,e,i){},{}],"awayjs-core/lib/library/IDUtil":[function(t,e,i){var r=function(){function t(){}t.createUID=function(){var e=new Array(36);var i=0;var r;var a;for(r=0;r<8;r++)e[i++]=t.ALPHA_CHAR_CODES[Math.floor(Math.random()*16)];for(r=0;r<3;r++){e[i++]=45;for(a=0;a<4;a++)e[i++]=t.ALPHA_CHAR_CODES[Math.floor(Math.random()*16)]}e[i++]=45;var s=(new Date).getTime();var n=("0000000"+s.toString(16).toUpperCase()).substr(-8);for(r=0;r<8;r++)e[i++]=n.charCodeAt(r);for(r=0;r<4;r++)e[i++]=t.ALPHA_CHAR_CODES[Math.floor(Math.random()*16)];return String.fromCharCode.apply(null,e)};t.ALPHA_CHAR_CODES=[48,49,50,51,52,53,54,55,56,57,65,66,67,68,69,70];return t}();e.exports=r},{}],"awayjs-core/lib/library/IgnoreConflictStrategy":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/ConflictStrategyBase");var s=function(t){r(e,t);function e(){t.call(this)}e.prototype.resolveConflict=function(t,e,i,r){return};e.prototype.create=function(){return new e};return e}(a);e.exports=s},{"awayjs-core/lib/library/ConflictStrategyBase":undefined}],"awayjs-core/lib/library/NamedAssetBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/AbstractMethodError");var s=t("awayjs-core/lib/events/AssetEvent");var n=t("awayjs-core/lib/events/EventDispatcher");var o=function(t){r(e,t);function e(i){if(i===void 0){i=null}t.call(this);this._id=e.ID_COUNT++;if(i==null)i="null";this._name=i;this._originalName=i;this.updateFullPath()}Object.defineProperty(e.prototype,"assetType",{get:function(){throw new a},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"originalName",{get:function(){return this._originalName},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(t){var e;e=this._name;this._name=t;if(this._name==null)this._name="null";this.updateFullPath();this.dispatchEvent(new s(s.ASSET_RENAME,this,e))},enumerable:true,configurable:true});e.prototype.dispose=function(){throw new a};Object.defineProperty(e.prototype,"assetNamespace",{get:function(){return this._namespace},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"assetFullPath",{get:function(){return this._full_path},enumerable:true,configurable:true});e.prototype.assetPathEquals=function(t,e){return this._name==t&&(!e||this._namespace==e)};e.prototype.resetAssetPath=function(t,i,r){if(i===void 0){i=null}if(r===void 0){r=true}this._name=t?t:"null";this._namespace=i?i:e.DEFAULT_NAMESPACE;if(r)this._originalName=this._name;this.updateFullPath()};e.prototype.updateFullPath=function(){this._full_path=[this._namespace,this._name]};e.ID_COUNT=0;e.DEFAULT_NAMESPACE="default";return e}(n);e.exports=o},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/events/AssetEvent":undefined,"awayjs-core/lib/events/EventDispatcher":undefined}],"awayjs-core/lib/library/NumSuffixConflictStrategy":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/ConflictStrategyBase");var s=function(t){r(e,t);function e(e){if(e===void 0){e="."}t.call(this);this._separator=e;this._next_suffix={}}e.prototype.resolveConflict=function(t,e,i,r){var a;var s;var n;var o;a=t.name;if(a.indexOf(this._separator)>=0){n=a.substring(0,a.lastIndexOf(this._separator));o=parseInt(a.substring(n.length-1));if(isNaN(o)){n=a;o=0}}else{n=a;o=0}if(o==0&&this._next_suffix.hasOwnProperty(n)){o=this._next_suffix[n]}do{o++;s=n.concat(this._separator,o.toString())}while(i.hasOwnProperty(s));this._next_suffix[n]=o;this._pUpdateNames(e.assetNamespace,s,e,t,i,r)};e.prototype.create=function(){return new e(this._separator)};return e}(a);e.exports=s},{"awayjs-core/lib/library/ConflictStrategyBase":undefined}],"awayjs-core/lib/net/CrossDomainPolicy":[function(t,e,i){var r=function(){function t(){}t.ANONYMOUS="anonymous";t.USE_CREDENTIALS="use-credentials";return t}();e.exports=r},{}],"awayjs-core/lib/net/URLLoaderDataFormat":[function(t,e,i){var r=function(){function t(){}t.TEXT="text";t.VARIABLES="variables";t.BLOB="blob";t.ARRAY_BUFFER="arraybuffer";t.BINARY="binary";return t}();e.exports=r},{}],"awayjs-core/lib/net/URLLoader":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/net/URLLoaderDataFormat");var s=t("awayjs-core/lib/net/URLRequestMethod");var n=t("awayjs-core/lib/net/URLVariables");var o=t("awayjs-core/lib/events/Event");var h=t("awayjs-core/lib/events/EventDispatcher");var l=t("awayjs-core/lib/events/HTTPStatusEvent");var u=t("awayjs-core/lib/events/IOErrorEvent");var p=t("awayjs-core/lib/events/ProgressEvent");var c=function(t){r(e,t);function e(){t.call(this);this._bytesLoaded=0;this._bytesTotal=0;this._dataFormat=a.TEXT;this._loadError=false}Object.defineProperty(e.prototype,"url",{get:function(){return this._request?this._request.url:""},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"dataFormat",{get:function(){return this._dataFormat},set:function(t){this._dataFormat=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"bytesLoaded",{get:function(){return this._bytesLoaded},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"bytesTotal",{get:function(){return this._bytesTotal},enumerable:true,configurable:true});e.prototype.load=function(t){this._request=t;this.initXHR();if(t.method===s.POST)this.postRequest(t);else this.getRequest(t)};e.prototype.close=function(){this._XHR.abort();this.disposeXHR()};e.prototype.dispose=function(){if(this._XHR)this._XHR.abort();this.disposeXHR();this._data=null;this._dataFormat=null;this._bytesLoaded=null;this._bytesTotal=null};e.prototype.setResponseType=function(t,e){switch(e){case a.ARRAY_BUFFER:case a.BLOB:case a.TEXT:t.responseType=e;break;case a.VARIABLES:t.responseType=a.TEXT;break;case a.BINARY:t.responseType="";break;default:}};e.prototype.getRequest=function(t){try{this._XHR.open(t.method,t.url,t.async);this.setResponseType(this._XHR,this._dataFormat);this._XHR.send()}catch(e){this.handleXmlHttpRequestException(e)}};e.prototype.postRequest=function(t){this._loadError=false;this._XHR.open(t.method,t.url,t.async);if(t.data!=null){if(t.data instanceof n){var e=t.data;try{this._XHR.responseType="text";this._XHR.send(e.formData)}catch(i){this.handleXmlHttpRequestException(i)}}else{this.setResponseType(this._XHR,this._dataFormat);if(t.data)this._XHR.send(t.data);else this._XHR.send()}}else{this._XHR.send()}};e.prototype.handleXmlHttpRequestException=function(t){switch(t.code){case 101:break}};e.prototype.initXHR=function(){var t=this;if(!this._XHR){this._XHR=new XMLHttpRequest;this._XHR.onloadstart=function(e){return t.onLoadStart(e)};this._XHR.onprogress=function(e){return t.onProgress(e)};this._XHR.onabort=function(e){return t.onAbort(e)};this._XHR.onerror=function(e){return t.onLoadError(e)};this._XHR.onload=function(e){return t.onLoadComplete(e)};this._XHR.ontimeout=function(e){return t.onTimeOut(e)};this._XHR.onloadend=function(e){return t.onLoadEnd(e)};this._XHR.onreadystatechange=function(e){return t.onReadyStateChange(e)}}};e.prototype.disposeXHR=function(){if(this._XHR!==null){this._XHR.onloadstart=null;this._XHR.onprogress=null;this._XHR.onabort=null;this._XHR.onerror=null;this._XHR.onload=null;this._XHR.ontimeout=null;this._XHR.onloadend=null;this._XHR=null}};e.prototype.decodeURLVariables=function(t){var e=new Object;t=t.split("+").join(" ");var i,r=/[?&]?([^=]+)=([^&]*)/g;while(i=r.exec(t))e[decodeURIComponent(i[1])]=decodeURIComponent(i[2]);return e};e.prototype.onReadyStateChange=function(t){if(this._XHR.readyState==4){if(this._XHR.status==404){this._loadError=true;if(!this._loadErrorEvent)this._loadErrorEvent=new u(u.IO_ERROR);this.dispatchEvent(this._loadErrorEvent)}this.dispatchEvent(new l(l.HTTP_STATUS,this._XHR.status))}};e.prototype.onLoadEnd=function(t){if(this._loadError===true)return};e.prototype.onTimeOut=function(t){};e.prototype.onAbort=function(t){};e.prototype.onProgress=function(t){if(!this._progressEvent)this._progressEvent=new p(p.PROGRESS);this._progressEvent.bytesTotal=t.total;this._progressEvent.bytesLoaded=t.loaded;this.dispatchEvent(this._progressEvent)};e.prototype.onLoadStart=function(t){if(!this._loadStartEvent)this._loadStartEvent=new o(o.OPEN);this.dispatchEvent(this._loadStartEvent)};e.prototype.onLoadComplete=function(t){if(this._loadError===true)return;switch(this._dataFormat){case a.TEXT:this._data=this._XHR.responseText;break;case a.VARIABLES:this._data=this.decodeURLVariables(this._XHR.responseText);break;case a.BLOB:case a.ARRAY_BUFFER:case a.BINARY:this._data=this._XHR.response;break;default:this._data=this._XHR.responseText;break}if(!this._loadCompleteEvent)this._loadCompleteEvent=new o(o.COMPLETE);this.dispatchEvent(this._loadCompleteEvent)};e.prototype.onLoadError=function(t){this._loadError=true;if(!this._loadErrorEvent)this._loadErrorEvent=new u(u.IO_ERROR);this.dispatchEvent(this._loadErrorEvent)};return e}(h);e.exports=c},{"awayjs-core/lib/events/Event":undefined,"awayjs-core/lib/events/EventDispatcher":undefined,"awayjs-core/lib/events/HTTPStatusEvent":undefined,"awayjs-core/lib/events/IOErrorEvent":undefined,"awayjs-core/lib/events/ProgressEvent":undefined,"awayjs-core/lib/net/URLLoaderDataFormat":undefined,"awayjs-core/lib/net/URLRequestMethod":undefined,"awayjs-core/lib/net/URLVariables":undefined}],"awayjs-core/lib/net/URLRequestMethod":[function(t,e,i){var r=function(){function t(){}t.POST="POST";t.GET="GET";return t}();e.exports=r},{}],"awayjs-core/lib/net/URLRequest":[function(t,e,i){var r=t("awayjs-core/lib/net/URLRequestMethod");var a=function(){function t(t){if(t===void 0){t=null}this.method=r.GET;this.async=true;this._url=t}Object.defineProperty(t.prototype,"url",{get:function(){return this._url},set:function(t){this._url=t},enumerable:true,configurable:true});t.prototype.dispose=function(){this.data=null;this._url=null};return t}();e.exports=a},{"awayjs-core/lib/net/URLRequestMethod":undefined}],"awayjs-core/lib/net/URLVariables":[function(t,e,i){var r=function(){function t(t){if(t===void 0){t=null}this._variables=new Object;if(t!==null)this.decode(t)}t.prototype.decode=function(t){t=t.split("+").join(" ");var e,i=/[?&]?([^=]+)=([^&]*)/g;while(e=i.exec(t))this._variables[decodeURIComponent(e[1])]=decodeURIComponent(e[2])};t.prototype.toString=function(){return""};Object.defineProperty(t.prototype,"variables",{get:function(){return this._variables},set:function(t){this._variables=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"formData",{get:function(){var t=new FormData;for(var e in this._variables)t.append(e,this._variables[e]);return t},enumerable:true,configurable:true});return t}();e.exports=r},{}],"awayjs-core/lib/parsers/CubeTextureParser":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/net/URLLoaderDataFormat");var s=t("awayjs-core/lib/net/URLRequest");var n=t("awayjs-core/lib/parsers/ParserBase");var o=t("awayjs-core/lib/textures/ImageCubeTexture");var h=function(t){r(e,t);function e(){t.call(this,a.TEXT)}e.supportsType=function(t){t=t.toLowerCase();return t=="cube"};e.supportsData=function(t){try{var e=JSON.parse(t);if(e){return true}return false}catch(i){return false}return false};e.prototype._iResolveDependency=function(t){};e.prototype._iResolveDependencyFailure=function(t){};e.prototype._pProceedParsing=function(){if(this._imgDependencyDictionary!=null){var t=new o(this._getHTMLImageElement(e.posX),this._getHTMLImageElement(e.negX),this._getHTMLImageElement(e.posY),this._getHTMLImageElement(e.negY),this._getHTMLImageElement(e.posZ),this._getHTMLImageElement(e.negZ));this._imgDependencyDictionary=null;t.name=this._iFileName;this._pFinalizeAsset(t,this._iFileName);return n.PARSING_DONE}try{var i=JSON.parse(this.data);var r=i.data;var a;if(r.length!=6)this._pDieWithError("CubeTextureParser: Error - cube texture should have exactly 6 images");if(i){this._imgDependencyDictionary=new Object;for(var h=0;h<r.length;h++){a=r[h];this._imgDependencyDictionary[a.id]=this._pAddDependency(a.id,new s(a.image.toString()))}if(!this._validateCubeData()){this._pDieWithError("CubeTextureParser: JSON data error - cubes require id of:   \n"+e.posX+", "+e.negX+",  \n"+e.posY+", "+e.negY+",  \n"+e.posZ+", "+e.negZ);return n.PARSING_DONE}this._pPauseAndRetrieveDependencies();return n.MORE_TO_PARSE}}catch(l){this._pDieWithError("CubeTexturePaser Error parsing JSON")}return n.PARSING_DONE};e.prototype._validateCubeData=function(){return this._imgDependencyDictionary[e.posX]!=null&&this._imgDependencyDictionary[e.negX]!=null&&this._imgDependencyDictionary[e.posY]!=null&&this._imgDependencyDictionary[e.negY]!=null&&this._imgDependencyDictionary[e.posZ]!=null&&this._imgDependencyDictionary[e.negZ]!=null};e.prototype._getHTMLImageElement=function(t){var e=this._imgDependencyDictionary[t];if(e){return e.assets[0].htmlImageElement}return null};e.posX="posX";e.negX="negX";e.posY="posY";e.negY="negY";e.posZ="posZ";e.negZ="negZ";return e}(n);e.exports=h},{"awayjs-core/lib/net/URLLoaderDataFormat":undefined,"awayjs-core/lib/net/URLRequest":undefined,"awayjs-core/lib/parsers/ParserBase":undefined,"awayjs-core/lib/textures/ImageCubeTexture":undefined}],"awayjs-core/lib/parsers/ParserBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/AbstractMethodError");var s=t("awayjs-core/lib/events/AssetEvent");var n=t("awayjs-core/lib/events/EventDispatcher");var o=t("awayjs-core/lib/events/ParserEvent");var h=t("awayjs-core/lib/events/TimerEvent");var l=t("awayjs-core/lib/parsers/ParserUtils");var u=t("awayjs-core/lib/parsers/ResourceDependency");var p=t("awayjs-core/lib/utils/TextureUtils");var c=t("awayjs-core/lib/utils/Timer");var d=t("awayjs-core/lib/utils/getTimer");var f=function(t){r(e,t);function e(e){var i=this;t.call(this);this._materialMode=0;this._dataFormat=e;this._dependencies=new Array;this._pOnIntervalDelegate=function(t){return i._pOnInterval(t)}}e.supportsType=function(t){throw new a};Object.defineProperty(e.prototype,"content",{get:function(){return this._pContent},enumerable:true,configurable:true});e.prototype.isBitmapDataValid=function(t){var e=p.isBitmapDataValid(t);if(!e){console.log(">> Bitmap loaded is not having power of 2 dimensions or is higher than 2048")}return e};Object.defineProperty(e.prototype,"parsingFailure",{get:function(){return this._parsingFailure},set:function(t){this._parsingFailure=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"parsingPaused",{get:function(){return this._parsingPaused},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"parsingComplete",{get:function(){return this._parsingComplete},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"materialMode",{get:function(){return this._materialMode},set:function(t){this._materialMode=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"dataFormat",{get:function(){return this._dataFormat},enumerable:true,configurable:true});e.prototype.parseAsync=function(t,e){if(e===void 0){e=30}this._data=t;this._pStartParsing(e)};Object.defineProperty(e.prototype,"dependencies",{get:function(){return this._dependencies
},enumerable:true,configurable:true});e.prototype._iResolveDependency=function(t){throw new a};e.prototype._iResolveDependencyFailure=function(t){throw new a};e.prototype._iResolveDependencyName=function(t,e){return e.name};e.prototype._iResumeParsingAfterDependencies=function(){this._parsingPaused=false;if(this._timer)this._timer.start()};e.prototype._pFinalizeAsset=function(t,e){if(e===void 0){e=null}var i;var r;if(e!=null)t.name=e;if(!t.name)t.name=t.assetType;this.dispatchEvent(new s(s.ASSET_COMPLETE,t))};e.prototype._pProceedParsing=function(){throw new a};e.prototype._pDieWithError=function(t){if(t===void 0){t="Unknown parsing error"}if(this._timer){this._timer.removeEventListener(h.TIMER,this._pOnIntervalDelegate);this._timer.stop();this._timer=null}this.dispatchEvent(new o(o.PARSE_ERROR,t))};e.prototype._pAddDependency=function(t,e,i,r,a){if(i===void 0){i=false}if(r===void 0){r=null}if(a===void 0){a=false}var s=new u(t,e,r,null,this,i,a);this._dependencies.push(s);return s};e.prototype._pPauseAndRetrieveDependencies=function(){if(this._timer)this._timer.stop();this._parsingPaused=true;this.dispatchEvent(new o(o.READY_FOR_DEPENDENCIES))};e.prototype._pHasTime=function(){return d()-this._lastFrameTime<this._frameLimit};e.prototype._pOnInterval=function(t){if(t===void 0){t=null}this._lastFrameTime=d();if(this._pProceedParsing()&&!this._parsingFailure)this._pFinishParsing()};e.prototype._pStartParsing=function(t){this._frameLimit=t;this._timer=new c(this._frameLimit,0);this._timer.addEventListener(h.TIMER,this._pOnIntervalDelegate);this._timer.start()};e.prototype._pFinishParsing=function(){if(this._timer){this._timer.removeEventListener(h.TIMER,this._pOnIntervalDelegate);this._timer.stop()}this._timer=null;this._parsingComplete=true;this.dispatchEvent(new o(o.PARSE_COMPLETE))};e.prototype._pGetTextData=function(){return l.toString(this._data)};e.prototype._pGetByteData=function(){return l.toByteArray(this._data)};e.PARSING_DONE=true;e.MORE_TO_PARSE=false;return e}(n);e.exports=f},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/events/AssetEvent":undefined,"awayjs-core/lib/events/EventDispatcher":undefined,"awayjs-core/lib/events/ParserEvent":undefined,"awayjs-core/lib/events/TimerEvent":undefined,"awayjs-core/lib/parsers/ParserUtils":undefined,"awayjs-core/lib/parsers/ResourceDependency":undefined,"awayjs-core/lib/utils/TextureUtils":undefined,"awayjs-core/lib/utils/Timer":undefined,"awayjs-core/lib/utils/getTimer":undefined}],"awayjs-core/lib/parsers/ParserDataFormat":[function(t,e,i){var r=function(){function t(){}t.BINARY="binary";t.PLAIN_TEXT="plainText";t.IMAGE="image";return t}();e.exports=r},{}],"awayjs-core/lib/parsers/ParserUtils":[function(t,e,i){var r=t("awayjs-core/lib/utils/ByteArray");var a=function(){function t(){}t.arrayBufferToImage=function(t){var e="";var i=new Uint8Array(t);var r=i.byteLength;for(var a=0;a<r;a++)e+=String.fromCharCode(i[a]);var s=window.btoa(e);var n="data:image/png;base64,"+s;var o=new Image;o.src=n;return o};t.byteArrayToImage=function(t){var e="";var i=new Uint8Array(t.arraybytes);var r=i.byteLength;for(var a=0;a<r;a++)e+=String.fromCharCode(i[a]);var s=window.btoa(e);var n="data:image/png;base64,"+s;var o=new Image;o.src=n;return o};t.blobToImage=function(t){var e=window["URL"]||window["webkitURL"];var i=e.createObjectURL(t);var r=new Image;r.src=i;return r};t.toByteArray=function(t){var e=new r;e.setArrayBuffer(t);return e};t.toString=function(t,e){if(e===void 0){e=0}if(typeof t==="string"){var i=t;if(i["substr"]!=null)return i.substr(0,i.length)}if(t instanceof r){var a=t;a.position=0;return a.readUTFBytes(Math.min(a.getBytesAvailable(),e))}return null};return t}();e.exports=a},{"awayjs-core/lib/utils/ByteArray":undefined}],"awayjs-core/lib/parsers/ResourceDependency":[function(t,e,i){var r=function(){function t(t,e,i,r,a,s,n){if(s===void 0){s=false}if(n===void 0){n=false}this._id=t;this._request=e;this._data=i;this._parser=r;this._parentParser=a;this._retrieveAsRawData=s;this._suppressAssetEvents=n;this._assets=new Array;this._dependencies=new Array}Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"request",{get:function(){return this._request},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"parser",{get:function(){return this._parser},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"parentParser",{get:function(){return this._parentParser},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"retrieveAsRawData",{get:function(){return this._retrieveAsRawData},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"suppresAssetEvents",{get:function(){return this._suppressAssetEvents},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"assets",{get:function(){return this._assets},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"dependencies",{get:function(){return this._dependencies},enumerable:true,configurable:true});t.prototype._iSetData=function(t){this._data=t};t.prototype._iSetParser=function(t){this._parser=t};t.prototype.resolve=function(){if(this._parentParser)this._parentParser._iResolveDependency(this)};t.prototype.resolveFailure=function(){if(this._parentParser)this._parentParser._iResolveDependencyFailure(this)};t.prototype.resolveName=function(t){if(this._parentParser)return this._parentParser._iResolveDependencyName(this,t);return t.name};return t}();e.exports=r},{}],"awayjs-core/lib/parsers/Texture2DParser":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/net/URLLoaderDataFormat");var s=t("awayjs-core/lib/parsers/ParserBase");var n=t("awayjs-core/lib/parsers/ParserUtils");var o=t("awayjs-core/lib/utils/ByteArray");var h=t("awayjs-core/lib/utils/TextureUtils");var l=t("awayjs-core/lib/textures/ImageTexture");var u=function(t){r(e,t);function e(){t.call(this,a.BLOB)}e.supportsType=function(t){t=t.toLowerCase();return t=="jpg"||t=="jpeg"||t=="png"||t=="gif"};e.supportsData=function(t){if(t instanceof HTMLImageElement)return true;if(!(t instanceof o))return false;var e=t;e.position=0;if(e.readUnsignedShort()==65496)return true;e.position=0;if(e.readShort()==16973)return true;e.position=1;if(e.readUTFBytes(3)=="PNG")return true;e.position=0;if(e.readUTFBytes(3)=="GIF"&&e.readShort()==14393&&e.readByte()==97)return true;e.position=0;if(e.readUTFBytes(3)=="ATF")return true;return false};e.prototype._pProceedParsing=function(){var t=this;var e;var i=false;if(this._loadingImage){return s.MORE_TO_PARSE}else if(this._htmlImageElement){if(h.isHTMLImageElementValid(this._htmlImageElement)){e=new l(this._htmlImageElement);this._pFinalizeAsset(e,this._iFileName)}}else if(this.data instanceof HTMLImageElement){if(h.isHTMLImageElementValid(this.data)){e=new l(this.data);this._pFinalizeAsset(e,this._iFileName)}else{i=true}}else if(this.data instanceof o){var r=this.data;r.position=0;var a=n.byteArrayToImage(this.data);if(h.isHTMLImageElementValid(a)){e=new l(a);this._pFinalizeAsset(e,this._iFileName)}else{i=true}}else if(this.data instanceof ArrayBuffer){this._htmlImageElement=n.arrayBufferToImage(this.data);e=new l(this._htmlImageElement);this._pFinalizeAsset(e,this._iFileName)}else if(this.data instanceof Blob){this._htmlImageElement=n.blobToImage(this.data);this._htmlImageElement.onload=function(e){return t.onLoadComplete(e)};this._loadingImage=true;return s.MORE_TO_PARSE}if(i==true){}this._pContent=e;return s.PARSING_DONE};e.prototype.onLoadComplete=function(t){this._loadingImage=false};return e}(s);e.exports=u},{"awayjs-core/lib/net/URLLoaderDataFormat":undefined,"awayjs-core/lib/parsers/ParserBase":undefined,"awayjs-core/lib/parsers/ParserUtils":undefined,"awayjs-core/lib/textures/ImageTexture":undefined,"awayjs-core/lib/utils/ByteArray":undefined,"awayjs-core/lib/utils/TextureUtils":undefined}],"awayjs-core/lib/pool/ITextureData":[function(t,e,i){},{}],"awayjs-core/lib/projections/CoordinateSystem":[function(t,e,i){var r=function(){function t(){}t.LEFT_HANDED="leftHanded";t.RIGHT_HANDED="rightHanded";return t}();e.exports=r},{}],"awayjs-core/lib/projections/FreeMatrixProjection":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/projections/PerspectiveProjection");var s=t("awayjs-core/lib/projections/ProjectionBase");var n=function(t){r(e,t);function e(){t.call(this);this._pMatrix.copyFrom((new a).matrix)}Object.defineProperty(e.prototype,"near",{set:function(t){this._pNear=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"far",{set:function(t){this._pFar=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"iAspectRatio",{set:function(t){this._pAspectRatio=t},enumerable:true,configurable:true});e.prototype.clone=function(){var t=new e;t._pMatrix.copyFrom(this._pMatrix);t._pNear=this._pNear;t._pFar=this._pFar;t._pAspectRatio=this._pAspectRatio;t.pInvalidateMatrix();return t};e.prototype.pUpdateMatrix=function(){this._pMatrixInvalid=false};return e}(s);e.exports=n},{"awayjs-core/lib/projections/PerspectiveProjection":undefined,"awayjs-core/lib/projections/ProjectionBase":undefined}],"awayjs-core/lib/projections/IProjection":[function(t,e,i){},{}],"awayjs-core/lib/projections/ObliqueNearPlaneProjection":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-core/lib/events/ProjectionEvent");var n=t("awayjs-core/lib/projections/ProjectionBase");var o=function(t){r(e,t);function e(e,i){var r=this;t.call(this);this.baseProjection=e;this.plane=i;this._onProjectionMatrixChangedDelegate=function(t){return r.onProjectionMatrixChanged(t)}}Object.defineProperty(e.prototype,"frustumCorners",{get:function(){return this._baseProjection.frustumCorners},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"near",{get:function(){return this._baseProjection.near},set:function(t){this._baseProjection.near=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"far",{get:function(){return this._baseProjection.far},set:function(t){this._baseProjection.far=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"iAspectRatio",{get:function(){return this._baseProjection._iAspectRatio},set:function(t){this._baseProjection._iAspectRatio=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"plane",{get:function(){return this._plane},set:function(t){this._plane=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"baseProjection",{set:function(t){if(this._baseProjection){this._baseProjection.removeEventListener(s.MATRIX_CHANGED,this._onProjectionMatrixChangedDelegate)}this._baseProjection=t;if(this._baseProjection){this._baseProjection.addEventListener(s.MATRIX_CHANGED,this._onProjectionMatrixChangedDelegate)}this.pInvalidateMatrix()},enumerable:true,configurable:true});e.prototype.onProjectionMatrixChanged=function(t){this.pInvalidateMatrix()};e.prototype.pUpdateMatrix=function(){this._pMatrix.copyFrom(this._baseProjection.matrix);var t=this._plane.a;var e=this._plane.b;var i=this._plane.c;var r=-this._plane.d+.05;var s=t>=0?1:-1;var n=e>=0?1:-1;var o=new a(s,n,1,1);var h=this._pMatrix.clone();h.invert();var l=h.transformVector(o);this._pMatrix.copyRowTo(3,o);var u=(l.x*o.x+l.y*o.y+l.z*o.z+l.w*o.w)/(t*l.x+e*l.y+i*l.z+r*l.w);this._pMatrix.copyRowFrom(2,new a(t*u,e*u,i*u,r*u))};return e}(n);e.exports=o},{"awayjs-core/lib/events/ProjectionEvent":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/projections/ProjectionBase":undefined}],"awayjs-core/lib/projections/OrthographicOffCenterProjection":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-core/lib/projections/ProjectionBase");var n=function(t){r(e,t);function e(e,i,r,a){t.call(this);this._minX=e;this._maxX=i;this._minY=r;this._maxY=a}Object.defineProperty(e.prototype,"minX",{get:function(){return this._minX},set:function(t){this._minX=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"maxX",{get:function(){return this._maxX},set:function(t){this._maxX=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"minY",{get:function(){return this._minY},set:function(t){this._minY=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"maxY",{get:function(){return this._maxY},set:function(t){this._maxY=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});e.prototype.unproject=function(t,e,i){var r=new a(t,-e,i,1);r=this.unprojectionMatrix.transformVector(r);r.z=i;return r};e.prototype.clone=function(){var t=new e(this._minX,this._maxX,this._minY,this._maxY);t._pNear=this._pNear;t._pFar=this._pFar;t._pAspectRatio=this._pAspectRatio;return t};e.prototype.pUpdateMatrix=function(){var t=[];var e=1/(this._maxX-this._minX);var i=1/(this._maxY-this._minY);var r=1/(this._pFar-this._pNear);t[0]=2*e;t[5]=2*i;t[10]=r;t[12]=-(this._maxX+this._minX)*e;t[13]=-(this._maxY+this._minY)*i;t[14]=-this._pNear*r;t[15]=1;t[1]=t[2]=t[3]=t[4]=t[6]=t[7]=t[8]=t[9]=t[11]=0;this._pMatrix.copyRawDataFrom(t);this._pFrustumCorners[0]=this._pFrustumCorners[9]=this._pFrustumCorners[12]=this._pFrustumCorners[21]=this._minX;this._pFrustumCorners[3]=this._pFrustumCorners[6]=this._pFrustumCorners[15]=this._pFrustumCorners[18]=this._maxX;this._pFrustumCorners[1]=this._pFrustumCorners[4]=this._pFrustumCorners[13]=this._pFrustumCorners[16]=this._minY;this._pFrustumCorners[7]=this._pFrustumCorners[10]=this._pFrustumCorners[19]=this._pFrustumCorners[22]=this._maxY;this._pFrustumCorners[2]=this._pFrustumCorners[5]=this._pFrustumCorners[8]=this._pFrustumCorners[11]=this._pNear;this._pFrustumCorners[14]=this._pFrustumCorners[17]=this._pFrustumCorners[20]=this._pFrustumCorners[23]=this._pFar;this._pMatrixInvalid=false};return e}(s);e.exports=n},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/projections/ProjectionBase":undefined}],"awayjs-core/lib/projections/OrthographicProjection":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-core/lib/projections/ProjectionBase");var n=function(t){r(e,t);function e(e){if(e===void 0){e=500}t.call(this);this._projectionHeight=e}Object.defineProperty(e.prototype,"projectionHeight",{get:function(){return this._projectionHeight},set:function(t){if(t==this._projectionHeight){return}this._projectionHeight=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});e.prototype.unproject=function(t,e,i){var r=new a(t+this.matrix.rawData[12],-e+this.matrix.rawData[13],i,1);r=this.unprojectionMatrix.transformVector(r);r.z=i;return r};e.prototype.clone=function(){var t=new e;t._pNear=this._pNear;t._pFar=this._pFar;t._pAspectRatio=this._pAspectRatio;t.projectionHeight=this._projectionHeight;return t};e.prototype.pUpdateMatrix=function(){var t=[];this._yMax=this._projectionHeight*.5;this._xMax=this._yMax*this._pAspectRatio;var e;var i;var r;var a;if(this._pScissorRect.x==0&&this._pScissorRect.y==0&&this._pScissorRect.width==this._pViewPort.width&&this._pScissorRect.height==this._pViewPort.height){e=-this._xMax;i=this._xMax;r=-this._yMax;a=this._yMax;t[0]=2/(this._projectionHeight*this._pAspectRatio);t[5]=2/this._projectionHeight;t[10]=1/(this._pFar-this._pNear);t[14]=this._pNear/(this._pNear-this._pFar);t[1]=t[2]=t[3]=t[4]=t[6]=t[7]=t[8]=t[9]=t[11]=t[12]=t[13]=0;t[15]=1}else{var s=this._xMax*(this._pViewPort.width/this._pScissorRect.width);var n=this._yMax*(this._pViewPort.height/this._pScissorRect.height);var o=this._xMax*(this._pScissorRect.x*2-this._pViewPort.width)/this._pScissorRect.width+this._xMax;var h=-this._yMax*(this._pScissorRect.y*2-this._pViewPort.height)/this._pScissorRect.height-this._yMax;e=o-s;i=o+s;r=h-n;a=h+n;t[0]=2*1/(i-e);t[5]=-2*1/(r-a);t[10]=1/(this._pFar-this._pNear);t[12]=(i+e)/(i-e);t[13]=(a+r)/(a-r);t[14]=this._pNear/(this.near-this.far);t[1]=t[2]=t[3]=t[4]=t[6]=t[7]=t[8]=t[9]=t[11]=0;t[15]=1}this._pFrustumCorners[0]=this._pFrustumCorners[9]=this._pFrustumCorners[12]=this._pFrustumCorners[21]=e;this._pFrustumCorners[3]=this._pFrustumCorners[6]=this._pFrustumCorners[15]=this._pFrustumCorners[18]=i;this._pFrustumCorners[1]=this._pFrustumCorners[4]=this._pFrustumCorners[13]=this._pFrustumCorners[16]=r;this._pFrustumCorners[7]=this._pFrustumCorners[10]=this._pFrustumCorners[19]=this._pFrustumCorners[22]=a;this._pFrustumCorners[2]=this._pFrustumCorners[5]=this._pFrustumCorners[8]=this._pFrustumCorners[11]=this._pNear;this._pFrustumCorners[14]=this._pFrustumCorners[17]=this._pFrustumCorners[20]=this._pFrustumCorners[23]=this._pFar;this._pMatrix.copyRawDataFrom(t);this._pMatrixInvalid=false};return e}(s);e.exports=n},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/projections/ProjectionBase":undefined}],"awayjs-core/lib/projections/PerspectiveProjection":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-core/lib/projections/CoordinateSystem");var n=t("awayjs-core/lib/projections/ProjectionBase");var o=function(t){r(e,t);function e(e,i){if(e===void 0){e=60}if(i===void 0){i="leftHanded"}t.call(this,i);this._fieldOfView=60;this._focalLength=1e3;this._hFieldOfView=60;this._hFocalLength=1e3;this._preserveAspectRatio=true;this._preserveFocalLength=false;this.fieldOfView=e}Object.defineProperty(e.prototype,"preserveAspectRatio",{get:function(){return this._preserveAspectRatio},set:function(t){if(this._preserveAspectRatio==t)return;this._preserveAspectRatio=t;if(this._preserveAspectRatio)this.pInvalidateMatrix()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"preserveFocalLength",{get:function(){return this._preserveFocalLength},set:function(t){if(this._preserveFocalLength==t)return;this._preserveFocalLength=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"fieldOfView",{get:function(){return this._fieldOfView},set:function(t){if(this._fieldOfView==t)return;this._fieldOfView=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"focalLength",{get:function(){return this._focalLength},set:function(t){if(this._focalLength==t)return;this._focalLength=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"hFieldOfView",{get:function(){return this._hFieldOfView},set:function(t){if(this._hFieldOfView==t)return;this._hFieldOfView=t;this._hFocalLength=1/Math.tan(this._hFieldOfView*Math.PI/360);this.pInvalidateMatrix()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"hFocalLength",{get:function(){return this._hFocalLength},set:function(t){if(this._hFocalLength==t)return;this._hFocalLength=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});e.prototype.unproject=function(t,e,i){var r=new a(t,-e,i,1);r.x*=i;r.y*=i;r=this.unprojectionMatrix.transformVector(r);r.z=i;return r};e.prototype.clone=function(){var t=new e(this._fieldOfView);t._pNear=this._pNear;t._pFar=this._pFar;t._pAspectRatio=this._pAspectRatio;t._pCoordinateSystem=this._pCoordinateSystem;return t};e.prototype.pUpdateMatrix=function(){var t=[];if(this._preserveFocalLength){if(this._preserveAspectRatio)this._hFocalLength=this._focalLength;this._fieldOfView=Math.atan(.5*this._pScissorRect.height/this._focalLength)*360/Math.PI;this._hFieldOfView=Math.atan(.5*this._pScissorRect.width/this._hFocalLength)*360/Math.PI}else{this._focalLength=.5*this._pScissorRect.height/Math.tan(this._fieldOfView*Math.PI/360);if(this._preserveAspectRatio)this._hFocalLength=this._focalLength;else this._hFocalLength=.5*this._pScissorRect.width/Math.tan(this._hFieldOfView*Math.PI/360)}var e=-this._pOriginX/this._hFocalLength;var i=(1-this._pOriginX)/this._hFocalLength;var r=-this._pOriginY/this._focalLength;var a=(1-this._pOriginY)/this._focalLength;var n;var o;var h;var l;var u=-((e-i)*this._pScissorRect.x+e*this._pScissorRect.width);var p=(r-a)*this._pScissorRect.y+r*this._pScissorRect.height;n=u-(i-e)*this._pViewPort.width;o=u;h=p;l=p+(a-r)*this._pViewPort.height;t[0]=2/(o-n);t[5]=2/(l-h);t[8]=(o+n)/(o-n);t[9]=(l+h)/(l-h);t[10]=(this._pFar+this._pNear)/(this._pFar-this._pNear);t[11]=1;t[1]=t[2]=t[3]=t[4]=t[6]=t[7]=t[12]=t[13]=t[15]=0;t[14]=-2*this._pFar*this._pNear/(this._pFar-this._pNear);if(this._pCoordinateSystem==s.RIGHT_HANDED)t[5]=-t[5];this._pMatrix.copyRawDataFrom(t);this._pFrustumCorners[0]=this._pFrustumCorners[9]=this._pNear*n;this._pFrustumCorners[3]=this._pFrustumCorners[6]=this._pNear*o;this._pFrustumCorners[1]=this._pFrustumCorners[4]=this._pNear*h;this._pFrustumCorners[7]=this._pFrustumCorners[10]=this._pNear*l;this._pFrustumCorners[12]=this._pFrustumCorners[21]=this._pFar*n;this._pFrustumCorners[15]=this._pFrustumCorners[18]=this._pFar*o;this._pFrustumCorners[13]=this._pFrustumCorners[16]=this._pFar*h;this._pFrustumCorners[19]=this._pFrustumCorners[22]=this._pFar*l;this._pFrustumCorners[2]=this._pFrustumCorners[5]=this._pFrustumCorners[8]=this._pFrustumCorners[11]=this._pNear;this._pFrustumCorners[14]=this._pFrustumCorners[17]=this._pFrustumCorners[20]=this._pFrustumCorners[23]=this._pFar;this._pMatrixInvalid=false};return e}(n);e.exports=o},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/projections/CoordinateSystem":undefined,"awayjs-core/lib/projections/ProjectionBase":undefined}],"awayjs-core/lib/projections/ProjectionBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Matrix3D");var s=t("awayjs-core/lib/geom/Rectangle");var n=t("awayjs-core/lib/events/EventDispatcher");var o=t("awayjs-core/lib/events/ProjectionEvent");var h=t("awayjs-core/lib/errors/AbstractMethodError");var l=function(t){r(e,t);function e(e){if(e===void 0){e="leftHanded"}t.call(this);this._pMatrix=new a;this._pScissorRect=new s;this._pViewPort=new s;this._pNear=20;this._pFar=3e3;this._pAspectRatio=1;this._pMatrixInvalid=true;this._pFrustumCorners=[];this._pOriginX=.5;this._pOriginY=.5;this._unprojectionInvalid=true;this.coordinateSystem=e}Object.defineProperty(e.prototype,"coordinateSystem",{get:function(){return this._pCoordinateSystem},set:function(t){if(this._pCoordinateSystem==t)return;this._pCoordinateSystem=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"frustumCorners",{get:function(){return this._pFrustumCorners},set:function(t){this._pFrustumCorners=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"matrix",{get:function(){if(this._pMatrixInvalid){this.pUpdateMatrix();this._pMatrixInvalid=false}return this._pMatrix},set:function(t){this._pMatrix=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"near",{get:function(){return this._pNear},set:function(t){if(t==this._pNear){return}this._pNear=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"originX",{get:function(){return this._pOriginX},set:function(t){if(this._pOriginX==t)return;this._pOriginX=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"originY",{get:function(){return this._pOriginY},set:function(t){if(this._pOriginY==t)return;this._pOriginY=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"far",{get:function(){return this._pFar},set:function(t){if(t==this._pFar){return}this._pFar=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});e.prototype.project=function(t){var e=this.matrix.transformVector(t);e.x=e.x/e.w;e.y=-e.y/e.w;e.z=t.z;return e};Object.defineProperty(e.prototype,"unprojectionMatrix",{get:function(){if(this._unprojectionInvalid){if(!this._unprojection)this._unprojection=new a;this._unprojection.copyFrom(this.matrix);this._unprojection.invert();this._unprojectionInvalid=false}return this._unprojection},enumerable:true,configurable:true});e.prototype.unproject=function(t,e,i){throw new h};e.prototype.clone=function(){throw new h};Object.defineProperty(e.prototype,"_iAspectRatio",{get:function(){return this._pAspectRatio},set:function(t){if(this._pAspectRatio==t)return;this._pAspectRatio=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});e.prototype.pInvalidateMatrix=function(){this._pMatrixInvalid=true;this._unprojectionInvalid=true;this.dispatchEvent(new o(o.MATRIX_CHANGED,this))};e.prototype.pUpdateMatrix=function(){throw new h};e.prototype._iUpdateScissorRect=function(t,e,i,r){this._pScissorRect.x=t;this._pScissorRect.y=e;this._pScissorRect.width=i;this._pScissorRect.height=r;this.pInvalidateMatrix()};e.prototype._iUpdateViewport=function(t,e,i,r){this._pViewPort.x=t;this._pViewPort.y=e;this._pViewPort.width=i;this._pViewPort.height=r;this.pInvalidateMatrix()};return e}(n);e.exports=l},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/events/EventDispatcher":undefined,"awayjs-core/lib/events/ProjectionEvent":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Rectangle":undefined}],"awayjs-core/lib/textures/BitmapCubeTexture":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/Error");var s=t("awayjs-core/lib/textures/CubeTextureBase");var n=t("awayjs-core/lib/utils/TextureUtils");var o=function(t){r(e,t);function e(e,i,r,a,s,n,o){if(o===void 0){o=false}t.call(this,o);this._bitmapDatas=new Array(6);this._testSize(this._bitmapDatas[0]=e);this._testSize(this._bitmapDatas[1]=i);this._testSize(this._bitmapDatas[2]=r);this._testSize(this._bitmapDatas[3]=a);this._testSize(this._bitmapDatas[4]=s);this._testSize(this._bitmapDatas[5]=n);this.invalidateContent();this._pSetSize(e.width)}Object.defineProperty(e.prototype,"positiveX",{get:function(){return this._bitmapDatas[0]},set:function(t){this._testSize(t);this.invalidateContent();this._pSetSize(t.width);this._bitmapDatas[0]=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"negativeX",{get:function(){return this._bitmapDatas[1]},set:function(t){this._testSize(t);this.invalidateContent();this._pSetSize(t.width);this._bitmapDatas[1]=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"positiveY",{get:function(){return this._bitmapDatas[2]},set:function(t){this._testSize(t);this.invalidateContent();this._pSetSize(t.width);this._bitmapDatas[2]=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"negativeY",{get:function(){return this._bitmapDatas[3]},set:function(t){this._testSize(t);this.invalidateContent();this._pSetSize(t.width);this._bitmapDatas[3]=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"positiveZ",{get:function(){return this._bitmapDatas[4]},set:function(t){this._testSize(t);this.invalidateContent();this._pSetSize(t.width);this._bitmapDatas[4]=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"negativeZ",{get:function(){return this._bitmapDatas[5]},set:function(t){this._testSize(t);this.invalidateContent();this._pSetSize(t.width);this._bitmapDatas[5]=t},enumerable:true,configurable:true});e.prototype._testSize=function(t){if(t.width!=t.height)throw new a("BitmapData should have equal width and height!");if(!n.isBitmapDataValid(t))throw new a("Invalid bitmapData: Width and height must be power of 2 and cannot exceed 2048")};e.prototype.dispose=function(){t.prototype.dispose.call(this);var e=this._bitmapDatas.length;for(var i=0;i<e;i++){this._bitmapDatas[i].dispose();this._bitmapDatas[i]=null}this._bitmapDatas=null};e.prototype._iGetTextureData=function(t){return this._bitmapDatas[t]};return e}(s);e.exports=o},{"awayjs-core/lib/errors/Error":undefined,"awayjs-core/lib/textures/CubeTextureBase":undefined,"awayjs-core/lib/utils/TextureUtils":undefined}],"awayjs-core/lib/textures/BitmapTexture":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/Error");var s=t("awayjs-core/lib/textures/Texture2DBase");var n=t("awayjs-core/lib/utils/TextureUtils");var o=function(t){r(e,t);function e(e,i){if(i===void 0){i=false}t.call(this,i);this.bitmapData=e}Object.defineProperty(e.prototype,"bitmapData",{get:function(){return this._bitmapData},set:function(t){if(this._bitmapData==t)return;if(!n.isBitmapDataValid(t))throw new a("Invalid bitmapData: Width and height must be power of 2 and cannot exceed 2048");this._bitmapData=t;this.invalidateContent();this._pSetSize(t.width,t.height)},enumerable:true,configurable:true});e.prototype.dispose=function(){t.prototype.dispose.call(this);this._bitmapData.dispose();this._bitmapData=null};e.prototype._iGetTextureData=function(){return this._bitmapData};return e}(s);e.exports=o},{"awayjs-core/lib/errors/Error":undefined,"awayjs-core/lib/textures/Texture2DBase":undefined,"awayjs-core/lib/utils/TextureUtils":undefined}],"awayjs-core/lib/textures/CubeTextureBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/AbstractMethodError");var s=t("awayjs-core/lib/textures/MipmapGenerator");var n=t("awayjs-core/lib/textures/TextureProxyBase");var o=function(t){r(e,t);function e(e){if(e===void 0){e=false}t.call(this,e);this._mipmapDataArray=new Array(6);this._mipmapDataDirtyArray=new Array(6)}e.prototype._pSetSize=function(t){if(this._pSize!=t)this.invalidateSize();for(var e=0;e<6;e++)this._mipmapDataDirtyArray[e]=true;this._pSize=t};e.prototype.dispose=function(){t.prototype.dispose.call(this);for(var e=0;e<6;e++){var i=this._mipmapDataArray[e];var r=i.length;for(var a=0;a<r;a++)s.freeMipMapHolder(i[a])}};e.prototype.invalidateContent=function(){t.prototype.invalidateContent.call(this);for(var e=0;e<6;e++)this._mipmapDataDirtyArray[e]=true};e.prototype._iGetMipmapData=function(t){if(this._mipmapDataDirtyArray[t]){this._mipmapDataDirtyArray[t]=false;var e=this._mipmapDataArray[t]||(this._mipmapDataArray[t]=new Array);s.generateMipMaps(this._iGetTextureData(t),e,true)}return this._mipmapDataArray[t]};e.prototype._iGetTextureData=function(t){throw new a};return e}(n);e.exports=o},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/textures/MipmapGenerator":undefined,"awayjs-core/lib/textures/TextureProxyBase":undefined}],"awayjs-core/lib/textures/ImageCubeTexture":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/Error");var s=t("awayjs-core/lib/textures/CubeTextureBase");var n=t("awayjs-core/lib/utils/TextureUtils");
var o=function(t){r(e,t);function e(e,i,r,a,s,n,o){if(o===void 0){o=false}t.call(this,o);this._htmlImageElements=new Array(6);this._testSize(this._htmlImageElements[0]=e);this._testSize(this._htmlImageElements[1]=i);this._testSize(this._htmlImageElements[2]=r);this._testSize(this._htmlImageElements[3]=a);this._testSize(this._htmlImageElements[4]=s);this._testSize(this._htmlImageElements[5]=n);this.invalidateContent();this._pSetSize(e.width)}Object.defineProperty(e.prototype,"positiveX",{get:function(){return this._htmlImageElements[0]},set:function(t){this._testSize(t);this.invalidateContent();this._pSetSize(t.width);this._htmlImageElements[0]=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"negativeX",{get:function(){return this._htmlImageElements[1]},set:function(t){this._testSize(t);this.invalidateContent();this._pSetSize(t.width);this._htmlImageElements[1]=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"positiveY",{get:function(){return this._htmlImageElements[2]},set:function(t){this._testSize(t);this.invalidateContent();this._pSetSize(t.width);this._htmlImageElements[2]=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"negativeY",{get:function(){return this._htmlImageElements[3]},set:function(t){this._testSize(t);this.invalidateContent();this._pSetSize(t.width);this._htmlImageElements[3]=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"positiveZ",{get:function(){return this._htmlImageElements[4]},set:function(t){this._testSize(t);this.invalidateContent();this._pSetSize(t.width);this._htmlImageElements[4]=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"negativeZ",{get:function(){return this._htmlImageElements[5]},set:function(t){this._testSize(t);this.invalidateContent();this._pSetSize(t.width);this._htmlImageElements[5]=t},enumerable:true,configurable:true});e.prototype._testSize=function(t){if(t.width!=t.height)throw new a("BitmapData should have equal width and height!");if(!n.isHTMLImageElementValid(t))throw new a("Invalid bitmapData: Width and height must be power of 2 and cannot exceed 2048")};e.prototype._iGetTextureData=function(t){return this._htmlImageElements[t]};return e}(s);e.exports=o},{"awayjs-core/lib/errors/Error":undefined,"awayjs-core/lib/textures/CubeTextureBase":undefined,"awayjs-core/lib/utils/TextureUtils":undefined}],"awayjs-core/lib/textures/ImageTexture":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/Error");var s=t("awayjs-core/lib/textures/Texture2DBase");var n=t("awayjs-core/lib/utils/TextureUtils");var o=function(t){r(e,t);function e(e,i){if(i===void 0){i=false}t.call(this,i);this.htmlImageElement=e}Object.defineProperty(e.prototype,"htmlImageElement",{get:function(){return this._htmlImageElement},set:function(t){if(this._htmlImageElement==t)return;if(!n.isHTMLImageElementValid(t))throw new a("Invalid bitmapData: Width and height must be power of 2 and cannot exceed 2048");this._htmlImageElement=t;this.invalidateContent();this._pSetSize(t.width,t.height)},enumerable:true,configurable:true});e.prototype._iGetTextureData=function(){return this._htmlImageElement};return e}(s);e.exports=o},{"awayjs-core/lib/errors/Error":undefined,"awayjs-core/lib/textures/Texture2DBase":undefined,"awayjs-core/lib/utils/TextureUtils":undefined}],"awayjs-core/lib/textures/MipmapGenerator":[function(t,e,i){var r=t("awayjs-core/lib/base/BitmapData");var a=t("awayjs-core/lib/geom/Matrix");var s=t("awayjs-core/lib/geom/Rectangle");var n=function(){function t(){}t.generateMipMaps=function(e,i,r){if(r===void 0){r=false}var a=e.width;var s=e.height;var n=0;var o;t._rect.width=a;t._rect.height=s;while(a>=1&&s>=1){o=i[n]=t._getMipmapHolder(i[n],a,s);if(r)o.fillRect(t._rect,0);t._matrix.a=t._rect.width/e.width;t._matrix.d=t._rect.height/e.height;o.draw(e,t._matrix);a>>=1;s>>=1;t._rect.width=a>1?a:1;t._rect.height=s>1?s:1;n++}};t._getMipmapHolder=function(e,i,a){if(e){if(e.width==i&&e.height==a)return e;t.freeMipMapHolder(e)}if(!t._mipMaps[i]){t._mipMaps[i]=[];t._mipMapUses[i]=[]}if(!t._mipMaps[i][a]){e=t._mipMaps[i][a]=new r(i,a,true);t._mipMapUses[i][a]=1}else{t._mipMapUses[i][a]=t._mipMapUses[i][a]+1;e=t._mipMaps[i][a]}return e};t.freeMipMapHolder=function(e){var i=e.width;var r=e.height;if(--t._mipMapUses[i][r]==0){t._mipMaps[i][r].dispose();t._mipMaps[i][r]=null}};t._mipMaps=[];t._mipMapUses=[];t._matrix=new a;t._rect=new s;return t}();e.exports=n},{"awayjs-core/lib/base/BitmapData":undefined,"awayjs-core/lib/geom/Matrix":undefined,"awayjs-core/lib/geom/Rectangle":undefined}],"awayjs-core/lib/textures/RenderTexture":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/Error");var s=t("awayjs-core/lib/textures/Texture2DBase");var n=t("awayjs-core/lib/utils/TextureUtils");var o=function(t){r(e,t);function e(e,i){t.call(this,false);this._pSetSize(e,i)}Object.defineProperty(e.prototype,"width",{get:function(){return this._pWidth},set:function(t){if(t==this._pWidth)return;if(!n.isDimensionValid(t))throw new a("Invalid size: Width and height must be power of 2 and cannot exceed 2048");this.invalidateContent();this._pSetSize(t,this._pHeight)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this._pHeight},set:function(t){if(t==this._pHeight)return;if(!n.isDimensionValid(t))throw new a("Invalid size: Width and height must be power of 2 and cannot exceed 2048");this.invalidateContent();this._pSetSize(this._pWidth,t)},enumerable:true,configurable:true});return e}(s);e.exports=o},{"awayjs-core/lib/errors/Error":undefined,"awayjs-core/lib/textures/Texture2DBase":undefined,"awayjs-core/lib/utils/TextureUtils":undefined}],"awayjs-core/lib/textures/SpecularBitmapTexture":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/base/BitmapData");var s=t("awayjs-core/lib/base/BitmapDataChannel");var n=t("awayjs-core/lib/geom/Point");var o=t("awayjs-core/lib/textures/BitmapTexture");var h=function(t){r(e,t);function e(e,i,r){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=true}var s=e?e:i;s=s?new a(s.width,s.height,false,16777215):new a(1,1,false,16777215);t.call(this,s,r);this.specularMap=e;this.glossMap=i}Object.defineProperty(e.prototype,"specularMap",{get:function(){return this._specularMap},set:function(t){this._specularMap=t;this.invalidateContent();this._testSize()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"glossMap",{get:function(){return this._glossMap},set:function(t){this._glossMap=t;this.invalidateContent();this._testSize()},enumerable:true,configurable:true});e.prototype._testSize=function(){var t,e;if(this._specularMap){t=this._specularMap.width;e=this._specularMap.height}else if(this._glossMap){t=this._glossMap.width;e=this._glossMap.height}else{t=1;e=1}if(t!=this._bitmapData.width&&e!=this._bitmapData.height){var i=this._bitmapData;this.bitmapData=new a(this._specularMap.width,this._specularMap.height,false,16777215);i.dispose()}};e.prototype._iGetTextureData=function(){var t=this._specularMap.rect;var e=new n;this._bitmapData.fillRect(t,16777215);if(this._glossMap)this._bitmapData.copyChannel(this._glossMap,t,e,s.GREEN,s.GREEN);if(this._specularMap)this._bitmapData.copyChannel(this._specularMap,t,e,s.RED,s.RED);return this._bitmapData};return e}(o);e.exports=h},{"awayjs-core/lib/base/BitmapData":undefined,"awayjs-core/lib/base/BitmapDataChannel":undefined,"awayjs-core/lib/geom/Point":undefined,"awayjs-core/lib/textures/BitmapTexture":undefined}],"awayjs-core/lib/textures/Texture2DBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/AbstractMethodError");var s=t("awayjs-core/lib/textures/MipmapGenerator");var n=t("awayjs-core/lib/textures/TextureProxyBase");var o=function(t){r(e,t);function e(e){if(e===void 0){e=false}t.call(this,e)}Object.defineProperty(e.prototype,"width",{get:function(){return this._pWidth},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this._pHeight},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"size",{get:function(){return this._pWidth},enumerable:true,configurable:true});e.prototype.dispose=function(){t.prototype.dispose.call(this);if(this._mipmapData){var e=this._mipmapData.length;for(var i=0;i<e;i++)s.freeMipMapHolder(this._mipmapData[i])}};e.prototype.invalidateContent=function(){t.prototype.invalidateContent.call(this);this._mipmapDataDirty=true};e.prototype._pSetSize=function(t,e){if(this._pWidth!=t||this._pHeight!=e)this.invalidateSize();this._mipmapDataDirty=true;this._pWidth=t;this._pHeight=e};e.prototype._iGetMipmapData=function(){if(this._mipmapDataDirty){this._mipmapDataDirty=false;if(!this._mipmapData)this._mipmapData=new Array;s.generateMipMaps(this._iGetTextureData(),this._mipmapData,true)}return this._mipmapData};e.prototype._iGetTextureData=function(){throw new a};return e}(n);e.exports=o},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/textures/MipmapGenerator":undefined,"awayjs-core/lib/textures/TextureProxyBase":undefined}],"awayjs-core/lib/textures/TextureProxyBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetType");var s=t("awayjs-core/lib/library/NamedAssetBase");var n=function(t){r(e,t);function e(e){if(e===void 0){e=false}t.call(this);this._pFormat="bgra";this._textureData=new Array;this._generateMipmaps=this._hasMipmaps=e}Object.defineProperty(e.prototype,"size",{get:function(){return this._pSize},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"hasMipmaps",{get:function(){return this._hasMipmaps},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"format",{get:function(){return this._pFormat},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"generateMipmaps",{get:function(){return this._generateMipmaps},set:function(t){if(this._generateMipmaps==t)return;this._generateMipmaps=this._hasMipmaps=t;this.invalidateContent()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"assetType",{get:function(){return a.TEXTURE},enumerable:true,configurable:true});e.prototype.invalidateContent=function(){var t=this._textureData.length;for(var e=0;e<t;e++)this._textureData[e].invalidate()};e.prototype.invalidateSize=function(){while(this._textureData.length)this._textureData[0].dispose()};e.prototype.dispose=function(){while(this._textureData.length)this._textureData[0].dispose()};e.prototype._iAddTextureData=function(t){this._textureData.push(t);return t};e.prototype._iRemoveTextureData=function(t){this._textureData.splice(this._textureData.indexOf(t),1);return t};return e}(s);e.exports=n},{"awayjs-core/lib/library/AssetType":undefined,"awayjs-core/lib/library/NamedAssetBase":undefined}],"awayjs-core/lib/ui/Keyboard":[function(t,e,i){var r=function(){function t(){}t.A=65;t.ALTERNATE=18;t.AUDIO=16777239;t.B=66;t.BACK=16777238;t.BACKQUOTE=192;t.BACKSLASH=220;t.BACKSPACE=8;t.BLUE=16777219;t.C=67;t.CAPS_LOCK=20;t.CHANNEL_DOWN=16777221;t.CHANNEL_UP=16777221;t.COMMA=188;t.COMMAND=15;t.CONTROL=17;t.D=68;t.DELETE=46;t.DOWN=40;t.DVR=16777241;t.E=69;t.END=35;t.ENTER=13;t.EQUAL=187;t.ESCAPE=27;t.EXIT=16777237;t.F=70;t.F1=112;t.F10=121;t.F11=122;t.F12=123;t.F13=124;t.F14=125;t.F15=126;t.F2=113;t.F3=114;t.F4=115;t.F5=116;t.F6=117;t.F7=118;t.F8=119;t.F9=120;t.FAST_FORWARD=16777226;t.G=71;t.GREEN=16777217;t.GUIDE=16777236;t.H=72;t.HELP=16777245;t.HOME=36;t.I=73;t.INFO=16777235;t.INPUT=16777243;t.INSERT=45;t.J=74;t.K=75;t.KEYNAME_BEGIN="Begin";t.KEYNAME_BREAK="Break";t.KEYNAME_CLEARDISPLAY="ClrDsp";t.KEYNAME_CLEARLINE="ClrLn";t.KEYNAME_DELETE="Delete";t.KEYNAME_DELETECHAR="DelChr";t.KEYNAME_DELETELINE="DelLn";t.KEYNAME_DOWNARROW="Down";t.KEYNAME_END="End";t.KEYNAME_EXECUTE="Exec";t.KEYNAME_F1="F1";t.KEYNAME_F10="F10";t.KEYNAME_F11="F11";t.KEYNAME_F12="F12";t.KEYNAME_F13="F13";t.KEYNAME_F14="F14";t.KEYNAME_F15="F15";t.KEYNAME_F16="F16";t.KEYNAME_F17="F17";t.KEYNAME_F18="F18";t.KEYNAME_F19="F19";t.KEYNAME_F2="F2";t.KEYNAME_F20="F20";t.KEYNAME_F21="F21";t.KEYNAME_F22="F22";t.KEYNAME_F23="F23";t.KEYNAME_F24="F24";t.KEYNAME_F25="F25";t.KEYNAME_F26="F26";t.KEYNAME_F27="F27";t.KEYNAME_F28="F28";t.KEYNAME_F29="F29";t.KEYNAME_F3="F3";t.KEYNAME_F30="F30";t.KEYNAME_F31="F31";t.KEYNAME_F32="F32";t.KEYNAME_F33="F33";t.KEYNAME_F34="F34";t.KEYNAME_F35="F35";t.KEYNAME_F4="F4";t.KEYNAME_F5="F5";t.KEYNAME_F6="F6";t.KEYNAME_F7="F7";t.KEYNAME_F8="F8";t.KEYNAME_F9="F9";t.KEYNAME_FIND="Find";t.KEYNAME_HELP="Help";t.KEYNAME_HOME="Home";t.KEYNAME_INSERT="Insert";t.KEYNAME_INSERTCHAR="InsChr";t.KEYNAME_INSERTLINE="LnsLn";t.KEYNAME_LEFTARROW="Left";t.KEYNAME_MENU="Menu";t.KEYNAME_MODESWITCH="ModeSw";t.KEYNAME_NEXT="Next";t.KEYNAME_PAGEDOWN="PgDn";t.KEYNAME_PAGEUP="PgUp";t.KEYNAME_PAUSE="Pause";t.KEYNAME_PREV="Prev";t.KEYNAME_PRINT="Print";t.KEYNAME_PRINTSCREEN="PrntScrn";t.KEYNAME_REDO="Redo";t.KEYNAME_RESET="Reset";t.KEYNAME_RIGHTARROW="Right";t.KEYNAME_SCROLLLOCK="ScrlLck";t.KEYNAME_SELECT="Select";t.KEYNAME_STOP="Stop";t.KEYNAME_SYSREQ="SysReq";t.KEYNAME_SYSTEM="Sys";t.KEYNAME_UNDO="Undo";t.KEYNAME_UPARROW="Up";t.KEYNAME_USER="User";t.L=76;t.LAST=16777233;t.LEFT=37;t.LEFTBRACKET=219;t.LIVE=16777232;t.M=77;t.MASTER_SHELL=16777246;t.MENU=16777234;t.MINUS=189;t.N=78;t.NEXT=16777230;t.NUMBER_0=48;t.NUMBER_1=49;t.NUMBER_2=50;t.NUMBER_3=51;t.NUMBER_4=52;t.NUMBER_5=53;t.NUMBER_6=54;t.NUMBER_7=55;t.NUMBER_8=56;t.NUMBER_9=57;t.NUMPAD=21;t.NUMPAD_0=96;t.NUMPAD_1=97;t.NUMPAD_2=98;t.NUMPAD_3=99;t.NUMPAD_4=100;t.NUMPAD_5=101;t.NUMPAD_6=102;t.NUMPAD_7=103;t.NUMPAD_8=104;t.NUMPAD_9=105;t.NUMPAD_ADD=107;t.NUMPAD_DECIMAL=110;t.NUMPAD_DIVIDE=111;t.NUMPAD_ENTER=108;t.NUMPAD_MULTIPLY=106;t.NUMPAD_SUBTRACT=109;t.O=79;t.P=80;t.PAGE_DOWN=34;t.PAGE_UP=33;t.PAUSE=16777224;t.PERIOD=190;t.PLAY=16777223;t.PREVIOUS=16777231;t.Q=81;t.QUOTE=222;t.R=82;t.RECORD=16777222;t.RED=16777216;t.REWIND=16777227;t.RIGHT=39;t.RIGHTBRACKET=221;t.S=83;t.SEARCH=16777247;t.SEMICOLON=186;t.SETUP=16777244;t.SHIFT=16;t.SKIP_BACKWARD=16777229;t.SKIP_FORWARD=16777228;t.SLASH=191;t.SPACE=32;t.STOP=16777225;t.SUBTITLE=16777240;t.T=84;t.TAB=9;t.U=85;t.UP=38;t.V=86;t.VOD=16777242;t.W=87;t.X=88;t.Y=89;t.YELLOW=16777218;t.Z=90;return t}();e.exports=r},{}],"awayjs-core/lib/utils/ByteArrayBase":[function(t,e,i){var r=t("awayjs-core/lib/errors/AbstractMethodError");var a=function(){function t(){this.position=0;this.length=0;this._mode=""}t.prototype.writeByte=function(t){throw"Virtual method"};t.prototype.readByte=function(){throw"Virtual method"};t.prototype.writeUnsignedByte=function(t){throw"Virtual method"};t.prototype.readUnsignedByte=function(){throw"Virtual method"};t.prototype.writeUnsignedShort=function(t){throw"Virtual method"};t.prototype.readUnsignedShort=function(){throw"Virtual method"};t.prototype.writeUnsignedInt=function(t){throw"Virtual method"};t.prototype.readUnsignedInt=function(){throw"Virtual method"};t.prototype.writeFloat=function(t){throw"Virtual method"};t.prototype.toFloatBits=function(t){throw"Virtual method"};t.prototype.readFloat=function(t){throw"Virtual method"};t.prototype.fromFloatBits=function(t){throw"Virtual method"};t.prototype.getBytesAvailable=function(){throw new r("ByteArrayBase, getBytesAvailable() not implemented ")};t.prototype.toString=function(){return"[ByteArray] ( "+this._mode+" ) position="+this.position+" length="+this.length};t.prototype.compareEqual=function(t,e){if(e==undefined||e>this.length-this.position)e=this.length-this.position;if(e>t.length-t.position)e=t.length-t.position;var i=e;var r=true;while(r&&e>=4){e-=4;if(this.readUnsignedInt()!=t.readUnsignedInt())r=false}while(r&&e>=1){e--;if(this.readUnsignedByte()!=t.readUnsignedByte())r=false}var a;this.position-=a-e;t.position-=a-e;return r};t.prototype.writeBase64String=function(t){for(var e=0;e<t.length;e++){var i=t.charAt(e)}};t.prototype.dumpToConsole=function(){var t=this.position;this.position=0;var e=8;function i(t,e){var i=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];var r="";for(var a=0;a<e;a++){r=i[t>>(a<<2)&15]+r}return r}for(var r=0;r<this.length;r+=e){var a=i(r,4)+":";for(var s=0;s<e&&r+s<this.length;s++){a+=" "+i(this.readUnsignedByte(),2)}console.log(a)}this.position=t};t.prototype.readBase64String=function(e){if(e==undefined||e>this.length-this.position)e=this.length-this.position;if(!(e>0))return"";return t.internalGetBase64String(e,this.readUnsignedByte,this)};t.internalGetBase64String=function(e,i,r){var a="";var s,n,o,h,l,u,p;var c=t.Base64Key;while(e>=3){s=i.apply(r);n=i.apply(r);o=i.apply(r);h=s>>2;l=(s&3)<<4|n>>4;u=(n&15)<<2|o>>6;p=o&63;a+=c.charAt(h)+c.charAt(l)+c.charAt(u)+c.charAt(p);e-=3}if(e==2){s=i.apply(r);n=i.apply(r);h=s>>2;l=(s&3)<<4|n>>4;u=(n&15)<<2;a+=c.charAt(h)+c.charAt(l)+c.charAt(u)+"="}else if(e==1){s=i.apply(r);h=s>>2;l=(s&3)<<4;a+=c.charAt(h)+c.charAt(l)+"=="}return a};t.Base64Key="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return t}();e.exports=a},{"awayjs-core/lib/errors/AbstractMethodError":undefined}],"awayjs-core/lib/utils/ByteArrayBuffer":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/utils/ByteArrayBase");var s=function(t){r(e,t);function e(){t.call(this);this._bytes=[];this._mode="Array"}e.prototype.writeByte=function(t){var e=~~t;this._bytes[this.position++]=e;if(this.position>this.length){this.length=this.position}};e.prototype.readByte=function(){if(this.position>=this.length){throw"ByteArray out of bounds read. Position="+this.position+", Length="+this.length}return this._bytes[this.position++]};e.prototype.writeUnsignedByte=function(t){var e=~~t;this._bytes[this.position++]=e&255;if(this.position>this.length){this.length=this.position}};e.prototype.readUnsignedByte=function(){if(this.position>=this.length){throw"ByteArray out of bounds read. Position="+this.position+", Length="+this.length}return this._bytes[this.position++]};e.prototype.writeUnsignedShort=function(t){var e=~~t;this._bytes[this.position++]=e&255;this._bytes[this.position++]=e>>8&255;if(this.position>this.length){this.length=this.position}};e.prototype.readUnsignedShort=function(){if(this.position+2>this.length){throw"ByteArray out of bounds read. Position="+this.position+", Length="+this.length}var t=this._bytes[this.position]|this._bytes[this.position+1]<<8;this.position+=2;return t};e.prototype.writeUnsignedInt=function(t){var e=~~t;this._bytes[this.position++]=e&255;this._bytes[this.position++]=e>>>8&255;this._bytes[this.position++]=e>>>16&255;this._bytes[this.position++]=e>>>24&255;if(this.position>this.length){this.length=this.position}};e.prototype.readUnsignedInt=function(){if(this.position+4>this.length){throw"ByteArray out of bounds read. Position="+this.position+", Length="+this.length}var t=this._bytes[this.position]|this._bytes[this.position+1]<<8|this._bytes[this.position+2]<<16|this._bytes[this.position+3]<<24;this.position+=4;return t>>>0};e.prototype.writeFloat=function(t){this.writeUnsignedInt(this.toFloatBits(Number(t)))};e.prototype.toFloatBits=function(t){if(t==0){return 0}var e=0;if(t<0){t=-t;e=1}else{e=0}var i=Math.log(t)/Math.log(2);i=Math.floor(i);t=t*Math.pow(2,23-i);var r=Math.floor(t)-8388608;i=i+127;return e<<31>>>0|i<<23|r};e.prototype.readFloat=function(t){return this.fromFloatBits(this.readUnsignedInt())};e.prototype.fromFloatBits=function(t){if(t==0){return 0}var e=t>>>23&255;var i=t&8388607|8388608;var r=Math.pow(2,e-127-23)*i;if(t>>>31!=0){r=-r}return r};return e}(a);e.exports=s},{"awayjs-core/lib/utils/ByteArrayBase":undefined}],"awayjs-core/lib/utils/ByteArray":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/utils/ByteArrayBase");var s=function(t){r(e,t);function e(){t.call(this);this.maxlength=0;this._mode="Typed array";this.maxlength=4;this.arraybytes=new ArrayBuffer(this.maxlength);this.unalignedarraybytestemp=new ArrayBuffer(16)}e.prototype.ensureWriteableSpace=function(t){this.ensureSpace(t+this.position)};e.prototype.setArrayBuffer=function(t){this.ensureSpace(t.byteLength);this.length=t.byteLength;var e=new Int8Array(t);var i=new Int8Array(this.arraybytes,0,this.length);i.set(e);this.position=0};e.prototype.getBytesAvailable=function(){return this.length-this.position};e.prototype.ensureSpace=function(t){if(t>this.maxlength){var e=t+255&~255;var i=new ArrayBuffer(e);var r=new Uint8Array(this.arraybytes,0,this.length);var a=new Uint8Array(i,0,this.length);a.set(r);this.arraybytes=i;this.maxlength=e}};e.prototype.writeByte=function(t){this.ensureWriteableSpace(1);var e=new Int8Array(this.arraybytes);e[this.position++]=~~t;if(this.position>this.length){this.length=this.position}};e.prototype.readByte=function(){if(this.position>=this.length){throw"ByteArray out of bounds read. Positon="+this.position+", Length="+this.length}var t=new Int8Array(this.arraybytes);return t[this.position++]};e.prototype.readBytes=function(t,e,i){if(e===void 0){e=0}if(i===void 0){i=0}if(i==null){i=t.length}t.ensureWriteableSpace(e+i);var r=new Int8Array(t.arraybytes);var a=new Int8Array(this.arraybytes);r.set(a.subarray(this.position,this.position+i),e);this.position+=i;if(i+e>t.length){t.length+=i+e-t.length}};e.prototype.writeUnsignedByte=function(t){this.ensureWriteableSpace(1);var e=new Uint8Array(this.arraybytes);e[this.position++]=~~t&255;if(this.position>this.length){this.length=this.position}};e.prototype.readUnsignedByte=function(){if(this.position>=this.length){throw"ByteArray out of bounds read. Positon="+this.position+", Length="+this.length}var t=new Uint8Array(this.arraybytes);return t[this.position++]};e.prototype.writeUnsignedShort=function(t){this.ensureWriteableSpace(2);if((this.position&1)==0){var e=new Uint16Array(this.arraybytes);e[this.position>>1]=~~t&65535}else{var e=new Uint16Array(this.unalignedarraybytestemp,0,1);e[0]=~~t&65535;var i=new Uint8Array(this.arraybytes,this.position,2);var r=new Uint8Array(this.unalignedarraybytestemp,0,2);i.set(r)}this.position+=2;if(this.position>this.length){this.length=this.position}};e.prototype.readUTFBytes=function(t){var e="";var i=this.position+t;var r=new DataView(this.arraybytes);while(this.position<i){var a=r.getUint8(this.position++);if(a<128){if(a==0)break;e+=String.fromCharCode(a)}else if(a<224){e+=String.fromCharCode((a&63)<<6|r.getUint8(this.position++)&127)}else if(a<240){var s=r.getUint8(this.position++);e+=String.fromCharCode((a&31)<<12|(s&127)<<6|r.getUint8(this.position++)&127)}else{var s=r.getUint8(this.position++);var n=r.getUint8(this.position++);e+=String.fromCharCode((a&15)<<18|(s&127)<<12|n<<6&127|r.getUint8(this.position++)&127)}}return e};e.prototype.readInt=function(){var t=new DataView(this.arraybytes);var e=t.getInt32(this.position,true);this.position+=4;return e};e.prototype.readShort=function(){var t=new DataView(this.arraybytes);var e=t.getInt16(this.position,true);this.position+=2;return e};e.prototype.readDouble=function(){var t=new DataView(this.arraybytes);var e=t.getFloat64(this.position,true);this.position+=8;return e};e.prototype.readUnsignedShort=function(){if(this.position>this.length+2){throw"ByteArray out of bounds read. Position="+this.position+", Length="+this.length}if((this.position&1)==0){var t=new Uint16Array(this.arraybytes);var e=this.position>>1;this.position+=2;return t[e]}else{var t=new Uint16Array(this.unalignedarraybytestemp,0,1);var i=new Uint8Array(this.arraybytes,this.position,2);var r=new Uint8Array(this.unalignedarraybytestemp,0,2);r.set(i);this.position+=2;return t[0]}};e.prototype.writeUnsignedInt=function(t){this.ensureWriteableSpace(4);if((this.position&3)==0){var e=new Uint32Array(this.arraybytes);e[this.position>>2]=~~t&4294967295}else{var e=new Uint32Array(this.unalignedarraybytestemp,0,1);e[0]=~~t&4294967295;var i=new Uint8Array(this.arraybytes,this.position,4);var r=new Uint8Array(this.unalignedarraybytestemp,0,4);i.set(r)}this.position+=4;if(this.position>this.length){this.length=this.position}};e.prototype.readUnsignedInt=function(){if(this.position>this.length+4){throw"ByteArray out of bounds read. Position="+this.position+", Length="+this.length}if((this.position&3)==0){var t=new Uint32Array(this.arraybytes);var e=this.position>>2;this.position+=4;return t[e]}else{var t=new Uint32Array(this.unalignedarraybytestemp,0,1);var i=new Uint8Array(this.arraybytes,this.position,4);var r=new Uint8Array(this.unalignedarraybytestemp,0,4);r.set(i);this.position+=4;return t[0]}};e.prototype.writeFloat=function(t){this.ensureWriteableSpace(4);if((this.position&3)==0){var e=new Float32Array(this.arraybytes);e[this.position>>2]=t}else{var e=new Float32Array(this.unalignedarraybytestemp,0,1);e[0]=t;var i=new Uint8Array(this.arraybytes,this.position,4);var r=new Uint8Array(this.unalignedarraybytestemp,0,4);i.set(r)}this.position+=4;if(this.position>this.length){this.length=this.position}};e.prototype.readFloat=function(){if(this.position>this.length+4){throw"ByteArray out of bounds read. Positon="+this.position+", Length="+this.length}if((this.position&3)==0){var t=new Float32Array(this.arraybytes);var e=this.position>>2;this.position+=4;return t[e]}else{var t=new Float32Array(this.unalignedarraybytestemp,0,1);var i=new Uint8Array(this.arraybytes,this.position,4);var r=new Uint8Array(this.unalignedarraybytestemp,0,4);r.set(i);this.position+=4;return t[0]}};return e}(a);e.exports=s},{"awayjs-core/lib/utils/ByteArrayBase":undefined}],"awayjs-core/lib/utils/CSS":[function(t,e,i){var r=function(){function t(){}t.setElementSize=function(t,e,i){t.style.width=e+"px";t.style.height=i+"px";t["width"]=e;t["height"]=i};t.setElementWidth=function(t,e){t.style.width=e+"px";t["width"]=e};t.setElementHeight=function(t,e){t.style.height=e+"px";t["height"]=e};t.setElementX=function(t,e){t.style.position="absolute";t.style.left=e+"px"};t.setElementY=function(t,e){t.style.position="absolute";t.style.top=e+"px"};t.getElementVisibility=function(t){return t.style.visibility=="visible"};t.setElementVisibility=function(t,e){if(e){t.style.visibility="visible"}else{t.style.visibility="hidden"}};t.setElementAlpha=function(t,e){if(t instanceof HTMLCanvasElement){var i=t.getContext("2d");i.globalAlpha=e}};t.setElementPosition=function(t,e,i,r){if(r===void 0){r=false}if(r){t.style.position="absolute"}else{t.style.position="relative"}t.style.left=e+"px";t.style.top=i+"px"};return t}();e.exports=r},{}],"awayjs-core/lib/utils/ColorUtils":[function(t,e,i){var r=function(){function t(){}t.float32ColorToARGB=function(t){var e=(t&4278190080)>>>24;var i=(t&16711680)>>>16;var r=(t&65280)>>>8;var a=t&255;var s=[e,i,r,a];return s};t.componentToHex=function(t){var e=t.toString(16);return e.length==1?"0"+e:e};t.RGBToHexString=function(e){return"#"+t.componentToHex(e[1])+t.componentToHex(e[2])+t.componentToHex(e[3])};t.ARGBToHexString=function(e){return"#"+t.componentToHex(e[0])+t.componentToHex(e[1])+t.componentToHex(e[2])+t.componentToHex(e[3])};return t}();e.exports=r},{}],"awayjs-core/lib/utils/Debug":[function(t,e,i){var r=t("awayjs-core/lib/errors/PartialImplementationError");var a=function(){function t(){}t.breakpoint=function(){t["break"]()};t.throwPIROnKeyWordOnly=function(e,i){if(i===void 0){i=true}if(!i)t.keyword=null;else t.keyword=e};t.throwPIR=function(e,i,a){t.logPIR("PartialImplementationError "+e,i,a);if(t.THROW_ERRORS){if(t.keyword){var s=e+i+a;if(s.indexOf(t.keyword)==-1)return}throw new r(e+"."+i+": "+a)}};t.logPIR=function(e,i,r){if(r===void 0){r=""}if(t.LOG_PI_ERRORS)console.log(e+"."+i+": "+r)};t.log=function(){var e=[];for(var i=0;i<arguments.length;i++){e[i-0]=arguments[i]}if(t.ENABLE_LOG)console.log(e)};t.THROW_ERRORS=true;t.ENABLE_LOG=true;t.LOG_PI_ERRORS=true;t.keyword=null;return t}();e.exports=a},{"awayjs-core/lib/errors/PartialImplementationError":undefined}],"awayjs-core/lib/utils/RequestAnimationFrame":[function(t,e,i){var r=t("awayjs-core/lib/utils/getTimer");var a=function(){function t(t,e){var i=this;this._active=false;this._argsArray=new Array;this._getTimer=r;this.setCallback(t,e);this._rafUpdateFunction=function(){if(i._active)i._tick()};this._argsArray.push(this._dt)}t.prototype.setCallback=function(t,e){this._callback=t;this._callbackContext=e};t.prototype.start=function(){this._prevTime=this._getTimer();this._active=true;if(window.requestAnimationFrame){window.requestAnimationFrame(this._rafUpdateFunction)}else{if(window["mozRequestAnimationFrame"])window.requestAnimationFrame=window["mozRequestAnimationFrame"];else if(window["webkitRequestAnimationFrame"])window.requestAnimationFrame=window["webkitRequestAnimationFrame"];else if(window["oRequestAnimationFrame"])window.requestAnimationFrame=window["oRequestAnimationFrame"]}};t.prototype.stop=function(){this._active=false};Object.defineProperty(t.prototype,"active",{get:function(){return this._active},enumerable:true,configurable:true});t.prototype._tick=function(){this._currentTime=this._getTimer();this._dt=this._currentTime-this._prevTime;this._argsArray[0]=this._dt;this._callback.apply(this._callbackContext,this._argsArray);window.requestAnimationFrame(this._rafUpdateFunction);this._prevTime=this._currentTime};return t}();e.exports=a},{"awayjs-core/lib/utils/getTimer":undefined}],"awayjs-core/lib/utils/TextureUtils":[function(t,e,i){var r=function(){function t(){}t.isBitmapDataValid=function(e){if(e==null){return true}return t.isDimensionValid(e.width)&&t.isDimensionValid(e.height)};t.isHTMLImageElementValid=function(e){if(e==null)return true;return t.isDimensionValid(e.width)&&t.isDimensionValid(e.height)};t.isDimensionValid=function(e){return e>=1&&e<=t.MAX_SIZE&&t.isPowerOfTwo(e)};t.isPowerOfTwo=function(t){return t?(t&-t)==t:false};t.getBestPowerOf2=function(e){var i=1;while(i<e)i<<=1;if(i>t.MAX_SIZE)i=t.MAX_SIZE;return i};t.MAX_SIZE=2048;return t}();e.exports=r},{}],"awayjs-core/lib/utils/Timer":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/Error");var s=t("awayjs-core/lib/events/EventDispatcher");var n=t("awayjs-core/lib/events/TimerEvent");var o=function(t){r(e,t);function e(e,i){if(i===void 0){i=0}t.call(this);this._repeatCount=0;this._currentCount=0;this._running=false;this._delay=e;this._repeatCount=i;if(isNaN(e)||e<0){throw new a("Delay is negative or not a number")}}Object.defineProperty(e.prototype,"currentCount",{get:function(){return this._currentCount},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"delay",{get:function(){return this._delay},set:function(t){this._delay=t;if(this._running){this.stop();this.start()}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"repeatCount",{get:function(){return this._repeatCount},set:function(t){this._repeatCount=t},enumerable:true,configurable:true});e.prototype.reset=function(){if(this._running){this.stop()}this._currentCount=0};Object.defineProperty(e.prototype,"running",{get:function(){return this._running},enumerable:true,configurable:true});e.prototype.start=function(){var t=this;
this._running=true;clearInterval(this._iid);this._iid=setInterval(function(){return t.tick()},this._delay)};e.prototype.stop=function(){this._running=false;clearInterval(this._iid)};e.prototype.tick=function(){this._currentCount++;if(this._repeatCount>0&&this._currentCount>=this._repeatCount){this.stop();this.dispatchEvent(new n(n.TIMER));this.dispatchEvent(new n(n.TIMER_COMPLETE))}else{this.dispatchEvent(new n(n.TIMER))}};return e}(s);e.exports=o},{"awayjs-core/lib/errors/Error":undefined,"awayjs-core/lib/events/EventDispatcher":undefined,"awayjs-core/lib/events/TimerEvent":undefined}],"awayjs-core/lib/utils/getTimer":[function(t,e,i){function r(){return Date.now()}e.exports=r},{}],"awayjs-display/lib/animators/IAnimationSet":[function(t,e,i){},{}],"awayjs-display/lib/animators/IAnimator":[function(t,e,i){},{}],"awayjs-display/lib/animators/nodes/AnimationNodeBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetType");var s=t("awayjs-core/lib/library/NamedAssetBase");var n=function(t){r(e,t);function e(){t.call(this)}Object.defineProperty(e.prototype,"stateClass",{get:function(){return this._pStateClass},enumerable:true,configurable:true});e.prototype.dispose=function(){};Object.defineProperty(e.prototype,"assetType",{get:function(){return a.ANIMATION_NODE},enumerable:true,configurable:true});return e}(s);e.exports=n},{"awayjs-core/lib/library/AssetType":undefined,"awayjs-core/lib/library/NamedAssetBase":undefined}],"awayjs-display/lib/base/AlignmentMode":[function(t,e,i){var r=function(){function t(){}t.REGISTRATION_POINT="registrationPoint";t.PIVOT_POINT="pivot";return t}();e.exports=r},{}],"awayjs-display/lib/base/BlendMode":[function(t,e,i){var r=function(){function t(){}t.ADD="add";t.ALPHA="alpha";t.DARKEN="darken";t.DIFFERENCE="difference";t.ERASE="erase";t.HARDLIGHT="hardlight";t.INVERT="invert";t.LAYER="layer";t.LIGHTEN="lighten";t.MULTIPLY="multiply";t.NORMAL="normal";t.OVERLAY="overlay";t.SCREEN="screen";t.SHADER="shader";t.SUBTRACT="subtract";return t}();e.exports=r},{}],"awayjs-display/lib/base/CapsStyle":[function(t,e,i){var r=function(){function t(){}t.ROUND="round";t.NONE="none";t.SQUARE="square";return t}();e.exports=r},{}],"awayjs-display/lib/base/DisplayObject":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/bounds/AxisAlignedBoundingBox");var s=t("awayjs-core/lib/geom/MathConsts");var n=t("awayjs-core/lib/geom/Matrix3D");var o=t("awayjs-core/lib/geom/Matrix3DUtils");var h=t("awayjs-core/lib/geom/Point");var l=t("awayjs-core/lib/geom/Vector3D");var u=t("awayjs-core/lib/library/NamedAssetBase");var p=t("awayjs-core/lib/errors/AbstractMethodError");var c=t("awayjs-display/lib/base/AlignmentMode");var d=t("awayjs-display/lib/base/OrientationMode");var f=t("awayjs-display/lib/base/Transform");var _=t("awayjs-display/lib/pick/PickingCollisionVO");var y=t("awayjs-display/lib/events/DisplayObjectEvent");var g=t("awayjs-display/lib/events/SceneEvent");var m=function(t){r(e,t);function e(){t.call(this);this._pSceneTransform=new n;this._pSceneTransformDirty=true;this._matrix3D=new n;this._matrix3DDirty=true;this._inverseSceneTransform=new n;this._inverseSceneTransformDirty=true;this._scenePosition=new l;this._scenePositionDirty=true;this._explicitVisibility=true;this._pImplicitVisibility=true;this._explicitMouseEnabled=true;this._pImplicitMouseEnabled=true;this._positionDirty=true;this._rotationDirty=true;this._scaleDirty=true;this._rotationX=0;this._rotationY=0;this._rotationZ=0;this._eulers=new l;this._flipY=new n;this._zOffset=0;this._pScaleX=1;this._pScaleY=1;this._pScaleZ=1;this._x=0;this._y=0;this._z=0;this._pivot=new l;this._orientationMatrix=new n;this._pivotZero=true;this._pivotDirty=true;this._pos=new l;this._rot=new l;this._sca=new l;this._pIgnoreTransform=false;this._pBoundsInvalid=true;this._worldBoundsInvalid=true;this._pRenderables=new Array;this.alignmentMode=c.REGISTRATION_POINT;this.castsShadows=true;this.orientationMode=d.DEFAULT;this._transformComponents=new Array(3);this._transformComponents[0]=this._pos;this._transformComponents[1]=this._rot;this._transformComponents[2]=this._sca;this._transform=new f(this);this._matrix3D.identity();this._flipY.appendScale(1,-1,1);this._pBounds=this.pCreateDefaultBoundingVolume();this._worldBounds=this.pCreateDefaultBoundingVolume()}Object.defineProperty(e.prototype,"bounds",{get:function(){if(this._pBoundsInvalid)this.pUpdateBounds();return this._pBounds},set:function(t){if(this._pBounds==t)return;this._pBounds=t;this._worldBounds=t.clone();this.pInvalidateBounds();if(this._boundsVisible)this._partitionNode._iUpdateEntityBounds()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"depth",{get:function(){if(this._pBoundsInvalid)this.pUpdateBounds();return this._depth},set:function(t){if(this._depth==t)return;this._depth==t;this._pScaleZ=t/this.bounds.aabb.depth;this.invalidateScale()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"eulers",{get:function(){this._eulers.x=this._rotationX*s.RADIANS_TO_DEGREES;this._eulers.y=this._rotationY*s.RADIANS_TO_DEGREES;this._eulers.z=this._rotationZ*s.RADIANS_TO_DEGREES;return this._eulers},set:function(t){this._rotationX=t.x*s.DEGREES_TO_RADIANS;this._rotationY=t.y*s.DEGREES_TO_RADIANS;this._rotationZ=t.z*s.DEGREES_TO_RADIANS;this.invalidateRotation()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){if(this._pBoundsInvalid)this.pUpdateBounds();return this._height},set:function(t){if(this._height==t)return;this._height==t;this._pScaleY=t/this.bounds.aabb.height;this.invalidateScale()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"index",{get:function(){if(this._pParent)return this._pParent.getChildIndex(this);return 0},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"inverseSceneTransform",{get:function(){if(this._inverseSceneTransformDirty){this._inverseSceneTransform.copyFrom(this.sceneTransform);this._inverseSceneTransform.invert();this._inverseSceneTransformDirty=false}return this._inverseSceneTransform},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"ignoreTransform",{get:function(){return this._pIgnoreTransform},set:function(t){if(this._pIgnoreTransform==t)return;this._pIgnoreTransform=t;if(t){this._pSceneTransform.identity();this._scenePosition.setTo(0,0,0)}this.pInvalidateSceneTransform()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"isEntity",{get:function(){return this._pIsEntity},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"loaderInfo",{get:function(){return this._loaderInfo},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"mouseEnabled",{get:function(){return this._explicitMouseEnabled},set:function(t){if(this._explicitMouseEnabled==t)return;this._explicitMouseEnabled=t;this._pUpdateImplicitMouseEnabled(this._pParent?this._pParent.mouseChildren:true)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"mouseX",{get:function(){return this._mouseX},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"mouseY",{get:function(){return this._mouseY},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"parent",{get:function(){return this._pParent},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"partition",{get:function(){return this._explicitPartition},set:function(t){if(this._explicitPartition==t)return;if(this._pScene&&this._explicitPartition)this._pScene.iUnregisterPartition(this._explicitPartition);this._explicitPartition=t;if(this._pScene&&t)this._pScene.iRegisterPartition(t);this._pUpdateImplicitPartition(this._pParent?this._pParent._iAssignedPartition:null)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"partitionNode",{get:function(){if(!this._partitionNode)this._partitionNode=this.pCreateEntityPartitionNode();return this._partitionNode},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"pickingCollider",{get:function(){return this._pPickingCollider},set:function(t){this._pPickingCollider=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"pivot",{get:function(){return this._pivot},set:function(t){this._pivot=t.clone();this.invalidatePivot()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"root",{get:function(){return this._root},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"rotationX",{get:function(){return this._rotationX*s.RADIANS_TO_DEGREES},set:function(t){if(this.rotationX==t)return;this._rotationX=t*s.DEGREES_TO_RADIANS;this.invalidateRotation()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"rotationY",{get:function(){return this._rotationY*s.RADIANS_TO_DEGREES},set:function(t){if(this.rotationY==t)return;this._rotationY=t*s.DEGREES_TO_RADIANS;this.invalidateRotation()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"rotationZ",{get:function(){return this._rotationZ*s.RADIANS_TO_DEGREES},set:function(t){if(this.rotationZ==t)return;this._rotationZ=t*s.DEGREES_TO_RADIANS;this.invalidateRotation()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scaleX",{get:function(){return this._pScaleX},set:function(t){if(this._pScaleX==t)return;this._pScaleX=t;this.invalidateScale()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scaleY",{get:function(){return this._pScaleY},set:function(t){if(this._pScaleY==t)return;this._pScaleY=t;this.invalidateScale()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scaleZ",{get:function(){return this._pScaleZ},set:function(t){if(this._pScaleZ==t)return;this._pScaleZ=t;this.invalidateScale()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scene",{get:function(){return this._pScene},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scenePosition",{get:function(){if(this._scenePositionDirty){if(!this._pivotZero&&this.alignmentMode==c.PIVOT_POINT){var t=new l(this._pivot.x/this._pScaleX,this._pivot.y/this._pScaleY,this._pivot.z/this._pScaleZ);this._scenePosition=this.sceneTransform.transformVector(t)}else{this.sceneTransform.copyColumnTo(3,this._scenePosition)}this._scenePositionDirty=false}return this._scenePosition},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"sceneTransform",{get:function(){if(this._pSceneTransformDirty)this.pUpdateSceneTransform();return this._pSceneTransform},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"shaderPickingDetails",{get:function(){return this._shaderPickingDetails},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"boundsVisible",{get:function(){return this._boundsVisible},set:function(t){if(t==this._boundsVisible)return;this._boundsVisible=t;this._partitionNode.boundsVisible=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"transform",{get:function(){return this._transform},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"visible",{get:function(){return this._explicitVisibility},set:function(t){if(this._explicitVisibility==t)return;this._explicitVisibility=t;this._pUpdateImplicitVisibility(this._pParent?this._pParent._iIsVisible():true)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"width",{get:function(){if(this._pBoundsInvalid)this.pUpdateBounds();return this._width},set:function(t){if(this._width==t)return;this._width==t;this._pScaleX=t/this.bounds.aabb.width;this.invalidateScale()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"worldBounds",{get:function(){if(this._iSourcePrefab)this._iSourcePrefab._iValidate();if(this._worldBoundsInvalid){this._worldBoundsInvalid=false;this._worldBounds.transformFrom(this.bounds,this.sceneTransform)}return this._worldBounds},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){if(this._x==t)return;this._x=t;this.invalidatePosition()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){if(this._y==t)return;this._y=t;this.invalidatePosition()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"z",{get:function(){return this._z},set:function(t){if(this._z==t)return;this._z=t;this.invalidatePosition()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"zOffset",{get:function(){return this._zOffset},set:function(t){this._zOffset=t},enumerable:true,configurable:true});e.prototype.addEventListener=function(e,i){t.prototype.addEventListener.call(this,e,i);switch(e){case y.POSITION_CHANGED:this._listenToPositionChanged=true;break;case y.ROTATION_CHANGED:this._listenToRotationChanged=true;break;case y.SCALE_CHANGED:this._listenToScaleChanged=true;break}};e.prototype.clone=function(){var t=new e;t.pivot=this.pivot;t._iMatrix3D=this._iMatrix3D;t.name=name;return t};e.prototype.dispose=function(){if(this.parent)this.parent.removeChild(this);while(this._pRenderables.length)this._pRenderables[0].dispose()};e.prototype.disposeAsset=function(){this.dispose()};e.prototype.getBounds=function(t){return this._bounds};e.prototype.getRect=function(t){return this._bounds};e.prototype.globalToLocal=function(t){return t};e.prototype.globalToLocal3D=function(t){return new l};e.prototype.hitTestObject=function(t){return false};e.prototype.hitTestPoint=function(t,e,i){if(i===void 0){i=false}return false};e.prototype.isIntersectingRay=function(t,e){var i=this.inverseSceneTransform.transformVector(t);var r=this.inverseSceneTransform.deltaTransformVector(e);var a=this._iPickingCollisionVO;if(!a.localNormal)a.localNormal=new l;var s=this.bounds.rayIntersection(i,r,a.localNormal);if(s<0)return false;a.rayEntryDistance=s;a.localRayPosition=i;a.localRayDirection=r;a.rayPosition=t;a.rayDirection=e;a.rayOriginIsInsideBounds=s==0;return true};e.prototype.local3DToGlobal=function(t){return new h};e.prototype.lookAt=function(t,e){if(e===void 0){e=null}var i;var r;var a;var s;if(e==null)e=l.Y_AXIS;else e.normalize();r=t.subtract(this._iMatrix3D.position);r.normalize();a=e.crossProduct(r);a.normalize();if(a.length<.05){a.x=e.y;a.y=e.x;a.z=0;a.normalize()}i=r.crossProduct(a);s=o.RAW_DATA_CONTAINER;s[0]=a.x;s[1]=a.y;s[2]=a.z;s[3]=0;s[4]=i.x;s[5]=i.y;s[6]=i.z;s[7]=0;s[8]=r.x;s[9]=r.y;s[10]=r.z;s[11]=0;var h=new n;h.copyRawDataFrom(s);var u=h.decompose()[1];this._rotationX=u.x;this._rotationY=u.y;this._rotationZ=u.z;this.invalidateRotation()};e.prototype.localToGlobal=function(t){return new h};e.prototype.moveTo=function(t,e,i){if(this._x==t&&this._y==e&&this._z==i)return;this._x=t;this._y=e;this._z=i;this.invalidatePosition()};e.prototype.movePivot=function(t,e,i){if(this._pivot==null)this._pivot=new l;this._pivot.x+=t;this._pivot.y+=e;this._pivot.z+=i;this.invalidatePivot()};e.prototype.pitch=function(t){this.rotate(l.X_AXIS,t)};e.prototype.getRenderSceneTransform=function(t){if(this.orientationMode==d.CAMERA_PLANE){var e=t.sceneTransform.decompose();var i=e[2];e[0]=this.scenePosition;i.x=this._pScaleX;i.y=this._pScaleY;i.z=this._pScaleZ;this._orientationMatrix.recompose(e);if(!this._pivotZero&&this.alignmentMode==c.PIVOT_POINT)this._orientationMatrix.prependTranslation(-this._pivot.x/this._pScaleX,-this._pivot.y/this._pScaleY,-this._pivot.z/this._pScaleZ);return this._orientationMatrix}return this.sceneTransform};e.prototype.roll=function(t){this.rotate(l.Z_AXIS,t)};e.prototype.rotate=function(t,e){var i=new n;i.prependRotation(e,t);var r=i.decompose()[1];this._rotationX+=r.x;this._rotationY+=r.y;this._rotationZ+=r.z;this.invalidateRotation()};e.prototype.rotateTo=function(t,e,i){this._rotationX=t*s.DEGREES_TO_RADIANS;this._rotationY=e*s.DEGREES_TO_RADIANS;this._rotationZ=i*s.DEGREES_TO_RADIANS;this.invalidateRotation()};e.prototype.removeEventListener=function(e,i){t.prototype.removeEventListener.call(this,e,i);if(this.hasEventListener(e,i))return;switch(e){case y.POSITION_CHANGED:this._listenToPositionChanged=false;break;case y.ROTATION_CHANGED:this._listenToRotationChanged=false;break;case y.SCALE_CHANGED:this._listenToScaleChanged=false;break}};e.prototype.translate=function(t,e){var i=t.x,r=t.y,a=t.z;var s=e/Math.sqrt(i*i+r*r+a*a);this._x+=i*s;this._y+=r*s;this._z+=a*s;this.invalidatePosition()};e.prototype.translateLocal=function(t,e){var i=t.x,r=t.y,a=t.z;var s=e/Math.sqrt(i*i+r*r+a*a);this._iMatrix3D.prependTranslation(i*s,r*s,a*s);this._matrix3D.copyColumnTo(3,this._pos);this._x=this._pos.x;this._y=this._pos.y;this._z=this._pos.z;this.invalidatePosition()};e.prototype.yaw=function(t){this.rotate(l.Y_AXIS,t)};Object.defineProperty(e.prototype,"_iAssignedPartition",{get:function(){return this._pImplicitPartition},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"_iMatrix3D",{get:function(){if(this._matrix3DDirty)this._pUpdateMatrix3D();return this._matrix3D},set:function(t){var e=t.decompose();var i;i=e[0];if(this._x!=i.x||this._y!=i.y||this._z!=i.z){this._x=i.x;this._y=i.y;this._z=i.z;this.invalidatePosition()}i=e[1];if(this._rotationX!=i.x||this._rotationY!=i.y||this._rotationZ!=i.z){this._rotationX=i.x;this._rotationY=i.y;this._rotationZ=i.z;this.invalidateRotation()}i=e[2];if(this._pScaleX!=i.x||this._pScaleY!=i.y||this._pScaleZ!=i.z){this._pScaleX=i.x;this._pScaleY=i.y;this._pScaleZ=i.z;this.invalidateScale()}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"_iPickingCollisionVO",{get:function(){if(!this._pPickingCollisionVO)this._pPickingCollisionVO=new _(this);return this._pPickingCollisionVO},enumerable:true,configurable:true});e.prototype.iSetParent=function(t){this._pParent=t;if(t){this._pUpdateImplicitMouseEnabled(t.mouseChildren);this._pUpdateImplicitVisibility(t._iIsVisible());this._pUpdateImplicitPartition(t._iAssignedPartition);this._iSetScene(t._pScene)}else{this._pUpdateImplicitMouseEnabled(true);this._pUpdateImplicitVisibility(true);this._pUpdateImplicitPartition(null);this._iSetScene(null)}};e.prototype.pCreateDefaultBoundingVolume=function(){return new a};e.prototype.pCreateEntityPartitionNode=function(){throw new p};e.prototype.pInvalidateBounds=function(){this._pBoundsInvalid=true;this._worldBoundsInvalid=true;if(this.isEntity)this.invalidatePartition()};e.prototype.pInvalidateSceneTransform=function(){this._pSceneTransformDirty=!this._pIgnoreTransform;this._inverseSceneTransformDirty=!this._pIgnoreTransform;this._scenePositionDirty=!this._pIgnoreTransform;this._worldBoundsInvalid=!this._pIgnoreTransform;if(this.isEntity)this.invalidatePartition();if(this._listenToSceneTransformChanged)this.notifySceneTransformChange()};e.prototype.pUpdateBounds=function(){this._width=this._pBounds.aabb.width*this._pScaleX;this._height=this._pBounds.aabb.height*this._pScaleY;this._depth=this._pBounds.aabb.depth*this._pScaleZ;this._pBoundsInvalid=false};e.prototype._pUpdateImplicitMouseEnabled=function(t){this._pImplicitMouseEnabled=this._explicitMouseEnabled&&t;if(this._pImplicitMouseEnabled&&this._pParent&&!this._pPickingCollider)this._pPickingCollider=this._pParent._pPickingCollider};e.prototype._pUpdateImplicitPartition=function(t){this._pImplicitPartition=this._explicitPartition||t};e.prototype._pUpdateImplicitVisibility=function(t){this._pImplicitVisibility=this._explicitVisibility&&t};e.prototype._pUpdateMatrix3D=function(){this._pos.x=this._x;this._pos.y=this._y;this._pos.z=this._z;this._rot.x=this._rotationX;this._rot.y=this._rotationY;this._rot.z=this._rotationZ;this._sca.x=this._pScaleX;this._sca.y=this._pScaleY;this._sca.z=this._pScaleZ;this._matrix3D.recompose(this._transformComponents);if(!this._pivotZero){this._matrix3D.prependTranslation(-this._pivot.x/this._pScaleX,-this._pivot.y/this._pScaleY,-this._pivot.z/this._pScaleZ);if(this.alignmentMode!=c.PIVOT_POINT)this._matrix3D.appendTranslation(this._pivot.x,this._pivot.y,this._pivot.z)}this._matrix3DDirty=false;this._positionDirty=false;this._rotationDirty=false;this._scaleDirty=false;this._pivotDirty=false};e.prototype.pUpdateSceneTransform=function(){if(this._pParent&&!this._pParent._iIsRoot){this._pSceneTransform.copyFrom(this._pParent.sceneTransform);this._pSceneTransform.prepend(this._iMatrix3D)}else{this._pSceneTransform.copyFrom(this._iMatrix3D)}this._pSceneTransformDirty=false};e.prototype._iAddRenderable=function(t){this._pRenderables.push(t);return t};e.prototype._iRemoveRenderable=function(t){var e=this._pRenderables.indexOf(t);this._pRenderables.splice(e,1);return t};e.prototype._iTestCollision=function(t,e){return false};e.prototype._iInternalUpdate=function(){if(this._iController)this._iController.update()};e.prototype._iIsVisible=function(){return this._pImplicitVisibility};e.prototype._iIsMouseEnabled=function(){return this._pImplicitMouseEnabled};e.prototype._iSetScene=function(t){if(this._pScene==t)return;this._pUpdateScene(t);if(!this._pSceneTransformDirty&&!this._pIgnoreTransform)this.pInvalidateSceneTransform()};e.prototype._pUpdateScene=function(t){if(this._pScene){this._pScene.dispatchEvent(new g(g.REMOVED_FROM_SCENE,this));this._pScene.iUnregisterEntity(this)}this._pScene=t;if(t){t.dispatchEvent(new g(g.ADDED_TO_SCENE,this));t.iRegisterEntity(this)}this.notifySceneChange()};e.prototype.notifyPositionChanged=function(){if(!this._positionChanged)this._positionChanged=new y(y.POSITION_CHANGED,this);this.dispatchEvent(this._positionChanged)};e.prototype.notifyRotationChanged=function(){if(!this._rotationChanged)this._rotationChanged=new y(y.ROTATION_CHANGED,this);this.dispatchEvent(this._rotationChanged)};e.prototype.notifyScaleChanged=function(){if(!this._scaleChanged)this._scaleChanged=new y(y.SCALE_CHANGED,this);this.dispatchEvent(this._scaleChanged)};e.prototype.notifySceneChange=function(){if(this._listenToSceneChanged){if(!this._scenechanged)this._scenechanged=new y(y.SCENE_CHANGED,this);this.dispatchEvent(this._scenechanged)}};e.prototype.notifySceneTransformChange=function(){if(!this._sceneTransformChanged)this._sceneTransformChanged=new y(y.SCENETRANSFORM_CHANGED,this);this.dispatchEvent(this._sceneTransformChanged)};e.prototype.invalidateMatrix3D=function(){if(this._matrix3DDirty)return;this._matrix3DDirty=true;if(!this._pSceneTransformDirty&&!this._pIgnoreTransform)this.pInvalidateSceneTransform()};e.prototype.invalidatePartition=function(){if(this._iAssignedPartition)this._iAssignedPartition.iMarkForUpdate(this)};e.prototype.invalidatePivot=function(){this._pivotZero=this._pivot.x==0&&this._pivot.y==0&&this._pivot.z==0;if(this._pivotDirty)return;this._pivotDirty=true;this.invalidateMatrix3D()};e.prototype.invalidatePosition=function(){if(this._positionDirty)return;this._positionDirty=true;this.invalidateMatrix3D();if(this._listenToPositionChanged)this.notifyPositionChanged()};e.prototype.invalidateRotation=function(){if(this._rotationDirty)return;this._rotationDirty=true;this.invalidateMatrix3D();if(this._listenToRotationChanged)this.notifyRotationChanged()};e.prototype.invalidateScale=function(){if(this._scaleDirty)return;this._scaleDirty=true;this.invalidateMatrix3D();if(this._listenToScaleChanged)this.notifyScaleChanged()};return e}(u);e.exports=m},{"awayjs-core/lib/bounds/AxisAlignedBoundingBox":undefined,"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/geom/MathConsts":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-core/lib/geom/Point":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/library/NamedAssetBase":undefined,"awayjs-display/lib/base/AlignmentMode":undefined,"awayjs-display/lib/base/OrientationMode":undefined,"awayjs-display/lib/base/Transform":undefined,"awayjs-display/lib/events/DisplayObjectEvent":undefined,"awayjs-display/lib/events/SceneEvent":undefined,"awayjs-display/lib/pick/PickingCollisionVO":undefined}],"awayjs-display/lib/base/Geometry":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetType");var s=t("awayjs-core/lib/library/NamedAssetBase");var n=t("awayjs-display/lib/events/GeometryEvent");var o=function(t){r(e,t);function e(){t.call(this);this._subGeometries=new Array}Object.defineProperty(e.prototype,"assetType",{get:function(){return a.GEOMETRY},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"subGeometries",{get:function(){return this._subGeometries},enumerable:true,configurable:true});e.prototype.getSubGeometries=function(){return this._subGeometries};e.prototype.applyTransformation=function(t){var e=this._subGeometries.length;for(var i=0;i<e;++i)this._subGeometries[i].applyTransformation(t)};e.prototype.addSubGeometry=function(t){this._subGeometries.push(t);t.parentGeometry=this;if(this.hasEventListener(n.SUB_GEOMETRY_ADDED))this.dispatchEvent(new n(n.SUB_GEOMETRY_ADDED,t));this.iInvalidateBounds(t)};e.prototype.removeSubGeometry=function(t){this._subGeometries.splice(this._subGeometries.indexOf(t),1);t.parentGeometry=null;if(this.hasEventListener(n.SUB_GEOMETRY_REMOVED))this.dispatchEvent(new n(n.SUB_GEOMETRY_REMOVED,t));this.iInvalidateBounds(t)};e.prototype.clone=function(){var t=new e;var i=this._subGeometries.length;for(var r=0;r<i;++r)t.addSubGeometry(this._subGeometries[r].clone());return t};e.prototype.scale=function(t){var e=this._subGeometries.length;for(var i=0;i<e;++i)this._subGeometries[i].scale(t)};e.prototype.dispose=function(){var t=this._subGeometries.length;for(var e=0;e<t;++e){var i=this._subGeometries[0];this.removeSubGeometry(i);i.dispose()}};e.prototype.scaleUV=function(t,e){if(t===void 0){t=1}if(e===void 0){e=1}var i=this._subGeometries.length;for(var r=0;r<i;++r)this._subGeometries[r].scaleUV(t,e)};e.prototype.iInvalidateBounds=function(t){if(this.hasEventListener(n.BOUNDS_INVALID))this.dispatchEvent(new n(n.BOUNDS_INVALID,t))};return e}(s);e.exports=o},{"awayjs-core/lib/library/AssetType":undefined,"awayjs-core/lib/library/NamedAssetBase":undefined,"awayjs-display/lib/events/GeometryEvent":undefined}],"awayjs-display/lib/base/GradientType":[function(t,e,i){var r=function(){function t(){}t.LINEAR="linear";t.RADIAL="radial";return t}();e.exports=r},{}],"awayjs-display/lib/base/GraphicsPathWinding":[function(t,e,i){var r=function(){function t(){}t.EVEN_ODD="evenOdd";t.NON_ZERO="nonZero";return t}();e.exports=r},{}],"awayjs-display/lib/base/Graphics":[function(t,e,i){var r=function(){function t(){}t.prototype.beginBitmapFill=function(t,e,i,r){if(e===void 0){e=null}if(i===void 0){i=true}if(r===void 0){r=false}};t.prototype.beginFill=function(t,e){if(e===void 0){e=1}};t.prototype.beginGradientFill=function(t,e,i,r,a,s,n,o){if(a===void 0){a=null}if(s===void 0){s="pad"}if(n===void 0){n="rgb"}if(o===void 0){o=0}};t.prototype.clear=function(){};t.prototype.copyFrom=function(t){};t.prototype.cubicCurveTo=function(t,e,i,r,a,s){};t.prototype.curveTo=function(t,e,i,r){};t.prototype.drawCircle=function(t,e,i){};t.prototype.drawEllipse=function(t,e,i,r){};t.prototype.drawGraphicsData=function(t){};t.prototype.drawPath=function(t,e,i){};t.prototype.drawRect=function(t,e,i,r){};t.prototype.drawRoundRect=function(t,e,i,r,a,s){if(s===void 0){s=NaN}};t.prototype.drawTriangles=function(t,e,i,r){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=null}};t.prototype.endFill=function(){};t.prototype.lineBitmapStyle=function(t,e,i,r){if(e===void 0){e=null}if(i===void 0){i=true}if(r===void 0){r=false}};t.prototype.lineGradientStyle=function(t,e,i,r,a,s,n,o){if(a===void 0){a=null}if(s===void 0){s=null}if(n===void 0){n=null}if(o===void 0){o=0}};t.prototype.lineStyle=function(t,e,i,r,a,s,n,o){if(t===void 0){t=0}if(e===void 0){e=0}if(i===void 0){i=1}if(r===void 0){r=false}if(a===void 0){a=null}if(s===void 0){s=null}if(n===void 0){n=null}if(o===void 0){o=3}};t.prototype.lineTo=function(t,e){};t.prototype.moveTo=function(t,e){};return t}();e.exports=r},{}],"awayjs-display/lib/base/IBitmapDrawable":[function(t,e,i){},{}],"awayjs-display/lib/base/IGraphicsData":[function(t,e,i){},{}],"awayjs-display/lib/base/IMaterialOwner":[function(t,e,i){},{}],"awayjs-display/lib/base/IStage":[function(t,e,i){},{}],"awayjs-display/lib/base/ISubMeshClass":[function(t,e,i){},{}],"awayjs-display/lib/base/ISubMesh":[function(t,e,i){},{}],"awayjs-display/lib/base/InterpolationMethod":[function(t,e,i){var r=function(){function t(){}t.LINEAR_RGB="linearRGB";t.RGB="rgb";return t}();e.exports=r},{}],"awayjs-display/lib/base/JointStyle":[function(t,e,i){var r=function(){function t(){}t.BEVEL="bevel";t.MITER="miter";t.ROUND="round";return t}();e.exports=r},{}],"awayjs-display/lib/base/LightBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetType");var s=t("awayjs-core/lib/errors/AbstractMethodError");var n=t("awayjs-display/lib/containers/DisplayObjectContainer");var o=t("awayjs-display/lib/events/LightEvent");var h=function(t){r(e,t);function e(){t.call(this);this._color=16777215;this._colorR=1;this._colorG=1;this._colorB=1;this._ambientColor=16777215;this._ambient=0;this._iAmbientR=0;this._iAmbientG=0;this._iAmbientB=0;this._specular=1;this._iSpecularR=1;this._iSpecularG=1;this._iSpecularB=1;this._diffuse=1;this._iDiffuseR=1;this._iDiffuseG=1;this._iDiffuseB=1;this._castsShadows=false}Object.defineProperty(e.prototype,"castsShadows",{get:function(){return this._castsShadows},set:function(t){if(this._castsShadows==t)return;this._castsShadows=t;if(t){if(this._shadowMapper==null)this._shadowMapper=this.pCreateShadowMapper();this._shadowMapper.light=this}else{this._shadowMapper.dispose();this._shadowMapper=null}this.dispatchEvent(new o(o.CASTS_SHADOW_CHANGE))},enumerable:true,configurable:true});e.prototype.pCreateShadowMapper=function(){throw new s};Object.defineProperty(e.prototype,"specular",{get:function(){return this._specular},set:function(t){if(t<0)t=0;this._specular=t;this.updateSpecular()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"diffuse",{get:function(){return this._diffuse},set:function(t){if(t<0)t=0;this._diffuse=t;this.updateDiffuse()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){this._color=t;this._colorR=(this._color>>16&255)/255;this._colorG=(this._color>>8&255)/255;this._colorB=(this._color&255)/255;this.updateDiffuse();this.updateSpecular()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"ambient",{get:function(){return this._ambient},set:function(t){if(t<0)t=0;else if(t>1)t=1;this._ambient=t;this.updateAmbient()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"ambientColor",{get:function(){return this._ambientColor},set:function(t){this._ambientColor=t;this.updateAmbient()},enumerable:true,configurable:true});e.prototype.updateAmbient=function(){this._iAmbientR=(this._ambientColor>>16&255)/255*this._ambient;this._iAmbientG=(this._ambientColor>>8&255)/255*this._ambient;this._iAmbientB=(this._ambientColor&255)/255*this._ambient};e.prototype.iGetObjectProjectionMatrix=function(t,e,i){if(i===void 0){i=null}throw new s};Object.defineProperty(e.prototype,"assetType",{get:function(){return a.LIGHT},enumerable:true,configurable:true});e.prototype.updateSpecular=function(){this._iSpecularR=this._colorR*this._specular;this._iSpecularG=this._colorG*this._specular;this._iSpecularB=this._colorB*this._specular};e.prototype.updateDiffuse=function(){this._iDiffuseR=this._colorR*this._diffuse;
this._iDiffuseG=this._colorG*this._diffuse;this._iDiffuseB=this._colorB*this._diffuse};Object.defineProperty(e.prototype,"shadowMapper",{get:function(){return this._shadowMapper},set:function(t){this._shadowMapper=t;this._shadowMapper.light=this},enumerable:true,configurable:true});return e}(n);e.exports=h},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/library/AssetType":undefined,"awayjs-display/lib/containers/DisplayObjectContainer":undefined,"awayjs-display/lib/events/LightEvent":undefined}],"awayjs-display/lib/base/LineScaleMode":[function(t,e,i){var r=function(){function t(){}t.HORIZONTAL="horizontal";t.NONE="none";t.NORMAL="normal";t.VERTICAL="vertical";return t}();e.exports=r},{}],"awayjs-display/lib/base/LineSubGeometry":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/base/LineSubMesh");var s=t("awayjs-display/lib/base/SubGeometryBase");var n=t("awayjs-display/lib/base/TriangleSubGeometry");var o=t("awayjs-display/lib/events/SubGeometryEvent");var h=function(t){r(e,t);function e(){t.call(this,true);this._positionsDirty=true;this._boundingPositionDirty=true;this._thicknessDirty=true;this._colorsDirty=true;this._pSubMeshClass=a}e.prototype._pUpdateStrideOffset=function(){this._pOffset[e.VERTEX_DATA]=0;var t=0;this._pOffset[e.START_POSITION_DATA]=t;t+=3;this._pOffset[e.END_POSITION_DATA]=t;t+=3;this._pOffset[e.THICKNESS_DATA]=t;t+=1;this._pOffset[e.COLOR_DATA]=t;t+=4;this._pStride[e.VERTEX_DATA]=t;this._pStride[e.START_POSITION_DATA]=t;this._pStride[e.END_POSITION_DATA]=t;this._pStride[e.THICKNESS_DATA]=t;this._pStride[e.COLOR_DATA]=t;var i=this._pNumVertices*t;if(this._pVertices==null)this._pVertices=new Array(i);else if(this._pVertices.length!=i)this._pVertices.length=i;this._pStrideOffsetDirty=false};Object.defineProperty(e.prototype,"vertices",{get:function(){if(this._positionsDirty)this.updatePositions(this._startPositions,this._endPositions);if(this._thicknessDirty)this.updateThickness(this._thickness);if(this._colorsDirty)this.updateColors(this._startColors,this._endColors);return this._pVertices},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"startPositions",{get:function(){if(this._positionsDirty)this.updatePositions(this._startPositions,this._endPositions);return this._startPositions},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"endPositions",{get:function(){if(this._positionsDirty)this.updatePositions(this._startPositions,this._endPositions);return this._endPositions},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"thickness",{get:function(){if(this._thicknessDirty)this.updateThickness(this._thickness);return this._thickness},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"startColors",{get:function(){if(this._colorsDirty)this.updateColors(this._startColors,this._endColors);return this._startColors},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"endColors",{get:function(){if(this._colorsDirty)this.updateColors(this._startColors,this._endColors);return this._endColors},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numSegments",{get:function(){return this._numSegments},enumerable:true,configurable:true});e.prototype.getBoundingPositions=function(){if(this._boundingPositionDirty)this._boundingPositions=this.startPositions.concat(this.endPositions);return this._boundingPositions};e.prototype.updatePositions=function(t,i){var r;var a;var s;var n;var o;var h;var l;this._startPositions=t;if(this._startPositions==null)this._startPositions=new Array;this._endPositions=i;if(this._endPositions==null)this._endPositions=new Array;this._boundingPositionDirty=true;this._numSegments=this._startPositions.length/3;this._pNumVertices=this._numSegments*4;var u=this._pNumVertices*this.getStride(e.VERTEX_DATA);if(this._pVertices==null)this._pVertices=new Array(u);else if(this._pVertices.length!=u)this._pVertices.length=u;r=0;a=0;n=this.getOffset(e.START_POSITION_DATA);o=this.getStride(e.START_POSITION_DATA);h=this._pVertices;l=new Array;while(r<t.length){s=n/o&1?i:t;h[n]=s[r];h[n+1]=s[r+1];h[n+2]=s[r+2];s=n/o&1?t:i;h[n+3]=s[r];h[n+4]=s[r+1];h[n+5]=s[r+2];if(++a==4){var p=n/o-3;l.push(p,p+1,p+2,p+3,p+2,p+1);a=0;r+=3}n+=o}this.updateIndices(l);this.pInvalidateBounds();this.notifyPositionsUpdate();this._positionsDirty=false};e.prototype.updateThickness=function(t){var i;var r;var a;var s;var n;var o;this._thickness=t;if(t!=null){i=0;r=0;s=this.getOffset(e.THICKNESS_DATA);n=this.getStride(e.THICKNESS_DATA);o=this._pVertices;a=s;while(i<t.length){o[a]=Math.floor(.5*(a-s)/n+.5)&1?-t[i]:t[i];if(++r==4){r=0;i++}a+=n}}this.notifyThicknessUpdate();this._thicknessDirty=false};e.prototype.updateColors=function(t,i){var r;var a;var s;var n;var o;var h;var l;this._startColors=t;this._endColors=i;if(this._startColors==null){this._startColors=new Array(this._numSegments*4);r=0;while(r<this._startColors.length)this._startColors[r++]=1}if(this._endColors==null){this._endColors=new Array(this._numSegments*4);r=0;while(r<this._endColors.length)this._endColors[r++]=1}r=0;a=0;o=this.getOffset(e.COLOR_DATA);h=this.getStride(e.COLOR_DATA);l=this._pVertices;n=o;while(r<this._startColors.length){s=(n-o)/h&1?this._endColors:this._startColors;l[n]=s[r];l[n+1]=s[r+1];l[n+2]=s[r+2];l[n+3]=s[r+3];if(++a==4){a=0;r+=4}n+=h}this.notifyColorsUpdate();this._colorsDirty=false};e.prototype.dispose=function(){t.prototype.dispose.call(this);this._startPositions=null;this._endPositions=null;this._thickness=null;this._startColors=null;this._endColors=null};e.prototype.pInvalidateBounds=function(){if(this.parentGeometry)this.parentGeometry.iInvalidateBounds(this)};e.prototype.clone=function(){var t=new e;t.updateIndices(this._pIndices.concat());t.updatePositions(this._startPositions.concat(),this._endPositions.concat());t.updateThickness(this._thickness.concat());t.updatePositions(this._startPositions.concat(),this._endPositions.concat());return t};e.prototype._pNotifyVerticesUpdate=function(){this._pStrideOffsetDirty=true;this.notifyPositionsUpdate();this.notifyThicknessUpdate();this.notifyColorsUpdate()};e.prototype.notifyPositionsUpdate=function(){if(this._positionsDirty)return;this._positionsDirty=true;if(!this._positionsUpdated)this._positionsUpdated=new o(o.VERTICES_UPDATED,n.POSITION_DATA);this.dispatchEvent(this._positionsUpdated)};e.prototype.notifyThicknessUpdate=function(){if(this._thicknessDirty)return;this._thicknessDirty=true;if(!this._thicknessUpdated)this._thicknessUpdated=new o(o.VERTICES_UPDATED,e.THICKNESS_DATA);this.dispatchEvent(this._thicknessUpdated)};e.prototype.notifyColorsUpdate=function(){if(this._colorsDirty)return;this._colorsDirty=true;if(!this._colorUpdated)this._colorUpdated=new o(o.VERTICES_UPDATED,e.COLOR_DATA);this.dispatchEvent(this._colorUpdated)};e.VERTEX_DATA="vertices";e.START_POSITION_DATA="startPositions";e.END_POSITION_DATA="endPositions";e.THICKNESS_DATA="thickness";e.COLOR_DATA="colors";e.POSITION_FORMAT="float3";e.COLOR_FORMAT="float4";e.THICKNESS_FORMAT="float1";return e}(s);e.exports=h},{"awayjs-display/lib/base/LineSubMesh":undefined,"awayjs-display/lib/base/SubGeometryBase":undefined,"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-display/lib/events/SubGeometryEvent":undefined}],"awayjs-display/lib/base/LineSubMesh":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetType");var s=t("awayjs-display/lib/base/SubMeshBase");var n=function(t){r(e,t);function e(e,i,r){if(r===void 0){r=null}t.call(this);this._pParentMesh=i;this._subGeometry=e;this.material=r}Object.defineProperty(e.prototype,"assetType",{get:function(){return a.LINE_SUB_MESH},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"subGeometry",{get:function(){return this._subGeometry},enumerable:true,configurable:true});e.prototype.dispose=function(){this.material=null;t.prototype.dispose.call(this)};e.prototype._iCollectRenderable=function(t){t.applyLineSubMesh(this)};return e}(s);e.exports=n},{"awayjs-core/lib/library/AssetType":undefined,"awayjs-display/lib/base/SubMeshBase":undefined}],"awayjs-display/lib/base/LoaderInfo":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/EventDispatcher");var s=function(t){r(e,t);function e(){t.apply(this,arguments)}Object.defineProperty(e.prototype,"bytes",{get:function(){return this._bytes},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"bytesLoaded",{get:function(){return this._bytesLoaded},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"bytesTotal",{get:function(){return this._bytesTotal},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"content",{get:function(){return this._content},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"contentType",{get:function(){return this._contentType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"loader",{get:function(){return this._loader},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"url",{get:function(){return this._url},enumerable:true,configurable:true});return e}(a);e.exports=s},{"awayjs-core/lib/events/EventDispatcher":undefined}],"awayjs-display/lib/base/OrientationMode":[function(t,e,i){var r=function(){function t(){}t.DEFAULT="default";t.CAMERA_PLANE="cameraPlane";t.CAMERA_POSITION="cameraPosition";return t}();e.exports=r},{}],"awayjs-display/lib/base/PixelSnapping":[function(t,e,i){var r=function(){function t(){}t.ALWAYS="always";t.AUTO="auto";t.NEVER="never";return t}();e.exports=r},{}],"awayjs-display/lib/base/SpreadMethod":[function(t,e,i){var r=function(){function t(){}t.PAD="pad";t.REFLECT="reflect";t.REPEAT="repeat";return t}();e.exports=r},{}],"awayjs-display/lib/base/SubGeometryBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/NamedAssetBase");var s=t("awayjs-core/lib/errors/AbstractMethodError");var n=t("awayjs-display/lib/events/SubGeometryEvent");var o=function(t){r(e,t);function e(e){t.call(this);this._pStrideOffsetDirty=true;this._pConcatenateArrays=true;this._pStride=new Object;this._pOffset=new Object;this._pConcatenateArrays=e}e.prototype._pUpdateStrideOffset=function(){throw new s};Object.defineProperty(e.prototype,"subMeshClass",{get:function(){return this._pSubMeshClass},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"concatenateArrays",{get:function(){return this._pConcatenateArrays},set:function(t){if(this._pConcatenateArrays==t)return;this._pConcatenateArrays=t;this._pStrideOffsetDirty=true;if(t)this._pNotifyVerticesUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"indices",{get:function(){return this._pIndices},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"vertices",{get:function(){this.updateVertices();return this._pVertices},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numTriangles",{get:function(){return this._numTriangles},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numVertices",{get:function(){return this._pNumVertices},enumerable:true,configurable:true});e.prototype.getStride=function(t){if(this._pStrideOffsetDirty)this._pUpdateStrideOffset();return this._pStride[t]};e.prototype.getOffset=function(t){if(this._pStrideOffsetDirty)this._pUpdateStrideOffset();return this._pOffset[t]};e.prototype.updateVertices=function(){throw new s};e.prototype.dispose=function(){this._pIndices=null;this._pVertices=null};e.prototype.updateIndices=function(t){this._pIndices=t;this._numIndices=t.length;this._numTriangles=this._numIndices/3;this.notifyIndicesUpdate()};e.prototype.pInvalidateBounds=function(){if(this.parentGeometry)this.parentGeometry.iInvalidateBounds(this)};e.prototype.clone=function(){throw new s};e.prototype.applyTransformation=function(t){};e.prototype.scale=function(t){};e.prototype.scaleUV=function(t,e){if(t===void 0){t=1}if(e===void 0){e=1}};e.prototype.getBoundingPositions=function(){throw new s};e.prototype.notifyIndicesUpdate=function(){if(!this._indicesUpdated)this._indicesUpdated=new n(n.INDICES_UPDATED);this.dispatchEvent(this._indicesUpdated)};e.prototype._pNotifyVerticesUpdate=function(){throw new s};e.VERTEX_DATA="vertices";return e}(a);e.exports=o},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/library/NamedAssetBase":undefined,"awayjs-display/lib/events/SubGeometryEvent":undefined}],"awayjs-display/lib/base/SubMeshBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/AbstractMethodError");var s=t("awayjs-core/lib/library/NamedAssetBase");var n=function(t){r(e,t);function e(){t.call(this);this._iIndex=0;this._renderables=new Array}Object.defineProperty(e.prototype,"animator",{get:function(){return this._pParentMesh.animator},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"material",{get:function(){return this._material||this._pParentMesh.material},set:function(t){if(this.material)this.material.iRemoveOwner(this);this._material=t;if(this.material)this.material.iAddOwner(this)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"sceneTransform",{get:function(){return this._pParentMesh.sceneTransform},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"parentMesh",{get:function(){return this._pParentMesh},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"uvTransform",{get:function(){return this._uvTransform||this._pParentMesh.uvTransform},set:function(t){this._uvTransform=t},enumerable:true,configurable:true});e.prototype.dispose=function(){this.material=null;var t=this._renderables.length;for(var e=0;e<t;e++)this._renderables[e].dispose()};e.prototype.getRenderSceneTransform=function(t){return this._pParentMesh.getRenderSceneTransform(t)};e.prototype._iAddRenderable=function(t){this._renderables.push(t);return t};e.prototype._iRemoveRenderable=function(t){var e=this._renderables.indexOf(t);this._renderables.splice(e,1);return t};e.prototype._iInvalidateRenderableGeometry=function(){var t=this._renderables.length;for(var e=0;e<t;e++)this._renderables[e].invalidateGeometry()};e.prototype._iCollectRenderable=function(t){throw new a};e.prototype._iGetExplicitMaterial=function(){return this._material};return e}(s);e.exports=n},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/library/NamedAssetBase":undefined}],"awayjs-display/lib/base/Transform":[function(t,e,i){var r=t("awayjs-core/lib/geom/Matrix3D");var a=t("awayjs-core/lib/geom/Matrix3DUtils");var s=t("awayjs-core/lib/geom/Vector3D");var n=function(){function t(t){this._position=new s;this._displayObject=t}Object.defineProperty(t.prototype,"backVector",{get:function(){var t=a.getForward(this._displayObject._iMatrix3D);t.negate();return t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"concatenatedColorTransform",{get:function(){return this._concatenatedColorTransform},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"concatenatedMatrix",{get:function(){return this._concatenatedMatrix},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"downVector",{get:function(){var t=a.getUp(this._displayObject._iMatrix3D);t.negate();return t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"forwardVector",{get:function(){return a.getForward(this._displayObject._iMatrix3D)},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"leftVector",{get:function(){var t=a.getRight(this._displayObject._iMatrix3D);t.negate();return t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"matrix3D",{get:function(){return this._displayObject._iMatrix3D},set:function(t){this._displayObject._iMatrix3D=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"pixelBounds",{get:function(){return this._pixelBounds},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"position",{get:function(){return this._displayObject._iMatrix3D.position},set:function(t){this._displayObject.x=t.x;this._displayObject.y=t.y;this._displayObject.z=t.z},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"rightVector",{get:function(){return a.getRight(this._displayObject._iMatrix3D)},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"rotation",{get:function(){return new s(this._displayObject.rotationX,this._displayObject.rotationY,this._displayObject.rotationZ)},set:function(t){this._displayObject.rotationX=t.x;this._displayObject.rotationY=t.y;this._displayObject.rotationZ=t.z},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"scale",{get:function(){return new s(this._displayObject.scaleX,this._displayObject.scaleY,this._displayObject.scaleZ)},set:function(t){this._displayObject.scaleX=t.x;this._displayObject.scaleY=t.y;this._displayObject.scaleZ=t.z},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"upVector",{get:function(){return a.getUp(this._displayObject._iMatrix3D)},enumerable:true,configurable:true});t.prototype.getRelativeMatrix3D=function(t){return new r};t.prototype.moveForward=function(t){this._displayObject.translateLocal(s.Z_AXIS,t)};t.prototype.moveBackward=function(t){this._displayObject.translateLocal(s.Z_AXIS,-t)};t.prototype.moveLeft=function(t){this._displayObject.translateLocal(s.X_AXIS,-t)};t.prototype.moveRight=function(t){this._displayObject.translateLocal(s.X_AXIS,t)};t.prototype.moveUp=function(t){this._displayObject.translateLocal(s.Y_AXIS,t)};t.prototype.moveDown=function(t){this._displayObject.translateLocal(s.Y_AXIS,-t)};return t}();e.exports=n},{"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-display/lib/base/TriangleCulling":[function(t,e,i){var r=function(){function t(){}t.NEGATIVE="negative";t.NONE="none";t.POSITIVE="positive";return t}();e.exports=r},{}],"awayjs-display/lib/base/TriangleSubGeometry":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-display/lib/base/SubGeometryBase");var n=t("awayjs-display/lib/base/TriangleSubMesh");var o=t("awayjs-display/lib/events/SubGeometryEvent");var h=function(t){r(e,t);function e(e){t.call(this,e);this._positionsDirty=true;this._faceNormalsDirty=true;this._faceTangentsDirty=true;this._vertexNormalsDirty=true;this._vertexTangentsDirty=true;this._uvsDirty=true;this._secondaryUVsDirty=true;this._jointIndicesDirty=true;this._jointWeightsDirty=true;this._concatenateArrays=true;this._autoDeriveNormals=true;this._autoDeriveTangents=true;this._autoDeriveUVs=false;this._useFaceWeights=false;this._scaleU=1;this._scaleV=1;this._pSubMeshClass=n}Object.defineProperty(e.prototype,"scaleU",{get:function(){return this._scaleU},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scaleV",{get:function(){return this._scaleV},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"useCondensedIndices",{get:function(){return this._useCondensedIndices},set:function(t){if(this._useCondensedIndices==t)return;this._useCondensedIndices=t;this.notifyJointIndicesUpdate()},enumerable:true,configurable:true});e.prototype._pUpdateStrideOffset=function(){if(this._concatenateArrays){this._pOffset[e.VERTEX_DATA]=0;this._pOffset[e.POSITION_DATA]=0;var t=3;if(this._vertexNormals!=null){this._pOffset[e.NORMAL_DATA]=t;t+=3}if(this._vertexTangents!=null){this._pOffset[e.TANGENT_DATA]=t;t+=3}if(this._uvs!=null){this._pOffset[e.UV_DATA]=t;t+=2}if(this._secondaryUVs!=null){this._pOffset[e.SECONDARY_UV_DATA]=t;t+=2}if(this._jointIndices!=null){this._pOffset[e.JOINT_INDEX_DATA]=t;t+=this._jointsPerVertex}if(this._jointWeights!=null){this._pOffset[e.JOINT_WEIGHT_DATA]=t;t+=this._jointsPerVertex}this._pStride[e.VERTEX_DATA]=t;this._pStride[e.POSITION_DATA]=t;this._pStride[e.NORMAL_DATA]=t;this._pStride[e.TANGENT_DATA]=t;this._pStride[e.UV_DATA]=t;this._pStride[e.SECONDARY_UV_DATA]=t;this._pStride[e.JOINT_INDEX_DATA]=t;this._pStride[e.JOINT_WEIGHT_DATA]=t;var i=this._pNumVertices*t;if(this._pVertices==null)this._pVertices=new Array(i);else if(this._pVertices.length!=i)this._pVertices.length=i}else{this._pOffset[e.POSITION_DATA]=0;this._pOffset[e.NORMAL_DATA]=0;this._pOffset[e.TANGENT_DATA]=0;this._pOffset[e.UV_DATA]=0;this._pOffset[e.SECONDARY_UV_DATA]=0;this._pOffset[e.JOINT_INDEX_DATA]=0;this._pOffset[e.JOINT_WEIGHT_DATA]=0;this._pStride[e.POSITION_DATA]=3;this._pStride[e.NORMAL_DATA]=3;this._pStride[e.TANGENT_DATA]=3;this._pStride[e.UV_DATA]=2;this._pStride[e.SECONDARY_UV_DATA]=2;this._pStride[e.JOINT_INDEX_DATA]=this._jointsPerVertex;this._pStride[e.JOINT_WEIGHT_DATA]=this._jointsPerVertex}this._pStrideOffsetDirty=false};Object.defineProperty(e.prototype,"jointsPerVertex",{get:function(){return this._jointsPerVertex},set:function(t){if(this._jointsPerVertex==t)return;this._jointsPerVertex=t;this._pStrideOffsetDirty=true;if(this._pConcatenateArrays)this._pNotifyVerticesUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"autoDeriveUVs",{get:function(){return this._autoDeriveUVs},set:function(t){if(this._autoDeriveUVs==t)return;this._autoDeriveUVs=t;if(t)this.notifyUVsUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"autoDeriveNormals",{get:function(){return this._autoDeriveNormals},set:function(t){if(this._autoDeriveNormals==t)return;this._autoDeriveNormals=t;if(t)this.notifyNormalsUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"autoDeriveTangents",{get:function(){return this._autoDeriveTangents},set:function(t){if(this._autoDeriveTangents==t)return;this._autoDeriveTangents=t;if(t)this.notifyTangentsUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"vertices",{get:function(){if(this._positionsDirty)this.updatePositions(this._positions);if(this._vertexNormalsDirty)this.updateVertexNormals(this._vertexNormals);if(this._vertexTangentsDirty)this.updateVertexTangents(this._vertexTangents);if(this._uvsDirty)this.updateUVs(this._uvs);if(this._secondaryUVsDirty)this.updateSecondaryUVs(this._secondaryUVs);if(this._jointIndicesDirty)this.updateJointIndices(this._jointIndices);if(this._jointWeightsDirty)this.updateJointWeights(this._jointWeights);return this._pVertices},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"positions",{get:function(){if(this._positionsDirty)this.updatePositions(this._positions);return this._positions},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"vertexNormals",{get:function(){if(this._vertexNormalsDirty)this.updateVertexNormals(this._vertexNormals);return this._vertexNormals},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"vertexTangents",{get:function(){if(this._vertexTangentsDirty)this.updateVertexTangents(this._vertexTangents);return this._vertexTangents},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"faceNormals",{get:function(){if(this._faceNormalsDirty)this.updateFaceNormals();return this._faceNormals},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"faceTangents",{get:function(){if(this._faceTangentsDirty)this.updateFaceTangents();return this._faceTangents},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"uvs",{get:function(){if(this._uvsDirty)this.updateUVs(this._uvs);return this._uvs},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"secondaryUVs",{get:function(){if(this._secondaryUVsDirty)this.updateSecondaryUVs(this._secondaryUVs);return this._secondaryUVs},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"jointIndices",{get:function(){if(this._jointIndicesDirty)this.updateJointIndices(this._jointIndices);if(this._useCondensedIndices)return this._condensedJointIndices;return this._jointIndices},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"jointWeights",{get:function(){if(this._jointWeightsDirty)this.updateJointWeights(this._jointWeights);return this._jointWeights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"useFaceWeights",{get:function(){return this._useFaceWeights},set:function(t){if(this._useFaceWeights==t)return;this._useFaceWeights=t;if(this._autoDeriveNormals)this.notifyNormalsUpdate();if(this._autoDeriveTangents)this.notifyTangentsUpdate();this._faceNormalsDirty=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numCondensedJoints",{get:function(){if(this._jointIndicesDirty)this.updateJointIndices(this._jointIndices);return this._numCondensedJoints},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"condensedIndexLookUp",{get:function(){if(this._jointIndicesDirty)this.updateJointIndices(this._jointIndices);return this._condensedIndexLookUp},enumerable:true,configurable:true});e.prototype.getBoundingPositions=function(){if(this._positionsDirty)this.updatePositions(this._positions);return this._positions};e.prototype.updatePositions=function(t){var i;var r;var a;var s;this._positions=t;if(this._positions==null)this._positions=new Array;this._pNumVertices=this._positions.length/3;if(this._concatenateArrays){var n=this._pNumVertices*this.getStride(e.VERTEX_DATA);if(this._pVertices==null)this._pVertices=new Array(n);else if(this._pVertices.length!=n)this._pVertices.length=n;i=0;r=this.getOffset(e.POSITION_DATA);a=this.getStride(e.POSITION_DATA);s=this._pVertices;while(i<t.length){s[r]=t[i++];s[r+1]=t[i++];s[r+2]=t[i++];r+=a}}if(this._autoDeriveNormals)this.notifyNormalsUpdate();if(this._autoDeriveTangents)this.notifyTangentsUpdate();if(this._autoDeriveUVs)this.notifyUVsUpdate();this.pInvalidateBounds();this.notifyPositionsUpdate();this._positionsDirty=false};e.prototype.updateVertexNormals=function(t){var i;var r;var a;var s;var n;if(!this._autoDeriveNormals){if((this._vertexNormals==null||t==null)&&(this._vertexNormals!=null||t!=null)){if(this._concatenateArrays)this._pNotifyVerticesUpdate();else this._pStrideOffsetDirty=true}this._vertexNormals=t;if(t!=null&&this._concatenateArrays){i=0;r=this.getOffset(e.NORMAL_DATA);s=this.getStride(e.NORMAL_DATA);n=this._pVertices;while(i<t.length){n[r]=t[i++];n[r+1]=t[i++];n[r+2]=t[i++];r+=s}}}else{if(this._vertexNormals==null){this._vertexNormals=new Array(this._positions.length);if(this._concatenateArrays)this._pNotifyVerticesUpdate();else this._pStrideOffsetDirty=true}if(this._faceNormalsDirty)this.updateFaceNormals();a=this.getOffset(e.NORMAL_DATA);s=this.getStride(e.NORMAL_DATA);n=this._concatenateArrays?this._pVertices:this._vertexNormals;var o=0;var h=1;var l=2;r=a;var u=n.length;while(r<u){n[r]=0;n[r+1]=0;n[r+2]=0;r+=s}var p=0;var c=this._pIndices.length;var d;i=0;while(i<c){d=this._useFaceWeights?this._faceWeights[p++]:1;r=a+this._pIndices[i++]*s;n[r]+=this._faceNormals[o]*d;n[r+1]+=this._faceNormals[h]*d;n[r+2]+=this._faceNormals[l]*d;r=a+this._pIndices[i++]*s;n[r]+=this._faceNormals[o]*d;n[r+1]+=this._faceNormals[h]*d;n[r+2]+=this._faceNormals[l]*d;r=a+this._pIndices[i++]*s;n[r]+=this._faceNormals[o]*d;n[r+1]+=this._faceNormals[h]*d;n[r+2]+=this._faceNormals[l]*d;o+=3;h+=3;l+=3}i=0;r=a;while(r<u){var f=n[r];var _=n[r+1];var y=n[r+2];var g=1/Math.sqrt(f*f+_*_+y*y);if(this._concatenateArrays){this._vertexNormals[i++]=n[r]=f*g;this._vertexNormals[i++]=n[r+1]=_*g;this._vertexNormals[i++]=n[r+2]=y*g}else{n[r]=f*g;n[r+1]=_*g;n[r+2]=y*g}r+=s}}this.notifyNormalsUpdate();this._vertexNormalsDirty=false};e.prototype.updateVertexTangents=function(t){var i;var r;var a;var s;var n;if(!this._autoDeriveTangents){if((this._vertexTangents==null||t==null)&&(this._vertexTangents!=null||t!=null)){if(this._concatenateArrays)this._pNotifyVerticesUpdate();else this._pStrideOffsetDirty=true}this._vertexTangents=t;if(t!=null&&this._concatenateArrays){i=0;r=this.getOffset(e.TANGENT_DATA);s=this.getStride(e.TANGENT_DATA);n=this._pVertices;while(i<t.length){n[r]=t[i++];n[r+1]=t[i++];n[r+2]=t[i++];r+=s}}}else{if(this._vertexTangents==null){this._vertexTangents=new Array(this._positions.length);if(this._concatenateArrays)this._pNotifyVerticesUpdate();else this._pStrideOffsetDirty=true}if(this._faceTangentsDirty)this.updateFaceTangents();a=this.getOffset(e.TANGENT_DATA);s=this.getStride(e.TANGENT_DATA);n=this._concatenateArrays?this._pVertices:this._vertexTangents;r=a;var o=n.length;while(r<o){n[r]=0;n[r+1]=0;n[r+2]=0;r+=s}var h=0;var l;var u=0;var p=1;var c=2;i=0;var d=this._pIndices.length;while(i<d){l=this._useFaceWeights?this._faceWeights[h++]:1;r=a+this._pIndices[i++]*s;n[r++]+=this._faceTangents[u]*l;n[r++]+=this._faceTangents[p]*l;n[r]+=this._faceTangents[c]*l;r=a+this._pIndices[i++]*s;n[r++]+=this._faceTangents[u]*l;n[r++]+=this._faceTangents[p]*l;n[r]+=this._faceTangents[c]*l;r=a+this._pIndices[i++]*s;n[r++]+=this._faceTangents[u]*l;n[r++]+=this._faceTangents[p]*l;n[r]+=this._faceTangents[c]*l;u+=3;p+=3;c+=3}i=0;r=a;while(r<o){var f=n[r];var _=n[r+1];var y=n[r+2];var g=1/Math.sqrt(f*f+_*_+y*y);if(this._concatenateArrays){this._vertexTangents[i++]=n[r]=f*g;this._vertexTangents[i++]=n[r+1]=_*g;this._vertexTangents[i++]=n[r+2]=y*g}else{n[r]=f*g;n[r+1]=_*g;n[r+2]=y*g}r+=s}}this.notifyTangentsUpdate();this._vertexTangentsDirty=false};e.prototype.updateUVs=function(t){var i;var r;var a;var s;var n;if(!this._autoDeriveUVs){if((this._uvs==null||t==null)&&(this._uvs!=null||t!=null)){if(this._concatenateArrays)this._pNotifyVerticesUpdate();else this._pStrideOffsetDirty=true}this._uvs=t;if(t!=null&&this._concatenateArrays){i=0;r=this.getOffset(e.UV_DATA);s=this.getStride(e.UV_DATA);n=this._pVertices;while(i<t.length){n[r]=t[i++];n[r+1]=t[i++];r+=s}}}else{if(this._uvs==null){this._uvs=new Array(this._positions.length*2/3);if(this._concatenateArrays)this._pNotifyVerticesUpdate();else this._pStrideOffsetDirty=true}a=this.getOffset(e.UV_DATA);s=this.getStride(e.UV_DATA);n=this._concatenateArrays?this._pVertices:this._uvs;i=0;r=a;var o=0;var h=n.length;while(r<h){if(this._concatenateArrays){this._uvs[i++]=n[r]=o*.5;this._uvs[i++]=n[r+1]=1-(o&1)}else{n[r]=o*.5;n[r+1]=1-(o&1)}if(++o==3)o=0;r+=s}}if(this._autoDeriveTangents)this.notifyTangentsUpdate();this.notifyUVsUpdate();this._uvsDirty=false};e.prototype.updateSecondaryUVs=function(t){var i;var r;var a;var s;var n;if(this._concatenateArrays&&(this._secondaryUVs==null||t==null)&&(this._secondaryUVs!=null||t!=null))this._pNotifyVerticesUpdate();this._secondaryUVs=t;if(t!=null&&this._concatenateArrays){a=this.getOffset(e.SECONDARY_UV_DATA);s=this.getStride(e.SECONDARY_UV_DATA);i=0;r=a;n=this._pVertices;while(i<t.length){n[r]=t[i++];n[r+1]=t[i++];r+=s}}this.notifySecondaryUVsUpdate();this._secondaryUVsDirty=false};e.prototype.updateJointIndices=function(t){var i;var r;var a;var s;var n;var o;if(this._concatenateArrays&&(this._jointIndices==null||t==null)&&(this._jointIndices!=null||t!=null))this._pNotifyVerticesUpdate();this._jointIndices=t;if(t!=null){s=this.getOffset(e.JOINT_INDEX_DATA);n=this.getStride(e.JOINT_INDEX_DATA);if(this._useCondensedIndices){i=0;r=0;a=s;o=this._concatenateArrays?this._pVertices:this._condensedJointIndices;
var h;var l=0;var u=new Object;if(!this._concatenateArrays)this._condensedJointIndices=new Array(t.length);this._condensedIndexLookUp=new Array;while(i<t.length){for(r=0;r<this._jointsPerVertex;r++){h=t[i++];if(u[h]==undefined){u[h]=l*3;this._condensedIndexLookUp[l++]=h}o[a+r]=u[h]}a+=n}this._numCondensedJoints=l}else if(this._concatenateArrays){i=0;a=s;o=this._pVertices;while(i<t.length){r=0;while(r<this._jointsPerVertex)o[a+r++]=t[i++];a+=n}}}this.notifyJointIndicesUpdate();this._jointIndicesDirty=false};e.prototype.updateJointWeights=function(t){var i;var r;var a;var s;var n;var o;if(this._concatenateArrays&&(this._jointWeights==null||t==null)&&(this._jointWeights!=null||t!=null))this._pNotifyVerticesUpdate();this._jointWeights=t;if(t!=null&&this._concatenateArrays){s=this.getOffset(e.JOINT_WEIGHT_DATA);n=this.getStride(e.JOINT_WEIGHT_DATA);i=0;a=s;o=this._pVertices;while(i<t.length){r=0;while(r<this._jointsPerVertex)o[a+r++]=t[i++];a+=n}}this.notifyJointWeightsUpdate();this._jointWeightsDirty=false};e.prototype.dispose=function(){t.prototype.dispose.call(this);this._positions=null;this._vertexNormals=null;this._vertexTangents=null;this._uvs=null;this._secondaryUVs=null;this._jointIndices=null;this._jointWeights=null;this._faceNormals=null;this._faceWeights=null;this._faceTangents=null};e.prototype.updateIndices=function(e){t.prototype.updateIndices.call(this,e);this._faceNormalsDirty=true;if(this._autoDeriveNormals)this._vertexNormalsDirty=true;if(this._autoDeriveTangents)this._vertexTangentsDirty=true;if(this._autoDeriveUVs)this._uvsDirty=true};e.prototype.clone=function(){var t=new e(this._concatenateArrays);t.updateIndices(this._pIndices.concat());t.updatePositions(this._positions.concat());if(this._vertexNormals&&!this._autoDeriveNormals)t.updateVertexNormals(this._vertexNormals.concat());else t.updateVertexNormals(null);if(this._uvs&&!this._autoDeriveUVs)t.updateUVs(this._uvs.concat());else t.updateUVs(null);if(this._vertexTangents&&!this._autoDeriveTangents)t.updateVertexTangents(this._vertexTangents.concat());else t.updateVertexTangents(null);if(this._secondaryUVs)t.updateSecondaryUVs(this._secondaryUVs.concat());if(this._jointIndices){t.jointsPerVertex=this._jointsPerVertex;t.updateJointIndices(this._jointIndices.concat())}if(this._jointWeights)t.updateJointWeights(this._jointWeights.concat());return t};e.prototype.scaleUV=function(t,e){if(t===void 0){t=1}if(e===void 0){e=1}var i;var r;var a;var s;s=this._uvs;var n=t/this._scaleU;var o=e/this._scaleV;this._scaleU=t;this._scaleV=e;var h=s.length;r=0;a=2;i=r;while(i<h){s[i]*=n;s[i+1]*=o;i+=a}this.notifyUVsUpdate()};e.prototype.scale=function(t){var e;var i;var r;var a;var s;s=this._positions;var n=s.length;r=0;a=3;e=0;i=r;while(e<n){s[i]*=t;s[i+1]*=t;s[i+2]*=t;e+=3;i+=a}this.notifyPositionsUpdate()};e.prototype.applyTransformation=function(t){var i;var r;var s;if(this._concatenateArrays){i=this._pVertices;r=this._pVertices;s=this._pVertices}else{i=this._positions;r=this._vertexNormals;s=this._vertexTangents}var n=this._positions.length/3;var o;var h;var l;var u=new a;var p=this._vertexNormals!=null;var c=this._vertexTangents!=null;var d;if(p||c){d=t.clone();d.invert();d.transpose()}var f=this.getOffset(e.POSITION_DATA);var _=this.getOffset(e.NORMAL_DATA);var y=this.getOffset(e.TANGENT_DATA);var g=this.getStride(e.POSITION_DATA);var m=this.getStride(e.NORMAL_DATA);var b=this.getStride(e.TANGENT_DATA);for(o=0;o<n;++o){h=f+1;l=f+2;u.x=i[f];u.y=i[h];u.z=i[l];u=t.transformVector(u);i[f]=u.x;i[h]=u.y;i[l]=u.z;f+=g;if(p){h=_+1;l=_+2;u.x=r[_];u.y=r[h];u.z=r[l];u=d.deltaTransformVector(u);u.normalize();r[_]=u.x;r[h]=u.y;r[l]=u.z;_+=m}if(c){h=y+1;l=y+2;u.x=s[y];u.y=s[h];u.z=s[l];u=d.deltaTransformVector(u);u.normalize();s[y]=u.x;s[h]=u.y;s[l]=u.z;y+=b}}this.notifyPositionsUpdate();this.notifyNormalsUpdate();this.notifyTangentsUpdate()};e.prototype.updateFaceTangents=function(){var t=0;var e;var i;var r;var a;var s;var n;var o;var h;var l,u,p;var c,d,f;var _,y,g;var m,b,v;var w=this._positions;var x=this._uvs;var P=this._pIndices.length;if(this._faceTangents==null)this._faceTangents=new Array(P);while(t<P){e=this._pIndices[t];i=this._pIndices[t+1];r=this._pIndices[t+2];s=x[e*2+1];n=x[i*2+1]-s;o=x[r*2+1]-s;a=e*3;l=w[a];u=w[a+1];p=w[a+2];a=i*3;c=w[a]-l;d=w[a+1]-u;f=w[a+2]-p;a=r*3;_=w[a]-l;y=w[a+1]-u;g=w[a+2]-p;m=o*c-n*_;b=o*d-n*y;v=o*f-n*g;h=1/Math.sqrt(m*m+b*b+v*v);this._faceTangents[t++]=h*m;this._faceTangents[t++]=h*b;this._faceTangents[t++]=h*v}this._faceTangentsDirty=false};e.prototype.updateFaceNormals=function(){var t=0;var e=0;var i=0;var r;var a;var s;var n,o,h;var l,u,p;var c,d,f;var _,y,g;var m,b,v;var w,x,P;var D;var C=this._positions;var T=this._pIndices.length;if(this._faceNormals==null)this._faceNormals=new Array(T);if(this._useFaceWeights&&this._faceWeights==null)this._faceWeights=new Array(T/3);while(t<T){r=this._pIndices[t++]*3;n=C[r];l=C[r+1];c=C[r+2];r=this._pIndices[t++]*3;o=C[r];u=C[r+1];d=C[r+2];r=this._pIndices[t++]*3;h=C[r];p=C[r+1];f=C[r+2];_=h-n;y=p-l;g=f-c;m=o-n;b=u-l;v=d-c;w=g*b-y*v;x=_*v-g*m;P=y*m-_*b;D=Math.sqrt(w*w+x*x+P*P);if(this._useFaceWeights){var A=D*1e4;if(A<1)A=1;this._faceWeights[i++]=A}D=1/D;this._faceNormals[e++]=w*D;this._faceNormals[e++]=x*D;this._faceNormals[e++]=P*D}this._faceNormalsDirty=false};e.prototype._pNotifyVerticesUpdate=function(){this._pStrideOffsetDirty=true;this.notifyPositionsUpdate();this.notifyNormalsUpdate();this.notifyTangentsUpdate();this.notifyUVsUpdate();this.notifySecondaryUVsUpdate();this.notifyJointIndicesUpdate();this.notifyJointWeightsUpdate()};e.prototype.notifyPositionsUpdate=function(){if(this._positionsDirty)return;this._positionsDirty=true;if(!this._positionsUpdated)this._positionsUpdated=new o(o.VERTICES_UPDATED,e.POSITION_DATA);this.dispatchEvent(this._positionsUpdated)};e.prototype.notifyNormalsUpdate=function(){if(this._vertexNormalsDirty)return;this._vertexNormalsDirty=true;if(!this._normalsUpdated)this._normalsUpdated=new o(o.VERTICES_UPDATED,e.NORMAL_DATA);this.dispatchEvent(this._normalsUpdated)};e.prototype.notifyTangentsUpdate=function(){if(this._vertexTangentsDirty)return;this._vertexTangentsDirty=true;if(!this._tangentsUpdated)this._tangentsUpdated=new o(o.VERTICES_UPDATED,e.TANGENT_DATA);this.dispatchEvent(this._tangentsUpdated)};e.prototype.notifyUVsUpdate=function(){if(this._uvsDirty)return;this._uvsDirty=true;if(!this._uvsUpdated)this._uvsUpdated=new o(o.VERTICES_UPDATED,e.UV_DATA);this.dispatchEvent(this._uvsUpdated)};e.prototype.notifySecondaryUVsUpdate=function(){if(this._secondaryUVsDirty)return;this._secondaryUVsDirty=true;if(!this._secondaryUVsUpdated)this._secondaryUVsUpdated=new o(o.VERTICES_UPDATED,e.SECONDARY_UV_DATA);this.dispatchEvent(this._secondaryUVsUpdated)};e.prototype.notifyJointIndicesUpdate=function(){if(this._jointIndicesDirty)return;this._jointIndicesDirty=true;if(!this._jointIndicesUpdated)this._jointIndicesUpdated=new o(o.VERTICES_UPDATED,e.JOINT_INDEX_DATA);this.dispatchEvent(this._jointIndicesUpdated)};e.prototype.notifyJointWeightsUpdate=function(){if(this._jointWeightsDirty)return;this._jointWeightsDirty=true;if(!this._jointWeightsUpdated)this._jointWeightsUpdated=new o(o.VERTICES_UPDATED,e.JOINT_WEIGHT_DATA);this.dispatchEvent(this._jointWeightsUpdated)};e.POSITION_DATA="positions";e.NORMAL_DATA="vertexNormals";e.TANGENT_DATA="vertexTangents";e.UV_DATA="uvs";e.SECONDARY_UV_DATA="secondaryUVs";e.JOINT_INDEX_DATA="jointIndices";e.JOINT_WEIGHT_DATA="jointWeights";e.POSITION_FORMAT="float3";e.NORMAL_FORMAT="float3";e.TANGENT_FORMAT="float3";e.UV_FORMAT="float2";e.SECONDARY_UV_FORMAT="float2";return e}(s);e.exports=h},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/base/SubGeometryBase":undefined,"awayjs-display/lib/base/TriangleSubMesh":undefined,"awayjs-display/lib/events/SubGeometryEvent":undefined}],"awayjs-display/lib/base/TriangleSubMesh":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetType");var s=t("awayjs-display/lib/base/SubMeshBase");var n=function(t){r(e,t);function e(e,i,r){if(r===void 0){r=null}t.call(this);this._pParentMesh=i;this._subGeometry=e;this.material=r}Object.defineProperty(e.prototype,"assetType",{get:function(){return a.TRIANGLE_SUB_MESH},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"subGeometry",{get:function(){return this._subGeometry},enumerable:true,configurable:true});e.prototype.dispose=function(){t.prototype.dispose.call(this)};e.prototype._iCollectRenderable=function(t){t.applyTriangleSubMesh(this)};return e}(s);e.exports=n},{"awayjs-core/lib/library/AssetType":undefined,"awayjs-display/lib/base/SubMeshBase":undefined}],"awayjs-display/lib/containers/DisplayObjectContainer":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetType");var s=t("awayjs-core/lib/errors/ArgumentError");var n=t("awayjs-core/lib/errors/Error");var o=t("awayjs-core/lib/errors/RangeError");var h=t("awayjs-display/lib/base/DisplayObject");var l=function(t){r(e,t);function e(){t.call(this);this._mouseChildren=true;this._children=new Array}Object.defineProperty(e.prototype,"assetType",{get:function(){return a.CONTAINER},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"mouseChildren",{get:function(){return this._mouseChildren},set:function(t){if(this._mouseChildren==t)return;this._mouseChildren=t;this._pUpdateImplicitMouseEnabled(this._pParent?this._pParent.mouseChildren:true)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numChildren",{get:function(){return this._children.length},enumerable:true,configurable:true});e.prototype.addChild=function(t){if(t==null)throw new n("Parameter child cannot be null.");if(t._pParent)t._pParent.removeChildInternal(t);t.iSetParent(this);this._children.push(t);return t};e.prototype.addChildAt=function(t,e){return t};e.prototype.addChildren=function(){var t=[];for(var e=0;e<arguments.length;e++){t[e-0]=arguments[e]}var i=t.length;for(var r=0;r<i;r++)this.addChild(t[r])};e.prototype.clone=function(){var t=new e;t.pivot=this.pivot;t._iMatrix3D=this._iMatrix3D;t.partition=this.partition;t.name=name;var i=this._children.length;for(var r=0;r<i;++r)t.addChild(this._children[r].clone());return t};e.prototype.contains=function(t){return this._children.indexOf(t)>=0};e.prototype.disposeWithChildren=function(){this.dispose();while(this.numChildren>0)this.getChildAt(0).dispose()};e.prototype.getChildAt=function(t){var e=this._children[t];if(e==null)throw new o("Index does not exist in the child list of the caller");return e};e.prototype.getChildByName=function(t){var e=this._children.length;for(var i=0;i<e;++i)if(this._children[i].name==t)return this._children[i];return null};e.prototype.getChildIndex=function(t){var e=this._children.indexOf(t);if(e==-1)throw new s("Child parameter is not a child of the caller");return e};e.prototype.getObjectsUnderPoint=function(t){return new Array};e.prototype.removeChild=function(t){if(t==null)throw new n("Parameter child cannot be null");this.removeChildInternal(t);t.iSetParent(null);return t};e.prototype.removeChildAt=function(t){return this.removeChild(this._children[t])};e.prototype.removeChildren=function(t,e){if(t===void 0){t=0}if(e===void 0){e=2147483647}if(t<0)throw new o("beginIndex is out of range of the child list");if(e>this._children.length)throw new o("endIndex is out of range of the child list");for(var i=t;i<e;i++)this.removeChild(this._children[i])};e.prototype.setChildIndex=function(t,e){};e.prototype.swapChildren=function(t,e){};e.prototype.swapChildrenAt=function(t,e){};e.prototype.pInvalidateSceneTransform=function(){t.prototype.pInvalidateSceneTransform.call(this);var e=this._children.length;for(var i=0;i<e;++i)this._children[i].pInvalidateSceneTransform()};e.prototype._pUpdateScene=function(e){t.prototype._pUpdateScene.call(this,e);var i=this._children.length;for(var r=0;r<i;++r)this._children[r]._pUpdateScene(e)};e.prototype._pUpdateImplicitMouseEnabled=function(e){t.prototype._pUpdateImplicitMouseEnabled.call(this,e);var i=this._children.length;for(var r=0;r<i;++r)this._children[r]._pUpdateImplicitMouseEnabled(this._mouseChildren)};e.prototype._pUpdateImplicitVisibility=function(e){t.prototype._pUpdateImplicitVisibility.call(this,e);var i=this._children.length;for(var r=0;r<i;++r)this._children[r]._pUpdateImplicitVisibility(this._pImplicitVisibility)};e.prototype._pUpdateImplicitPartition=function(e){t.prototype._pUpdateImplicitPartition.call(this,e);var i=this._children.length;for(var r=0;r<i;++r)this._children[r]._pUpdateImplicitPartition(this._pImplicitPartition)};e.prototype.removeChildInternal=function(t){this._children.splice(this.getChildIndex(t),1);return t};return e}(h);e.exports=l},{"awayjs-core/lib/errors/ArgumentError":undefined,"awayjs-core/lib/errors/Error":undefined,"awayjs-core/lib/errors/RangeError":undefined,"awayjs-core/lib/library/AssetType":undefined,"awayjs-display/lib/base/DisplayObject":undefined}],"awayjs-display/lib/containers/Loader":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetLibraryBundle");var s=t("awayjs-core/lib/library/AssetLoader");var n=t("awayjs-core/lib/events/AssetEvent");var o=t("awayjs-core/lib/events/IOErrorEvent");var h=t("awayjs-core/lib/events/LoaderEvent");var l=t("awayjs-core/lib/events/ParserEvent");var u=t("awayjs-display/lib/containers/DisplayObjectContainer");var p=function(t){r(e,t);function e(e,i){var r=this;if(e===void 0){e=true}if(i===void 0){i=null}t.call(this);this._loadingSessions=new Array;this._useAssetLib=e;this._assetLibId=i;this._onResourceCompleteDelegate=function(t){return r.onResourceComplete(t)};this._onAssetCompleteDelegate=function(t){return r.onAssetComplete(t)}}Object.defineProperty(e.prototype,"content",{get:function(){return this._content},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"contentLoaderInfo",{get:function(){return this._contentLoaderInfo},enumerable:true,configurable:true});e.prototype.close=function(){if(this._useAssetLib){var t;t=a.getInstance(this._assetLibId);t.stopAllLoadingSessions();this._loadingSessions=null;return}var e;var i=this._loadingSessions.length;for(e=0;e<i;e++){this.removeListeners(this._loadingSessions[e]);this._loadingSessions[e].stop();this._loadingSessions[e]=null}this._loadingSessions=null};e.prototype.load=function(t,e,i,r){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=null}var o;if(this._useAssetLib){var l;l=a.getInstance(this._assetLibId);o=l.load(t,e,i,r)}else{var u=new s;this._loadingSessions.push(u);o=u.load(t,e,i,r)}o.addEventListener(h.RESOURCE_COMPLETE,this._onResourceCompleteDelegate);o.addEventListener(n.ASSET_COMPLETE,this._onAssetCompleteDelegate);o._iLoader._iAddErrorHandler(this.onLoadError);o._iLoader._iAddParseErrorHandler(this.onParseError);return o};e.prototype.loadData=function(t,e,i,r){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=null}var o;if(this._useAssetLib){var l;l=a.getInstance(this._assetLibId);o=l.loadData(t,e,i,r)}else{var u=new s;this._loadingSessions.push(u);o=u.loadData(t,"",e,i,r)}o.addEventListener(h.RESOURCE_COMPLETE,this._onResourceCompleteDelegate);o.addEventListener(n.ASSET_COMPLETE,this._onAssetCompleteDelegate);o._iLoader._iAddErrorHandler(this.onLoadError);o._iLoader._iAddParseErrorHandler(this.onParseError);return o};e.prototype.unload=function(){};e.enableParser=function(t){s.enableParser(t)};e.enableParsers=function(t){s.enableParsers(t)};e.prototype.removeListeners=function(t){t.removeEventListener(h.RESOURCE_COMPLETE,this._onResourceCompleteDelegate);t.removeEventListener(n.ASSET_COMPLETE,this._onAssetCompleteDelegate)};e.prototype.onAssetComplete=function(t){this.dispatchEvent(t)};e.prototype.onLoadError=function(t){if(this.hasEventListener(o.IO_ERROR)){this.dispatchEvent(t);return true}else{return false}};e.prototype.onParseError=function(t){if(this.hasEventListener(l.PARSE_ERROR)){this.dispatchEvent(t);return true}else{return false}};e.prototype.onResourceComplete=function(t){this._content=t.content;if(this._content)this.addChild(this._content);this.dispatchEvent(t)};return e}(u);e.exports=p},{"awayjs-core/lib/events/AssetEvent":undefined,"awayjs-core/lib/events/IOErrorEvent":undefined,"awayjs-core/lib/events/LoaderEvent":undefined,"awayjs-core/lib/events/ParserEvent":undefined,"awayjs-core/lib/library/AssetLibraryBundle":undefined,"awayjs-core/lib/library/AssetLoader":undefined,"awayjs-display/lib/containers/DisplayObjectContainer":undefined}],"awayjs-display/lib/containers/Scene":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/EventDispatcher");var s=t("awayjs-display/lib/containers/DisplayObjectContainer");var n=t("awayjs-display/lib/events/SceneEvent");var o=t("awayjs-display/lib/partition/NodeBase");var h=t("awayjs-display/lib/partition/Partition");var l=function(t){r(e,t);function e(){t.call(this);this._expandedPartitions=new Array;this._partitions=new Array;this._iCollectionMark=0;this._iSceneGraphRoot=new s;this._iSceneGraphRoot._iSetScene(this);this._iSceneGraphRoot._iIsRoot=true;this._iSceneGraphRoot.partition=new h(new o)}e.prototype.traversePartitions=function(t){var e=0;var i=this._partitions.length;t.scene=this;while(e<i){this._iCollectionMark++;this._partitions[e++].traverse(t)}};Object.defineProperty(e.prototype,"partition",{get:function(){return this._iSceneGraphRoot.partition},set:function(t){this._iSceneGraphRoot.partition=t;this.dispatchEvent(new n(n.PARTITION_CHANGED,this._iSceneGraphRoot))},enumerable:true,configurable:true});e.prototype.contains=function(t){return this._iSceneGraphRoot.contains(t)};e.prototype.addChild=function(t){return this._iSceneGraphRoot.addChild(t)};e.prototype.removeChild=function(t){this._iSceneGraphRoot.removeChild(t)};e.prototype.removeChildAt=function(t){this._iSceneGraphRoot.removeChildAt(t)};e.prototype.getChildAt=function(t){return this._iSceneGraphRoot.getChildAt(t)};Object.defineProperty(e.prototype,"numChildren",{get:function(){return this._iSceneGraphRoot.numChildren},enumerable:true,configurable:true});e.prototype.iRegisterEntity=function(t){if(t.partition)this.iRegisterPartition(t.partition);if(t.isEntity)t._iAssignedPartition.iMarkForUpdate(t)};e.prototype.iRegisterPartition=function(t){this._expandedPartitions.push(t);if(this._partitions.indexOf(t)==-1)this._partitions.push(t)};e.prototype.iUnregisterEntity=function(t){if(t.partition)this.iUnregisterPartition(t.partition);if(t.isEntity)t._iAssignedPartition.iRemoveEntity(t)};e.prototype.iUnregisterPartition=function(t){this._expandedPartitions.splice(this._expandedPartitions.indexOf(t),1);if(this._expandedPartitions.indexOf(t)==-1)this._partitions.splice(this._partitions.indexOf(t),1)};return e}(a);e.exports=l},{"awayjs-core/lib/events/EventDispatcher":undefined,"awayjs-display/lib/containers/DisplayObjectContainer":undefined,"awayjs-display/lib/events/SceneEvent":undefined,"awayjs-display/lib/partition/NodeBase":undefined,"awayjs-display/lib/partition/Partition":undefined}],"awayjs-display/lib/containers/View":[function(t,e,i){var r=t("awayjs-core/lib/utils/getTimer");var a=t("awayjs-display/lib/containers/Scene");var s=t("awayjs-display/lib/pick/RaycastPicker");var n=t("awayjs-display/lib/entities/Camera");var o=t("awayjs-display/lib/events/CameraEvent");var h=t("awayjs-display/lib/events/SceneEvent");var l=t("awayjs-display/lib/events/RendererEvent");var u=t("awayjs-display/lib/managers/MouseManager");var p=function(){function t(t,e,i){var r=this;if(e===void 0){e=null}if(i===void 0){i=null}this._width=0;this._height=0;this._time=0;this._deltaTime=0;this._backgroundColor=0;this._backgroundAlpha=1;this._viewportDirty=true;this._scissorDirty=true;this._mousePicker=new s;this._onScenePartitionChangedDelegate=function(t){return r.onScenePartitionChanged(t)};this._onProjectionChangedDelegate=function(t){return r.onProjectionChanged(t)};this._onViewportUpdatedDelegate=function(t){return r.onViewportUpdated(t)};this._onScissorUpdatedDelegate=function(t){return r.onScissorUpdated(t)};this.scene=e||new a;this.camera=i||new n;this.renderer=t;document.body.style.margin="0px";this._htmlElement=document.createElement("div");this._htmlElement.style.position="absolute";document.body.appendChild(this._htmlElement);this._mouseManager=u.getInstance();this._mouseManager.registerView(this)}t.prototype.onScenePartitionChanged=function(t){if(this._pCamera)this._pCamera.partition=this.scene.partition};Object.defineProperty(t.prototype,"mouseX",{get:function(){return this._pMouseX},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"mouseY",{get:function(){return this._pMouseY},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"htmlElement",{get:function(){return this._htmlElement},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"renderer",{get:function(){return this._pRenderer},set:function(t){if(this._pRenderer==t)return;if(this._pRenderer){this._pRenderer.dispose();this._pRenderer.removeEventListener(l.VIEWPORT_UPDATED,this._onViewportUpdatedDelegate);this._pRenderer.removeEventListener(l.SCISSOR_UPDATED,this._onScissorUpdatedDelegate)}this._pRenderer=t;this._pRenderer.addEventListener(l.VIEWPORT_UPDATED,this._onViewportUpdatedDelegate);this._pRenderer.addEventListener(l.SCISSOR_UPDATED,this._onScissorUpdatedDelegate);this._pEntityCollector=this._pRenderer._iCreateEntityCollector();if(this._pCamera)this._pEntityCollector.camera=this._pCamera;this._pRenderer._iBackgroundR=(this._backgroundColor>>16&255)/255;this._pRenderer._iBackgroundG=(this._backgroundColor>>8&255)/255;this._pRenderer._iBackgroundB=(this._backgroundColor&255)/255;this._pRenderer._iBackgroundAlpha=this._backgroundAlpha;this._pRenderer.width=this._width;this._pRenderer.height=this._height;this._pRenderer.shareContext=this._shareContext},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"shareContext",{get:function(){return this._shareContext},set:function(t){if(this._shareContext==t)return;this._shareContext=t;if(this._pRenderer)this._pRenderer.shareContext=this._shareContext},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(t){if(this._backgroundColor==t)return;this._backgroundColor=t;this._pRenderer._iBackgroundR=(t>>16&255)/255;this._pRenderer._iBackgroundG=(t>>8&255)/255;this._pRenderer._iBackgroundB=(t&255)/255},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"backgroundAlpha",{get:function(){return this._backgroundAlpha},set:function(t){if(t>1)t=1;else if(t<0)t=0;if(this._backgroundAlpha==t)return;this._pRenderer._iBackgroundAlpha=this._backgroundAlpha=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"camera",{get:function(){return this._pCamera},set:function(t){if(this._pCamera==t)return;if(this._pCamera)this._pCamera.removeEventListener(o.PROJECTION_CHANGED,this._onProjectionChangedDelegate);this._pCamera=t;if(this._pEntityCollector)this._pEntityCollector.camera=this._pCamera;if(this._pScene)this._pCamera.partition=this._pScene.partition;this._pCamera.addEventListener(o.PROJECTION_CHANGED,this._onProjectionChangedDelegate);this._scissorDirty=true;this._viewportDirty=true},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"scene",{get:function(){return this._pScene},set:function(t){if(this._pScene==t)return;if(this._pScene)this._pScene.removeEventListener(h.PARTITION_CHANGED,this._onScenePartitionChangedDelegate);this._pScene=t;this._pScene.addEventListener(h.PARTITION_CHANGED,this._onScenePartitionChangedDelegate);if(this._pCamera)this._pCamera.partition=this._pScene.partition},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"deltaTime",{get:function(){return this._deltaTime},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(t){if(this._width==t)return;this._width=t;this._aspectRatio=this._width/this._height;this._pCamera.projection._iAspectRatio=this._aspectRatio;this._pRenderer.width=t;this._htmlElement.style.width=t+"px"},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(t){if(this._height==t)return;this._height=t;this._aspectRatio=this._width/this._height;this._pCamera.projection._iAspectRatio=this._aspectRatio;this._pRenderer.height=t;this._htmlElement.style.height=t+"px"},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"mousePicker",{get:function(){return this._mousePicker},set:function(t){if(this._mousePicker==t)return;if(t==null)this._mousePicker=new s;else this._mousePicker=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"x",{get:function(){return this._pRenderer.x},set:function(t){if(this._pRenderer.x==t)return;this._pRenderer.x==t;this._htmlElement.style.left=t+"px"},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"y",{get:function(){return this._pRenderer.y},set:function(t){if(this._pRenderer.y==t)return;this._pRenderer.y==t;this._htmlElement.style.top=t+"px"},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"visible",{get:function(){return this._htmlElement.style.visibility=="visible"},set:function(t){this._htmlElement.style.visibility=t?"visible":"hidden"},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"renderedFacesCount",{get:function(){return 0},enumerable:true,configurable:true});t.prototype.render=function(){this.pUpdateTime();this._pCamera.projection._iAspectRatio=this._aspectRatio;if(this._scissorDirty){this._scissorDirty=false;this._pCamera.projection._iUpdateScissorRect(this._pRenderer.scissorRect.x,this._pRenderer.scissorRect.y,this._pRenderer.scissorRect.width,this._pRenderer.scissorRect.height)}if(this._viewportDirty){this._viewportDirty=false;this._pCamera.projection._iUpdateViewport(this._pRenderer.viewPort.x,this._pRenderer.viewPort.y,this._pRenderer.viewPort.width,this._pRenderer.viewPort.height)}if(!this._shareContext){if(this.forceMouseMove&&this._htmlElement==this._mouseManager._iActiveDiv&&!this._mouseManager._iUpdateDirty)this._mouseManager._iCollidingObject=this.mousePicker.getViewCollision(this._pMouseX,this._pMouseY,this);this._mouseManager.fireMouseEvents(this.forceMouseMove)}this._pEntityCollector.clear();this._pScene.traversePartitions(this._pEntityCollector);this._pRenderer.render(this._pEntityCollector)};t.prototype.pUpdateTime=function(){var t=r();if(this._time==0)this._time=t;this._deltaTime=t-this._time;this._time=t};t.prototype.dispose=function(){this._pRenderer.dispose();this._mouseManager.unregisterView(this);this._mouseManager=null;this._pRenderer=null;this._pEntityCollector=null};Object.defineProperty(t.prototype,"iEntityCollector",{get:function(){return this._pEntityCollector},enumerable:true,configurable:true});t.prototype.onProjectionChanged=function(t){this._scissorDirty=true;this._viewportDirty=true};t.prototype.onViewportUpdated=function(t){this._viewportDirty=true};t.prototype.onScissorUpdated=function(t){this._scissorDirty=true};t.prototype.project=function(t){var e=this._pCamera.project(t);e.x=e.x*this._pRenderer.viewPort.width/2+this._width*this._pCamera.projection.originX;e.y=e.y*this._pRenderer.viewPort.height/2+this._height*this._pCamera.projection.originY;return e};t.prototype.unproject=function(t,e,i){return this._pCamera.unproject(2*(t-this._width*this._pCamera.projection.originX)/this._pRenderer.viewPort.width,2*(e-this._height*this._pCamera.projection.originY)/this._pRenderer.viewPort.height,i)};t.prototype.getRay=function(t,e,i){return this._pCamera.getRay((t*2-this._width)/this._width,(e*2-this._height)/this._height,i)};t.prototype.updateCollider=function(){if(!this._shareContext){if(this._htmlElement==this._mouseManager._iActiveDiv)this._mouseManager._iCollidingObject=this.mousePicker.getViewCollision(this._pMouseX,this._pMouseY,this)}else{var t=this.mousePicker.getViewCollision(this._pMouseX,this._pMouseY,this);if(this.layeredView||this._mouseManager._iCollidingObject==null||t.rayEntryDistance<this._mouseManager._iCollidingObject.rayEntryDistance)this._mouseManager._iCollidingObject=t}};return t}();e.exports=p},{"awayjs-core/lib/utils/getTimer":undefined,"awayjs-display/lib/containers/Scene":undefined,"awayjs-display/lib/entities/Camera":undefined,"awayjs-display/lib/events/CameraEvent":undefined,"awayjs-display/lib/events/RendererEvent":undefined,"awayjs-display/lib/events/SceneEvent":undefined,"awayjs-display/lib/managers/MouseManager":undefined,"awayjs-display/lib/pick/RaycastPicker":undefined}],"awayjs-display/lib/controllers/ControllerBase":[function(t,e,i){var r=t("awayjs-core/lib/errors/AbstractMethodError");var a=function(){function t(t){if(t===void 0){t=null}this._pAutoUpdate=true;this.targetObject=t}t.prototype.pNotifyUpdate=function(){if(this._pTargetObject&&this._pTargetObject._iAssignedPartition&&this._pAutoUpdate){this._pTargetObject._iAssignedPartition.iMarkForUpdate(this._pTargetObject)}};Object.defineProperty(t.prototype,"targetObject",{get:function(){return this._pTargetObject},set:function(t){if(this._pTargetObject==t){return}if(this._pTargetObject&&this._pAutoUpdate){this._pTargetObject._iController=null}this._pTargetObject=t;if(this._pTargetObject&&this._pAutoUpdate){this._pTargetObject._iController=this}this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"autoUpdate",{get:function(){return this._pAutoUpdate},set:function(t){if(this._pAutoUpdate==t){return}this._pAutoUpdate=t;if(this._pTargetObject){if(this._pTargetObject){this._pTargetObject._iController=this}else{this._pTargetObject._iController=null}}},enumerable:true,configurable:true});t.prototype.update=function(t){if(t===void 0){t=true}throw new r};return t}();e.exports=a},{"awayjs-core/lib/errors/AbstractMethodError":undefined}],"awayjs-display/lib/controllers/FirstPersonController":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/MathConsts");var s=t("awayjs-display/lib/controllers/ControllerBase");var n=function(t){r(e,t);function e(e,i,r,a,s,n,o){if(e===void 0){e=null}if(i===void 0){i=0}if(r===void 0){r=90}if(a===void 0){a=-90}if(s===void 0){s=90}if(n===void 0){n=8}if(o===void 0){o=false}t.call(this,e);this._iCurrentPanAngle=0;this._iCurrentTiltAngle=90;this._panAngle=0;this._tiltAngle=90;this._minTiltAngle=-90;this._maxTiltAngle=90;this._steps=8;this._walkIncrement=0;this._strafeIncrement=0;this._wrapPanAngle=false;this.fly=false;this.panAngle=i;this.tiltAngle=r;this.minTiltAngle=a;this.maxTiltAngle=s;this.steps=n;this.wrapPanAngle=o;this._iCurrentPanAngle=this._panAngle;this._iCurrentTiltAngle=this._tiltAngle}Object.defineProperty(e.prototype,"steps",{get:function(){return this._steps},set:function(t){t=t<1?1:t;if(this._steps==t)return;this._steps=t;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"panAngle",{get:function(){return this._panAngle},set:function(t){if(this._panAngle==t)return;this._panAngle=t;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"tiltAngle",{get:function(){return this._tiltAngle},set:function(t){t=Math.max(this._minTiltAngle,Math.min(this._maxTiltAngle,t));
if(this._tiltAngle==t)return;this._tiltAngle=t;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"minTiltAngle",{get:function(){return this._minTiltAngle},set:function(t){if(this._minTiltAngle==t)return;this._minTiltAngle=t;this.tiltAngle=Math.max(this._minTiltAngle,Math.min(this._maxTiltAngle,this._tiltAngle))},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"maxTiltAngle",{get:function(){return this._maxTiltAngle},set:function(t){if(this._maxTiltAngle==t)return;this._maxTiltAngle=t;this.tiltAngle=Math.max(this._minTiltAngle,Math.min(this._maxTiltAngle,this._tiltAngle))},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"wrapPanAngle",{get:function(){return this._wrapPanAngle},set:function(t){if(this._wrapPanAngle==t)return;this._wrapPanAngle=t;this.pNotifyUpdate()},enumerable:true,configurable:true});e.prototype.update=function(t){if(t===void 0){t=true}if(this._tiltAngle!=this._iCurrentTiltAngle||this._panAngle!=this._iCurrentPanAngle){this.pNotifyUpdate();if(this._wrapPanAngle){if(this._panAngle<0){this._iCurrentPanAngle+=this._panAngle%360+360-this._panAngle;this._panAngle=this._panAngle%360+360}else{this._iCurrentPanAngle+=this._panAngle%360-this._panAngle;this._panAngle=this._panAngle%360}while(this._panAngle-this._iCurrentPanAngle<-180)this._iCurrentPanAngle-=360;while(this._panAngle-this._iCurrentPanAngle>180)this._iCurrentPanAngle+=360}if(t){this._iCurrentTiltAngle+=(this._tiltAngle-this._iCurrentTiltAngle)/(this.steps+1);this._iCurrentPanAngle+=(this._panAngle-this._iCurrentPanAngle)/(this.steps+1)}else{this._iCurrentTiltAngle=this._tiltAngle;this._iCurrentPanAngle=this._panAngle}if(Math.abs(this.tiltAngle-this._iCurrentTiltAngle)<.01&&Math.abs(this._panAngle-this._iCurrentPanAngle)<.01){this._iCurrentTiltAngle=this._tiltAngle;this._iCurrentPanAngle=this._panAngle}}this.targetObject.rotationX=this._iCurrentTiltAngle;this.targetObject.rotationY=this._iCurrentPanAngle;if(this._walkIncrement){if(this.fly){this.targetObject.transform.moveForward(this._walkIncrement)}else{this.targetObject.x+=this._walkIncrement*Math.sin(this._panAngle*a.DEGREES_TO_RADIANS);this.targetObject.z+=this._walkIncrement*Math.cos(this._panAngle*a.DEGREES_TO_RADIANS)}this._walkIncrement=0}if(this._strafeIncrement){this.targetObject.transform.moveRight(this._strafeIncrement);this._strafeIncrement=0}};e.prototype.incrementWalk=function(t){if(t==0)return;this._walkIncrement+=t;this.pNotifyUpdate()};e.prototype.incrementStrafe=function(t){if(t==0)return;this._strafeIncrement+=t;this.pNotifyUpdate()};return e}(s);e.exports=n},{"awayjs-core/lib/geom/MathConsts":undefined,"awayjs-display/lib/controllers/ControllerBase":undefined}],"awayjs-display/lib/controllers/FollowController":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/controllers/HoverController");var s=function(t){r(e,t);function e(e,i,r,a){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=45}if(a===void 0){a=700}t.call(this,e,i,0,r,a)}e.prototype.update=function(e){if(e===void 0){e=true}e=e;if(!this.lookAtObject)return;this.panAngle=this._pLookAtObject.rotationY-180;t.prototype.update.call(this)};return e}(a);e.exports=s},{"awayjs-display/lib/controllers/HoverController":undefined}],"awayjs-display/lib/controllers/HoverController":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/MathConsts");var s=t("awayjs-core/lib/geom/Vector3D");var n=t("awayjs-display/lib/controllers/LookAtController");var o=function(t){r(e,t);function e(e,i,r,a,n,o,h,l,u,p,c,d){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=0}if(a===void 0){a=90}if(n===void 0){n=1e3}if(o===void 0){o=-90}if(h===void 0){h=90}if(l===void 0){l=null}if(u===void 0){u=null}if(p===void 0){p=8}if(c===void 0){c=2}if(d===void 0){d=false}t.call(this,e,i);this._iCurrentPanAngle=0;this._iCurrentTiltAngle=90;this._panAngle=0;this._tiltAngle=90;this._distance=1e3;this._minPanAngle=-Infinity;this._maxPanAngle=Infinity;this._minTiltAngle=-90;this._maxTiltAngle=90;this._steps=8;this._yFactor=2;this._wrapPanAngle=false;this._upAxis=new s;this.distance=n;this.panAngle=r;this.tiltAngle=a;this.minPanAngle=l!=null?l:-Infinity;this.maxPanAngle=u!=null?u:Infinity;this.minTiltAngle=o;this.maxTiltAngle=h;this.steps=p;this.yFactor=c;this.wrapPanAngle=d;this._iCurrentPanAngle=this._panAngle;this._iCurrentTiltAngle=this._tiltAngle}Object.defineProperty(e.prototype,"steps",{get:function(){return this._steps},set:function(t){t=t<1?1:t;if(this._steps==t)return;this._steps=t;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"panAngle",{get:function(){return this._panAngle},set:function(t){t=Math.max(this._minPanAngle,Math.min(this._maxPanAngle,t));if(this._panAngle==t)return;this._panAngle=t;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"tiltAngle",{get:function(){return this._tiltAngle},set:function(t){t=Math.max(this._minTiltAngle,Math.min(this._maxTiltAngle,t));if(this._tiltAngle==t)return;this._tiltAngle=t;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},set:function(t){if(this._distance==t)return;this._distance=t;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"minPanAngle",{get:function(){return this._minPanAngle},set:function(t){if(this._minPanAngle==t)return;this._minPanAngle=t;this.panAngle=Math.max(this._minPanAngle,Math.min(this._maxPanAngle,this._panAngle))},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"maxPanAngle",{get:function(){return this._maxPanAngle},set:function(t){if(this._maxPanAngle==t)return;this._maxPanAngle=t;this.panAngle=Math.max(this._minPanAngle,Math.min(this._maxPanAngle,this._panAngle))},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"minTiltAngle",{get:function(){return this._minTiltAngle},set:function(t){if(this._minTiltAngle==t)return;this._minTiltAngle=t;this.tiltAngle=Math.max(this._minTiltAngle,Math.min(this._maxTiltAngle,this._tiltAngle))},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"maxTiltAngle",{get:function(){return this._maxTiltAngle},set:function(t){if(this._maxTiltAngle==t)return;this._maxTiltAngle=t;this.tiltAngle=Math.max(this._minTiltAngle,Math.min(this._maxTiltAngle,this._tiltAngle))},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"yFactor",{get:function(){return this._yFactor},set:function(t){if(this._yFactor==t)return;this._yFactor=t;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"wrapPanAngle",{get:function(){return this._wrapPanAngle},set:function(t){if(this._wrapPanAngle==t)return;this._wrapPanAngle=t;this.pNotifyUpdate()},enumerable:true,configurable:true});e.prototype.update=function(t){if(t===void 0){t=true}if(this._tiltAngle!=this._iCurrentTiltAngle||this._panAngle!=this._iCurrentPanAngle){this.pNotifyUpdate();if(this._wrapPanAngle){if(this._panAngle<0){this._iCurrentPanAngle+=this._panAngle%360+360-this._panAngle;this._panAngle=this._panAngle%360+360}else{this._iCurrentPanAngle+=this._panAngle%360-this._panAngle;this._panAngle=this._panAngle%360}while(this._panAngle-this._iCurrentPanAngle<-180)this._iCurrentPanAngle-=360;while(this._panAngle-this._iCurrentPanAngle>180)this._iCurrentPanAngle+=360}if(t){this._iCurrentTiltAngle+=(this._tiltAngle-this._iCurrentTiltAngle)/(this.steps+1);this._iCurrentPanAngle+=(this._panAngle-this._iCurrentPanAngle)/(this.steps+1)}else{this._iCurrentPanAngle=this._panAngle;this._iCurrentTiltAngle=this._tiltAngle}if(Math.abs(this.tiltAngle-this._iCurrentTiltAngle)<.01&&Math.abs(this._panAngle-this._iCurrentPanAngle)<.01){this._iCurrentTiltAngle=this._tiltAngle;this._iCurrentPanAngle=this._panAngle}}var e=this.lookAtObject?this.lookAtObject.transform.position:this.lookAtPosition?this.lookAtPosition:this._pOrigin;this.targetObject.x=e.x+this.distance*Math.sin(this._iCurrentPanAngle*a.DEGREES_TO_RADIANS)*Math.cos(this._iCurrentTiltAngle*a.DEGREES_TO_RADIANS);this.targetObject.y=e.y+this.distance*Math.sin(this._iCurrentTiltAngle*a.DEGREES_TO_RADIANS)*this.yFactor;this.targetObject.z=e.z+this.distance*Math.cos(this._iCurrentPanAngle*a.DEGREES_TO_RADIANS)*Math.cos(this._iCurrentTiltAngle*a.DEGREES_TO_RADIANS);this._upAxis.x=-Math.sin(this._iCurrentPanAngle*a.DEGREES_TO_RADIANS)*Math.sin(this._iCurrentTiltAngle*a.DEGREES_TO_RADIANS);this._upAxis.y=Math.cos(this._iCurrentTiltAngle*a.DEGREES_TO_RADIANS);this._upAxis.z=-Math.cos(this._iCurrentPanAngle*a.DEGREES_TO_RADIANS)*Math.sin(this._iCurrentTiltAngle*a.DEGREES_TO_RADIANS);if(this._pTargetObject){if(this._pLookAtPosition)this._pTargetObject.lookAt(this._pLookAtPosition,this._upAxis);else if(this._pLookAtObject)this._pTargetObject.lookAt(this._pLookAtObject.scene?this._pLookAtObject.scenePosition:this._pLookAtObject.transform.position,this._upAxis)}};return e}(n);e.exports=o},{"awayjs-core/lib/geom/MathConsts":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/controllers/LookAtController":undefined}],"awayjs-display/lib/controllers/LookAtController":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-display/lib/controllers/ControllerBase");var n=t("awayjs-display/lib/events/DisplayObjectEvent");var o=function(t){r(e,t);function e(e,i){var r=this;if(e===void 0){e=null}if(i===void 0){i=null}t.call(this,e);this._pOrigin=new a(0,0,0);this._onLookAtObjectChangedDelegate=function(t){return r.onLookAtObjectChanged(t)};if(i)this.lookAtObject=i;else this.lookAtPosition=new a}Object.defineProperty(e.prototype,"lookAtPosition",{get:function(){return this._pLookAtPosition},set:function(t){if(this._pLookAtObject){this._pLookAtObject.removeEventListener(n.SCENETRANSFORM_CHANGED,this._onLookAtObjectChangedDelegate);this._pLookAtObject=null}this._pLookAtPosition=t;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lookAtObject",{get:function(){return this._pLookAtObject},set:function(t){if(this._pLookAtPosition)this._pLookAtPosition=null;if(this._pLookAtObject==t)return;if(this._pLookAtObject)this._pLookAtObject.removeEventListener(n.SCENETRANSFORM_CHANGED,this._onLookAtObjectChangedDelegate);this._pLookAtObject=t;if(this._pLookAtObject)this._pLookAtObject.addEventListener(n.SCENETRANSFORM_CHANGED,this._onLookAtObjectChangedDelegate);this.pNotifyUpdate()},enumerable:true,configurable:true});e.prototype.update=function(t){if(t===void 0){t=true}if(this._pTargetObject){if(this._pLookAtPosition)this._pTargetObject.lookAt(this._pLookAtPosition);else if(this._pLookAtObject)this._pTargetObject.lookAt(this._pLookAtObject.scene?this._pLookAtObject.scenePosition:this._pLookAtObject.transform.position)}};e.prototype.onLookAtObjectChanged=function(t){this.pNotifyUpdate()};return e}(s);e.exports=o},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/controllers/ControllerBase":undefined,"awayjs-display/lib/events/DisplayObjectEvent":undefined}],"awayjs-display/lib/controllers/SpringController":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-display/lib/controllers/LookAtController");var n=function(t){r(e,t);function e(e,i,r,s,n){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=1}if(s===void 0){s=40}if(n===void 0){n=4}t.call(this,e,i);this.positionOffset=new a(0,500,-1e3);this.stiffness=r;this.damping=n;this.mass=s;this._velocity=new a;this._dv=new a;this._stretch=new a;this._force=new a;this._acceleration=new a;this._desiredPosition=new a}e.prototype.update=function(e){if(e===void 0){e=true}var i;if(!this._pLookAtObject||!this._pTargetObject)return;i=this._pLookAtObject.transform.matrix3D.deltaTransformVector(this.positionOffset);this._desiredPosition.x=this._pLookAtObject.x+i.x;this._desiredPosition.y=this._pLookAtObject.y+i.y;this._desiredPosition.z=this._pLookAtObject.z+i.z;this._stretch=this._pTargetObject.transform.position.add(this._desiredPosition);this._stretch.scaleBy(-this.stiffness);this._dv.copyFrom(this._velocity);this._dv.scaleBy(this.damping);this._force.x=this._stretch.x-this._dv.x;this._force.y=this._stretch.y-this._dv.y;this._force.z=this._stretch.z-this._dv.z;this._acceleration.copyFrom(this._force);this._acceleration.scaleBy(1/this.mass);this._velocity.incrementBy(this._acceleration);this._pTargetObject.transform.position=this._pTargetObject.transform.position.add(this._velocity);t.prototype.update.call(this)};return e}(s);e.exports=n},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/controllers/LookAtController":undefined}],"awayjs-display/lib/display/ContextMode":[function(t,e,i){var r=function(){function t(){}t.AUTO="auto";t.WEBGL="webgl";t.FLASH="flash";t.NATIVE="native";return t}();e.exports=r},{}],"awayjs-display/lib/display/IContext":[function(t,e,i){},{}],"awayjs-display/lib/entities/Billboard":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetType");var s=t("awayjs-display/lib/base/DisplayObject");var n=t("awayjs-display/lib/partition/EntityNode");var o=t("awayjs-display/lib/events/MaterialEvent");var h=function(t){r(e,t);function e(e,i,r){var a=this;if(i===void 0){i="auto"}if(r===void 0){r=false}t.call(this);this._pIsEntity=true;this.onSizeChangedDelegate=function(t){return a.onSizeChanged(t)};this.material=e;this._billboardWidth=e.width;this._billboardHeight=e.height}Object.defineProperty(e.prototype,"animator",{get:function(){return this._animator},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"assetType",{get:function(){return a.BILLBOARD},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"billboardHeight",{get:function(){return this._billboardHeight},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"billboardWidth",{get:function(){return this._billboardWidth},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"material",{get:function(){return this._material},set:function(t){if(t==this._material)return;if(this._material){this._material.iRemoveOwner(this);this._material.removeEventListener(o.SIZE_CHANGED,this.onSizeChangedDelegate)}this._material=t;if(this._material){this._material.iAddOwner(this);this._material.addEventListener(o.SIZE_CHANGED,this.onSizeChangedDelegate)}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"uvTransform",{get:function(){return this._uvTransform},set:function(t){this._uvTransform=t},enumerable:true,configurable:true});e.prototype.pCreateEntityPartitionNode=function(){return new n(this)};e.prototype.pUpdateBounds=function(){this._pBounds.fromExtremes(0,0,0,this._billboardWidth,this._billboardHeight,0);t.prototype.pUpdateBounds.call(this)};e.prototype._iTestCollision=function(t,e){return this._pPickingCollider.testBillboardCollision(this,this._pPickingCollisionVO,t)};e.prototype.onSizeChanged=function(t){this._billboardWidth=this._material.width;this._billboardHeight=this._material.height;this._pBoundsInvalid=true;var e=this._pRenderables.length;for(var i=0;i<e;i++)this._pRenderables[i].invalidateVertexData("vertices")};e.prototype._iCollectRenderables=function(t){if(this._iSourcePrefab)this._iSourcePrefab._iValidate();this._iCollectRenderable(t)};e.prototype._iCollectRenderable=function(t){t.applyBillboard(this)};return e}(s);e.exports=h},{"awayjs-core/lib/library/AssetType":undefined,"awayjs-display/lib/base/DisplayObject":undefined,"awayjs-display/lib/events/MaterialEvent":undefined,"awayjs-display/lib/partition/EntityNode":undefined}],"awayjs-display/lib/entities/Camera":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/bounds/NullBounds");var s=t("awayjs-core/lib/geom/Matrix3D");var n=t("awayjs-core/lib/geom/Plane3D");var o=t("awayjs-core/lib/library/AssetType");var h=t("awayjs-core/lib/events/ProjectionEvent");var l=t("awayjs-core/lib/projections/PerspectiveProjection");var u=t("awayjs-display/lib/containers/DisplayObjectContainer");var p=t("awayjs-display/lib/events/CameraEvent");var c=t("awayjs-display/lib/partition/CameraNode");var d=function(t){r(e,t);function e(e){var i=this;if(e===void 0){e=null}t.call(this);this._viewProjection=new s;this._viewProjectionDirty=true;this._frustumPlanesDirty=true;this._pIsEntity=true;this._onProjectionMatrixChangedDelegate=function(t){return i.onProjectionMatrixChanged(t)};this._projection=e||new l;this._projection.addEventListener(h.MATRIX_CHANGED,this._onProjectionMatrixChangedDelegate);this._frustumPlanes=[];for(var r=0;r<6;++r)this._frustumPlanes[r]=new n;this.z=-1e3}e.prototype.pCreateDefaultBoundingVolume=function(){return new a};e.prototype.pCreateEntityPartitionNode=function(){return new c(this)};Object.defineProperty(e.prototype,"assetType",{get:function(){return o.CAMERA},enumerable:true,configurable:true});e.prototype.onProjectionMatrixChanged=function(t){this._viewProjectionDirty=true;this._frustumPlanesDirty=true;this.dispatchEvent(t)};Object.defineProperty(e.prototype,"frustumPlanes",{get:function(){if(this._frustumPlanesDirty)this.updateFrustum();return this._frustumPlanes},enumerable:true,configurable:true});e.prototype.updateFrustum=function(){var t,e,i;var r,a,s,n;var o,h,l,u;var p,c,d,f;var _,y,g,m;var b;var v=new Array(16);var w;this.viewProjection.copyRawDataTo(v);r=v[0];a=v[4];s=v[8];n=v[12];o=v[1];h=v[5];l=v[9];u=v[13];p=v[2];c=v[6];d=v[10];f=v[14];_=v[3];y=v[7];g=v[11];m=v[15];b=this._frustumPlanes[0];t=_+r;e=y+a;i=g+s;w=1/Math.sqrt(t*t+e*e+i*i);b.a=t*w;b.b=e*w;b.c=i*w;b.d=-(m+n)*w;b=this._frustumPlanes[1];t=_-r;e=y-a;i=g-s;w=1/Math.sqrt(t*t+e*e+i*i);b.a=t*w;b.b=e*w;b.c=i*w;b.d=(n-m)*w;b=this._frustumPlanes[2];t=_+o;e=y+h;i=g+l;w=1/Math.sqrt(t*t+e*e+i*i);b.a=t*w;b.b=e*w;b.c=i*w;b.d=-(m+u)*w;b=this._frustumPlanes[3];t=_-o;e=y-h;i=g-l;w=1/Math.sqrt(t*t+e*e+i*i);b.a=t*w;b.b=e*w;b.c=i*w;b.d=(u-m)*w;b=this._frustumPlanes[4];t=p;e=c;i=d;w=1/Math.sqrt(t*t+e*e+i*i);b.a=t*w;b.b=e*w;b.c=i*w;b.d=-f*w;b=this._frustumPlanes[5];t=_-p;e=y-c;i=g-d;w=1/Math.sqrt(t*t+e*e+i*i);b.a=t*w;b.b=e*w;b.c=i*w;b.d=(f-m)*w;this._frustumPlanesDirty=false};e.prototype.pInvalidateSceneTransform=function(){t.prototype.pInvalidateSceneTransform.call(this);this._viewProjectionDirty=true;this._frustumPlanesDirty=true};e.prototype.pUpdateBounds=function(){this._pBoundsInvalid=false;this._pBounds.nullify()};Object.defineProperty(e.prototype,"projection",{get:function(){return this._projection},set:function(t){if(this._projection==t)return;if(!t)throw new Error("Projection cannot be null!");this._projection.removeEventListener(h.MATRIX_CHANGED,this._onProjectionMatrixChangedDelegate);this._projection=t;this._projection.addEventListener(h.MATRIX_CHANGED,this._onProjectionMatrixChangedDelegate);this.dispatchEvent(new p(p.PROJECTION_CHANGED,this))},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"viewProjection",{get:function(){if(this._viewProjectionDirty){this._viewProjection.copyFrom(this.inverseSceneTransform);this._viewProjection.append(this._projection.matrix);this._viewProjectionDirty=false}return this._viewProjection},enumerable:true,configurable:true});e.prototype.getRay=function(t,e,i){return this.sceneTransform.deltaTransformVector(this._projection.unproject(t,e,i))};e.prototype.project=function(t){return this._projection.project(this.inverseSceneTransform.transformVector(t))};e.prototype.unproject=function(t,e,i){return this.sceneTransform.transformVector(this._projection.unproject(t,e,i))};e.prototype._iCollectRenderables=function(t){if(this._iSourcePrefab)this._iSourcePrefab._iValidate();this._iCollectRenderable(t)};e.prototype._iCollectRenderable=function(t){};return e}(u);e.exports=d},{"awayjs-core/lib/bounds/NullBounds":undefined,"awayjs-core/lib/events/ProjectionEvent":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Plane3D":undefined,"awayjs-core/lib/library/AssetType":undefined,"awayjs-core/lib/projections/PerspectiveProjection":undefined,"awayjs-display/lib/containers/DisplayObjectContainer":undefined,"awayjs-display/lib/events/CameraEvent":undefined,"awayjs-display/lib/partition/CameraNode":undefined}],"awayjs-display/lib/entities/DirectionalLight":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/bounds/NullBounds");var s=t("awayjs-core/lib/geom/Matrix3D");var n=t("awayjs-core/lib/geom/Vector3D");var o=t("awayjs-display/lib/base/LightBase");var h=t("awayjs-display/lib/partition/DirectionalLightNode");var l=t("awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper");var u=function(t){r(e,t);function e(e,i,r){if(e===void 0){e=0}if(i===void 0){i=-1}if(r===void 0){r=1}t.call(this);this._pIsEntity=true;this.direction=new n(e,i,r);this._sceneDirection=new n}Object.defineProperty(e.prototype,"sceneDirection",{get:function(){if(this._pSceneTransformDirty)this.pUpdateSceneTransform();return this._sceneDirection},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"direction",{get:function(){return this._direction},set:function(t){this._direction=t;if(!this._tmpLookAt)this._tmpLookAt=new n;this._tmpLookAt.x=this.x+this._direction.x;this._tmpLookAt.y=this.y+this._direction.y;this._tmpLookAt.z=this.z+this._direction.z;this.lookAt(this._tmpLookAt)},enumerable:true,configurable:true});e.prototype.pCreateDefaultBoundingVolume=function(){return new a};e.prototype.pUpdateBounds=function(){};e.prototype.pUpdateSceneTransform=function(){t.prototype.pUpdateSceneTransform.call(this);this.sceneTransform.copyColumnTo(2,this._sceneDirection);this._sceneDirection.normalize()};e.prototype.pCreateShadowMapper=function(){return new l};e.prototype.pCreateEntityPartitionNode=function(){return new h(this)};e.prototype.iGetObjectProjectionMatrix=function(t,e,i){if(i===void 0){i=null}var r=new Array;var a=t.bounds;var n=new s;n.copyFrom(t.getRenderSceneTransform(e));n.append(this.inverseSceneTransform);if(!this._projAABBPoints)this._projAABBPoints=[];n.transformVectors(a.aabbPoints,this._projAABBPoints);var o=Infinity,h=-Infinity;var l=Infinity,u=-Infinity;var p=Infinity,c=-Infinity;var d;for(var f=0;f<24;){d=this._projAABBPoints[f++];if(d<o)o=d;if(d>h)h=d;d=this._projAABBPoints[f++];if(d<l)l=d;if(d>u)u=d;d=this._projAABBPoints[f++];if(d<p)p=d;if(d>c)c=d}var _=1/(h-o);var y=1/(u-l);var g=1/(c-p);r[0]=2*_;r[5]=2*y;r[10]=g;r[12]=-(h+o)*_;r[13]=-(u+l)*y;r[14]=-p*g;r[1]=r[2]=r[3]=r[4]=r[6]=r[7]=r[8]=r[9]=r[11]=0;r[15]=1;if(!i)i=new s;i.copyRawDataFrom(r);i.prepend(n);return i};e.prototype._iCollectRenderables=function(t){};return e}(o);e.exports=u},{"awayjs-core/lib/bounds/NullBounds":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/base/LightBase":undefined,"awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper":undefined,"awayjs-display/lib/partition/DirectionalLightNode":undefined}],"awayjs-display/lib/entities/IEntity":[function(t,e,i){},{}],"awayjs-display/lib/entities/LightProbe":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/bounds/NullBounds");var s=t("awayjs-core/lib/errors/Error");var n=t("awayjs-display/lib/base/LightBase");var o=t("awayjs-display/lib/partition/LightProbeNode");var h=function(t){r(e,t);function e(e,i){if(i===void 0){i=null}t.call(this);this._pIsEntity=true;this._diffuseMap=e;this._specularMap=i}Object.defineProperty(e.prototype,"diffuseMap",{get:function(){return this._diffuseMap},set:function(t){this._diffuseMap=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"specularMap",{get:function(){return this._specularMap},set:function(t){this._specularMap=t},enumerable:true,configurable:true});e.prototype.pCreateEntityPartitionNode=function(){return new o(this)};e.prototype.pUpdateBounds=function(){this._pBoundsInvalid=false};e.prototype.pCreateDefaultBoundingVolume=function(){return new a};e.prototype.iGetObjectProjectionMatrix=function(t,e,i){if(i===void 0){i=null}throw new s("Object projection matrices are not supported for LightProbe objects!")};e.prototype._iCollectRenderables=function(t){};return e}(n);e.exports=h},{"awayjs-core/lib/bounds/NullBounds":undefined,"awayjs-core/lib/errors/Error":undefined,"awayjs-display/lib/base/LightBase":undefined,"awayjs-display/lib/partition/LightProbeNode":undefined}],"awayjs-display/lib/entities/LineSegment":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetType");var s=t("awayjs-display/lib/base/DisplayObject");var n=t("awayjs-display/lib/partition/EntityNode");var o=t("awayjs-display/lib/events/MaterialEvent");var h=function(t){r(e,t);function e(e,i,r,a){var s=this;if(a===void 0){a=1}t.call(this);this._pIsEntity=true;this.onSizeChangedDelegate=function(t){return s.onSizeChanged(t)};this.material=e;this._startPosition=i;this._endPosition=r;this._halfThickness=a*.5}Object.defineProperty(e.prototype,"animator",{get:function(){return this._animator},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"assetType",{get:function(){return a.LINE_SEGMENT},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"startPostion",{get:function(){return this._startPosition},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"startPosition",{set:function(t){if(this._startPosition==t)return;this._startPosition=t;this.notifyRenderableUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"endPosition",{get:function(){return this._endPosition},set:function(t){if(this._endPosition==t)return;this._endPosition=t;this.notifyRenderableUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"material",{get:function(){return this._material},set:function(t){if(t==this._material)return;if(this._material){this._material.iRemoveOwner(this);this._material.removeEventListener(o.SIZE_CHANGED,this.onSizeChangedDelegate)}this._material=t;if(this._material){this._material.iAddOwner(this);this._material.addEventListener(o.SIZE_CHANGED,this.onSizeChangedDelegate)}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"thickness",{get:function(){return this._halfThickness*2},set:function(t){if(this._halfThickness==t)return;this._halfThickness=t*.5;this.notifyRenderableUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"uvTransform",{get:function(){return this._uvTransform},set:function(t){this._uvTransform=t},enumerable:true,configurable:true});e.prototype.dispose=function(){this._startPosition=null;this._endPosition=null};e.prototype.pCreateEntityPartitionNode=function(){return new n(this)};e.prototype.pUpdateBounds=function(){this._pBounds.fromExtremes(this._startPosition.x,this._startPosition.y,this._startPosition.z,this._endPosition.x,this._endPosition.y,this._endPosition.z);t.prototype.pUpdateBounds.call(this)};e.prototype.onSizeChanged=function(t){this.notifyRenderableUpdate()};e.prototype.notifyRenderableUpdate=function(){var t=this._pRenderables.length;for(var e=0;e<t;e++)this._pRenderables[e].invalidateVertexData("vertices")};e.prototype._iCollectRenderables=function(t){if(this._iSourcePrefab)this._iSourcePrefab._iValidate();this._iCollectRenderable(t)};e.prototype._iCollectRenderable=function(t){};return e}(s);e.exports=h},{"awayjs-core/lib/library/AssetType":undefined,"awayjs-display/lib/base/DisplayObject":undefined,"awayjs-display/lib/events/MaterialEvent":undefined,"awayjs-display/lib/partition/EntityNode":undefined}],"awayjs-display/lib/entities/Mesh":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetType");var s=t("awayjs-display/lib/base/Geometry");var n=t("awayjs-display/lib/containers/DisplayObjectContainer");var o=t("awayjs-display/lib/partition/EntityNode");var h=t("awayjs-display/lib/events/GeometryEvent");var l=function(t){r(e,t);function e(e,i){var r=this;if(i===void 0){i=null}t.call(this);this._castsShadows=true;this._shareAnimationGeometry=true;this._pIsEntity=true;this._subMeshes=new Array;this._onGeometryBoundsInvalidDelegate=function(t){return r.onGeometryBoundsInvalid(t)};this._onSubGeometryAddedDelegate=function(t){return r.onSubGeometryAdded(t)};this._onSubGeometryRemovedDelegate=function(t){return r.onSubGeometryRemoved(t)};this.geometry=e||new s;this.material=i}Object.defineProperty(e.prototype,"animator",{get:function(){return this._animator},set:function(t){if(this._animator)this._animator.removeOwner(this);this._animator=t;var e=this._subMeshes.length;var i;for(var r=0;r<e;++r){i=this._subMeshes[r];if(i.material){i.material.iRemoveOwner(i);i.material.iAddOwner(i)}i._iInvalidateRenderableGeometry()}if(this._animator)this._animator.addOwner(this)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"assetType",{get:function(){return a.MESH},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"castsShadows",{get:function(){return this._castsShadows},set:function(t){this._castsShadows=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"geometry",{get:function(){if(this._iSourcePrefab)this._iSourcePrefab._iValidate();return this._geometry},set:function(t){var e;if(this._geometry){this._geometry.removeEventListener(h.BOUNDS_INVALID,this._onGeometryBoundsInvalidDelegate);this._geometry.removeEventListener(h.SUB_GEOMETRY_ADDED,this._onSubGeometryAddedDelegate);this._geometry.removeEventListener(h.SUB_GEOMETRY_REMOVED,this._onSubGeometryRemovedDelegate);for(e=0;e<this._subMeshes.length;++e)this._subMeshes[e].dispose();this._subMeshes.length=0}this._geometry=t;if(this._geometry){this._geometry.addEventListener(h.BOUNDS_INVALID,this._onGeometryBoundsInvalidDelegate);this._geometry.addEventListener(h.SUB_GEOMETRY_ADDED,this._onSubGeometryAddedDelegate);this._geometry.addEventListener(h.SUB_GEOMETRY_REMOVED,this._onSubGeometryRemovedDelegate);var i=this._geometry.subGeometries;for(e=0;e<i.length;++e)this.addSubMesh(i[e])}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"material",{get:function(){return this._material},set:function(t){if(t==this._material)return;var e;var i=this._subMeshes.length;var r;for(e=0;e<i;e++)if(this._material&&(r=this._subMeshes[e]).material==this._material)this._material.iRemoveOwner(r);this._material=t;for(e=0;e<i;e++)if(this._material&&(r=this._subMeshes[e]).material==this._material)this._material.iAddOwner(r)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"shareAnimationGeometry",{get:function(){return this._shareAnimationGeometry},set:function(t){this._shareAnimationGeometry=t},enumerable:true,configurable:true});
Object.defineProperty(e.prototype,"subMeshes",{get:function(){if(this._iSourcePrefab)this._iSourcePrefab._iValidate();return this._subMeshes},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"uvTransform",{get:function(){return this._uvTransform},set:function(t){this._uvTransform=t},enumerable:true,configurable:true});e.prototype.bakeTransformations=function(){this.geometry.applyTransformation(this._iMatrix3D);this._iMatrix3D.identity()};e.prototype.dispose=function(){t.prototype.dispose.call(this);this.material=null;this.geometry=null};e.prototype.disposeWithAnimatorAndChildren=function(){this.disposeWithChildren();if(this._animator)this._animator.dispose()};e.prototype.clone=function(){var t=new e(this._geometry,this._material);t._iMatrix3D=this._iMatrix3D;t.pivot=this.pivot;t.partition=this.partition;t.bounds=this.bounds.clone();t.name=this.name;t.castsShadows=this.castsShadows;t.shareAnimationGeometry=this.shareAnimationGeometry;t.mouseEnabled=this.mouseEnabled;t.mouseChildren=this.mouseChildren;t.extra=this.extra;var i=this._subMeshes.length;for(var r=0;r<i;++r)t._subMeshes[r].material=this._subMeshes[r]._iGetExplicitMaterial();i=this.numChildren;var a;for(r=0;r<i;++r){a=this.getChildAt(r).clone();t.addChild(a)}if(this._animator)t.animator=this._animator.clone();return t};e.prototype.getSubMeshFromSubGeometry=function(t){return this._subMeshes[this._geometry.subGeometries.indexOf(t)]};e.prototype.pCreateEntityPartitionNode=function(){return new o(this)};e.prototype.pUpdateBounds=function(){var e,i,r;var a=this._geometry.subGeometries;var s;var n;var o=a.length;var h,l,u;var p,c,d;if(o>0){e=0;s=a[0];n=s.getBoundingPositions();h=p=n[e];l=c=n[e+1];u=d=n[e+2];i=o;while(i--){s=a[i];n=s.getBoundingPositions();e=n.length;while(e--){r=n[e];if(r<h)h=r;else if(r>p)p=r;r=n[e+1];if(r<l)l=r;else if(r>c)c=r;r=n[e+2];if(r<u)u=r;else if(r>d)d=r}}this._pBounds.fromExtremes(h,l,u,p,c,d)}else{this._pBounds.fromExtremes(0,0,0,0,0,0)}t.prototype.pUpdateBounds.call(this)};e.prototype.onGeometryBoundsInvalid=function(t){this.pInvalidateBounds()};e.prototype.onSubGeometryAdded=function(t){this.addSubMesh(t.subGeometry)};e.prototype.onSubGeometryRemoved=function(t){var e;var i=t.subGeometry;var r=this._subMeshes.length;var a;for(a=0;a<r;++a){e=this._subMeshes[a];if(e.subGeometry==i){e.dispose();this._subMeshes.splice(a,1);break}}--r;for(;a<r;++a)this._subMeshes[a]._iIndex=a};e.prototype.addSubMesh=function(t){var e=t.subMeshClass;var i=new e(t,this,null);var r=this._subMeshes.length;i._iIndex=r;this._subMeshes[r]=i;this.pInvalidateBounds()};e.prototype._iTestCollision=function(t,e){return this._pPickingCollider.testMeshCollision(this,this._pPickingCollisionVO,t,e)};e.prototype._iCollectRenderables=function(t){if(this._iSourcePrefab)this._iSourcePrefab._iValidate();var e=this._subMeshes.length;for(var i=0;i<e;i++)this._subMeshes[i]._iCollectRenderable(t)};e.prototype._iInvalidateRenderableGeometries=function(){var t=this._subMeshes.length;for(var e=0;e<t;++e)this._subMeshes[e]._iInvalidateRenderableGeometry()};return e}(n);e.exports=l},{"awayjs-core/lib/library/AssetType":undefined,"awayjs-display/lib/base/Geometry":undefined,"awayjs-display/lib/containers/DisplayObjectContainer":undefined,"awayjs-display/lib/events/GeometryEvent":undefined,"awayjs-display/lib/partition/EntityNode":undefined}],"awayjs-display/lib/entities/PointLight":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/bounds/BoundingSphere");var s=t("awayjs-core/lib/geom/Matrix3D");var n=t("awayjs-core/lib/geom/Vector3D");var o=t("awayjs-display/lib/base/LightBase");var h=t("awayjs-display/lib/partition/PointLightNode");var l=t("awayjs-display/lib/materials/shadowmappers/CubeMapShadowMapper");var u=function(t){r(e,t);function e(){t.call(this);this._pRadius=9e4;this._pFallOff=1e5;this._pIsEntity=true;this._pFallOffFactor=1/(this._pFallOff*this._pFallOff-this._pRadius*this._pRadius)}e.prototype.pCreateShadowMapper=function(){return new l};Object.defineProperty(e.prototype,"radius",{get:function(){return this._pRadius},set:function(t){this._pRadius=t;if(this._pRadius<0){this._pRadius=0}else if(this._pRadius>this._pFallOff){this._pFallOff=this._pRadius;this.pInvalidateBounds()}this._pFallOffFactor=1/(this._pFallOff*this._pFallOff-this._pRadius*this._pRadius)},enumerable:true,configurable:true});e.prototype.iFallOffFactor=function(){return this._pFallOffFactor};Object.defineProperty(e.prototype,"fallOff",{get:function(){return this._pFallOff},set:function(t){this._pFallOff=t;if(this._pFallOff<0)this._pFallOff=0;if(this._pFallOff<this._pRadius)this._pRadius=this._pFallOff;this._pFallOffFactor=1/(this._pFallOff*this._pFallOff-this._pRadius*this._pRadius);this.pInvalidateBounds()},enumerable:true,configurable:true});e.prototype.pCreateEntityPartitionNode=function(){return new h(this)};e.prototype.pUpdateBounds=function(){this._pBounds.fromSphere(new n,this._pFallOff);this._pBoundsInvalid=false};e.prototype.pCreateDefaultBoundingVolume=function(){return new a};e.prototype.iGetObjectProjectionMatrix=function(t,e,i){if(i===void 0){i=null}var r=new Array(16);var a=t.bounds;var o=new s;o.copyFrom(t.getRenderSceneTransform(e));o.append(this._pParent.inverseSceneTransform);this.lookAt(o.position);o.copyFrom(t.getRenderSceneTransform(e));o.append(this.inverseSceneTransform);var h=a.aabb;var l=o.deltaTransformVector(new n(h.left,h.bottom,h.front));var u=o.deltaTransformVector(new n(h.right,h.top,h.back));var p=l.x*l.x+l.y*l.y+l.z*l.z;var c=u.x*u.x+u.y*u.y+u.z*u.z;var d=Math.sqrt(p>c?p:c);var f;var _;var y=o.rawData[14];f=y-d;_=y+d;r[5]=r[0]=f/d;r[10]=_/(_-f);r[11]=1;r[1]=r[2]=r[3]=r[4]=r[6]=r[7]=r[8]=r[9]=r[12]=r[13]=r[15]=0;r[14]=-f*r[10];if(!i)i=new s;i.copyRawDataFrom(r);i.prepend(o);return i};e.prototype._iCollectRenderables=function(t){};return e}(o);e.exports=u},{"awayjs-core/lib/bounds/BoundingSphere":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/base/LightBase":undefined,"awayjs-display/lib/materials/shadowmappers/CubeMapShadowMapper":undefined,"awayjs-display/lib/partition/PointLightNode":undefined}],"awayjs-display/lib/entities/Shape":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/base/DisplayObject");var s=function(t){r(e,t);function e(){t.call(this)}Object.defineProperty(e.prototype,"graphics",{get:function(){return this._graphics},enumerable:true,configurable:true});return e}(a);e.exports=s},{"awayjs-display/lib/base/DisplayObject":undefined}],"awayjs-display/lib/entities/Skybox":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/bounds/NullBounds");var s=t("awayjs-core/lib/library/AssetType");var n=t("awayjs-display/lib/base/DisplayObject");var o=t("awayjs-display/lib/partition/SkyboxNode");var h=function(t){r(e,t);function e(e){t.call(this);this._pIsEntity=true;this.material=e}Object.defineProperty(e.prototype,"animator",{get:function(){return this._animator},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"uvTransform",{get:function(){return this._uvTransform},set:function(t){this._uvTransform=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"material",{get:function(){return this._material},set:function(t){if(t==this._material)return;if(this._material)this._material.iRemoveOwner(this);this._material=t;if(this._material)this._material.iAddOwner(this)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"assetType",{get:function(){return s.SKYBOX},enumerable:true,configurable:true});e.prototype.pInvalidateBounds=function(){};e.prototype.pCreateEntityPartitionNode=function(){return new o(this)};e.prototype.pCreateDefaultBoundingVolume=function(){return new a};e.prototype.pUpdateBounds=function(){this._pBoundsInvalid=false};Object.defineProperty(e.prototype,"castsShadows",{get:function(){return false},enumerable:true,configurable:true});e.prototype._iCollectRenderables=function(t){};e.prototype._iCollectRenderable=function(t){};return e}(n);e.exports=h},{"awayjs-core/lib/bounds/NullBounds":undefined,"awayjs-core/lib/library/AssetType":undefined,"awayjs-display/lib/base/DisplayObject":undefined,"awayjs-display/lib/partition/SkyboxNode":undefined}],"awayjs-display/lib/entities/TextField":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/base/DisplayObject");var s=function(t){r(e,t);function e(){t.call(this);this._text=""}Object.defineProperty(e.prototype,"bottomScrollV",{get:function(){return this._bottomScrollV},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"caretIndex",{get:function(){return this._caretIndex},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"length",{get:function(){return this._length},enumerable:true,configurable:true});e.prototype.maxScrollH=function(){return this._maxScrollH};e.prototype.maxScrollV=function(){return this._maxScrollV};Object.defineProperty(e.prototype,"numLines",{get:function(){return this._numLines},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"selectionBeginIndex",{get:function(){return this._selectionBeginIndex},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"selectionEndIndex",{get:function(){return this._selectionEndIndex},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){if(this._text==t)return;this._text=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"textHeight",{get:function(){return this._textHeight},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"textInteractionMode",{get:function(){return this._textInteractionMode},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"textWidth",{get:function(){return this._textWidth},enumerable:true,configurable:true});e.prototype.appendText=function(t){};e.prototype.getCharBoundaries=function(t){return this._charBoundaries};e.prototype.getCharIndexAtPoint=function(t,e){return this._charIndexAtPoint};e.prototype.getFirstCharInParagraph=function(t){return this._firstCharInParagraph};e.prototype.getImageReference=function(t){return this._imageReference};e.prototype.getLineIndexAtPoint=function(t,e){return this._lineIndexAtPoint};e.prototype.getLineIndexOfChar=function(t){return this._lineIndexOfChar};e.prototype.getLineLength=function(t){return this._lineLength};e.prototype.getLineMetrics=function(t){return this._lineMetrics};e.prototype.getLineOffset=function(t){return this._lineOffset};e.prototype.getLineText=function(t){return this._lineText};e.prototype.getParagraphLength=function(t){return this._paragraphLength};e.prototype.getTextFormat=function(t,e){if(t===void 0){t=-1}if(e===void 0){e=-1}return this._textFormat};e.prototype.replaceSelectedText=function(t){};e.prototype.replaceText=function(t,e,i){};e.prototype.setSelection=function(t,e){};e.prototype.setTextFormat=function(t,e,i){if(e===void 0){e=-1}if(i===void 0){i=-1}};e.isFontCompatible=function(t,e){return false};return e}(a);e.exports=s},{"awayjs-display/lib/base/DisplayObject":undefined}],"awayjs-display/lib/errors/CastError":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/Error");var s=function(t){r(e,t);function e(e){t.call(this,e)}return e}(a);e.exports=s},{"awayjs-core/lib/errors/Error":undefined}],"awayjs-display/lib/events/CameraEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e,i){t.call(this,e);this._camera=i}Object.defineProperty(e.prototype,"camera",{get:function(){return this._camera},enumerable:true,configurable:true});e.PROJECTION_CHANGED="projectionChanged";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":undefined}],"awayjs-display/lib/events/DisplayObjectEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e,i){t.call(this,e);this.object=i}e.VISIBLITY_UPDATED="visiblityUpdated";e.SCENETRANSFORM_CHANGED="scenetransformChanged";e.SCENE_CHANGED="sceneChanged";e.POSITION_CHANGED="positionChanged";e.ROTATION_CHANGED="rotationChanged";e.SCALE_CHANGED="scaleChanged";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":undefined}],"awayjs-display/lib/events/GeometryEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e,i){if(i===void 0){i=null}t.call(this,e);this._subGeometry=i}Object.defineProperty(e.prototype,"subGeometry",{get:function(){return this._subGeometry},enumerable:true,configurable:true});e.prototype.clone=function(){return new e(this.type,this._subGeometry)};e.SUB_GEOMETRY_ADDED="SubGeometryAdded";e.SUB_GEOMETRY_REMOVED="SubGeometryRemoved";e.BOUNDS_INVALID="BoundsInvalid";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":undefined}],"awayjs-display/lib/events/LightEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e){t.call(this,e)}e.prototype.clone=function(){return new e(this.type)};e.CASTS_SHADOW_CHANGE="castsShadowChange";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":undefined}],"awayjs-display/lib/events/MaterialEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e){t.call(this,e)}e.SIZE_CHANGED="sizeChanged";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":undefined}],"awayjs-display/lib/events/MouseEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e){t.call(this,e);this._iAllowedToPropagate=true}Object.defineProperty(e.prototype,"bubbles",{get:function(){var t=this._iAllowedToPropagate;this._iAllowedToPropagate=true;return t},enumerable:true,configurable:true});e.prototype.stopPropagation=function(){this._iAllowedToPropagate=false;if(this._iParentEvent)this._iParentEvent.stopPropagation()};e.prototype.stopImmediatePropagation=function(){this._iAllowedToPropagate=false;if(this._iParentEvent)this._iParentEvent.stopImmediatePropagation()};e.prototype.clone=function(){var t=new e(this.type);t.screenX=this.screenX;t.screenY=this.screenY;t.view=this.view;t.object=this.object;t.materialOwner=this.materialOwner;t.material=this.material;t.uv=this.uv;t.localPosition=this.localPosition;t.localNormal=this.localNormal;t.index=this.index;t.subGeometryIndex=this.subGeometryIndex;t.delta=this.delta;t.ctrlKey=this.ctrlKey;t.shiftKey=this.shiftKey;t._iParentEvent=this;t._iAllowedToPropagate=this._iAllowedToPropagate;return t};Object.defineProperty(e.prototype,"scenePosition",{get:function(){return this.object.sceneTransform.transformVector(this.localPosition)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"sceneNormal",{get:function(){var t=this.object.sceneTransform.deltaTransformVector(this.localNormal);t.normalize();return t},enumerable:true,configurable:true});e.MOUSE_OVER="mouseOver3d";e.MOUSE_OUT="mouseOut3d";e.MOUSE_UP="mouseUp3d";e.MOUSE_DOWN="mouseDown3d";e.MOUSE_MOVE="mouseMove3d";e.CLICK="click3d";e.DOUBLE_CLICK="doubleClick3d";e.MOUSE_WHEEL="mouseWheel3d";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":undefined}],"awayjs-display/lib/events/RendererEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e){t.call(this,e)}e.VIEWPORT_UPDATED="viewportUpdated";e.SCISSOR_UPDATED="scissorUpdated";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":undefined}],"awayjs-display/lib/events/ResizeEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e,i,r){if(i===void 0){i=NaN}if(r===void 0){r=NaN}t.call(this,e);this._oldHeight=i;this._oldWidth=r}Object.defineProperty(e.prototype,"oldHeight",{get:function(){return this._oldHeight},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"oldWidth",{get:function(){return this._oldWidth},enumerable:true,configurable:true});e.RESIZE="resize";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":undefined}],"awayjs-display/lib/events/SceneEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e,i){t.call(this,e);this.displayObject=i}e.ADDED_TO_SCENE="addedToScene";e.REMOVED_FROM_SCENE="removedFromScene";e.PARTITION_CHANGED="partitionChanged";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":undefined}],"awayjs-display/lib/events/StageEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e){t.call(this,e)}e.CONTEXT_CREATED="contextCreated";e.CONTEXT_DISPOSED="contextDisposed";e.CONTEXT_RECREATED="contextRecreated";e.VIEWPORT_UPDATED="viewportUpdated";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":undefined}],"awayjs-display/lib/events/SubGeometryEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e,i){if(i===void 0){i=""}t.call(this,e);this._dataType=i}Object.defineProperty(e.prototype,"dataType",{get:function(){return this._dataType},enumerable:true,configurable:true});e.prototype.clone=function(){return new e(this.type,this._dataType)};e.INDICES_UPDATED="indicesUpdated";e.VERTICES_UPDATED="verticesUpdated";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":undefined}],"awayjs-display/lib/managers/MouseManager":[function(t,e,i){var r=t("awayjs-core/lib/geom/Vector3D");var a=t("awayjs-display/lib/events/MouseEvent");var s=function(){function t(){var t=this;this._viewLookup=new Array;this._nullVector=new r;this._queuedEvents=new Array;this._mouseUp=new a(a.MOUSE_UP);this._mouseClick=new a(a.CLICK);this._mouseOut=new a(a.MOUSE_OUT);this._mouseDown=new a(a.MOUSE_DOWN);this._mouseMove=new a(a.MOUSE_MOVE);this._mouseOver=new a(a.MOUSE_OVER);this._mouseWheel=new a(a.MOUSE_WHEEL);this._mouseDoubleClick=new a(a.DOUBLE_CLICK);this.onClickDelegate=function(e){return t.onClick(e)};this.onDoubleClickDelegate=function(e){return t.onDoubleClick(e)};this.onMouseDownDelegate=function(e){return t.onMouseDown(e)};this.onMouseMoveDelegate=function(e){return t.onMouseMove(e)};this.onMouseUpDelegate=function(e){return t.onMouseUp(e)};this.onMouseWheelDelegate=function(e){return t.onMouseWheel(e)};this.onMouseOverDelegate=function(e){return t.onMouseOver(e)};this.onMouseOutDelegate=function(e){return t.onMouseOut(e)}}t.getInstance=function(){if(this._instance)return this._instance;return this._instance=new t};t.prototype.fireMouseEvents=function(t){if(this._iCollidingObject!=this._previousCollidingObject){if(this._previousCollidingObject)this.queueDispatch(this._mouseOut,this._mouseMoveEvent,this._previousCollidingObject);if(this._iCollidingObject)this.queueDispatch(this._mouseOver,this._mouseMoveEvent)}if(t&&this._iCollidingObject)this.queueDispatch(this._mouseMove,this._mouseMoveEvent);var e;var i;var r=this._queuedEvents.length;for(var a=0;a<r;++a){e=this._queuedEvents[a];i=e.object;while(i&&!i._iIsMouseEnabled())i=i.parent;if(i)i.dispatchEvent(e)}this._queuedEvents.length=0;this._previousCollidingObject=this._iCollidingObject;this._iUpdateDirty=false};t.prototype.registerView=function(t){t.htmlElement.addEventListener("click",this.onClickDelegate);t.htmlElement.addEventListener("dblclick",this.onDoubleClickDelegate);t.htmlElement.addEventListener("mousedown",this.onMouseDownDelegate);t.htmlElement.addEventListener("mousemove",this.onMouseMoveDelegate);t.htmlElement.addEventListener("mouseup",this.onMouseUpDelegate);t.htmlElement.addEventListener("mousewheel",this.onMouseWheelDelegate);t.htmlElement.addEventListener("mouseover",this.onMouseOverDelegate);t.htmlElement.addEventListener("mouseout",this.onMouseOutDelegate);this._viewLookup.push(t)};t.prototype.unregisterView=function(t){t.htmlElement.removeEventListener("click",this.onClickDelegate);t.htmlElement.removeEventListener("dblclick",this.onDoubleClickDelegate);t.htmlElement.removeEventListener("mousedown",this.onMouseDownDelegate);t.htmlElement.removeEventListener("mousemove",this.onMouseMoveDelegate);t.htmlElement.removeEventListener("mouseup",this.onMouseUpDelegate);t.htmlElement.removeEventListener("mousewheel",this.onMouseWheelDelegate);t.htmlElement.removeEventListener("mouseover",this.onMouseOverDelegate);t.htmlElement.removeEventListener("mouseout",this.onMouseOutDelegate);this._viewLookup.slice(this._viewLookup.indexOf(t),1)};t.prototype.queueDispatch=function(t,e,i){if(i===void 0){i=null}if(e){t.ctrlKey=e.ctrlKey;t.altKey=e.altKey;t.shiftKey=e.shiftKey;t.screenX=e.clientX;t.screenY=e.clientY}if(i==null)i=this._iCollidingObject;if(i){t.object=i.displayObject;t.materialOwner=i.materialOwner;t.uv=i.uv;t.localPosition=i.localPosition?i.localPosition.clone():null;t.localNormal=i.localNormal?i.localNormal.clone():null;t.index=i.index}else{t.uv=null;t.object=null;t.localPosition=this._nullVector;t.localNormal=this._nullVector;t.index=0;t.subGeometryIndex=0}this._queuedEvents.push(t)};t.prototype.onMouseMove=function(t){this.updateColliders(t);if(this._iCollidingObject)this.queueDispatch(this._mouseMove,this._mouseMoveEvent=t)};t.prototype.onMouseOut=function(t){this._iActiveDiv=null;this.updateColliders(t);if(this._iCollidingObject)this.queueDispatch(this._mouseOut,t)};t.prototype.onMouseOver=function(t){this._iActiveDiv=t.target;this.updateColliders(t);if(this._iCollidingObject)this.queueDispatch(this._mouseOver,t)};t.prototype.onClick=function(t){this.updateColliders(t);if(this._iCollidingObject)this.queueDispatch(this._mouseClick,t)};t.prototype.onDoubleClick=function(t){this.updateColliders(t);if(this._iCollidingObject)this.queueDispatch(this._mouseDoubleClick,t)};t.prototype.onMouseDown=function(t){this._iActiveDiv=t.target;this.updateColliders(t);if(this._iCollidingObject)this.queueDispatch(this._mouseDown,t)};t.prototype.onMouseUp=function(t){this.updateColliders(t);if(this._iCollidingObject)this.queueDispatch(this._mouseUp,t)};t.prototype.onMouseWheel=function(t){this.updateColliders(t);if(this._iCollidingObject)this.queueDispatch(this._mouseWheel,t)};t.prototype.updateColliders=function(t){if(this._iUpdateDirty)return;var e;var i;var r=t.clientX;var a=t.clientY;var s=this._viewLookup.length;for(var n=0;n<s;n++){e=this._viewLookup[n];i=e.htmlElement.getBoundingClientRect();if(r<i.left||r>i.right||a<i.top||a>i.bottom){e._pMouseX=null;e._pMouseY=null}else{e._pMouseX=r+i.left;e._pMouseY=a+i.top;e.updateCollider();if(e.layeredView&&this._iCollidingObject)break}}this._iUpdateDirty=true};return t}();e.exports=s},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/events/MouseEvent":undefined}],"awayjs-display/lib/materials/CSSMaterialBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/materials/MaterialBase");var s=t("awayjs-core/lib/textures/ImageTexture");var n=function(t){r(e,t);function e(e,i,r){if(e===void 0){e=null}if(i===void 0){i=true}if(r===void 0){r=false}t.call(this);this._iMaterialId=Number(this.id);this.texture=e;this.smooth=i;this.repeat=r}Object.defineProperty(e.prototype,"imageElement",{get:function(){return this._imageElement},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"imageStyle",{get:function(){return this._imageStyle},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"texture",{get:function(){return this._pTexture},set:function(t){if(this._pTexture==t)return;this._pTexture=t;if(t instanceof s){this._imageElement=t.htmlImageElement;var e=document.createElement("style");e.type="text/css";document.getElementsByTagName("head")[0].appendChild(e);var i=document.styleSheets[document.styleSheets.length-1];i.insertRule(".material"+this.id+"{ }",0);var r=i.cssRules[0].style;r.backgroundImage="url("+this._imageElement.src+")";r.backgroundSize="100% 100%";r.position="absolute";r.width=this._imageElement.width+"px";r.height=this._imageElement.height+"px";r.transformOrigin=r["-webkit-transform-origin"]=r["-moz-transform-origin"]=r["-o-transform-origin"]=r["-ms-transform-origin"]="0% 0%";this._pHeight=this._imageElement.height;this._pWidth=this._imageElement.width;this._pNotifySizeChanged()}},enumerable:true,configurable:true});return e}(a);e.exports=n},{"awayjs-core/lib/textures/ImageTexture":undefined,"awayjs-display/lib/materials/MaterialBase":undefined}],"awayjs-display/lib/materials/LightSources":[function(t,e,i){var r=function(){function t(){}t.LIGHTS=1;t.PROBES=2;t.ALL=3;return t}();e.exports=r},{}],"awayjs-display/lib/materials/MaterialBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=t("awayjs-core/lib/library/AssetType");var n=t("awayjs-core/lib/library/NamedAssetBase");var o=t("awayjs-display/lib/base/BlendMode");var h=t("awayjs-display/lib/events/MaterialEvent");var l=function(t){r(e,t);function e(){var e=this;t.call(this);this._materialPassData=new Array;this._materialData=new Array;this._pAlphaThreshold=0;this._pAnimateUVs=false;this._enableLightFallOff=true;this._specularLightSources=1;this._diffuseLightSources=3;this._iMaterialId=0;this._iBaseScreenPassIndex=0;this._bothSides=false;this._pScreenPassesInvalid=true;this._pBlendMode=o.NORMAL;this._numPasses=0;this._mipmap=false;this._smooth=true;this._repeat=false;this._color=16777215;this._pHeight=1;this._pWidth=1;this._pRequiresBlending=false;this._iMaterialId=Number(this.id);this._owners=new Array;this._passes=new Array;this._onPassChangeDelegate=function(t){return e.onPassChange(t)};this._onLightChangeDelegate=function(t){return e.onLightsChange(t)};this.alphaPremultiplied=false}Object.defineProperty(e.prototype,"assetType",{get:function(){return s.MATERIAL},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this._pHeight},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"animationSet",{get:function(){return this._animationSet},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lightPicker",{get:function(){return this._pLightPicker},set:function(t){if(this._pLightPicker==t)return;if(this._pLightPicker)this._pLightPicker.removeEventListener(a.CHANGE,this._onLightChangeDelegate);this._pLightPicker=t;if(this._pLightPicker)this._pLightPicker.addEventListener(a.CHANGE,this._onLightChangeDelegate);this._pInvalidateScreenPasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"mipmap",{get:function(){return this._mipmap},set:function(t){if(this._mipmap==t)return;this._mipmap=t;this._pInvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"smooth",{get:function(){return this._smooth},set:function(t){if(this._smooth==t)return;this._smooth=t;this._pInvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"repeat",{get:function(){return this._repeat},set:function(t){if(this._repeat==t)return;this._repeat=t;this._pInvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){if(this._color==t)return;this._color=t;this._pInvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"texture",{get:function(){return this._pTexture},set:function(t){if(this._pTexture==t)return;this._pTexture=t;this._pInvalidatePasses();this._pHeight=this._pTexture.height;this._pWidth=this._pTexture.width;this._pNotifySizeChanged()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"animateUVs",{get:function(){return this._pAnimateUVs},set:function(t){if(this._pAnimateUVs==t)return;this._pAnimateUVs=t;this._pInvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"enableLightFallOff",{get:function(){return this._enableLightFallOff},set:function(t){if(this._enableLightFallOff==t)return;this._enableLightFallOff=t;this._pInvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"diffuseLightSources",{get:function(){return this._diffuseLightSources},set:function(t){if(this._diffuseLightSources==t)return;this._diffuseLightSources=t;this._pInvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"specularLightSources",{get:function(){return this._specularLightSources},set:function(t){if(this._specularLightSources==t)return;this._specularLightSources=t;this._pInvalidatePasses()},enumerable:true,configurable:true});e.prototype.dispose=function(){var t;var e;this._pClearScreenPasses();e=this._materialData.length;for(t=0;t<e;t++)this._materialData[t].dispose();this._materialData=new Array;e=this._materialPassData.length;for(t=0;t<e;t++)this._materialPassData[t].dispose();this._materialPassData=new Array};Object.defineProperty(e.prototype,"bothSides",{get:function(){return this._bothSides},set:function(t){if(this._bothSides=t)return;this._bothSides=t;this._pInvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._pBlendMode},set:function(t){if(this._pBlendMode==t)return;this._pBlendMode=t;this._pInvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"alphaPremultiplied",{get:function(){return this._alphaPremultiplied},set:function(t){if(this._alphaPremultiplied==t)return;this._alphaPremultiplied=t;this._pInvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"alphaThreshold",{get:function(){return this._pAlphaThreshold
},set:function(t){if(t<0)t=0;else if(t>1)t=1;if(this._pAlphaThreshold==t)return;this._pAlphaThreshold=t;this._pInvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"requiresBlending",{get:function(){return this._pRequiresBlending},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"width",{get:function(){return this._pWidth},enumerable:true,configurable:true});e.prototype._iActivatePass=function(t,e,i){t.materialPass._iActivate(t,e,i)};e.prototype._iDeactivatePass=function(t,e){t.materialPass._iDeactivate(t,e)};e.prototype._iRenderPass=function(t,e,i,r,a){if(this._pLightPicker)this._pLightPicker.collectLights(e);t.materialPass._iRender(t,e,i,r,a)};e.prototype.iAddOwner=function(t){this._owners.push(t);var e;var i=t.animator;if(i)e=i.animationSet;if(t.animator){if(this._animationSet&&e!=this._animationSet){throw new Error("A Material instance cannot be shared across material owners with different animation sets")}else{if(this._animationSet!=e){this._animationSet=e;this.invalidateAnimation()}}}};e.prototype.iRemoveOwner=function(t){this._owners.splice(this._owners.indexOf(t),1);if(this._owners.length==0){this._animationSet=null;this.invalidateAnimation()}};Object.defineProperty(e.prototype,"iOwners",{get:function(){return this._owners},enumerable:true,configurable:true});e.prototype._iNumScreenPasses=function(){return this._numPasses};Object.defineProperty(e.prototype,"_iScreenPasses",{get:function(){return this._passes},enumerable:true,configurable:true});e.prototype._pInvalidatePasses=function(){var t=this._materialPassData.length;for(var e=0;e<t;e++)this._materialPassData[e].invalidate();this.invalidateMaterial()};e.prototype._pInvalidateScreenPasses=function(){this._pScreenPassesInvalid=true};e.prototype._pRemoveScreenPass=function(t){t.removeEventListener(a.CHANGE,this._onPassChangeDelegate);this._passes.splice(this._passes.indexOf(t),1);this._numPasses--};e.prototype._pClearScreenPasses=function(){for(var t=0;t<this._numPasses;++t)this._passes[t].removeEventListener(a.CHANGE,this._onPassChangeDelegate);this._passes.length=this._numPasses=0};e.prototype._pAddScreenPass=function(t){this._passes[this._numPasses++]=t;t.lightPicker=this._pLightPicker;t.addEventListener(a.CHANGE,this._onPassChangeDelegate);this.invalidateMaterial()};e.prototype._iAddMaterialData=function(t){this._materialData.push(t);return t};e.prototype._iRemoveMaterialData=function(t){this._materialData.splice(this._materialData.indexOf(t),1);return t};e.prototype._iUpdateMaterial=function(){};e.prototype.onPassChange=function(t){this.invalidateMaterial()};e.prototype.invalidateAnimation=function(){var t=this._materialData.length;for(var e=0;e<t;e++)this._materialData[e].invalidateAnimation()};e.prototype.invalidateMaterial=function(){var t=this._materialData.length;for(var e=0;e<t;e++)this._materialData[e].invalidateMaterial()};e.prototype.onLightsChange=function(t){this._pInvalidateScreenPasses()};e.prototype._pNotifySizeChanged=function(){if(!this._sizeChanged)this._sizeChanged=new h(h.SIZE_CHANGED);this.dispatchEvent(this._sizeChanged)};e.prototype._iAddMaterialPassData=function(t){this._materialPassData.push(t);return t};e.prototype._iRemoveMaterialPassData=function(t){this._materialPassData.splice(this._materialPassData.indexOf(t),1);return t};return e}(n);e.exports=l},{"awayjs-core/lib/events/Event":undefined,"awayjs-core/lib/library/AssetType":undefined,"awayjs-core/lib/library/NamedAssetBase":undefined,"awayjs-display/lib/base/BlendMode":undefined,"awayjs-display/lib/events/MaterialEvent":undefined}],"awayjs-display/lib/materials/lightpickers/LightPickerBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetType");var s=t("awayjs-core/lib/library/NamedAssetBase");var n=function(t){r(e,t);function e(){t.call(this);this._pNumPointLights=0;this._pNumDirectionalLights=0;this._pNumCastingPointLights=0;this._pNumCastingDirectionalLights=0;this._pNumLightProbes=0}e.prototype.dispose=function(){};Object.defineProperty(e.prototype,"assetType",{get:function(){return a.LIGHT_PICKER},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numDirectionalLights",{get:function(){return this._pNumDirectionalLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numPointLights",{get:function(){return this._pNumPointLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numCastingDirectionalLights",{get:function(){return this._pNumCastingDirectionalLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numCastingPointLights",{get:function(){return this._pNumCastingPointLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numLightProbes",{get:function(){return this._pNumLightProbes},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"pointLights",{get:function(){return this._pPointLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"directionalLights",{get:function(){return this._pDirectionalLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"castingPointLights",{get:function(){return this._pCastingPointLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"castingDirectionalLights",{get:function(){return this._pCastingDirectionalLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lightProbes",{get:function(){return this._pLightProbes},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lightProbeWeights",{get:function(){return this._pLightProbeWeights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"allPickedLights",{get:function(){return this._pAllPickedLights},enumerable:true,configurable:true});e.prototype.collectLights=function(t){this.updateProbeWeights(t)};e.prototype.updateProbeWeights=function(t){var e=t.sourceEntity.scenePosition;var i;var r=e.x,a=e.y,s=e.z;var n,o,h;var l,u=0;var p;for(p=0;p<this._pNumLightProbes;++p){i=this._pLightProbes[p].scenePosition;n=r-i.x;o=a-i.y;h=s-i.z;l=n*n+o*o+h*h;l=l>1e-5?1/l:5e7;this._pLightProbeWeights[p]=l;u+=l}u=1/u;for(p=0;p<this._pNumLightProbes;++p)this._pLightProbeWeights[p]*=u};return e}(s);e.exports=n},{"awayjs-core/lib/library/AssetType":undefined,"awayjs-core/lib/library/NamedAssetBase":undefined}],"awayjs-display/lib/materials/lightpickers/StaticLightPicker":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=t("awayjs-display/lib/entities/DirectionalLight");var n=t("awayjs-display/lib/entities/LightProbe");var o=t("awayjs-display/lib/entities/PointLight");var h=t("awayjs-display/lib/events/LightEvent");var l=t("awayjs-display/lib/materials/lightpickers/LightPickerBase");var u=function(t){r(e,t);function e(e){var i=this;t.call(this);this._onCastShadowChangeDelegate=function(t){return i.onCastShadowChange(t)};this.lights=e}Object.defineProperty(e.prototype,"lights",{get:function(){return this._lights},set:function(t){var e=0;var i=0;var r=0;var l=0;var u=0;var p;if(this._lights)this.clearListeners();this._lights=t;this._pAllPickedLights=t;this._pPointLights=new Array;this._pCastingPointLights=new Array;this._pDirectionalLights=new Array;this._pCastingDirectionalLights=new Array;this._pLightProbes=new Array;var c=t.length;for(var d=0;d<c;++d){p=t[d];p.addEventListener(h.CASTS_SHADOW_CHANGE,this._onCastShadowChangeDelegate);if(p instanceof o){if(p.castsShadows)this._pCastingPointLights[r++]=p;else this._pPointLights[e++]=p}else if(p instanceof s){if(p.castsShadows)this._pCastingDirectionalLights[l++]=p;else this._pDirectionalLights[i++]=p}else if(p instanceof n){this._pLightProbes[u++]=p}}if(this._pNumDirectionalLights==i&&this._pNumPointLights==e&&this._pNumLightProbes==u&&this._pNumCastingPointLights==r&&this._pNumCastingDirectionalLights==l)return;this._pNumDirectionalLights=i;this._pNumCastingDirectionalLights=l;this._pNumPointLights=e;this._pNumCastingPointLights=r;this._pNumLightProbes=u;this._pLightProbeWeights=new Array(Math.ceil(u/4)*4);this.dispatchEvent(new a(a.CHANGE))},enumerable:true,configurable:true});e.prototype.clearListeners=function(){var t=this._lights.length;for(var e=0;e<t;++e)this._lights[e].removeEventListener(h.CASTS_SHADOW_CHANGE,this._onCastShadowChangeDelegate)};e.prototype.onCastShadowChange=function(t){var e=t.target;if(e instanceof o)this.updatePointCasting(e);else if(e instanceof s)this.updateDirectionalCasting(e);this.dispatchEvent(new a(a.CHANGE))};e.prototype.updateDirectionalCasting=function(t){var e=t;if(t.castsShadows){--this._pNumDirectionalLights;++this._pNumCastingDirectionalLights;this._pDirectionalLights.splice(this._pDirectionalLights.indexOf(e),1);this._pCastingDirectionalLights.push(t)}else{++this._pNumDirectionalLights;--this._pNumCastingDirectionalLights;this._pCastingDirectionalLights.splice(this._pCastingDirectionalLights.indexOf(e),1);this._pDirectionalLights.push(t)}};e.prototype.updatePointCasting=function(t){var e=t;if(t.castsShadows){--this._pNumPointLights;++this._pNumCastingPointLights;this._pPointLights.splice(this._pPointLights.indexOf(e),1);this._pCastingPointLights.push(t)}else{++this._pNumPointLights;--this._pNumCastingPointLights;this._pCastingPointLights.splice(this._pCastingPointLights.indexOf(e),1);this._pPointLights.push(t)}};return e}(l);e.exports=u},{"awayjs-core/lib/events/Event":undefined,"awayjs-display/lib/entities/DirectionalLight":undefined,"awayjs-display/lib/entities/LightProbe":undefined,"awayjs-display/lib/entities/PointLight":undefined,"awayjs-display/lib/events/LightEvent":undefined,"awayjs-display/lib/materials/lightpickers/LightPickerBase":undefined}],"awayjs-display/lib/materials/passes/IMaterialPass":[function(t,e,i){},{}],"awayjs-display/lib/materials/shadowmappers/CascadeShadowMapper":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Matrix3DUtils");var s=t("awayjs-core/lib/geom/Rectangle");var n=t("awayjs-core/lib/events/Event");var o=t("awayjs-core/lib/events/EventDispatcher");var h=t("awayjs-core/lib/projections/FreeMatrixProjection");var l=t("awayjs-display/lib/entities/Camera");var u=t("awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper");var p=function(t){r(e,t);function e(e){if(e===void 0){e=3}t.call(this);this._pScissorRectsInvalid=true;if(e<1||e>4)throw new Error("numCascades must be an integer between 1 and 4");this._numCascades=e;this._changeDispatcher=new o(this);this.init()}e.prototype.getSplitRatio=function(t){return this._splitRatios[t]};e.prototype.setSplitRatio=function(t,e){if(e<0)e=0;else if(e>1)e=1;if(t>=this._numCascades)throw new Error("index must be smaller than the number of cascades!");this._splitRatios[t]=e};e.prototype.getDepthProjections=function(t){return this._depthCameras[t].viewProjection};e.prototype.init=function(){this._splitRatios=new Array(this._numCascades);this._nearPlaneDistances=new Array(this._numCascades);var t=1;for(var e=this._numCascades-1;e>=0;--e){this._splitRatios[e]=t;t*=.4}this._texOffsetsX=Array(-1,1,-1,1);this._texOffsetsY=Array(1,1,-1,-1);this._pScissorRects=new Array(4);this._depthLenses=new Array;this._depthCameras=new Array;for(e=0;e<this._numCascades;++e){this._depthLenses[e]=new h;this._depthCameras[e]=new l(this._depthLenses[e])}};e.prototype._pSetDepthMapSize=function(e){t.prototype._pSetDepthMapSize.call(this,e);this.invalidateScissorRects()};e.prototype.invalidateScissorRects=function(){this._pScissorRectsInvalid=true};Object.defineProperty(e.prototype,"numCascades",{get:function(){return this._numCascades},set:function(t){if(t==this._numCascades)return;if(t<1||t>4)throw new Error("numCascades must be an integer between 1 and 4");this._numCascades=t;this.invalidateScissorRects();this.init();this.dispatchEvent(new n(n.CHANGE))},enumerable:true,configurable:true});e.prototype.pDrawDepthMap=function(t,e,i){if(this._pScissorRectsInvalid)this.updateScissorRects();this._pCasterCollector.cullPlanes=this._pCullPlanes;this._pCasterCollector.camera=this._pOverallDepthCamera;this._pCasterCollector.clear();e.traversePartitions(this._pCasterCollector);i._iRenderCascades(this._pCasterCollector,t,this._numCascades,this._pScissorRects,this._depthCameras)};e.prototype.updateScissorRects=function(){var t=this._pDepthMapSize*.5;this._pScissorRects[0]=new s(0,0,t,t);this._pScissorRects[1]=new s(t,0,t,t);this._pScissorRects[2]=new s(0,t,t,t);this._pScissorRects[3]=new s(t,t,t,t);this._pScissorRectsInvalid=false};e.prototype.pUpdateDepthProjection=function(t){var e;var i=t.projection;var r=i.near;var a=i.far-r;this.pUpdateProjectionFromFrustumCorners(t,t.projection.frustumCorners,this._pMatrix);this._pMatrix.appendScale(.96,.96,1);this._pOverallDepthProjection.matrix=this._pMatrix;this.pUpdateCullPlanes(t);for(var s=0;s<this._numCascades;++s){e=this._depthLenses[s].matrix;this._nearPlaneDistances[s]=r+this._splitRatios[s]*a;this._depthCameras[s].transform=this._pOverallDepthCamera.transform;this.updateProjectionPartition(e,this._splitRatios[s],this._texOffsetsX[s],this._texOffsetsY[s]);this._depthLenses[s].matrix=e}};e.prototype.updateProjectionPartition=function(t,e,i,r){var s=a.RAW_DATA_CONTAINER;var n,o,h;var l,u,p;var c=Number.POSITIVE_INFINITY,d=Number.POSITIVE_INFINITY,f;var _=Number.NEGATIVE_INFINITY,y=Number.NEGATIVE_INFINITY,g=Number.NEGATIVE_INFINITY;var m=0;while(m<12){n=this._pLocalFrustum[m];o=this._pLocalFrustum[m+1];h=this._pLocalFrustum[m+2];l=n+(this._pLocalFrustum[m+12]-n)*e;u=o+(this._pLocalFrustum[m+13]-o)*e;p=h+(this._pLocalFrustum[m+14]-h)*e;if(n<c)c=n;if(n>_)_=n;if(o<d)d=o;if(o>y)y=o;if(h>g)g=h;if(l<c)c=l;if(l>_)_=l;if(u<d)d=u;if(u>y)y=u;if(p>g)g=p;m+=3}f=1;var b=_-c;var v=y-d;var w=1/(g-f);if(c<0)c-=this._pSnap;if(d<0)d-=this._pSnap;c=Math.floor(c/this._pSnap)*this._pSnap;d=Math.floor(d/this._pSnap)*this._pSnap;var x=2*this._pSnap;b=Math.floor(b/x+1)*x;v=Math.floor(v/x+1)*x;_=c+b;y=d+v;b=1/b;v=1/v;s[0]=2*b;s[5]=2*v;s[10]=w;s[12]=-(_+c)*b;s[13]=-(y+d)*v;s[14]=-f*w;s[15]=1;s[1]=s[2]=s[3]=s[4]=s[6]=s[7]=s[8]=s[9]=s[11]=0;t.copyRawDataFrom(s);t.appendScale(.96,.96,1);t.appendTranslation(i,r,0);t.appendScale(.5,.5,1)};e.prototype.addEventListener=function(t,e){this._changeDispatcher.addEventListener(t,e)};e.prototype.removeEventListener=function(t,e){this._changeDispatcher.removeEventListener(t,e)};e.prototype.dispatchEvent=function(t){return this._changeDispatcher.dispatchEvent(t)};e.prototype.hasEventListener=function(t){return this._changeDispatcher.hasEventListener(t)};Object.defineProperty(e.prototype,"_iNearPlaneDistances",{get:function(){return this._nearPlaneDistances},enumerable:true,configurable:true});return e}(u);e.exports=p},{"awayjs-core/lib/events/Event":undefined,"awayjs-core/lib/events/EventDispatcher":undefined,"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-core/lib/geom/Rectangle":undefined,"awayjs-core/lib/projections/FreeMatrixProjection":undefined,"awayjs-display/lib/entities/Camera":undefined,"awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper":undefined}],"awayjs-display/lib/materials/shadowmappers/CubeMapShadowMapper":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/PartialImplementationError");var s=t("awayjs-display/lib/entities/Camera");var n=t("awayjs-display/lib/materials/shadowmappers/ShadowMapperBase");var o=function(t){r(e,t);function e(){t.call(this);this._pDepthMapSize=512;this._needsRender=new Array;this.initCameras()}e.prototype.initCameras=function(){this._depthCameras=new Array;this._projections=new Array;this.addCamera(0,90,0);this.addCamera(0,-90,0);this.addCamera(-90,0,0);this.addCamera(90,0,0);this.addCamera(0,0,0);this.addCamera(0,180,0)};e.prototype.addCamera=function(t,e,i){var r=new s;r.rotationX=t;r.rotationY=e;r.rotationZ=i;r.projection.near=.01;var a=r.projection;a.fieldOfView=90;this._projections.push(a);r.projection._iAspectRatio=1;this._depthCameras.push(r)};e.prototype.pCreateDepthTexture=function(){throw new a};e.prototype.pUpdateDepthProjection=function(t){var e=this._pLight;var i=e._pFallOff;var r=this._pLight.scenePosition;for(var a=0;a<6;++a){this._projections[a].far=i;this._depthCameras[a].transform.position=r;this._needsRender[a]=true}};e.prototype.pDrawDepthMap=function(t,e,i){for(var r=0;r<6;++r){if(this._needsRender[r]){this._pCasterCollector.camera=this._depthCameras[r];this._pCasterCollector.clear();e.traversePartitions(this._pCasterCollector);i._iRender(this._pCasterCollector,t,null,r)}}};return e}(n);e.exports=o},{"awayjs-core/lib/errors/PartialImplementationError":undefined,"awayjs-display/lib/entities/Camera":undefined,"awayjs-display/lib/materials/shadowmappers/ShadowMapperBase":undefined}],"awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Matrix3D");var s=t("awayjs-core/lib/projections/FreeMatrixProjection");var n=t("awayjs-display/lib/entities/Camera");var o=t("awayjs-display/lib/materials/shadowmappers/ShadowMapperBase");var h=function(t){r(e,t);function e(){t.call(this);this._pLightOffset=1e4;this._pSnap=64;this._pCullPlanes=[];this._pOverallDepthProjection=new s;this._pOverallDepthCamera=new n(this._pOverallDepthProjection);this._pLocalFrustum=[];this._pMatrix=new a}Object.defineProperty(e.prototype,"snap",{get:function(){return this._pSnap},set:function(t){this._pSnap=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lightOffset",{get:function(){return this._pLightOffset},set:function(t){this._pLightOffset=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"iDepthProjection",{get:function(){return this._pOverallDepthCamera.viewProjection},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"depth",{get:function(){return this._pMaxZ-this._pMinZ},enumerable:true,configurable:true});e.prototype.pDrawDepthMap=function(t,e,i){this._pCasterCollector.camera=this._pOverallDepthCamera;this._pCasterCollector.cullPlanes=this._pCullPlanes;this._pCasterCollector.clear();e.traversePartitions(this._pCasterCollector);i._iRender(this._pCasterCollector,t)};e.prototype.pUpdateCullPlanes=function(t){var e=this._pOverallDepthCamera.frustumPlanes;var i=t.frustumPlanes;this._pCullPlanes.length=4;this._pCullPlanes[0]=e[0];this._pCullPlanes[1]=e[1];this._pCullPlanes[2]=e[2];this._pCullPlanes[3]=e[3];var r=this._pLight;var a=r.sceneDirection;var s=a.x;var n=a.y;var o=a.z;var h=4;for(var l=0;l<6;++l){var u=i[l];if(u.a*s+u.b*n+u.c*o<0)this._pCullPlanes[h++]=u}};e.prototype.pUpdateDepthProjection=function(t){this.pUpdateProjectionFromFrustumCorners(t,t.projection.frustumCorners,this._pMatrix);this._pOverallDepthProjection.matrix=this._pMatrix;this.pUpdateCullPlanes(t)};e.prototype.pUpdateProjectionFromFrustumCorners=function(t,e,i){var r=new Array;var a;var s,n,o;var h,l;var u,p;var c;var d=this._pLight;a=d.sceneDirection;this._pOverallDepthCamera.transform.matrix3D=this._pLight.sceneTransform;s=Math.floor((t.x-a.x*this._pLightOffset)/this._pSnap)*this._pSnap;n=Math.floor((t.y-a.y*this._pLightOffset)/this._pSnap)*this._pSnap;o=Math.floor((t.z-a.z*this._pLightOffset)/this._pSnap)*this._pSnap;this._pOverallDepthCamera.x=s;this._pOverallDepthCamera.y=n;this._pOverallDepthCamera.z=o;this._pMatrix.copyFrom(this._pOverallDepthCamera.inverseSceneTransform);this._pMatrix.prepend(t.sceneTransform);this._pMatrix.transformVectors(e,this._pLocalFrustum);h=u=this._pLocalFrustum[0];l=p=this._pLocalFrustum[1];this._pMaxZ=this._pLocalFrustum[2];c=3;while(c<24){s=this._pLocalFrustum[c];n=this._pLocalFrustum[c+1];o=this._pLocalFrustum[c+2];if(s<h)h=s;if(s>u)u=s;if(n<l)l=n;if(n>p)p=n;if(o>this._pMaxZ)this._pMaxZ=o;c+=3}this._pMinZ=1;var f=u-h;var _=p-l;var y=1/(this._pMaxZ-this._pMinZ);if(h<0)h-=this._pSnap;if(l<0)l-=this._pSnap;h=Math.floor(h/this._pSnap)*this._pSnap;l=Math.floor(l/this._pSnap)*this._pSnap;var g=2*this._pSnap;f=Math.floor(f/g+2)*g;_=Math.floor(_/g+2)*g;u=h+f;p=l+_;f=1/f;_=1/_;r[0]=2*f;r[5]=2*_;r[10]=y;r[12]=-(u+h)*f;r[13]=-(p+l)*_;r[14]=-this._pMinZ*y;r[15]=1;r[1]=r[2]=r[3]=r[4]=r[6]=r[7]=r[8]=r[9]=r[11]=0;i.copyRawDataFrom(r)};return e}(o);e.exports=h},{"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/projections/FreeMatrixProjection":undefined,"awayjs-display/lib/entities/Camera":undefined,"awayjs-display/lib/materials/shadowmappers/ShadowMapperBase":undefined}],"awayjs-display/lib/materials/shadowmappers/NearDirectionalShadowMapper":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper");var s=function(t){r(e,t);function e(e){if(e===void 0){e=.5}t.call(this);this.coverageRatio=e}Object.defineProperty(e.prototype,"coverageRatio",{get:function(){return this._coverageRatio},set:function(t){if(t>1)t=1;else if(t<0)t=0;this._coverageRatio=t},enumerable:true,configurable:true});e.prototype.pUpdateDepthProjection=function(t){var e=t.projection.frustumCorners;for(var i=0;i<12;++i){var r=e[i];this._pLocalFrustum[i]=r;this._pLocalFrustum[i+12]=r+(e[i+12]-r)*this._coverageRatio}this.pUpdateProjectionFromFrustumCorners(t,this._pLocalFrustum,this._pMatrix);this._pOverallDepthProjection.matrix=this._pMatrix};return e}(a);e.exports=s},{"awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper":undefined}],"awayjs-display/lib/materials/shadowmappers/ShadowMapperBase":[function(t,e,i){var r=t("awayjs-core/lib/errors/AbstractMethodError");var a=t("awayjs-display/lib/traverse/ShadowCasterCollector");var s=t("awayjs-core/lib/textures/RenderTexture");var n=function(){function t(){this._pDepthMapSize=2048;this._autoUpdateShadows=true;this._pCasterCollector=this.pCreateCasterCollector()}t.prototype.pCreateCasterCollector=function(){return new a};Object.defineProperty(t.prototype,"autoUpdateShadows",{get:function(){return this._autoUpdateShadows},set:function(t){this._autoUpdateShadows=t},enumerable:true,configurable:true});t.prototype.updateShadows=function(){this._iShadowsInvalid=true};t.prototype.iSetDepthMap=function(t){if(this._depthMap==t)return;if(this._depthMap&&!this._explicitDepthMap)this._depthMap.dispose();this._depthMap=t;if(this._depthMap){this._explicitDepthMap=true;this._pDepthMapSize=this._depthMap.size}else{this._explicitDepthMap=false}};Object.defineProperty(t.prototype,"light",{get:function(){return this._pLight},set:function(t){this._pLight=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"depthMap",{get:function(){if(!this._depthMap)this._depthMap=this.pCreateDepthTexture();return this._depthMap},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"depthMapSize",{get:function(){return this._pDepthMapSize},set:function(t){if(t==this._pDepthMapSize)return;this._pSetDepthMapSize(t)},enumerable:true,configurable:true});t.prototype.dispose=function(){this._pCasterCollector=null;if(this._depthMap&&!this._explicitDepthMap)this._depthMap.dispose();this._depthMap=null};t.prototype.pCreateDepthTexture=function(){return new s(this._pDepthMapSize,this._pDepthMapSize)};t.prototype.iRenderDepthMap=function(t,e){this._iShadowsInvalid=false;this.pUpdateDepthProjection(t.camera);if(!this._depthMap)this._depthMap=this.pCreateDepthTexture();this.pDrawDepthMap(this._depthMap,t.scene,e)};t.prototype.pUpdateDepthProjection=function(t){throw new r};t.prototype.pDrawDepthMap=function(t,e,i){throw new r};t.prototype._pSetDepthMapSize=function(t){this._pDepthMapSize=t;if(this._explicitDepthMap){throw Error("Cannot set depth map size for the current renderer.")}else if(this._depthMap){this._depthMap.dispose();this._depthMap=null}};return t}();e.exports=n},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/textures/RenderTexture":undefined,"awayjs-display/lib/traverse/ShadowCasterCollector":undefined}],"awayjs-display/lib/partition/CameraNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/partition/EntityNode");var s=function(t){r(e,t);function e(e){t.call(this,e)}e.prototype.acceptTraverser=function(t){};return e}(a);e.exports=s},{"awayjs-display/lib/partition/EntityNode":undefined}],"awayjs-display/lib/partition/DirectionalLightNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/partition/EntityNode");var s=function(t){r(e,t);function e(e){t.call(this,e);this._directionalLight=e}e.prototype.acceptTraverser=function(t){if(t.enterNode(this))t.applyDirectionalLight(this._directionalLight)};e.prototype.isCastingShadow=function(){return false};return e}(a);e.exports=s},{"awayjs-display/lib/partition/EntityNode":undefined}],"awayjs-display/lib/partition/EntityNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/PartialImplementationError");var s=t("awayjs-display/lib/partition/NodeBase");var n=function(t){r(e,t);function e(e){t.call(this);this._entity=e;this._iNumEntities=1}Object.defineProperty(e.prototype,"entity",{get:function(){return this._entity},enumerable:true,configurable:true});e.prototype.removeFromParent=function(){if(this._iParent)this._iParent.iRemoveNode(this);this._iParent=null};e.prototype.isCastingShadow=function(){return this.entity.castsShadows};e.prototype.isInFrustum=function(t,e){if(!this._entity._iIsVisible())return false;return this._entity.worldBounds.isInFrustum(t,e)};e.prototype.acceptTraverser=function(t){if(t.enterNode(this))t.applyEntity(this._entity)};e.prototype.isIntersectingRay=function(t,e){if(!this._entity._iIsVisible())return false;return this._entity.isIntersectingRay(t,e)};e.prototype._pCreateBoundsPrimitive=function(){throw new a};return e}(s);e.exports=n},{"awayjs-core/lib/errors/PartialImplementationError":undefined,"awayjs-display/lib/partition/NodeBase":undefined}],"awayjs-display/lib/partition/LightProbeNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/partition/EntityNode");var s=function(t){r(e,t);function e(e){t.call(this,e);this._lightProbe=e}e.prototype.acceptTraverser=function(t){if(t.enterNode(this))t.applyLightProbe(this._lightProbe)};e.prototype.isCastingShadow=function(){return false};return e}(a);e.exports=s},{"awayjs-display/lib/partition/EntityNode":undefined}],"awayjs-display/lib/partition/NodeBase":[function(t,e,i){var r=function(){function t(){this._pNumChildNodes=0;this._iNumEntities=0;this._pChildNodes=new Array}Object.defineProperty(t.prototype,"boundsVisible",{get:function(){return this._explicitBoundsVisible},set:function(t){if(this._explicitBoundsVisible==t)return;this._explicitBoundsVisible=t;this._iUpdateImplicitBoundsVisible(this._iParent?this._iParent.boundsChildrenVisible:false)},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"boundsChildrenVisible",{get:function(){return this._boundsChildrenVisible},set:function(t){if(this._boundsChildrenVisible==t)return;this._boundsChildrenVisible=t;for(var e=0;e<this._pNumChildNodes;++e)this._pChildNodes[e]._iUpdateImplicitBoundsVisible(this._boundsChildrenVisible)},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"parent",{get:function(){return this._iParent},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"_pNumEntities",{get:function(){return this._iNumEntities},enumerable:true,configurable:true});t.prototype.isInFrustum=function(t,e){return true};t.prototype.isIntersectingRay=function(t,e){return true};t.prototype.isCastingShadow=function(){return true};t.prototype.findPartitionForEntity=function(t){return this};t.prototype.acceptTraverser=function(t){if(this._pNumEntities==0&&!this._implicitBoundsVisible)return;if(t.enterNode(this)){var e=0;while(e<this._pNumChildNodes)this._pChildNodes[e++].acceptTraverser(t);if(this._implicitBoundsVisible)this._pBoundsPrimitive.partitionNode.acceptTraverser(t)}};t.prototype._pCreateBoundsPrimitive=function(){return null};t.prototype.iAddNode=function(t){t._iParent=this;this._iNumEntities+=t._pNumEntities;this._pChildNodes[this._pNumChildNodes++]=t;t._iUpdateImplicitBoundsVisible(this.boundsChildrenVisible);var e=t._pNumEntities;t=this;do{t._iNumEntities+=e}while((t=t._iParent)!=null)};t.prototype.iRemoveNode=function(t){var e=this._pChildNodes.indexOf(t);this._pChildNodes[e]=this._pChildNodes[--this._pNumChildNodes];this._pChildNodes.pop();t._iUpdateImplicitBoundsVisible(false);var i=t._pNumEntities;t=this;do{t._pNumEntities-=i}while((t=t._iParent)!=null)};t.prototype._iUpdateImplicitBoundsVisible=function(t){if(this._implicitBoundsVisible==this._explicitBoundsVisible||t)return;this._implicitBoundsVisible=this._explicitBoundsVisible||t;this._iUpdateEntityBounds();for(var e=0;e<this._pNumChildNodes;++e)this._pChildNodes[e]._iUpdateImplicitBoundsVisible(this._boundsChildrenVisible)};t.prototype._iIsBoundsVisible=function(){return this._implicitBoundsVisible};t.prototype._iUpdateEntityBounds=function(){if(this._pBoundsPrimitive){this._pBoundsPrimitive.dispose();this._pBoundsPrimitive=null}if(this._implicitBoundsVisible)this._pBoundsPrimitive=this._pCreateBoundsPrimitive()};return t}();e.exports=r},{}],"awayjs-display/lib/partition/NullNode":[function(t,e,i){var r=function(){function t(){}return t}();e.exports=r},{}],"awayjs-display/lib/partition/Partition":[function(t,e,i){var r=t("awayjs-display/lib/partition/NullNode");var a=function(){function t(t){this._updatesMade=false;this._rootNode=t||new r}Object.defineProperty(t.prototype,"rootNode",{get:function(){return this._rootNode},enumerable:true,configurable:true});t.prototype.traverse=function(t){if(this._updatesMade)this.updateEntities();this._rootNode.acceptTraverser(t)};t.prototype.iMarkForUpdate=function(t){var e=t.partitionNode;var i=this._updateQueue;while(i){if(e==i)return;i=i._iUpdateQueueNext}e._iUpdateQueueNext=this._updateQueue;this._updateQueue=e;this._updatesMade=true};t.prototype.iRemoveEntity=function(t){var e=t.partitionNode;var i;e.removeFromParent();if(e==this._updateQueue){this._updateQueue=e._iUpdateQueueNext}else{i=this._updateQueue;while(i&&i._iUpdateQueueNext!=e)i=i._iUpdateQueueNext;if(i)i._iUpdateQueueNext=e._iUpdateQueueNext}e._iUpdateQueueNext=null;if(!this._updateQueue)this._updatesMade=false};t.prototype.updateEntities=function(){var t=this._updateQueue;var e;var i;this._updateQueue=null;this._updatesMade=false;do{e=this._rootNode.findPartitionForEntity(t.entity);if(t.parent!=e){if(t)t.removeFromParent();e.iAddNode(t)}i=t._iUpdateQueueNext;t._iUpdateQueueNext=null;t.entity._iInternalUpdate()}while((t=i)!=null)};return t}();e.exports=a},{"awayjs-display/lib/partition/NullNode":undefined}],"awayjs-display/lib/partition/PointLightNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];
function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/partition/EntityNode");var s=function(t){r(e,t);function e(e){t.call(this,e);this._pointLight=e}e.prototype.acceptTraverser=function(t){if(t.enterNode(this))t.applyPointLight(this._pointLight)};e.prototype.isCastingShadow=function(){return false};return e}(a);e.exports=s},{"awayjs-display/lib/partition/EntityNode":undefined}],"awayjs-display/lib/partition/SkyboxNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/partition/EntityNode");var s=function(t){r(e,t);function e(e){t.call(this,e);this._skyBox=e}e.prototype.acceptTraverser=function(t){if(t.enterNode(this))t.applySkybox(this._skyBox)};e.prototype.isInFrustum=function(t,e){if(!this._skyBox._iIsVisible)return false;return true};return e}(a);e.exports=s},{"awayjs-display/lib/partition/EntityNode":undefined}],"awayjs-display/lib/pick/IPicker":[function(t,e,i){},{}],"awayjs-display/lib/pick/IPickingCollider":[function(t,e,i){},{}],"awayjs-display/lib/pick/PickingCollisionVO":[function(t,e,i){var r=function(){function t(t){this.displayObject=t}return t}();e.exports=r},{}],"awayjs-display/lib/pick/RaycastPicker":[function(t,e,i){var r=t("awayjs-core/lib/geom/Vector3D");var a=t("awayjs-display/lib/traverse/RaycastCollector");var s=function(){function t(t){if(t===void 0){t=false}this._ignoredEntities=[];this._onlyMouseEnabled=true;this._numEntities=0;this._raycastCollector=new a;this._findClosestCollision=t;this._entities=new Array}Object.defineProperty(t.prototype,"onlyMouseEnabled",{get:function(){return this._onlyMouseEnabled},set:function(t){this._onlyMouseEnabled=t},enumerable:true,configurable:true});t.prototype.getViewCollision=function(t,e,i){var r=i.unproject(t,e,0);var a=i.unproject(t,e,1).subtract(r);return this.getSceneCollision(r,a,i.scene)};t.prototype.getSceneCollision=function(t,e,i){this._raycastCollector.clear();this._raycastCollector.rayPosition=t;this._raycastCollector.rayDirection=e;i.traversePartitions(this._raycastCollector);this._numEntities=0;var r=this._raycastCollector.entityHead;var a;while(r){if(!this.isIgnored(a=r.entity))this._entities[this._numEntities++]=a;r=r.next}if(!this._numEntities)return null;return this.getPickingCollisionVO(this._raycastCollector)};t.prototype.setIgnoreList=function(t){this._ignoredEntities=t};t.prototype.isIgnored=function(t){if(this._onlyMouseEnabled&&!t._iIsMouseEnabled())return true;var e=this._ignoredEntities.length;for(var i=0;i<e;i++)if(this._ignoredEntities[i]==t)return true;return false};t.prototype.sortOnNearT=function(t,e){return t._iPickingCollisionVO.rayEntryDistance>e._iPickingCollisionVO.rayEntryDistance?1:-1};t.prototype.getPickingCollisionVO=function(t){this._entities.length=this._numEntities;this._entities=this._entities.sort(this.sortOnNearT);var e=Number.MAX_VALUE;var i;var r;var a;var s;for(s=0;s<this._numEntities;++s){a=this._entities[s];r=a._iPickingCollisionVO;if(a.pickingCollider){if((i==null||r.rayEntryDistance<i.rayEntryDistance)&&a._iTestCollision(e,this._findClosestCollision)){e=r.rayEntryDistance;i=r;if(!this._findClosestCollision){this.updateLocalPosition(r);return r}}}else if(i==null||r.rayEntryDistance<i.rayEntryDistance){if(!r.rayOriginIsInsideBounds){this.updateLocalPosition(r);return r}}}return i};t.prototype.updateLocalPosition=function(t){var e=t.localPosition==null?new r:t.localPosition;var i=t.localRayDirection;var a=t.localRayPosition;var s=t.rayEntryDistance;e.x=a.x+s*i.x;e.y=a.y+s*i.y;e.z=a.z+s*i.z};t.prototype.dispose=function(){};return t}();e.exports=s},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/traverse/RaycastCollector":undefined}],"awayjs-display/lib/pool/CSSBillboardRenderable":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/pool/CSSRenderableBase");var s=function(t){r(e,t);function e(e,i){t.call(this,e,i,i);var r=document.createElement("div");r.onmousedown=function(t){return false};this.htmlElement=r;var a=r.style;a.position="absolute";a.transformOrigin=a["-webkit-transform-origin"]=a["-moz-transform-origin"]=a["-o-transform-origin"]=a["-ms-transform-origin"]="0% 0%";var s=document.createElement("div");r.appendChild(s);s.className="material"+i.material.id}e.id="billboard";return e}(a);e.exports=s},{"awayjs-display/lib/pool/CSSRenderableBase":undefined}],"awayjs-display/lib/pool/CSSLineSegmentRenderable":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/pool/CSSRenderableBase");var s=function(t){r(e,t);function e(e,i){t.call(this,e,i,i);var r=document.createElement("div");r.onmousedown=function(t){return false};this.htmlElement=r;var a=r.style;a.position="absolute";a.transformOrigin=a["-webkit-transform-origin"]=a["-moz-transform-origin"]=a["-o-transform-origin"]=a["-ms-transform-origin"]="0% 0%";var s=document.createElement("div");r.appendChild(s);s.className="material"+i.material.id}e.id="lineSegment";return e}(a);e.exports=s},{"awayjs-display/lib/pool/CSSRenderableBase":undefined}],"awayjs-display/lib/pool/CSSRenderableBase":[function(t,e,i){var r=function(){function t(t,e,i){this._pool=t;this.sourceEntity=e;this.materialOwner=i}t.prototype.dispose=function(){this._pool.disposeItem(this.materialOwner)};t.prototype.invalidateGeometry=function(){};t.prototype.invalidateIndexData=function(){};t.prototype.invalidateVertexData=function(t){};return t}();e.exports=r},{}],"awayjs-display/lib/pool/CSSSkyboxRenderable":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/pool/CSSRenderableBase");var s=function(t){r(e,t);function e(e,i){t.call(this,e,i,i);var r=document.createElement("div");r.onmousedown=function(t){return false};this.htmlElement=r;var a=r.style;var s;a.position="absolute";a.transformOrigin=a["-webkit-transform-origin"]=a["-moz-transform-origin"]=a["-o-transform-origin"]=a["-ms-transform-origin"]="0% 0%";s=document.createElement("div");r.appendChild(s);s.className="material"+i.material.id}e.id="skybox";return e}(a);e.exports=s},{"awayjs-display/lib/pool/CSSRenderableBase":undefined}],"awayjs-display/lib/pool/EntityListItemPool":[function(t,e,i){var r=t("awayjs-display/lib/pool/EntityListItem");var a=function(){function t(){this._index=0;this._poolSize=0;this._pool=new Array}t.prototype.getItem=function(){var t;if(this._index==this._poolSize){t=new r;this._pool[this._index++]=t;++this._poolSize}else{t=this._pool[this._index++]}return t};t.prototype.freeAll=function(){this._index=0};t.prototype.dispose=function(){this._pool.length=0};return t}();e.exports=a},{"awayjs-display/lib/pool/EntityListItem":undefined}],"awayjs-display/lib/pool/EntityListItem":[function(t,e,i){var r=function(){function t(){}return t}();e.exports=r},{}],"awayjs-display/lib/pool/IMaterialData":[function(t,e,i){},{}],"awayjs-display/lib/pool/IMaterialPassData":[function(t,e,i){},{}],"awayjs-display/lib/pool/IRenderableClass":[function(t,e,i){},{}],"awayjs-display/lib/pool/IRenderable":[function(t,e,i){},{}],"awayjs-display/lib/pool/RenderablePool":[function(t,e,i){var r=function(){function t(t){this._pool=new Object;this._renderableClass=t}t.prototype.getItem=function(t){return this._pool[t.id]||(this._pool[t.id]=t._iAddRenderable(new this._renderableClass(this,t)))};t.prototype.disposeItem=function(t){t._iRemoveRenderable(this._pool[t.id]);this._pool[t.id]=null};t.getPool=function(e){var i=t._pools[e.id];if(i!=undefined)return i;return t._pools[e.id]=new t(e)};t.disposePool=function(e){if(t._pools[e.id])t._pools[e.id]=undefined};t._pools=new Object;return t}();e.exports=r},{}],"awayjs-display/lib/prefabs/PrefabBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/NamedAssetBase");var s=t("awayjs-core/lib/errors/AbstractMethodError");var n=function(t){r(e,t);function e(){t.call(this);this._pObjects=new Array}e.prototype.getNewObject=function(){var t=this._pCreateObject();this._pObjects.push(t);return t};e.prototype._pCreateObject=function(){throw new s};e.prototype._iValidate=function(){};return e}(a);e.exports=n},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/library/NamedAssetBase":undefined}],"awayjs-display/lib/prefabs/PrimitiveCapsulePrefab":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/prefabs/PrimitivePrefabBase");var s=function(t){r(e,t);function e(e,i,r,a,s){if(e===void 0){e=50}if(i===void 0){i=100}if(r===void 0){r=16}if(a===void 0){a=15}if(s===void 0){s=true}t.call(this);this._numVertices=0;this._radius=e;this._height=i;this._segmentsW=r;this._segmentsH=a%2==0?a+1:a;this._yUp=s}Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsW",{get:function(){return this._segmentsW},set:function(t){this._segmentsW=t;this._pInvalidateGeometry();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsH",{get:function(){return this._segmentsH},set:function(t){this._segmentsH=t%2==0?t+1:t;this._pInvalidateGeometry();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"yUp",{get:function(){return this._yUp},set:function(t){this._yUp=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});e.prototype._pBuildGeometry=function(t,e){var i;var r;var a;var s;var n;var o;var h=0;var l=0;var u;var p,c,d,f;var _=0;if(e=="triangleSubGeometry"){var y=t;this._numVertices=(this._segmentsH+1)*(this._segmentsW+1);_=(this._segmentsH-1)*this._segmentsW*6;if(this._numVertices==y.numVertices){i=y.indices;r=y.positions;a=y.vertexNormals;s=y.vertexTangents}else{i=new Array(_);r=new Array(this._numVertices*3);a=new Array(this._numVertices*3);s=new Array(this._numVertices*3);this._pInvalidateUVs()}for(o=0;o<=this._segmentsH;++o){var g=Math.PI*o/this._segmentsH;var m=-this._radius*Math.cos(g);var b=this._radius*Math.sin(g);u=l;for(n=0;n<=this._segmentsW;++n){var v=2*Math.PI*n/this._segmentsW;var w=b*Math.cos(v);var x=o>this._segmentsH/2?this._height/2:-this._height/2;var P=b*Math.sin(v);var D=1/Math.sqrt(w*w+P*P+m*m);var C=Math.sqrt(P*P+w*w);if(this._yUp){d=0;f=C>.007?w/C:0;p=-m;c=P}else{d=C>.007?w/C:0;f=0;p=P;c=m}if(n==this._segmentsW){r[l]=r[u];r[l+1]=r[u+1];r[l+2]=r[u+2];a[l]=(a[u]+w*D)*.5;a[l+1]=(a[u+1]+p*D)*.5;a[l+2]=(a[u+2]+c*D)*.5;s[l]=(s[u]+(C>.007?-P/C:1))*.5;s[l+1]=(s[u+1]+d)*.5;s[l+2]=(s[u+2]+f)*.5}else{r[l]=w;r[l+1]=this._yUp?p-x:p;r[l+2]=this._yUp?c:c+x;a[l]=w*D;a[l+1]=p*D;a[l+2]=c*D;s[l]=C>.007?-P/C:1;s[l+1]=d;s[l+2]=f}if(n>0&&o>0){var T=(this._segmentsW+1)*o+n;var A=(this._segmentsW+1)*o+n-1;var S=(this._segmentsW+1)*(o-1)+n-1;var j=(this._segmentsW+1)*(o-1)+n;if(o==this._segmentsH){r[l]=r[u];r[l+1]=r[u+1];r[l+2]=r[u+2];i[h++]=T;i[h++]=S;i[h++]=j}else if(o==1){i[h++]=T;i[h++]=A;i[h++]=S}else{i[h++]=T;i[h++]=A;i[h++]=S;i[h++]=T;i[h++]=S;i[h++]=j}}l+=3}}y.updateIndices(i);y.updatePositions(r);y.updateVertexNormals(a);y.updateVertexTangents(s)}else if(e=="lineSubGeometry"){}};e.prototype._pBuildUVs=function(t,e){var i,r;var a;if(e=="triangleSubGeometry"){var s=t;if(s.uvs&&this._numVertices==s.numVertices){a=s.uvs}else{a=new Array(this._numVertices*2)}var n=0;for(r=0;r<=this._segmentsH;++r){for(i=0;i<=this._segmentsW;++i){a[n++]=i/this._segmentsW*s.scaleU;a[n++]=r/this._segmentsH*s.scaleV}}s.updateUVs(a)}else if(e=="lineSubGeometry"){}};return e}(a);e.exports=s},{"awayjs-display/lib/prefabs/PrimitivePrefabBase":undefined}],"awayjs-display/lib/prefabs/PrimitiveConePrefab":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/prefabs/PrimitiveCylinderPrefab");var s=function(t){r(e,t);function e(e,i,r,a,s,n){if(e===void 0){e=50}if(i===void 0){i=100}if(r===void 0){r=16}if(a===void 0){a=1}if(s===void 0){s=true}if(n===void 0){n=true}t.call(this,0,e,i,r,a,false,s,true,n)}Object.defineProperty(e.prototype,"radius",{get:function(){return this._pBottomRadius},set:function(t){this._pBottomRadius=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});return e}(a);e.exports=s},{"awayjs-display/lib/prefabs/PrimitiveCylinderPrefab":undefined}],"awayjs-display/lib/prefabs/PrimitiveCubePrefab":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/prefabs/PrimitivePrefabBase");var s=function(t){r(e,t);function e(e,i,r,a,s,n,o){if(e===void 0){e=100}if(i===void 0){i=100}if(r===void 0){r=100}if(a===void 0){a=1}if(s===void 0){s=1}if(n===void 0){n=1}if(o===void 0){o=true}t.call(this);this._width=e;this._height=i;this._depth=r;this._segmentsW=a;this._segmentsH=s;this._segmentsD=n;this._tile6=o}Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"depth",{get:function(){return this._depth},set:function(t){this._depth=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"tile6",{get:function(){return this._tile6},set:function(t){this._tile6=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsW",{get:function(){return this._segmentsW},set:function(t){this._segmentsW=t;this._pInvalidateGeometry();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsH",{get:function(){return this._segmentsH},set:function(t){this._segmentsH=t;this._pInvalidateGeometry();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsD",{get:function(){return this._segmentsD},set:function(t){this._segmentsD=t;this._pInvalidateGeometry();this._pInvalidateUVs()},enumerable:true,configurable:true});e.prototype._pBuildGeometry=function(t,e){var i;var r;var a;var s;var n,o,h,l;var u,p,c=0;var d,f;var _,y,g;var m,b,v;var w;var x;var P;_=this._width/2;y=this._height/2;g=this._depth/2;if(e=="triangleSubGeometry"){var D=t;P=((this._segmentsW+1)*(this._segmentsH+1)+(this._segmentsW+1)*(this._segmentsD+1)+(this._segmentsH+1)*(this._segmentsD+1))*2;x=(this._segmentsW*this._segmentsH+this._segmentsW*this._segmentsD+this._segmentsH*this._segmentsD)*12;if(P==D.numVertices&&D.indices!=null){i=D.indices;r=D.positions;a=D.vertexNormals;s=D.vertexTangents}else{i=new Array(x);r=new Array(P*3);a=new Array(P*3);s=new Array(P*3);this._pInvalidateUVs()}d=0;f=0;m=this._width/this._segmentsW;b=this._height/this._segmentsH;v=this._depth/this._segmentsD;for(u=0;u<=this._segmentsW;u++){w=-_+u*m;for(p=0;p<=this._segmentsH;p++){r[d]=w;r[d+1]=-y+p*b;r[d+2]=-g;a[d]=0;a[d+1]=0;a[d+2]=-1;s[d]=1;s[d+1]=0;s[d+2]=0;d+=3;r[d]=w;r[d+1]=-y+p*b;r[d+2]=g;a[d]=0;a[d+1]=0;a[d+2]=1;s[d]=-1;s[d+1]=0;s[d+2]=0;d+=3;if(u&&p){n=2*((u-1)*(this._segmentsH+1)+(p-1));o=2*(u*(this._segmentsH+1)+(p-1));h=n+2;l=o+2;i[f++]=n;i[f++]=h;i[f++]=l;i[f++]=n;i[f++]=l;i[f++]=o;i[f++]=o+1;i[f++]=l+1;i[f++]=h+1;i[f++]=o+1;i[f++]=h+1;i[f++]=n+1}}}c+=2*(this._segmentsW+1)*(this._segmentsH+1);for(u=0;u<=this._segmentsW;u++){w=-_+u*m;for(p=0;p<=this._segmentsD;p++){r[d]=w;r[d+1]=y;r[d+2]=-g+p*v;a[d]=0;a[d+1]=1;a[d+2]=0;s[d]=1;s[d+1]=0;s[d+2]=0;d+=3;r[d]=w;r[d+1]=-y;r[d+2]=-g+p*v;a[d]=0;a[d+1]=-1;a[d+2]=0;s[d]=1;s[d+1]=0;s[d+2]=0;d+=3;if(u&&p){n=c+2*((u-1)*(this._segmentsD+1)+(p-1));o=c+2*(u*(this._segmentsD+1)+(p-1));h=n+2;l=o+2;i[f++]=n;i[f++]=h;i[f++]=l;i[f++]=n;i[f++]=l;i[f++]=o;i[f++]=o+1;i[f++]=l+1;i[f++]=h+1;i[f++]=o+1;i[f++]=h+1;i[f++]=n+1}}}c+=2*(this._segmentsW+1)*(this._segmentsD+1);for(u=0;u<=this._segmentsD;u++){w=g-u*v;for(p=0;p<=this._segmentsH;p++){r[d]=-_;r[d+1]=-y+p*b;r[d+2]=w;a[d]=-1;a[d+1]=0;a[d+2]=0;s[d]=0;s[d+1]=0;s[d+2]=-1;d+=3;r[d]=_;r[d+1]=-y+p*b;r[d+2]=w;a[d]=1;a[d+1]=0;a[d+2]=0;s[d]=0;s[d+1]=0;s[d+2]=1;d+=3;if(u&&p){n=c+2*((u-1)*(this._segmentsH+1)+(p-1));o=c+2*(u*(this._segmentsH+1)+(p-1));h=n+2;l=o+2;i[f++]=n;i[f++]=h;i[f++]=l;i[f++]=n;i[f++]=l;i[f++]=o;i[f++]=o+1;i[f++]=l+1;i[f++]=h+1;i[f++]=o+1;i[f++]=h+1;i[f++]=n+1}}}D.updateIndices(i);D.updatePositions(r);D.updateVertexNormals(a);D.updateVertexTangents(s)}else if(e=="lineSubGeometry"){var C=t;var T=this._segmentsH*4+this._segmentsW*4+this._segmentsD*4;var A;var S;var j;if(C.indices!=null&&T==C.numSegments){A=C.startPositions;S=C.endPositions;j=C.thickness}else{A=new Array(T*3);S=new Array(T*3);j=new Array(T)}d=0;f=0;for(u=0;u<this._segmentsH;++u){A[d]=-_;A[d+1]=u*this._height/this._segmentsH-y;A[d+2]=-g;S[d]=_;S[d+1]=u*this._height/this._segmentsH-y;S[d+2]=-g;j[f++]=1;d+=3;A[d]=-_;A[d+1]=y-u*this._height/this._segmentsH;A[d+2]=g;S[d]=_;S[d+1]=y-u*this._height/this._segmentsH;S[d+2]=g;j[f++]=1;d+=3}for(u=0;u<this._segmentsW;++u){A[d]=u*this._width/this._segmentsW-_;A[d+1]=-y;A[d+2]=-g;S[d]=u*this._width/this._segmentsW-_;S[d+1]=y;S[d+2]=-g;j[f++]=1;d+=3;A[d]=_-u*this._width/this._segmentsW;A[d+1]=-y;A[d+2]=g;S[d]=_-u*this._width/this._segmentsW;S[d+1]=y;S[d+2]=g;j[f++]=1;d+=3}for(u=0;u<this._segmentsH;++u){A[d]=-_;A[d+1]=u*this._height/this._segmentsH-y;A[d+2]=-g;S[d]=-_;S[d+1]=u*this._height/this._segmentsH-y;S[d+2]=g;j[f++]=1;d+=3;A[d]=_;A[d+1]=y-u*this._height/this._segmentsH;A[d+2]=-g;S[d]=_;S[d+1]=y-u*this._height/this._segmentsH;S[d+2]=g;j[f++]=1;d+=3}for(u=0;u<this._segmentsD;++u){A[d]=_;A[d+1]=-y;A[d+2]=u*this._depth/this._segmentsD-g;S[d]=_;S[d+1]=y;S[d+2]=u*this._depth/this._segmentsD-g;j[f++]=1;d+=3;A[d]=-_;A[d+1]=-y;A[d+2]=g-u*this._depth/this._segmentsD;S[d]=-_;S[d+1]=y;S[d+2]=g-u*this._depth/this._segmentsD;j[f++]=1;d+=3}for(u=0;u<this._segmentsD;++u){A[d]=-_;A[d+1]=-y;A[d+2]=g-u*this._depth/this._segmentsD;S[d]=_;S[d+1]=-y;S[d+2]=g-u*this._depth/this._segmentsD;j[f++]=1;d+=3;A[d]=-_;A[d+1]=y;A[d+2]=u*this._depth/this._segmentsD-g;S[d]=_;S[d+1]=y;S[d+2]=u*this._depth/this._segmentsD-g;j[f++]=1;d+=3}for(u=0;u<this._segmentsW;++u){A[d]=_-u*this._width/this._segmentsW;A[d+1]=-y;A[d+2]=-g;S[d]=_-u*this._width/this._segmentsW;S[d+1]=-y;S[d+2]=g;j[f++]=1;d+=3;A[d]=u*this._width/this._segmentsW-_;A[d+1]=y;A[d+2]=-g;S[d]=u*this._width/this._segmentsW-_;S[d+1]=y;S[d+2]=g;j[f++]=1;d+=3}C.updatePositions(A,S);C.updateThickness(j)}};e.prototype._pBuildUVs=function(t,e){var i,r,a;var s;var n,o;var h,l;var u,p;var c,d;var f,_;var y;if(e=="triangleSubGeometry"){y=((this._segmentsW+1)*(this._segmentsH+1)+(this._segmentsW+1)*(this._segmentsD+1)+(this._segmentsH+1)*(this._segmentsD+1))*2;var g=t;if(y==g.numVertices&&g.uvs!=null){s=g.uvs}else{s=new Array(y*2)}if(this._tile6){n=h=1/3;o=l=1/2}else{n=o=1;h=l=0}a=0;u=1*h;p=1*l;c=2*h;d=0*l;f=n/this._segmentsW;_=o/this._segmentsH;for(i=0;i<=this._segmentsW;i++){for(r=0;r<=this._segmentsH;r++){s[a++]=(u+i*f)*g.scaleU;s[a++]=(p+(o-r*_))*g.scaleV;s[a++]=(c+(n-i*f))*g.scaleU;s[a++]=(d+(o-r*_))*g.scaleV}}u=1*h;p=0*l;c=0*h;d=0*l;f=n/this._segmentsW;_=o/this._segmentsD;for(i=0;i<=this._segmentsW;i++){for(r=0;r<=this._segmentsD;r++){s[a++]=(u+i*f)*g.scaleU;s[a++]=(p+(o-r*_))*g.scaleV;s[a++]=(c+i*f)*g.scaleU;s[a++]=(d+r*_)*g.scaleV}}u=0*h;p=1*l;c=2*h;d=1*l;f=n/this._segmentsD;_=o/this._segmentsH;for(i=0;i<=this._segmentsD;i++){for(r=0;r<=this._segmentsH;r++){s[a++]=(u+i*f)*g.scaleU;s[a++]=(p+(o-r*_))*g.scaleV;s[a++]=(c+(n-i*f))*g.scaleU;s[a++]=(d+(o-r*_))*g.scaleV}}g.updateUVs(s)}else if(e=="lineSubGeometry"){}};return e}(a);e.exports=s},{"awayjs-display/lib/prefabs/PrimitivePrefabBase":undefined}],"awayjs-display/lib/prefabs/PrimitiveCylinderPrefab":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/prefabs/PrimitivePrefabBase");var s=function(t){r(e,t);function e(e,i,r,a,s,n,o,h,l){if(e===void 0){e=50}if(i===void 0){i=50}if(r===void 0){r=100}if(a===void 0){a=16}if(s===void 0){s=1}if(n===void 0){n=true}if(o===void 0){o=true}if(h===void 0){h=true}if(l===void 0){l=true}t.call(this);this._numVertices=0;this._topRadius=e;this._pBottomRadius=i;this._height=r;this._pSegmentsW=a;this._pSegmentsH=s;this._topClosed=n;this._bottomClosed=o;this._surfaceClosed=h;this._yUp=l}Object.defineProperty(e.prototype,"topRadius",{get:function(){return this._topRadius},set:function(t){this._topRadius=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"bottomRadius",{get:function(){return this._pBottomRadius},set:function(t){this._pBottomRadius=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsW",{get:function(){return this._pSegmentsW},set:function(t){this.setSegmentsW(t)},enumerable:true,configurable:true});e.prototype.setSegmentsW=function(t){this._pSegmentsW=t;this._pInvalidateGeometry();this._pInvalidateUVs()};Object.defineProperty(e.prototype,"segmentsH",{get:function(){return this._pSegmentsH},set:function(t){this.setSegmentsH(t)},enumerable:true,configurable:true});e.prototype.setSegmentsH=function(t){this._pSegmentsH=t;this._pInvalidateGeometry();this._pInvalidateUVs()};Object.defineProperty(e.prototype,"topClosed",{get:function(){return this._topClosed},set:function(t){this._topClosed=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"bottomClosed",{get:function(){return this._bottomClosed},set:function(t){this._bottomClosed=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"yUp",{get:function(){return this._yUp},set:function(t){this._yUp=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});e.prototype._pBuildGeometry=function(t,e){var i;var r;var a;var s;var n;var o;var h;var l;var u;var p;var c;var d;var f;var _;var y;var g;var m=0;var b;var v;var w=0;var x=0;var P;var D;this._numVertices=0;var C=2*Math.PI/this._pSegmentsW;if(e=="triangleSubGeometry"){var T=t;if(this._surfaceClosed){this._numVertices+=(this._pSegmentsH+1)*(this._pSegmentsW+1);m+=this._pSegmentsH*this._pSegmentsW*6}if(this._topClosed){this._numVertices+=2*(this._pSegmentsW+1);m+=this._pSegmentsW*3}if(this._bottomClosed){this._numVertices+=2*(this._pSegmentsW+1);m+=this._pSegmentsW*3}if(this._numVertices==T.numVertices){i=T.indices;r=T.positions;a=T.vertexNormals;s=T.vertexTangents}else{i=new Array(m);r=new Array(this._numVertices*3);a=new Array(this._numVertices*3);s=new Array(this._numVertices*3);this._pInvalidateUVs()}p=0;c=0;if(this._topClosed&&this._topRadius>0){u=-.5*this._height;for(n=0;n<=this._pSegmentsW;++n){if(this._yUp){P=1;D=0;b=-u;v=0}else{P=0;D=-1;b=0;v=u}r[p]=0;r[p+1]=b;r[p+2]=v;a[p]=0;a[p+1]=P;a[p+2]=D;s[p]=1;s[p+1]=0;s[p+2]=0;p+=3;f=n*C;h=this._topRadius*Math.cos(f);l=this._topRadius*Math.sin(f);if(this._yUp){b=-u;v=l}else{b=l;v=u}if(n==this._pSegmentsW){r[p]=r[w+3];r[p+1]=r[w+4];r[p+2]=r[w+5]}else{r[p]=h;r[p+1]=b;r[p+2]=v}a[p]=0;a[p+1]=P;a[p+2]=D;s[p]=1;s[p+1]=0;s[p+2]=0;p+=3;if(n>0){i[c++]=x;i[c++]=x+1;i[c++]=x+2;x+=2}}x+=2}if(this._bottomClosed&&this._pBottomRadius>0){u=.5*this._height;w=x*3;for(n=0;n<=this._pSegmentsW;++n){if(this._yUp){P=-1;D=0;b=-u;v=0}else{P=0;D=1;b=0;v=u}r[p]=0;r[p+1]=b;r[p+2]=v;a[p]=0;a[p+1]=P;a[p+2]=D;s[p]=1;s[p+1]=0;s[p+2]=0;p+=3;f=n*C;h=this._pBottomRadius*Math.cos(f);l=this._pBottomRadius*Math.sin(f);if(this._yUp){b=-u;v=l}else{b=l;v=u}if(n==this._pSegmentsW){r[p]=r[w+3];r[p+1]=r[w+4];r[p+2]=r[w+5]}else{r[p]=h;r[p+1]=b;r[p+2]=v}a[p]=0;a[p+1]=P;a[p+2]=D;s[p]=1;s[p+1]=0;s[p+2]=0;p+=3;if(n>0){i[c++]=x;i[c++]=x+2;i[c++]=x+1;x+=2}}x+=2}_=this._pBottomRadius-this._topRadius;y=_/this._height;g=y==0?1:this._height/_;if(this._surfaceClosed){var A;var S;var j;var O;var E,M,R,I;for(o=0;o<=this._pSegmentsH;++o){d=this._topRadius-o/this._pSegmentsH*(this._topRadius-this._pBottomRadius);u=-(this._height/2)+o/this._pSegmentsH*this._height;w=x*3;for(n=0;n<=this._pSegmentsW;++n){f=n*C;h=d*Math.cos(f);l=d*Math.sin(f);E=g*Math.cos(f);M=g*Math.sin(f);if(this._yUp){P=0;D=-E;b=-u;v=l;R=y;I=M}else{P=-E;D=0;b=l;v=u;R=M;I=y}if(n==this._pSegmentsW){r[p]=r[w];r[p+1]=r[w+1];r[p+2]=r[w+2];a[p]=E;a[p+1]=y;a[p+2]=M;s[p]=M;s[p+1]=P;s[p+2]=D}else{r[p]=h;r[p+1]=b;r[p+2]=v;a[p]=E;a[p+1]=R;a[p+2]=I;s[p]=-M;s[p+1]=P;s[p+2]=D}p+=3;if(n>0&&o>0){A=x;S=x-1;j=S-this._pSegmentsW-1;O=A-this._pSegmentsW-1;i[c++]=A;i[c++]=S;i[c++]=j;i[c++]=A;i[c++]=j;i[c++]=O}x++}}}T.updateIndices(i);T.updatePositions(r);T.updateVertexNormals(a);T.updateVertexTangents(s)}else if(e=="lineSubGeometry"){var N=t;var L=(this._pSegmentsH+1)*this._pSegmentsW+this._pSegmentsW;var F;var V;var B;if(N.indices!=null&&L==N.numSegments){F=N.startPositions;V=N.endPositions;B=N.thickness}else{F=new Array(L*3);V=new Array(L*3);B=new Array(L)}p=0;c=0;for(o=0;o<=this._pSegmentsH;++o){d=this._topRadius-o/this._pSegmentsH*(this._topRadius-this._pBottomRadius);u=this._height*(o/this._pSegmentsH-.5);for(n=0;n<=this._pSegmentsW;++n){f=n*C;h=d*Math.cos(f);l=d*Math.sin(f);if(this._yUp){b=-u;v=l}else{b=l;v=u}if(n>0){V[p]=h;V[p+1]=b;V[p+2]=v;B[c++]=1;p+=3;F[p]=V[p-this._pSegmentsW*6];F[p+1]=V[p+1-this._pSegmentsW*6];F[p+2]=V[p+2-this._pSegmentsW*6];V[p]=h;V[p+1]=b;V[p+2]=v;B[c++]=1;p+=3}if(n<this._pSegmentsW){F[p]=h;F[p+1]=b;F[p+2]=v}}}N.updatePositions(F,V);N.updateThickness(B)}};e.prototype._pBuildUVs=function(t,e){var i;var r;var a;var s;var n;var o;if(e=="triangleSubGeometry"){var h=t;if(h.uvs&&this._numVertices==h.numVertices){o=h.uvs}else{o=new Array(this._numVertices*2)}var l=2*Math.PI/this._pSegmentsW;var u=0;if(this._topClosed){for(i=0;i<=this._pSegmentsW;++i){n=i*l;a=.5+.5*-Math.cos(n);s=.5+.5*Math.sin(n);o[u++]=.5*h.scaleU;o[u++]=.5*h.scaleV;o[u++]=a*h.scaleU;o[u++]=s*h.scaleV}}if(this._bottomClosed){for(i=0;i<=this._pSegmentsW;++i){n=i*l;a=.5+.5*Math.cos(n);s=.5+.5*Math.sin(n);o[u++]=.5*h.scaleU;o[u++]=.5*h.scaleV;o[u++]=a*h.scaleU;o[u++]=s*h.scaleV}}if(this._surfaceClosed){for(r=0;r<=this._pSegmentsH;++r){for(i=0;i<=this._pSegmentsW;++i){o[u++]=i/this._pSegmentsW*h.scaleU;o[u++]=r/this._pSegmentsH*h.scaleV}}}h.updateUVs(o)}else if(e=="lineSubGeometry"){}};return e}(a);e.exports=s},{"awayjs-display/lib/prefabs/PrimitivePrefabBase":undefined}],"awayjs-display/lib/prefabs/PrimitivePlanePrefab":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/prefabs/PrimitivePrefabBase");var s=function(t){r(e,t);function e(e,i,r,a,s,n){if(e===void 0){e=100}if(i===void 0){i=100}if(r===void 0){r=1}if(a===void 0){a=1}if(s===void 0){s=true}if(n===void 0){n=false}t.call(this);this._segmentsW=r;this._segmentsH=a;this._yUp=s;this._width=e;this._height=i;this._doubleSided=n}Object.defineProperty(e.prototype,"segmentsW",{get:function(){return this._segmentsW},set:function(t){this._segmentsW=t;this._pInvalidateGeometry();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsH",{get:function(){return this._segmentsH},set:function(t){this._segmentsH=t;this._pInvalidateGeometry();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"yUp",{get:function(){return this._yUp},set:function(t){this._yUp=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"doubleSided",{get:function(){return this._doubleSided},set:function(t){this._doubleSided=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});e.prototype._pBuildGeometry=function(t,e){var i;var r,a;var s;var n;var o=this._segmentsW+1;var h;var l,u;var p;var c;if(e=="triangleSubGeometry"){var d=t;var h=(this._segmentsH+1)*o;var f;var _;var y;if(this._doubleSided)h*=2;s=this._segmentsH*this._segmentsW*6;if(this._doubleSided)s*=2;if(d.indices!=null&&s==d.indices.length){i=d.indices}else{i=new Array(s);this._pInvalidateUVs()}if(h==d.numVertices){f=d.positions;_=d.vertexNormals;y=d.vertexTangents}else{f=new Array(h*3);_=new Array(h*3);y=new Array(h*3);this._pInvalidateUVs()}u=0;l=0;for(c=0;c<=this._segmentsH;++c){for(p=0;p<=this._segmentsW;++p){r=(p/this._segmentsW-.5)*this._width;a=(c/this._segmentsH-.5)*this._height;f[l]=r;if(this._yUp){f[l+1]=0;f[l+2]=a}else{f[l+1]=a;f[l+2]=0}_[l]=0;if(this._yUp){_[l+1]=1;_[l+2]=0}else{_[l+1]=0;_[l+2]=-1}y[l]=1;y[l+1]=0;y[l+2]=0;l+=3;if(this._doubleSided){for(var g=l;g<l+3;++g){f[g]=f[g-3];_[g]=-_[g-3];y[g]=-y[g-3]}l+=3}if(p!=this._segmentsW&&c!=this._segmentsH){n=p+c*o;var m=this._doubleSided?2:1;i[u++]=n*m;i[u++]=(n+o)*m;i[u++]=(n+o+1)*m;i[u++]=n*m;i[u++]=(n+o+1)*m;i[u++]=(n+1)*m;if(this._doubleSided){i[u++]=(n+o+1)*m+1;i[u++]=(n+o)*m+1;i[u++]=n*m+1;i[u++]=(n+1)*m+1;i[u++]=(n+o+1)*m+1;i[u++]=n*m+1}}}}d.updateIndices(i);d.updatePositions(f);d.updateVertexNormals(_);d.updateVertexTangents(y)}else if(e=="lineSubGeometry"){var b=t;var v=this._segmentsH+1+o;var w;var x;var P;var D=this._width/2;var C=this._height/2;if(b.indices!=null&&v==b.numSegments){w=b.startPositions;x=b.endPositions;P=b.thickness}else{w=new Array(v*3);x=new Array(v*3);P=new Array(v)}u=0;l=0;for(c=0;c<=this._segmentsH;++c){w[l]=-D;w[l+1]=0;w[l+2]=c*this._height-C;x[l]=D;x[l+1]=0;x[l+2]=c*this._height-C;P[u++]=1;l+=3}for(p=0;p<=this._segmentsW;++p){w[l]=p*this._width-D;w[l+1]=0;w[l+2]=-C;x[l]=p*this._width-D;x[l+1]=0;x[l+2]=C;P[u++]=1;l+=3}b.updatePositions(w,x);b.updateThickness(P)}};e.prototype._pBuildUVs=function(t,e){var i;var r;if(e=="triangleSubGeometry"){r=(this._segmentsH+1)*(this._segmentsW+1);if(this._doubleSided)r*=2;var a=t;if(a.uvs&&r==a.numVertices){i=a.uvs}else{i=new Array(r*2);this._pInvalidateGeometry()}var s=0;for(var n=0;n<=this._segmentsH;++n){for(var o=0;o<=this._segmentsW;++o){i[s]=o/this._segmentsW*a.scaleU;i[s+1]=(1-n/this._segmentsH)*a.scaleV;s+=2;if(this._doubleSided){i[s]=o/this._segmentsW*a.scaleU;i[s+1]=(1-n/this._segmentsH)*a.scaleV;s+=2}}}a.updateUVs(i)}else if(e=="lineSubGeometry"){}};return e}(a);e.exports=s},{"awayjs-display/lib/prefabs/PrimitivePrefabBase":undefined}],"awayjs-display/lib/prefabs/PrimitivePolygonPrefab":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/prefabs/PrimitiveCylinderPrefab");
var s=function(t){r(e,t);function e(e,i,r){if(e===void 0){e=100}if(i===void 0){i=16}if(r===void 0){r=true}t.call(this,e,0,0,i,1,true,false,false,r)}Object.defineProperty(e.prototype,"radius",{get:function(){return this._pBottomRadius},set:function(t){this._pBottomRadius=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"sides",{get:function(){return this._pSegmentsW},set:function(t){this.setSegmentsW(t)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"subdivisions",{get:function(){return this._pSegmentsH},set:function(t){this.setSegmentsH(t)},enumerable:true,configurable:true});return e}(a);e.exports=s},{"awayjs-display/lib/prefabs/PrimitiveCylinderPrefab":undefined}],"awayjs-display/lib/prefabs/PrimitivePrefabBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetType");var s=t("awayjs-core/lib/errors/AbstractMethodError");var n=t("awayjs-display/lib/base/Geometry");var o=t("awayjs-display/lib/base/TriangleSubGeometry");var h=t("awayjs-display/lib/base/LineSubGeometry");var l=t("awayjs-display/lib/entities/Mesh");var u=t("awayjs-display/lib/prefabs/PrefabBase");var p=function(t){r(e,t);function e(e,i){if(e===void 0){e=null}if(i===void 0){i="triangleSubGeometry"}t.call(this);this._geomDirty=true;this._uvDirty=true;this._geometryTypeDirty=true;this._geometry=new n;this._material=e;this._geometryType=i}Object.defineProperty(e.prototype,"assetType",{get:function(){return a.PRIMITIVE_PREFAB},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"geometryType",{get:function(){return this._geometryType},set:function(t){if(this._geometryType==t)return;this._geometryType=t;this.invalidateGeometryType()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"geometry",{get:function(){this._iValidate();return this._geometry},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"material",{get:function(){return this._material},set:function(t){if(t==this._material)return;this._material=t;var e=this._pObjects.length;for(var i=0;i<e;i++)this._pObjects[i].material=this._material},enumerable:true,configurable:true});e.prototype._pBuildGeometry=function(t,e){throw new s};e.prototype._pBuildUVs=function(t,e){throw new s};e.prototype.invalidateGeometryType=function(){this._geometryTypeDirty=true;this._geomDirty=true;this._uvDirty=true};e.prototype._pInvalidateGeometry=function(){this._geomDirty=true};e.prototype._pInvalidateUVs=function(){this._uvDirty=true};e.prototype.updateGeometryType=function(){if(this._subGeometry)this._geometry.removeSubGeometry(this._subGeometry);if(this._geometryType=="triangleSubGeometry"){var t=new o(true);t.autoDeriveNormals=false;t.autoDeriveTangents=false;t.autoDeriveUVs=false;this._geometry.addSubGeometry(t);this._subGeometry=t}else if(this._geometryType=="lineSubGeometry"){this._geometry.addSubGeometry(this._subGeometry=new h)}this._geometryTypeDirty=false};e.prototype.updateGeometry=function(){this._pBuildGeometry(this._subGeometry,this._geometryType);this._geomDirty=false};e.prototype.updateUVs=function(){this._pBuildUVs(this._subGeometry,this._geometryType);this._uvDirty=false};e.prototype._iValidate=function(){if(this._geometryTypeDirty)this.updateGeometryType();if(this._geomDirty)this.updateGeometry();if(this._uvDirty)this.updateUVs()};e.prototype._pCreateObject=function(){var t=new l(this._geometry,this._material);t._iSourcePrefab=this;return t};return e}(u);e.exports=p},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/library/AssetType":undefined,"awayjs-display/lib/base/Geometry":undefined,"awayjs-display/lib/base/LineSubGeometry":undefined,"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-display/lib/entities/Mesh":undefined,"awayjs-display/lib/prefabs/PrefabBase":undefined}],"awayjs-display/lib/prefabs/PrimitiveSpherePrefab":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/prefabs/PrimitivePrefabBase");var s=function(t){r(e,t);function e(e,i,r,a){if(e===void 0){e=50}if(i===void 0){i=16}if(r===void 0){r=12}if(a===void 0){a=true}t.call(this);this._radius=e;this._segmentsW=i;this._segmentsH=r;this._yUp=a}Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsW",{get:function(){return this._segmentsW},set:function(t){this._segmentsW=t;this._pInvalidateGeometry();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsH",{get:function(){return this._segmentsH},set:function(t){this._segmentsH=t;this._pInvalidateGeometry();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"yUp",{get:function(){return this._yUp},set:function(t){this._yUp=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});e.prototype._pBuildGeometry=function(t,e){var i;var r;var a;var s;var n;var o;var h,l;var u;var p;var c;if(e=="triangleSubGeometry"){var d=t;c=(this._segmentsH+1)*(this._segmentsW+1);if(c==d.numVertices&&d.indices!=null){i=d.indices;r=d.positions;a=d.vertexNormals;s=d.vertexTangents}else{i=new Array((this._segmentsH-1)*this._segmentsW*6);r=new Array(c*3);a=new Array(c*3);s=new Array(c*3);this._pInvalidateUVs()}h=0;l=0;var f;var _;var y;for(o=0;o<=this._segmentsH;++o){f=h;var g=Math.PI*o/this._segmentsH;var m=-this._radius*Math.cos(g);var b=this._radius*Math.sin(g);for(n=0;n<=this._segmentsW;++n){var v=2*Math.PI*n/this._segmentsW;var w=b*Math.cos(v);var x=b*Math.sin(v);var P=1/Math.sqrt(w*w+x*x+m*m);var D=Math.sqrt(x*x+w*w);if(this._yUp){_=0;y=D>.007?w/D:0;u=-m;p=x}else{_=D>.007?w/D:0;y=0;u=x;p=m}if(n==this._segmentsW){r[h]=r[f];r[h+1]=r[f+1];r[h+2]=r[f+2];a[h]=a[f]+w*P*.5;a[h+1]=a[f+1]+u*P*.5;a[h+2]=a[f+2]+p*P*.5;s[h]=D>.007?-x/D:1;s[h+1]=_;s[h+2]=y}else{r[h]=w;r[h+1]=u;r[h+2]=p;a[h]=w*P;a[h+1]=u*P;a[h+2]=p*P;s[h]=D>.007?-x/D:1;s[h+1]=_;s[h+2]=y}if(n>0&&o>0){var C=(this._segmentsW+1)*o+n;var T=(this._segmentsW+1)*o+n-1;var A=(this._segmentsW+1)*(o-1)+n-1;var S=(this._segmentsW+1)*(o-1)+n;if(o==this._segmentsH){r[h]=r[f];r[h+1]=r[f+1];r[h+2]=r[f+2];i[l++]=C;i[l++]=A;i[l++]=S}else if(o==1){i[l++]=C;i[l++]=T;i[l++]=A}else{i[l++]=C;i[l++]=T;i[l++]=A;i[l++]=C;i[l++]=A;i[l++]=S}}h+=3}}d.updateIndices(i);d.updatePositions(r);d.updateVertexNormals(a);d.updateVertexTangents(s)}else if(e=="lineSubGeometry"){var j=t;var O=(this._segmentsH-1)*this._segmentsW*2;var E;var M;var R;if(j.indices!=null&&O==j.numSegments){E=j.startPositions;M=j.endPositions;R=j.thickness}else{E=new Array(O*3);M=new Array(O*3);R=new Array(O)}h=0;l=0;for(o=0;o<=this._segmentsH;++o){var g=Math.PI*o/this._segmentsH;var m=-this._radius*Math.cos(g);var b=this._radius*Math.sin(g);for(n=0;n<=this._segmentsW;++n){var v=2*Math.PI*n/this._segmentsW;var w=b*Math.cos(v);var x=b*Math.sin(v);if(this._yUp){u=-m;p=x}else{u=x;p=m}if(n>0&&o>0){if(o<this._segmentsH){M[h]=w;M[h+1]=u;M[h+2]=p;R[l++]=1;h+=3}E[h]=M[h-this._segmentsW*6];E[h+1]=M[h+1-this._segmentsW*6];E[h+2]=M[h+2-this._segmentsW*6];M[h]=w;M[h+1]=u;M[h+2]=p;R[l++]=1;h+=3}if(n<this._segmentsW&&o>0&&o<this._segmentsH){E[h]=w;E[h+1]=u;E[h+2]=p}}}j.updatePositions(E,M);j.updateThickness(R)}};e.prototype._pBuildUVs=function(t,e){var i,r;var a=(this._segmentsH+1)*(this._segmentsW+1);var s;if(e=="triangleSubGeometry"){a=(this._segmentsH+1)*(this._segmentsW+1);var n=t;if(a==n.numVertices&&n.uvs!=null){s=n.uvs}else{s=new Array(a*2)}var o=0;for(r=0;r<=this._segmentsH;++r){for(i=0;i<=this._segmentsW;++i){s[o++]=i/this._segmentsW*n.scaleU;s[o++]=r/this._segmentsH*n.scaleV}}n.updateUVs(s)}else if(e=="lineSubGeometry"){}};return e}(a);e.exports=s},{"awayjs-display/lib/prefabs/PrimitivePrefabBase":undefined}],"awayjs-display/lib/prefabs/PrimitiveTorusPrefab":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/prefabs/PrimitivePrefabBase");var s=function(t){r(e,t);function e(e,i,r,a,s){if(e===void 0){e=50}if(i===void 0){i=50}if(r===void 0){r=16}if(a===void 0){a=8}if(s===void 0){s=true}t.call(this);this._numVertices=0;this._radius=e;this._tubeRadius=i;this._segmentsR=r;this._segmentsT=a;this._yUp=s}Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"tubeRadius",{get:function(){return this._tubeRadius},set:function(t){this._tubeRadius=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsR",{get:function(){return this._segmentsR},set:function(t){this._segmentsR=t;this._pInvalidateGeometry();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsT",{get:function(){return this._segmentsT},set:function(t){this._segmentsT=t;this._pInvalidateGeometry();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"yUp",{get:function(){return this._yUp},set:function(t){this._yUp=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});e.prototype._pBuildGeometry=function(t,e){var i;var r;var a;var s;var n,o;var h,l,u,p,c,d,f,_;var y;var g;var m=0;if(e=="triangleSubGeometry"){var b=t;this._numVertices=(this._segmentsT+1)*(this._segmentsR+1);m=this._segmentsT*this._segmentsR*6;if(this._numVertices==b.numVertices){i=b.indices;r=b.positions;a=b.vertexNormals;s=b.vertexTangents}else{i=new Array(m);r=new Array(this._numVertices*3);a=new Array(this._numVertices*3);s=new Array(this._numVertices*3);this._pInvalidateUVs()}y=0;g=0;var v=2*Math.PI/this._segmentsR;var w=2*Math.PI/this._segmentsT;var x,P;var D,C,T,A;var S=0;var j=0;var O,E,M,R,I;for(o=0;o<=this._segmentsT;++o){S=j*3;for(n=0;n<=this._segmentsR;++n){f=n*v;_=o*w;I=Math.cos(_);p=I*Math.cos(f);c=I*Math.sin(f);d=Math.sin(_);h=this._radius*Math.cos(f)+this._tubeRadius*p;l=this._radius*Math.sin(f)+this._tubeRadius*c;u=o==this._segmentsT?0:this._tubeRadius*d;if(this._yUp){T=-d;A=c;D=0;C=I?p/I:h/this._radius;x=-u;P=l}else{T=c;A=d;D=I?p/I:h/this._radius;C=0;x=l;P=u}if(n==this._segmentsR){r[y]=h;r[y+1]=r[S+1];r[y+2]=r[S+2]}else{r[y]=h;r[y+1]=x;r[y+2]=P}a[y]=p;a[y+1]=T;a[y+2]=A;s[y]=-(I?c/I:l/this._radius);s[y+1]=D;s[y+2]=C;y+=3;if(n>0&&o>0){O=j;E=j-1;M=E-this._segmentsR-1;R=O-this._segmentsR-1;i[g++]=O;i[g++]=E;i[g++]=M;i[g++]=O;i[g++]=M;i[g++]=R}j++}}b.updateIndices(i);b.updatePositions(r);b.updateVertexNormals(a);b.updateVertexTangents(s)}else if(e=="lineSubGeometry"){}};e.prototype._pBuildUVs=function(t,e){var i,r;var a;if(e=="triangleSubGeometry"){var s=t;if(s.uvs&&this._numVertices==s.numVertices){a=s.uvs}else{a=new Array(this._numVertices*2)}var n=0;for(r=0;r<=this._segmentsT;++r){for(i=0;i<=this._segmentsR;++i){a[n++]=i/this._segmentsR*s.scaleU;a[n++]=r/this._segmentsT*s.scaleV}}s.updateUVs(a)}else if(e=="lineSubGeometry"){}};return e}(a);e.exports=s},{"awayjs-display/lib/prefabs/PrimitivePrefabBase":undefined}],"awayjs-display/lib/render/CSSDefaultRenderer":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Matrix3D");var s=t("awayjs-core/lib/projections/CoordinateSystem");var n=t("awayjs-display/lib/render/CSSRendererBase");var o=t("awayjs-display/lib/traverse/CSSEntityCollector");var h=function(t){r(e,t);function e(){t.call(this);this._contextMatrix=new a;this._skyboxProjection=new a;this._transform=new a;this._container=document.createElement("div");this._container.style.overflow="hidden";this._container.style.position="absolute";document.body.appendChild(this._container);this._context=document.createElement("div");this._contextStyle=this._context.style;this._contextStyle.position="absolute";this._contextStyle.transformStyle=this._contextStyle["-webkit-transform-style"]=this._contextStyle["-moz-transform-style"]=this._contextStyle["-o-transform-style"]=this._contextStyle["-ms-transform-style"]="preserve-3d";this._contextStyle.transformOrigin=this._contextStyle["-webkit-transform-origin"]=this._contextStyle["-moz-transform-origin"]=this._contextStyle["-o-transform-origin"]=this._contextStyle["-ms-transform-origin"]="0% 0%";this._container.appendChild(this._context)}e.prototype.render=function(e){t.prototype.render.call(this,e);if(this._pBackBufferInvalid)this.pUpdateBackBuffer();this._iRender(e);this._pBackBufferInvalid=false};e.prototype.pDraw=function(t){var e=document.styleSheets[document.styleSheets.length-1];for(var i=0;i<e.cssRules.length;i++){var r=e.cssRules[i].style;r.transform=r["-webkit-transform"]=r["-moz-transform"]=r["-o-transform"]=r["-ms-transform"]=t.camera.projection.coordinateSystem==s.RIGHT_HANDED?"":"scale3d(1, -1, 1) translateY(-"+r.height+")"}this.drawRenderables(this._renderableHead,t);this._activeMaterial=null};e.prototype.pUpdateBackBuffer=function(){this._container.style.width=this._width+"px";this._container.style.height=this._height+"px";this._container.style.clip="rect(0px, "+this._width+"px, "+this._height+"px, 0px)";this._contextMatrix.rawData[0]=this._width/2;this._contextMatrix.rawData[5]=-this._height/2;this._contextMatrix.rawData[10]=-1;this._contextMatrix.rawData[12]=this._width/2;this._contextMatrix.rawData[13]=this._height/2;this._contextStyle.transform=this._contextStyle["-webkit-transform"]=this._contextStyle["-moz-transform"]=this._contextStyle["-o-transform"]=this._contextStyle["-ms-transform"]=this._contextMatrix.toString();this._pBackBufferInvalid=false};e.prototype.drawSkybox=function(t){};e.prototype.drawRenderables=function(t,e){var i=e.camera.viewProjection.clone();while(t){this._activeMaterial=t.materialOwner.material;this._transform.copyRawDataFrom(t.renderSceneTransform.rawData);this._transform.append(i);var r=t.htmlElement.style;r.transform=r["-webkit-transform"]=r["-moz-transform"]=r["-o-transform"]=r["-ms-transform"]=this._transform.toString();r.transformStyle=r["-webkit-transform-style"]=r["-moz-transform-style"]=r["-o-transform-style"]=r["-ms-transform-style"]="preserve-3d";if(!this._context.contains(t.htmlElement))this._context.appendChild(t.htmlElement);t=t.next}};e.prototype.dispose=function(){t.prototype.dispose.call(this)};e.prototype._iCreateEntityCollector=function(){return new o};return e}(n);e.exports=h},{"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/projections/CoordinateSystem":undefined,"awayjs-display/lib/render/CSSRendererBase":undefined,"awayjs-display/lib/traverse/CSSEntityCollector":undefined}],"awayjs-display/lib/render/CSSRendererBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Point");var s=t("awayjs-core/lib/geom/Rectangle");var n=t("awayjs-core/lib/errors/AbstractMethodError");var o=t("awayjs-core/lib/events/EventDispatcher");var h=t("awayjs-display/lib/pool/CSSBillboardRenderable");var l=t("awayjs-display/lib/pool/CSSLineSegmentRenderable");var u=t("awayjs-display/lib/pool/RenderablePool");var p=t("awayjs-display/lib/events/RendererEvent");var c=function(t){r(e,t);function e(e,i,r){if(e===void 0){e=false}if(i===void 0){i=false}if(r===void 0){r="baseline"}t.call(this);this._backgroundR=0;this._backgroundG=0;this._backgroundB=0;this._backgroundAlpha=1;this._shareContext=false;this._pBackBufferInvalid=true;this._depthTextureInvalid=true;this._viewPort=new s;this._scissorRect=new s;this._localPos=new a;this._globalPos=new a;this._billboardRenderablePool=u.getPool(h);this._lineSegmentRenderablePool=u.getPool(l);this._viewPort=new s;if(this._width==0)this.width=window.innerWidth;if(this._height==0)this.height=window.innerHeight}Object.defineProperty(e.prototype,"viewPort",{get:function(){return this._viewPort},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scissorRect",{get:function(){return this._scissorRect},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"x",{get:function(){return this._localPos.x},set:function(t){if(this.x==t)return;this.updateGlobalPos()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"y",{get:function(){return this._localPos.y},set:function(t){if(this.y==t)return;this._globalPos.y=this._localPos.y=t;this.updateGlobalPos()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){if(this._width==t)return;this._width=t;this._scissorRect.width=t;this._viewPort.width=t;this._pBackBufferInvalid=true;this._depthTextureInvalid=true;this.notifyViewportUpdate();this.notifyScissorUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){if(this._height==t)return;this._height=t;this._scissorRect.height=t;this._viewPort.height=t;this._pBackBufferInvalid=true;this._depthTextureInvalid=true;this.notifyViewportUpdate();this.notifyScissorUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"_iBackgroundR",{get:function(){return this._backgroundR},set:function(t){if(this._backgroundR==t)return;this._backgroundR=t;this._pBackBufferInvalid=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"_iBackgroundG",{get:function(){return this._backgroundG},set:function(t){if(this._backgroundG==t)return;this._backgroundG=t;this._pBackBufferInvalid=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"_iBackgroundB",{get:function(){return this._backgroundB},set:function(t){if(this._backgroundB==t)return;this._backgroundB=t;this._pBackBufferInvalid=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"shareContext",{get:function(){return this._shareContext},set:function(t){if(this._shareContext==t)return;this._shareContext=t;this.updateGlobalPos()},enumerable:true,configurable:true});e.prototype.dispose=function(){};e.prototype.render=function(t){this._viewportDirty=false;this._scissorDirty=false};e.prototype._iRender=function(t,e,i,r){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=0}if(!t.entityHead)return;this.pExecuteRender(t,i)};e.prototype._iRenderCascades=function(t,e,i,r,a){};e.prototype.pCollectRenderables=function(t){this._renderableHead=null;var e=t.entityHead;this._pCamera=t.camera;this._iEntryPoint=this._pCamera.scenePosition;this._pCameraForward=this._pCamera.transform.forwardVector;while(e){e.entity._iCollectRenderables(this);e=e.next}};e.prototype.pExecuteRender=function(t,e){if(e===void 0){e=null}this.pCollectRenderables(t);this.pDraw(t)};e.prototype.pDraw=function(t){throw new n};Object.defineProperty(e.prototype,"_iBackgroundAlpha",{get:function(){return this._backgroundAlpha},set:function(t){if(this._backgroundAlpha==t)return;this._backgroundAlpha=t;this._pBackBufferInvalid=true},enumerable:true,configurable:true});e.prototype.applyBillboard=function(t){this._applyRenderable(this._billboardRenderablePool.getItem(t))};e.prototype.applyLineSubMesh=function(t){};e.prototype.applySkybox=function(t){};e.prototype.applyTriangleSubMesh=function(t){};e.prototype._applyRenderable=function(t){var e=t.materialOwner.material;var i=t.sourceEntity;var r=i.scenePosition;if(e){t.materialId=e._iMaterialId;t.cascaded=false;r=this._iEntryPoint.subtract(r);t.zIndex=i.zOffset-r.dotProduct(this._pCameraForward);t.renderSceneTransform=t.sourceEntity.getRenderSceneTransform(this._pCamera);t.next=this._renderableHead;this._renderableHead=t}};e.prototype.notifyScissorUpdate=function(){if(this._scissorDirty)return;this._scissorDirty=true;if(!this._scissorUpdated)this._scissorUpdated=new p(p.SCISSOR_UPDATED);this.dispatchEvent(this._scissorUpdated)};e.prototype.notifyViewportUpdate=function(){if(this._viewportDirty)return;this._viewportDirty=true;if(!this._viewPortUpdated)this._viewPortUpdated=new p(p.VIEWPORT_UPDATED);this.dispatchEvent(this._viewPortUpdated)};e.prototype.updateGlobalPos=function(){this._viewPort.x=this._globalPos.x;this._viewPort.y=this._globalPos.y;this.notifyViewportUpdate();this.notifyScissorUpdate()};e.prototype._iCreateEntityCollector=function(){throw new n};return e}(o);e.exports=c},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/events/EventDispatcher":undefined,"awayjs-core/lib/geom/Point":undefined,"awayjs-core/lib/geom/Rectangle":undefined,"awayjs-display/lib/events/RendererEvent":undefined,"awayjs-display/lib/pool/CSSBillboardRenderable":undefined,"awayjs-display/lib/pool/CSSLineSegmentRenderable":undefined,"awayjs-display/lib/pool/RenderablePool":undefined}],"awayjs-display/lib/render/IRenderer":[function(t,e,i){},{}],"awayjs-display/lib/sort/IEntitySorter":[function(t,e,i){},{}],"awayjs-display/lib/sort/RenderableMergeSort":[function(t,e,i){var r=function(){function t(){}t.prototype.sortBlendedRenderables=function(t){var e;var i;var r;if(!t||!t.next){return t}r=t;i=t.next;while(i){i=i.next;if(i){r=r.next;i=i.next}}e=r.next;r.next=null;t=this.sortBlendedRenderables(t);e=this.sortBlendedRenderables(e);var a;var s;var n;if(!t)return e;if(!e)return t;while(t&&e){if(t.zIndex<e.zIndex){n=t;t=t.next}else{n=e;e=e.next}if(!a)a=n;else s.next=n;s=n}if(t)s.next=t;else if(e)s.next=e;return a};t.prototype.sortOpaqueRenderables=function(t){var e;var i,r;if(!t||!t.next){return t}r=t;i=t.next;while(i){i=i.next;if(i){r=r.next;i=i.next}}e=r.next;r.next=null;t=this.sortOpaqueRenderables(t);e=this.sortOpaqueRenderables(e);var a;var s;var n;var o=0;if(!t)return e;if(!e)return t;while(t&&e&&t!=null&&e!=null){var h=t.renderOrderId;var l=e.renderOrderId;if(h==l){var u=t.materialId;var p=e.materialId;if(u==p){if(t.zIndex<e.zIndex)o=1;else o=-1}else if(u>p){o=1}else{o=-1}}else if(h>l){o=1}else{o=-1}if(o<0){n=t;t=t.next}else{n=e;e=e.next}if(!a){a=n;s=n}else{s.next=n;s=n}}if(t)s.next=t;else if(e)s.next=e;return a};return t}();e.exports=r},{}],"awayjs-display/lib/text/AntiAliasType":[function(t,e,i){var r=function(){function t(){}t.ADVANCED="advanced";t.NORMAL="normal";return t}();e.exports=r},{}],"awayjs-display/lib/text/GridFitType":[function(t,e,i){var r=function(){function t(){}t.NONE="none";t.PIXEL="pixel";t.SUBPIXEL="subpixel";return t}();e.exports=r},{}],"awayjs-display/lib/text/TextFieldAutoSize":[function(t,e,i){var r=function(){function t(){}t.CENTER="center";t.LEFT="left";t.NONE="none";t.RIGHT="right";return t}();e.exports=r},{}],"awayjs-display/lib/text/TextFieldType":[function(t,e,i){var r=function(){function t(){}t.DYNAMIC="dynamic";t.INPUT="input";return t}();e.exports=r},{}],"awayjs-display/lib/text/TextFormatAlign":[function(t,e,i){var r=function(){function t(){this.CENTER="center";this.JUSTIFY="justify";this.LEFT="left";this.RIGHT="right"}return t}();e.exports=r},{}],"awayjs-display/lib/text/TextFormat":[function(t,e,i){var r=function(){function t(t,e,i,r,a,s,n,o,h,l,u,p,c){if(t===void 0){t="Times New Roman"}if(e===void 0){e=12}if(i===void 0){i=0}if(r===void 0){r=false}if(a===void 0){a=false}if(s===void 0){s=false}if(n===void 0){n=""}if(o===void 0){o=""}if(h===void 0){h="left"}if(l===void 0){l=0}if(u===void 0){u=0}if(p===void 0){p=0}if(c===void 0){c=0}this.tabStops=new Array;this.font=t;this.size=e;this.bold=r;this.italic=a;this.underline=s;this.url=n;this.target=o;this.align=h;this.leftMargin=l;this.rightMargin=u;this.indent=p;this.leading=c}return t}();e.exports=r},{}],"awayjs-display/lib/text/TextInteractionMode":[function(t,e,i){var r=function(){function t(){}t.NORMAL="normal";t.SELECTION="selection";return t}();e.exports=r},{}],"awayjs-display/lib/text/TextLineMetrics":[function(t,e,i){var r=function(){function t(t,e,i,r,a,s){if(t===void 0){t=NaN}if(e===void 0){e=NaN}if(i===void 0){i=NaN}if(r===void 0){r=NaN}if(a===void 0){a=NaN}if(s===void 0){s=NaN}}return t}();e.exports=r},{}],"awayjs-display/lib/traverse/CSSEntityCollector":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/traverse/CollectorBase");var s=function(t){r(e,t);function e(){t.call(this)}return e}(a);e.exports=s},{"awayjs-display/lib/traverse/CollectorBase":undefined}],"awayjs-display/lib/traverse/CollectorBase":[function(t,e,i){var r=t("awayjs-display/lib/pool/EntityListItemPool");var a=function(){function t(){this._numCullPlanes=0;this._pNumEntities=0;this._pNumInteractiveEntities=0;this._pEntityListItemPool=new r}Object.defineProperty(t.prototype,"camera",{get:function(){return this._pCamera},set:function(t){this._pCamera=t;this._cullPlanes=this._pCamera.frustumPlanes},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"cullPlanes",{get:function(){return this._customCullPlanes},set:function(t){this._customCullPlanes=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"entityHead",{get:function(){return this._pEntityHead},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"numEntities",{get:function(){return this._pNumEntities},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"numInteractiveEntities",{get:function(){return this._pNumInteractiveEntities},enumerable:true,configurable:true});t.prototype.clear=function(){this._pNumEntities=this._pNumInteractiveEntities=0;this._cullPlanes=this._customCullPlanes?this._customCullPlanes:this._pCamera?this._pCamera.frustumPlanes:null;this._numCullPlanes=this._cullPlanes?this._cullPlanes.length:0;this._pEntityHead=null;this._pEntityListItemPool.freeAll()};t.prototype.enterNode=function(t){var e=this.scene._iCollectionMark!=t._iCollectionMark&&t.isInFrustum(this._cullPlanes,this._numCullPlanes);t._iCollectionMark=this.scene._iCollectionMark;return e};t.prototype.applyDirectionalLight=function(t){};t.prototype.applyEntity=function(t){this._pNumEntities++;if(t._iIsMouseEnabled())this._pNumInteractiveEntities++;var e=this._pEntityListItemPool.getItem();e.entity=t;e.next=this._pEntityHead;this._pEntityHead=e};t.prototype.applyLightProbe=function(t){};t.prototype.applyPointLight=function(t){};t.prototype.applySkybox=function(t){};return t}();e.exports=a},{"awayjs-display/lib/pool/EntityListItemPool":undefined}],"awayjs-display/lib/traverse/EntityCollector":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/traverse/CollectorBase");var s=function(t){r(e,t);function e(){t.call(this);this._pNumLights=0;this._numDirectionalLights=0;this._numPointLights=0;this._numLightProbes=0;this._pLights=new Array;this._directionalLights=new Array;this._pointLights=new Array;this._lightProbes=new Array}Object.defineProperty(e.prototype,"directionalLights",{get:function(){return this._directionalLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lightProbes",{get:function(){return this._lightProbes},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lights",{get:function(){return this._pLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"pointLights",{get:function(){return this._pointLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"skyBox",{get:function(){return this._pSkybox},enumerable:true,configurable:true});e.prototype.applyDirectionalLight=function(t){this._directionalLights[this._numDirectionalLights++]=t};e.prototype.applyLightProbe=function(t){this._lightProbes[this._numLightProbes++]=t};e.prototype.applyPointLight=function(t){this._pointLights[this._numPointLights++]=t};e.prototype.applySkybox=function(t){this._pSkybox=t};e.prototype.clear=function(){t.prototype.clear.call(this);this._pSkybox=null;if(this._pNumLights>0)this._pLights.length=this._pNumLights=0;if(this._numDirectionalLights>0)this._directionalLights.length=this._numDirectionalLights=0;if(this._numPointLights>0)this._pointLights.length=this._numPointLights=0;if(this._numLightProbes>0)this._lightProbes.length=this._numLightProbes=0};return e}(a);e.exports=s},{"awayjs-display/lib/traverse/CollectorBase":undefined}],"awayjs-display/lib/traverse/ICollector":[function(t,e,i){},{}],"awayjs-display/lib/traverse/RaycastCollector":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-display/lib/traverse/CollectorBase");var n=function(t){r(e,t);function e(){t.call(this);this._rayPosition=new a;this._rayDirection=new a;this._iCollectionMark=0}Object.defineProperty(e.prototype,"rayPosition",{get:function(){return this._rayPosition},set:function(t){this._rayPosition=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"rayDirection",{get:function(){return this._rayDirection},set:function(t){this._rayDirection=t},enumerable:true,configurable:true});e.prototype.enterNode=function(t){return t.isIntersectingRay(this._rayPosition,this._rayDirection)};return e}(s);e.exports=n},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/traverse/CollectorBase":undefined}],"awayjs-display/lib/traverse/ShadowCasterCollector":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/traverse/CollectorBase");var s=function(t){r(e,t);function e(){t.call(this)}e.prototype.enterNode=function(e){var i=this.scene._iCollectionMark!=e._iCollectionMark&&e.isCastingShadow();if(!i){e._iCollectionMark=this.scene._iCollectionMark;return false}return t.prototype.enterNode.call(this,e)};return e}(a);e.exports=s},{"awayjs-display/lib/traverse/CollectorBase":undefined}],"awayjs-display/lib/utils/Cast":[function(t,e,i){var r=t("awayjs-core/lib/base/BitmapData");var a=t("awayjs-core/lib/utils/ByteArray");var s=t("awayjs-display/lib/errors/CastError");var n=t("awayjs-core/lib/textures/BitmapTexture");var o=t("awayjs-core/lib/textures/ImageTexture");var h=function(){function t(){}t.string=function(t){if(typeof t=="function")t=new t;if(typeof t=="string")return t;return t};t.byteArray=function(t){if(typeof t=="function")t=new t;if(t instanceof a)return t;return t};t.isHex=function(t){var e=t.length;for(var i=0;i<e;++i){if(this._hexChars.indexOf(t.charAt(i))==-1)return false}return true};t.tryColor=function(t){if(typeof t=="number")return Math.floor(t);if(typeof t=="string"){if(t=="random")return Math.floor(Math.random()*16777216);if(this._colorNames==null){this._colorNames=new Object;this._colorNames["steelblue"]=4620980;this._colorNames["royalblue"]=267920;this._colorNames["cornflowerblue"]=6591981;this._colorNames["lightsteelblue"]=11584734;this._colorNames["mediumslateblue"]=8087790;this._colorNames["slateblue"]=6970061;this._colorNames["darkslateblue"]=4734347;this._colorNames["midnightblue"]=1644912;this._colorNames["navy"]=128;this._colorNames["darkblue"]=139;this._colorNames["mediumblue"]=205;this._colorNames["blue"]=255;this._colorNames["dodgerblue"]=2003199;this._colorNames["deepskyblue"]=49151;this._colorNames["lightskyblue"]=8900346;this._colorNames["skyblue"]=8900331;this._colorNames["lightblue"]=11393254;this._colorNames["powderblue"]=11591910;this._colorNames["azure"]=15794175;this._colorNames["lightcyan"]=14745599;this._colorNames["paleturquoise"]=11529966;
this._colorNames["mediumturquoise"]=4772300;this._colorNames["lightseagreen"]=2142890;this._colorNames["darkcyan"]=35723;this._colorNames["teal"]=32896;this._colorNames["cadetblue"]=6266528;this._colorNames["darkturquoise"]=52945;this._colorNames["aqua"]=65535;this._colorNames["cyan"]=65535;this._colorNames["turquoise"]=4251856;this._colorNames["aquamarine"]=8388564;this._colorNames["mediumaquamarine"]=6737322;this._colorNames["darkseagreen"]=9419919;this._colorNames["mediumseagreen"]=3978097;this._colorNames["seagreen"]=3050327;this._colorNames["darkgreen"]=25600;this._colorNames["green"]=32768;this._colorNames["forestgreen"]=2263842;this._colorNames["limegreen"]=3329330;this._colorNames["lime"]=65280;this._colorNames["chartreuse"]=8388352;this._colorNames["lawngreen"]=8190976;this._colorNames["greenyellow"]=11403055;this._colorNames["yellowgreen"]=10145074;this._colorNames["palegreen"]=10025880;this._colorNames["lightgreen"]=9498256;this._colorNames["springgreen"]=65407;this._colorNames["mediumspringgreen"]=64154;this._colorNames["darkolivegreen"]=5597999;this._colorNames["olivedrab"]=7048739;this._colorNames["olive"]=8421376;this._colorNames["darkkhaki"]=12433259;this._colorNames["darkgoldenrod"]=12092939;this._colorNames["goldenrod"]=14329120;this._colorNames["gold"]=16766720;this._colorNames["yellow"]=16776960;this._colorNames["khaki"]=15787660;this._colorNames["palegoldenrod"]=15657130;this._colorNames["blanchedalmond"]=16772045;this._colorNames["moccasin"]=16770229;this._colorNames["wheat"]=16113331;this._colorNames["navajowhite"]=16768685;this._colorNames["burlywood"]=14596231;this._colorNames["tan"]=13808780;this._colorNames["rosybrown"]=12357519;this._colorNames["sienna"]=10506797;this._colorNames["saddlebrown"]=9127187;this._colorNames["chocolate"]=13789470;this._colorNames["peru"]=13468991;this._colorNames["sandybrown"]=16032864;this._colorNames["darkred"]=9109504;this._colorNames["maroon"]=8388608;this._colorNames["brown"]=10824234;this._colorNames["firebrick"]=11674146;this._colorNames["indianred"]=13458524;this._colorNames["lightcoral"]=15761536;this._colorNames["salmon"]=16416882;this._colorNames["darksalmon"]=15308410;this._colorNames["lightsalmon"]=16752762;this._colorNames["coral"]=16744272;this._colorNames["tomato"]=16737095;this._colorNames["darkorange"]=16747520;this._colorNames["orange"]=16753920;this._colorNames["orangered"]=16729344;this._colorNames["crimson"]=14423100;this._colorNames["red"]=16711680;this._colorNames["deeppink"]=16716947;this._colorNames["fuchsia"]=16711935;this._colorNames["magenta"]=16711935;this._colorNames["hotpink"]=16738740;this._colorNames["lightpink"]=16758465;this._colorNames["pink"]=16761035;this._colorNames["palevioletred"]=14381203;this._colorNames["mediumvioletred"]=13047173;this._colorNames["purple"]=8388736;this._colorNames["darkmagenta"]=9109643;this._colorNames["mediumpurple"]=9662683;this._colorNames["blueviolet"]=9055202;this._colorNames["indigo"]=4915330;this._colorNames["darkviolet"]=9699539;this._colorNames["darkorchid"]=10040012;this._colorNames["mediumorchid"]=12211667;this._colorNames["orchid"]=14315734;this._colorNames["violet"]=15631086;this._colorNames["plum"]=14524637;this._colorNames["thistle"]=14204888;this._colorNames["lavender"]=15132410;this._colorNames["ghostwhite"]=16316671;this._colorNames["aliceblue"]=15792383;this._colorNames["mintcream"]=16121850;this._colorNames["honeydew"]=15794160;this._colorNames["lightgoldenrodyellow"]=16448210;this._colorNames["lemonchiffon"]=16775885;this._colorNames["cornsilk"]=16775388;this._colorNames["lightyellow"]=16777184;this._colorNames["ivory"]=16777200;this._colorNames["floralwhite"]=16775920;this._colorNames["linen"]=16445670;this._colorNames["oldlace"]=16643558;this._colorNames["antiquewhite"]=16444375;this._colorNames["bisque"]=16770244;this._colorNames["peachpuff"]=16767673;this._colorNames["papayawhip"]=16773077;this._colorNames["beige"]=16119260;this._colorNames["seashell"]=16774638;this._colorNames["lavenderblush"]=16773365;this._colorNames["mistyrose"]=16770273;this._colorNames["snow"]=16775930;this._colorNames["white"]=16777215;this._colorNames["whitesmoke"]=16119285;this._colorNames["gainsboro"]=14474460;this._colorNames["lightgrey"]=13882323;this._colorNames["silver"]=12632256;this._colorNames["darkgrey"]=11119017;this._colorNames["grey"]=8421504;this._colorNames["lightslategrey"]=7833753;this._colorNames["slategrey"]=7372944;this._colorNames["dimgrey"]=6908265;this._colorNames["darkslategrey"]=3100495;this._colorNames["black"]=0;this._colorNames["transparent"]=4278190080}if(this._colorNames[t]!=null)return this._colorNames[t];if(t.length==6&&this.isHex(t))return parseInt("0x"+t)}return null};t.color=function(t){var e=this.tryColor(t);if(e==null)throw new s("Can't cast to color: "+t);return e};t.tryClass=function(t){if(this._notClasses[t])return t;var e=this._classes[t];if(e!=null)return e;try{e=window[t];this._classes[t]=e;return e}catch(i){}this._notClasses[t]=true;return t};t.bitmapData=function(t){if(t==null)return null;if(typeof t=="string")t=this.tryClass(t);if(typeof t=="function"){try{t=new t}catch(e){t=new t(0,0)}}if(t instanceof r)return t;if(t instanceof o)t=t.htmlImageElement;if(t instanceof HTMLImageElement){var i=t;var a=new r(i.width,i.height,true,0);a.draw(i);return a}throw new s("Can't cast to BitmapData: "+t)};t.bitmapTexture=function(e){if(e==null)return null;if(typeof e=="string")e=this.tryClass(e);if(typeof e=="function"){try{e=new e}catch(i){e=new e(0,0)}}if(e instanceof n)return e;try{var r=t.bitmapData(e);return new n(r)}catch(i){}throw new s("Can't cast to BitmapTexture: "+e)};t._hexChars="0123456789abcdefABCDEF";t._notClasses=new Object;t._classes=new Object;return t}();e.exports=h},{"awayjs-core/lib/base/BitmapData":undefined,"awayjs-core/lib/textures/BitmapTexture":undefined,"awayjs-core/lib/textures/ImageTexture":undefined,"awayjs-core/lib/utils/ByteArray":undefined,"awayjs-display/lib/errors/CastError":undefined}],"awayjs-renderergl/lib/animators/ParticleAnimationSet":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/animators/AnimationSetBase");var s=t("awayjs-stagegl/lib/animators/data/AnimationRegisterCache");var n=t("awayjs-renderergl/lib/animators/data/AnimationSubGeometry");var o=t("awayjs-renderergl/lib/animators/data/ParticleAnimationData");var h=t("awayjs-renderergl/lib/animators/data/ParticleProperties");var l=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var u=t("awayjs-renderergl/lib/animators/nodes/ParticleTimeNode");var p=function(t){r(e,t);function e(e,i,r){if(e===void 0){e=false}if(i===void 0){i=false}if(r===void 0){r=false}t.call(this);this._animationSubGeometries=new Object;this._particleNodes=new Array;this._localDynamicNodes=new Array;this._localStaticNodes=new Array;this._totalLenOfOneVertex=0;this.addAnimation(this._timeNode=new u(e,i,r))}Object.defineProperty(e.prototype,"particleNodes",{get:function(){return this._particleNodes},enumerable:true,configurable:true});e.prototype.addAnimation=function(e){var i;var r=e;r._iProcessAnimationSetting(this);if(r.mode==l.LOCAL_STATIC){r._iDataOffset=this._totalLenOfOneVertex;this._totalLenOfOneVertex+=r.dataLength;this._localStaticNodes.push(r)}else if(r.mode==l.LOCAL_DYNAMIC)this._localDynamicNodes.push(r);for(i=this._particleNodes.length-1;i>=0;i--){if(this._particleNodes[i].priority<=r.priority)break}this._particleNodes.splice(i+1,0,r);t.prototype.addAnimation.call(this,e)};e.prototype.activate=function(t,e){};e.prototype.deactivate=function(t,e){};e.prototype.getAGALVertexCode=function(t){this._iAnimationRegisterCache=t.animationRegisterCache;if(this._iAnimationRegisterCache==null)this._iAnimationRegisterCache=t.animationRegisterCache=new s(t.profile);this._iAnimationRegisterCache.vertexConstantOffset=t.numUsedVertexConstants;this._iAnimationRegisterCache.vertexAttributesOffset=t.numUsedStreams;this._iAnimationRegisterCache.varyingsOffset=t.numUsedVaryings;this._iAnimationRegisterCache.fragmentConstantOffset=t.numUsedFragmentConstants;this._iAnimationRegisterCache.hasUVNode=this.hasUVNode;this._iAnimationRegisterCache.needVelocity=this.needVelocity;this._iAnimationRegisterCache.hasBillboard=this.hasBillboard;this._iAnimationRegisterCache.sourceRegisters=t.animatableAttributes;this._iAnimationRegisterCache.targetRegisters=t.animationTargetRegisters;this._iAnimationRegisterCache.needFragmentAnimation=t.usesFragmentAnimation;this._iAnimationRegisterCache.needUVAnimation=!t.usesUVTransform;this._iAnimationRegisterCache.hasColorAddNode=this.hasColorAddNode;this._iAnimationRegisterCache.hasColorMulNode=this.hasColorMulNode;this._iAnimationRegisterCache.reset();var i="";i+=this._iAnimationRegisterCache.getInitCode();var r;var a;for(a=0;a<this._particleNodes.length;a++){r=this._particleNodes[a];if(r.priority<e.POST_PRIORITY)i+=r.getAGALVertexCode(t,this._iAnimationRegisterCache)}i+=this._iAnimationRegisterCache.getCombinationCode();for(a=0;a<this._particleNodes.length;a++){r=this._particleNodes[a];if(r.priority>=e.POST_PRIORITY&&r.priority<e.COLOR_PRIORITY)i+=r.getAGALVertexCode(t,this._iAnimationRegisterCache)}i+=this._iAnimationRegisterCache.initColorRegisters();for(a=0;a<this._particleNodes.length;a++){r=this._particleNodes[a];if(r.priority>=e.COLOR_PRIORITY)i+=r.getAGALVertexCode(t,this._iAnimationRegisterCache)}i+=this._iAnimationRegisterCache.getColorPassCode();return i};e.prototype.getAGALUVCode=function(t){var e="";if(this.hasUVNode){this._iAnimationRegisterCache.setUVSourceAndTarget(t.uvSource,t.uvTarget);e+="mov "+this._iAnimationRegisterCache.uvTarget+".xy,"+this._iAnimationRegisterCache.uvAttribute.toString()+"\n";var i;for(var r=0;r<this._particleNodes.length;r++)i=this._particleNodes[r];e+=i.getAGALUVCode(t,this._iAnimationRegisterCache);e+="mov "+this._iAnimationRegisterCache.uvVar.toString()+","+this._iAnimationRegisterCache.uvTarget+".xy\n"}else e+="mov "+t.uvTarget+","+t.uvSource+"\n";return e};e.prototype.getAGALFragmentCode=function(t,e){return this._iAnimationRegisterCache.getColorCombinationCode(e)};e.prototype.doneAGALCode=function(t){this._iAnimationRegisterCache.setDataLength();this._iAnimationRegisterCache.setVertexConst(this._iAnimationRegisterCache.vertexZeroConst.index,0,1,2,0)};Object.defineProperty(e.prototype,"usesCPU",{get:function(){return false},enumerable:true,configurable:true});e.prototype.cancelGPUCompatibility=function(){};e.prototype.dispose=function(){for(var e in this._animationSubGeometries)this._animationSubGeometries[e].dispose();t.prototype.dispose.call(this)};e.prototype.getAnimationSubGeometry=function(t){var e=t.parentMesh;var i=e.shareAnimationGeometry?this._animationSubGeometries[t.subGeometry.id]:this._animationSubGeometries[t.id];if(i)return i;this._iGenerateAnimationSubGeometries(e);return e.shareAnimationGeometry?this._animationSubGeometries[t.subGeometry.id]:this._animationSubGeometries[t.id]};e.prototype._iGenerateAnimationSubGeometries=function(t){if(this.initParticleFunc==null)throw new Error("no initParticleFunc set");var e=t.geometry;if(!e)throw new Error("Particle animation can only be performed on a ParticleGeometry object");var i,r,a;var s;var l=false;var u;var p;var c;for(i=0;i<t.subMeshes.length;i++){p=t.subMeshes[i];u=p.subGeometry;if(t.shareAnimationGeometry){s=this._animationSubGeometries[u.id];if(s)continue}s=new n;if(t.shareAnimationGeometry)this._animationSubGeometries[u.id]=s;else this._animationSubGeometries[p.id]=s;l=true;s.createVertexData(u.numVertices,this._totalLenOfOneVertex)}if(!l)return;var d=e.particles;var f=d.length;var _=e.numParticles;var y=new h;var g;var m;var b;var v;var w;var x;var P;var D;var C;var T;var A;y.total=_;y.startTime=0;y.duration=1e3;y.delay=.1;i=0;r=0;while(i<_){y.index=i;this.initParticleFunc.call(this.initParticleScope,y);for(a=0;a<this._localStaticNodes.length;a++)this._localStaticNodes[a]._iGeneratePropertyOfOneParticle(y);while(r<f&&(g=d[r]).particleIndex==i){for(a=0;a<t.subMeshes.length;a++){p=t.subMeshes[a];if(p.subGeometry==g.subGeometry){s=t.shareAnimationGeometry?this._animationSubGeometries[p.subGeometry.id]:this._animationSubGeometries[p.id];break}}P=g.numVertices;D=s.vertexData;C=P*this._totalLenOfOneVertex;T=s.numProcessedVertices*this._totalLenOfOneVertex;for(a=0;a<this._localStaticNodes.length;a++){c=this._localStaticNodes[a];x=c.oneData;m=c.dataLength;b=T+c._iDataOffset;for(v=0;v<C;v+=this._totalLenOfOneVertex){A=b+v;for(w=0;w<m;w++)D[A+w]=x[w]}}if(this._localDynamicNodes.length)s.animationParticles.push(new o(i,y.startTime,y.duration,y.delay,g));s.numProcessedVertices+=P;r++}i++}};e.POST_PRIORITY=9;e.COLOR_PRIORITY=18;return e}(a);e.exports=p},{"awayjs-renderergl/lib/animators/data/AnimationSubGeometry":undefined,"awayjs-renderergl/lib/animators/data/ParticleAnimationData":undefined,"awayjs-renderergl/lib/animators/data/ParticleProperties":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/nodes/ParticleTimeNode":undefined,"awayjs-stagegl/lib/animators/AnimationSetBase":undefined,"awayjs-stagegl/lib/animators/data/AnimationRegisterCache":undefined}],"awayjs-renderergl/lib/animators/ParticleAnimator":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/animators/AnimatorBase");var s=t("awayjs-stagegl/lib/base/ContextGLProgramType");var n=t("awayjs-renderergl/lib/animators/data/AnimationSubGeometry");var o=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var h=function(t){r(e,t);function e(e){t.call(this,e);this._animationParticleStates=new Array;this._animatorParticleStates=new Array;this._timeParticleStates=new Array;this._totalLenOfOneVertex=0;this._animatorSubGeometries=new Object;this._particleAnimationSet=e;var i;var r;for(var a=0;a<this._particleAnimationSet.particleNodes.length;a++){r=this._particleAnimationSet.particleNodes[a];i=this.getAnimationState(r);if(r.mode==o.LOCAL_DYNAMIC){this._animatorParticleStates.push(i);r._iDataOffset=this._totalLenOfOneVertex;this._totalLenOfOneVertex+=r.dataLength}else{this._animationParticleStates.push(i)}if(i.needUpdateTime)this._timeParticleStates.push(i)}}e.prototype.clone=function(){return new e(this._particleAnimationSet)};e.prototype.setRenderState=function(t,e,i,r,a,n){var o=this._particleAnimationSet._iAnimationRegisterCache;var h=e.subMesh;var l;var u;if(!h)throw new Error("Must be subMesh");var p=this._particleAnimationSet.getAnimationSubGeometry(h);for(u=0;u<this._animationParticleStates.length;u++)this._animationParticleStates[u].setRenderState(i,e,p,o,r);var c=this.getAnimatorSubGeometry(h);for(u=0;u<this._animatorParticleStates.length;u++)this._animatorParticleStates[u].setRenderState(i,e,c,o,r);i.context.setProgramConstantsFromArray(s.VERTEX,o.vertexConstantOffset,o.vertexConstantData,o.numVertexConstant);if(o.numFragmentConstant>0)i.context.setProgramConstantsFromArray(s.FRAGMENT,o.fragmentConstantOffset,o.fragmentConstantData,o.numFragmentConstant)};e.prototype.testGPUCompatibility=function(t){};e.prototype.start=function(){t.prototype.start.call(this);for(var e=0;e<this._timeParticleStates.length;e++)this._timeParticleStates[e].offset(this._pAbsoluteTime)};e.prototype._pUpdateDeltaTime=function(t){this._pAbsoluteTime+=t;for(var e=0;e<this._timeParticleStates.length;e++)this._timeParticleStates[e].update(this._pAbsoluteTime)};e.prototype.resetTime=function(t){if(t===void 0){t=0}for(var e=0;e<this._timeParticleStates.length;e++)this._timeParticleStates[e].offset(this._pAbsoluteTime+t);this.update(this.time)};e.prototype.dispose=function(){for(var t in this._animatorSubGeometries)this._animatorSubGeometries[t].dispose()};e.prototype.getAnimatorSubGeometry=function(t){if(!this._animatorParticleStates.length)return;var e=t.subGeometry;var i=this._animatorSubGeometries[e.id]=new n;i.createVertexData(e.numVertices,this._totalLenOfOneVertex);i.animationParticles=this._particleAnimationSet.getAnimationSubGeometry(t).animationParticles};return e}(a);e.exports=h},{"awayjs-renderergl/lib/animators/data/AnimationSubGeometry":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-stagegl/lib/animators/AnimatorBase":undefined,"awayjs-stagegl/lib/base/ContextGLProgramType":undefined}],"awayjs-renderergl/lib/animators/SkeletonAnimationSet":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/animators/AnimationSetBase");var s=function(t){r(e,t);function e(e){if(e===void 0){e=4}t.call(this);this._jointsPerVertex=e}Object.defineProperty(e.prototype,"jointsPerVertex",{get:function(){return this._jointsPerVertex},enumerable:true,configurable:true});e.prototype.getAGALVertexCode=function(t){var e=t.animatableAttributes.length;var i=t.numUsedVertexConstants;var r=i+1;var a=i+2;var s="va"+t.numUsedStreams;var n="va"+(t.numUsedStreams+1);var o=[s+".x",s+".y",s+".z",s+".w"];var h=[n+".x",n+".y",n+".z",n+".w"];var l=this._pFindTempReg(t.animationTargetRegisters);var u=this._pFindTempReg(t.animationTargetRegisters,l);var p="dp4";var c="";for(var d=0;d<e;++d){var f=t.animatableAttributes[d];for(var _=0;_<this._jointsPerVertex;++_){c+=p+" "+l+".x, "+f+", vc["+o[_]+"+"+i+"]\n"+p+" "+l+".y, "+f+", vc["+o[_]+"+"+r+"]\n"+p+" "+l+".z, "+f+", vc["+o[_]+"+"+a+"]\n"+"mov "+l+".w, "+f+".w\n"+"mul "+l+", "+l+", "+h[_]+"\n";if(_==0)c+="mov "+u+", "+l+"\n";else c+="add "+u+", "+u+", "+l+"\n"}p="dp3";c+="mov "+t.animationTargetRegisters[d]+", "+u+"\n"}return c};e.prototype.activate=function(t,e){};e.prototype.deactivate=function(t,e){};e.prototype.getAGALFragmentCode=function(t,e){return""};e.prototype.getAGALUVCode=function(t){return"mov "+t.uvTarget+","+t.uvSource+"\n"};e.prototype.doneAGALCode=function(t){};return e}(a);e.exports=s},{"awayjs-stagegl/lib/animators/AnimationSetBase":undefined}],"awayjs-renderergl/lib/animators/SkeletonAnimator":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/base/TriangleSubGeometry");var s=t("awayjs-display/lib/events/SubGeometryEvent");var n=t("awayjs-stagegl/lib/animators/AnimatorBase");var o=t("awayjs-stagegl/lib/base/ContextGLProgramType");var h=t("awayjs-renderergl/lib/animators/data/JointPose");var l=t("awayjs-renderergl/lib/animators/data/SkeletonPose");var u=t("awayjs-renderergl/lib/events/AnimationStateEvent");var p=function(t){r(e,t);function e(e,i,r){var a=this;if(r===void 0){r=false}t.call(this,e);this._globalPose=new l;this._morphedSubGeometry=new Object;this._morphedSubGeometryDirty=new Object;this._skeleton=i;this._forceCPU=r;this._jointsPerVertex=e.jointsPerVertex;this._numJoints=this._skeleton.numJoints;this._globalMatrices=new Array(this._numJoints*12);var s=0;for(var n=0;n<this._numJoints;++n){this._globalMatrices[s++]=1;this._globalMatrices[s++]=0;this._globalMatrices[s++]=0;this._globalMatrices[s++]=0;this._globalMatrices[s++]=0;this._globalMatrices[s++]=1;this._globalMatrices[s++]=0;this._globalMatrices[s++]=0;this._globalMatrices[s++]=0;this._globalMatrices[s++]=0;this._globalMatrices[s++]=1;this._globalMatrices[s++]=0}this._onTransitionCompleteDelegate=function(t){return a.onTransitionComplete(t)};this._onIndicesUpdateDelegate=function(t){return a.onIndicesUpdate(t)};this._onVerticesUpdateDelegate=function(t){return a.onVerticesUpdate(t)}}Object.defineProperty(e.prototype,"globalMatrices",{get:function(){if(this._globalPropertiesDirty)this.updateGlobalProperties();return this._globalMatrices},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"globalPose",{get:function(){if(this._globalPropertiesDirty)this.updateGlobalProperties();return this._globalPose},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"skeleton",{get:function(){return this._skeleton},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"forceCPU",{get:function(){return this._forceCPU},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"useCondensedIndices",{get:function(){return this._useCondensedIndices},set:function(t){this._useCondensedIndices=t},enumerable:true,configurable:true});e.prototype.clone=function(){return new e(this._pAnimationSet,this._skeleton,this._forceCPU)};e.prototype.play=function(t,e,i){if(e===void 0){e=null}if(i===void 0){i=NaN}if(this._pActiveAnimationName==t)return;this._pActiveAnimationName=t;if(!this._pAnimationSet.hasAnimation(t))throw new Error("Animation root node "+t+" not found!");if(e&&this._pActiveNode){this._pActiveNode=e.getAnimationNode(this,this._pActiveNode,this._pAnimationSet.getAnimation(t),this._pAbsoluteTime);this._pActiveNode.addEventListener(u.TRANSITION_COMPLETE,this._onTransitionCompleteDelegate)}else this._pActiveNode=this._pAnimationSet.getAnimation(t);this._pActiveState=this.getAnimationState(this._pActiveNode);if(this.updatePosition){this._pActiveState.update(this._pAbsoluteTime);this._pActiveState.positionDelta}this._activeSkeletonState=this._pActiveState;this.start();if(!isNaN(i))this.reset(t,i)};e.prototype.setRenderState=function(t,e,i,r,s,n){if(this._globalPropertiesDirty)this.updateGlobalProperties();var h=e.subMesh.subGeometry;h.useCondensedIndices=this._useCondensedIndices;if(this._useCondensedIndices){this.updateCondensedMatrices(h.condensedIndexLookUp,h.numCondensedJoints);i.context.setProgramConstantsFromArray(o.VERTEX,s,this._condensedMatrices,h.numCondensedJoints*3)}else{if(this._pAnimationSet.usesCPU){if(this._morphedSubGeometryDirty[h.id])this.morphSubGeometry(e,h);return}i.context.setProgramConstantsFromArray(o.VERTEX,s,this._globalMatrices,this._numJoints*3)}i.context.activateBuffer(n,e.getVertexData(a.JOINT_INDEX_DATA),e.getVertexOffset(a.JOINT_INDEX_DATA),e.JOINT_INDEX_FORMAT);i.context.activateBuffer(n+1,e.getVertexData(a.JOINT_WEIGHT_DATA),e.getVertexOffset(a.JOINT_WEIGHT_DATA),e.JOINT_WEIGHT_FORMAT)};e.prototype.testGPUCompatibility=function(t){if(!this._useCondensedIndices&&(this._forceCPU||this._jointsPerVertex>4||t.numUsedVertexConstants+this._numJoints*3>128))this._pAnimationSet.cancelGPUCompatibility()};e.prototype._pUpdateDeltaTime=function(e){t.prototype._pUpdateDeltaTime.call(this,e);this._globalPropertiesDirty=true;if(this._pAnimationSet.usesCPU)for(var i in this._morphedSubGeometryDirty)this._morphedSubGeometryDirty[i]=true};e.prototype.updateCondensedMatrices=function(t,e){var i=0,r=0;var a;var s;this._condensedMatrices=new Array;do{s=t[i]*4;a=s+12;while(s<a)this._condensedMatrices[r++]=this._globalMatrices[s++]}while(++i<e)};e.prototype.updateGlobalProperties=function(){this._globalPropertiesDirty=false;this.localToGlobalPose(this._activeSkeletonState.getSkeletonPose(this._skeleton),this._globalPose,this._skeleton);var t=0;var e=this._globalPose.jointPoses;var i;var r,a,s,n;var o,h,l;var u,p,c;var d,f,_;var y,g,m;var b,v,w;var x,P,D,C;var T,A,S,j;var O,E,M,R;var I=this._skeleton.joints;var N;var L;var F;var V;for(var B=0;B<this._numJoints;++B){N=e[B];L=N.orientation;F=N.translation;r=L.x;a=L.y;s=L.z;n=L.w;o=(V=2*r)*a;h=V*s;l=V*n;u=(V=2*a)*s;p=V*n;c=2*s*n;u=2*a*s;p=2*a*n;c=2*s*n;r*=r;a*=a;s*=s;n*=n;d=(V=r-a)-s+n;f=o-c;_=h+p;y=o+c;g=-V-s+n;m=u-l;b=h-p;v=u+l;w=-r-a+s+n;i=I[B].inverseBindPose;x=i[0];P=i[4];D=i[8];C=i[12];T=i[1];A=i[5];S=i[9];j=i[13];O=i[2];E=i[6];M=i[10];R=i[14];this._globalMatrices[t]=d*x+f*T+_*O;this._globalMatrices[t+1]=d*P+f*A+_*E;this._globalMatrices[t+2]=d*D+f*S+_*M;this._globalMatrices[t+3]=d*C+f*j+_*R+F.x;this._globalMatrices[t+4]=y*x+g*T+m*O;this._globalMatrices[t+5]=y*P+g*A+m*E;this._globalMatrices[t+6]=y*D+g*S+m*M;this._globalMatrices[t+7]=y*C+g*j+m*R+F.y;this._globalMatrices[t+8]=b*x+v*T+w*O;this._globalMatrices[t+9]=b*P+v*A+w*E;this._globalMatrices[t+10]=b*D+v*S+w*M;this._globalMatrices[t+11]=b*C+v*j+w*R+F.z;t=t+12}};e.prototype.getRenderableSubGeometry=function(t,e){this._morphedSubGeometryDirty[e.id]=true;if(!this._pAnimationSet.usesCPU)return e;var i;if(!(i=this._morphedSubGeometry[e.id])){i=this._morphedSubGeometry[e.id]=e.clone();i.autoDeriveNormals=false;i.autoDeriveTangents=false;i.autoDeriveUVs=false;e.addEventListener(s.INDICES_UPDATED,this._onIndicesUpdateDelegate);e.addEventListener(s.VERTICES_UPDATED,this._onVerticesUpdateDelegate)}return i};e.prototype.morphSubGeometry=function(t,e){this._morphedSubGeometryDirty[e.id]=false;var i=e.positions;var r=e.vertexNormals;var a=e.vertexTangents;var s=e.jointIndices;var n=e.jointWeights;var o=this._morphedSubGeometry[e.id];var h=o.positions;var l=o.vertexNormals;var u=o.vertexTangents;var p=0;var c=0;var d;var f,_,y;var g,m,b;var v,w,x;var P=i.length;var D;var C,T,A;var S,j,O;var E,M,R;var I,N,L,F;var V,B,U,k;var z,G,H,X;while(p<P){C=i[p];T=i[p+1];A=i[p+2];S=r[p];j=r[p+1];O=r[p+2];E=a[p];M=a[p+1];R=a[p+2];f=0;_=0;y=0;g=0;m=0;b=0;v=0;w=0;x=0;d=0;while(d<this._jointsPerVertex){D=n[c];if(D>0){var W=s[c++]<<2;I=this._globalMatrices[W];N=this._globalMatrices[W+1];L=this._globalMatrices[W+2];F=this._globalMatrices[W+3];V=this._globalMatrices[W+4];B=this._globalMatrices[W+5];U=this._globalMatrices[W+6];k=this._globalMatrices[W+7];z=this._globalMatrices[W+8];G=this._globalMatrices[W+9];H=this._globalMatrices[W+10];X=this._globalMatrices[W+11];f+=D*(I*C+N*T+L*A+F);_+=D*(V*C+B*T+U*A+k);y+=D*(z*C+G*T+H*A+X);g+=D*(I*S+N*j+L*O);m+=D*(V*S+B*j+U*O);b+=D*(z*S+G*j+H*O);v+=D*(I*E+N*M+L*R);w+=D*(V*E+B*M+U*R);x+=D*(z*E+G*M+H*R);++d}else{c+=this._jointsPerVertex-d;d=this._jointsPerVertex}}h[p]=f;h[p+1]=_;h[p+2]=y;l[p]=g;l[p+1]=m;l[p+2]=b;u[p]=v;u[p+1]=w;u[p+2]=x;p+=3}o.updatePositions(h);o.updateVertexNormals(l);o.updateVertexTangents(u)};e.prototype.localToGlobalPose=function(t,e,i){var r=e.jointPoses;var a;var s=i.joints;var n=t.numJointPoses;var o=t.jointPoses;var l;var u;var p;var c;var d;var f;var _;var y;var g,m,b,v;var w,x,P,D;var C,T,A;if(r.length!=n)r.length=n;for(var S=0;S<n;++S){a=r[S];if(a==null)a=r[S]=new h;u=s[S];l=u.parentIndex;c=o[S];y=a.orientation;_=a.translation;if(l<0){f=c.translation;d=c.orientation;y.x=d.x;y.y=d.y;y.z=d.z;y.w=d.w;_.x=f.x;_.y=f.y;_.z=f.z}else{p=r[l];d=p.orientation;f=c.translation;w=d.x;x=d.y;P=d.z;D=d.w;C=f.x;T=f.y;A=f.z;v=-w*C-x*T-P*A;g=D*C+x*A-P*T;m=D*T-w*A+P*C;b=D*A+w*T-x*C;f=p.translation;_.x=-v*w+g*D-m*P+b*x+f.x;_.y=-v*x+g*P+m*D-b*w+f.y;_.z=-v*P-g*x+m*w+b*D+f.z;g=d.x;m=d.y;b=d.z;v=d.w;d=c.orientation;w=d.x;x=d.y;P=d.z;D=d.w;y.w=v*D-g*w-m*x-b*P;y.x=v*w+g*D+m*P-b*x;y.y=v*x-g*P+m*D+b*w;y.z=v*P+g*x-m*w+b*D}}};e.prototype.onTransitionComplete=function(t){if(t.type==u.TRANSITION_COMPLETE){t.animationNode.removeEventListener(u.TRANSITION_COMPLETE,this._onTransitionCompleteDelegate);if(this._pActiveState==t.animationState){this._pActiveNode=this._pAnimationSet.getAnimation(this._pActiveAnimationName);this._pActiveState=this.getAnimationState(this._pActiveNode);this._activeSkeletonState=this._pActiveState}}};e.prototype.onIndicesUpdate=function(t){var e=t.target;this._morphedSubGeometry[e.id].updateIndices(e.indices)};e.prototype.onVerticesUpdate=function(t){var e=t.target;var i=this._morphedSubGeometry[e.id];switch(t.dataType){case a.UV_DATA:i.updateUVs(e.uvs);case a.SECONDARY_UV_DATA:i.updateUVs(e.secondaryUVs)}};return e}(n);e.exports=p},{"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-display/lib/events/SubGeometryEvent":undefined,"awayjs-renderergl/lib/animators/data/JointPose":undefined,"awayjs-renderergl/lib/animators/data/SkeletonPose":undefined,"awayjs-renderergl/lib/events/AnimationStateEvent":undefined,"awayjs-stagegl/lib/animators/AnimatorBase":undefined,"awayjs-stagegl/lib/base/ContextGLProgramType":undefined}],"awayjs-renderergl/lib/animators/VertexAnimationSet":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/animators/AnimationSetBase");var s=t("awayjs-renderergl/lib/animators/data/VertexAnimationMode");var n=function(t){r(e,t);function e(e,i){if(e===void 0){e=2}if(i===void 0){i="absolute"}t.call(this);this._numPoses=e;this._blendMode=i}Object.defineProperty(e.prototype,"numPoses",{get:function(){return this._numPoses},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._blendMode},enumerable:true,configurable:true});e.prototype.getAGALVertexCode=function(t){if(this._blendMode==s.ABSOLUTE)return this.getAbsoluteAGALCode(t);else return this.getAdditiveAGALCode(t)};e.prototype.activate=function(t,e){};e.prototype.deactivate=function(t,e){};e.prototype.getAGALFragmentCode=function(t,e){return""};e.prototype.getAGALUVCode=function(t){return"mov "+t.uvTarget+","+t.uvSource+"\n"};e.prototype.doneAGALCode=function(t){};e.prototype.getAbsoluteAGALCode=function(t){var e="";var i=this._pFindTempReg(t.animationTargetRegisters);var r=this._pFindTempReg(t.animationTargetRegisters,i);var a=new Array("x","y","z","w");var s=t.animatableAttributes.length;var n="vc"+t.numUsedVertexConstants;if(s>2)s=2;var o=t.numUsedStreams;for(var h=0;h<s;++h){e+="mul "+i+", "+t.animatableAttributes[h]+", "+n+"."+a[0]+"\n";for(var l=1;l<this._numPoses;++l){e+="mul "+r+", va"+o+", "+n+"."+a[l]+"\n";if(l<this._numPoses-1)e+="add "+i+", "+i+", "+r+"\n";++o}e+="add "+t.animationTargetRegisters[h]+", "+i+", "+r+"\n"}if(t.tangentDependencies>0||t.outputsNormals){e+="dp3 "+i+".x, "+t.animatableAttributes[2]+", "+t.animationTargetRegisters[1]+"\n"+"mul "+i+", "+t.animationTargetRegisters[1]+", "+i+".x\n"+"sub "+t.animationTargetRegisters[2]+", "+t.animationTargetRegisters[2]+", "+i+"\n"}return e};e.prototype.getAdditiveAGALCode=function(t){var e="";var i=t.animatableAttributes.length;var r=["x","y","z","w"];var a=this._pFindTempReg(t.animationTargetRegisters);var s;var n=t.numUsedStreams;if(i>2)i=2;e+="mov  "+t.animationTargetRegisters[0]+", "+t.animatableAttributes[0]+"\n";if(t.normalDependencies>0)e+="mov "+t.animationTargetRegisters[1]+", "+t.animatableAttributes[1]+"\n";for(var o=0;o<i;++o){for(var h=0;h<this._numPoses;++h){e+="mul "+a+", va"+(n+s)+", vc"+t.numUsedVertexConstants+"."+r[h]+"\n"+"add "+t.animationTargetRegisters[o]+", "+t.animationTargetRegisters[o]+", "+a+"\n";s++}}if(t.tangentDependencies>0||t.outputsNormals){e+="dp3 "+a+".x, "+t.animatableAttributes[2]+", "+t.animationTargetRegisters[1]+"\n"+"mul "+a+", "+t.animationTargetRegisters[1]+", "+a+".x\n"+"sub "+t.animationTargetRegisters[2]+", "+t.animatableAttributes[2]+", "+a+"\n"}return e};return e}(a);e.exports=n},{"awayjs-renderergl/lib/animators/data/VertexAnimationMode":undefined,"awayjs-stagegl/lib/animators/AnimationSetBase":undefined}],"awayjs-renderergl/lib/animators/VertexAnimator":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/base/TriangleSubGeometry");var s=t("awayjs-stagegl/lib/animators/AnimatorBase");var n=t("awayjs-stagegl/lib/pool/VertexDataPool");var o=t("awayjs-stagegl/lib/base/ContextGLProgramType");var h=t("awayjs-renderergl/lib/animators/data/VertexAnimationMode");var l=function(t){r(e,t);function e(e){t.call(this,e);this._poses=new Array;this._weights=Array(1,0,0,0);this._vertexAnimationSet=e;this._numPoses=e.numPoses;this._blendMode=e.blendMode}e.prototype.clone=function(){return new e(this._vertexAnimationSet)};e.prototype.play=function(t,e,i){if(e===void 0){e=null}if(i===void 0){i=NaN}if(this._pActiveAnimationName==t)return;this._pActiveAnimationName=t;if(!this._pAnimationSet.hasAnimation(t))throw new Error("Animation root node "+t+" not found!");this._pActiveNode=this._pAnimationSet.getAnimation(t);
this._pActiveState=this.getAnimationState(this._pActiveNode);if(this.updatePosition){this._pActiveState.update(this._pAbsoluteTime);this._pActiveState.positionDelta}this._activeVertexState=this._pActiveState;this.start();if(!isNaN(i))this.reset(t,i)};e.prototype._pUpdateDeltaTime=function(e){t.prototype._pUpdateDeltaTime.call(this,e);var i=false;if(this._poses[0]!=this._activeVertexState.currentGeometry){this._poses[0]=this._activeVertexState.currentGeometry;i=true}if(this._poses[1]!=this._activeVertexState.nextGeometry){this._poses[1]=this._activeVertexState.nextGeometry;i=true}this._weights[0]=1-(this._weights[1]=this._activeVertexState.blendWeight);if(i){var r;var a=this._pOwners.length;for(var s=0;s<a;s++){r=this._pOwners[s];r._iInvalidateRenderableGeometries()}}};e.prototype.setRenderState=function(t,e,i,r,s,l){if(!this._poses.length){this.setNullPose(t,e,i,s,l);return}var u=e.subMesh;var p;var c;var d=this._numPoses;i.context.setProgramConstantsFromArray(o.VERTEX,s,this._weights,1);if(this._blendMode==h.ABSOLUTE)c=1;else c=0;for(;c<d;++c){p=this._poses[c].subGeometries[u._iIndex]||u.subGeometry;i.context.activateBuffer(l++,n.getItem(p,e.getIndexData(),a.POSITION_DATA),p.getOffset(a.POSITION_DATA),a.POSITION_FORMAT);if(t.normalDependencies>0)i.context.activateBuffer(l++,n.getItem(p,e.getIndexData(),a.NORMAL_DATA),p.getOffset(a.NORMAL_DATA),a.NORMAL_FORMAT)}};e.prototype.setNullPose=function(t,e,i,r,s){i.context.setProgramConstantsFromArray(o.VERTEX,r,this._weights,1);if(this._blendMode==h.ABSOLUTE){var n=this._numPoses;for(var l=1;l<n;++l){i.context.activateBuffer(s++,e.getVertexData(a.POSITION_DATA),e.getVertexOffset(a.POSITION_DATA),a.POSITION_FORMAT);if(t.normalDependencies>0)i.context.activateBuffer(s++,e.getVertexData(a.NORMAL_DATA),e.getVertexOffset(a.NORMAL_DATA),a.NORMAL_FORMAT)}}};e.prototype.testGPUCompatibility=function(t){};e.prototype.getRenderableSubGeometry=function(t,e){if(this._blendMode==h.ABSOLUTE&&this._poses.length)return this._poses[0].subGeometries[t.subMesh._iIndex]||e;return e};return e}(s);e.exports=l},{"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-renderergl/lib/animators/data/VertexAnimationMode":undefined,"awayjs-stagegl/lib/animators/AnimatorBase":undefined,"awayjs-stagegl/lib/base/ContextGLProgramType":undefined,"awayjs-stagegl/lib/pool/VertexDataPool":undefined}],"awayjs-renderergl/lib/animators/data/AnimationSubGeometry":[function(t,e,i){var r=function(){function t(){this._pVertexBuffer=new Array(8);this._pBufferContext=new Array(8);this._pBufferDirty=new Array(8);this.numProcessedVertices=0;this.previousTime=Number.NEGATIVE_INFINITY;this.animationParticles=new Array;for(var e=0;e<8;e++)this._pBufferDirty[e]=true;this._iUniqueId=t.SUBGEOM_ID_COUNT++}t.prototype.createVertexData=function(t,e){this._numVertices=t;this._totalLenOfOneVertex=e;this._pVertexData=new Array(t*e)};t.prototype.activateVertexBuffer=function(t,e,i,r){var a=i.stageIndex;var s=i.context;var n=this._pVertexBuffer[a];if(!n||this._pBufferContext[a]!=s){n=this._pVertexBuffer[a]=s.createVertexBuffer(this._numVertices,this._totalLenOfOneVertex);this._pBufferContext[a]=s;this._pBufferDirty[a]=true}if(this._pBufferDirty[a]){n.uploadFromArray(this._pVertexData,0,this._numVertices);this._pBufferDirty[a]=false}s.setVertexBufferAt(t,n,e,r)};t.prototype.dispose=function(){while(this._pVertexBuffer.length){var t=this._pVertexBuffer.pop();if(t)t.dispose()}};t.prototype.invalidateBuffer=function(){for(var t=0;t<8;t++)this._pBufferDirty[t]=true};Object.defineProperty(t.prototype,"vertexData",{get:function(){return this._pVertexData},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"numVertices",{get:function(){return this._numVertices},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"totalLenOfOneVertex",{get:function(){return this._totalLenOfOneVertex},enumerable:true,configurable:true});t.SUBGEOM_ID_COUNT=0;return t}();e.exports=r},{}],"awayjs-renderergl/lib/animators/data/ColorSegmentPoint":[function(t,e,i){var r=function(){function t(t,e){if(t<=0||t>=1)throw new Error("life exceeds range (0,1)");this._life=t;this._color=e}Object.defineProperty(t.prototype,"color",{get:function(){return this._color},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"life",{get:function(){return this._life},enumerable:true,configurable:true});return t}();e.exports=r},{}],"awayjs-renderergl/lib/animators/data/JointPose":[function(t,e,i){var r=t("awayjs-core/lib/geom/Matrix3D");var a=t("awayjs-core/lib/geom/Quaternion");var s=t("awayjs-core/lib/geom/Vector3D");var n=function(){function t(){this.orientation=new a;this.translation=new s}t.prototype.toMatrix3D=function(t){if(t===void 0){t=null}if(t==null)t=new r;this.orientation.toMatrix3D(t);t.appendTranslation(this.translation.x,this.translation.y,this.translation.z);return t};t.prototype.copyFrom=function(t){var e=t.orientation;var i=t.translation;this.orientation.x=e.x;this.orientation.y=e.y;this.orientation.z=e.z;this.orientation.w=e.w;this.translation.x=i.x;this.translation.y=i.y;this.translation.z=i.z};return t}();e.exports=n},{"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Quaternion":undefined,"awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-renderergl/lib/animators/data/ParticleAnimationData":[function(t,e,i){var r=function(){function t(t,e,i,r,a){this.index=t;this.startTime=e;this.totalTime=i+r;this.duration=i;this.delay=r;this.startVertexIndex=a.startVertexIndex;this.numVertices=a.numVertices}return t}();e.exports=r},{}],"awayjs-renderergl/lib/animators/data/ParticleData":[function(t,e,i){var r=function(){function t(){}return t}();e.exports=r},{}],"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":[function(t,e,i){var r=function(){function t(){}t.GLOBAL=0;t.LOCAL_STATIC=1;t.LOCAL_DYNAMIC=2;return t}();e.exports=r},{}],"awayjs-renderergl/lib/animators/data/ParticleProperties":[function(t,e,i){var r=function(){function t(){}return t}();e.exports=r},{}],"awayjs-renderergl/lib/animators/data/SkeletonJoint":[function(t,e,i){var r=function(){function t(){this.parentIndex=-1}return t}();e.exports=r},{}],"awayjs-renderergl/lib/animators/data/SkeletonPose":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetType");var s=t("awayjs-core/lib/library/NamedAssetBase");var n=t("awayjs-renderergl/lib/animators/data/JointPose");var o=function(t){r(e,t);function e(){t.call(this);this.jointPoses=new Array}Object.defineProperty(e.prototype,"numJointPoses",{get:function(){return this.jointPoses.length},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"assetType",{get:function(){return a.SKELETON_POSE},enumerable:true,configurable:true});e.prototype.jointPoseFromName=function(t){var e=this.jointPoseIndexFromName(t);if(e!=-1)return this.jointPoses[e];else return null};e.prototype.jointPoseIndexFromName=function(t){var e;var i;for(var r;r<this.jointPoses.length;r++){i=this.jointPoses[r];if(i.name==t)return e;e++}return-1};e.prototype.clone=function(){var t=new e;var i=this.jointPoses.length;for(var r=0;r<i;r++){var a=new n;var s=this.jointPoses[r];a.name=s.name;a.copyFrom(s);t.jointPoses[r]=a}return t};e.prototype.dispose=function(){this.jointPoses.length=0};return e}(s);e.exports=o},{"awayjs-core/lib/library/AssetType":undefined,"awayjs-core/lib/library/NamedAssetBase":undefined,"awayjs-renderergl/lib/animators/data/JointPose":undefined}],"awayjs-renderergl/lib/animators/data/Skeleton":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetType");var s=t("awayjs-core/lib/library/NamedAssetBase");var n=function(t){r(e,t);function e(){t.call(this);this.joints=new Array}Object.defineProperty(e.prototype,"numJoints",{get:function(){return this.joints.length},enumerable:true,configurable:true});e.prototype.jointFromName=function(t){var e=this.jointIndexFromName(t);if(e!=-1)return this.joints[e];else return null};e.prototype.jointIndexFromName=function(t){var e;var i;for(var r;r<this.joints.length;r++){i=this.joints[r];if(i.name==t)return e;e++}return-1};e.prototype.dispose=function(){this.joints.length=0};Object.defineProperty(e.prototype,"assetType",{get:function(){return a.SKELETON},enumerable:true,configurable:true});return e}(s);e.exports=n},{"awayjs-core/lib/library/AssetType":undefined,"awayjs-core/lib/library/NamedAssetBase":undefined}],"awayjs-renderergl/lib/animators/data/VertexAnimationMode":[function(t,e,i){var r=function(){function t(){}t.ADDITIVE="additive";t.ABSOLUTE="absolute";return t}();e.exports=r},{}],"awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-display/lib/animators/nodes/AnimationNodeBase");var n=function(t){r(e,t);function e(){t.call(this);this._pLooping=true;this._pTotalDuration=0;this._pStitchDirty=true;this._pStitchFinalFrame=false;this._pNumFrames=0;this._pDurations=new Array;this._pTotalDelta=new a;this.fixedFrameRate=true}Object.defineProperty(e.prototype,"looping",{get:function(){return this._pLooping},set:function(t){if(this._pLooping==t)return;this._pLooping=t;this._pStitchDirty=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"stitchFinalFrame",{get:function(){return this._pStitchFinalFrame},set:function(t){if(this._pStitchFinalFrame==t)return;this._pStitchFinalFrame=t;this._pStitchDirty=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"totalDuration",{get:function(){if(this._pStitchDirty)this._pUpdateStitch();return this._pTotalDuration},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"totalDelta",{get:function(){if(this._pStitchDirty)this._pUpdateStitch();return this._pTotalDelta},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lastFrame",{get:function(){if(this._pStitchDirty)this._pUpdateStitch();return this._pLastFrame},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"durations",{get:function(){return this._pDurations},enumerable:true,configurable:true});e.prototype._pUpdateStitch=function(){this._pStitchDirty=false;this._pLastFrame=this._pStitchFinalFrame?this._pNumFrames:this._pNumFrames-1;this._pTotalDuration=0;this._pTotalDelta.x=0;this._pTotalDelta.y=0;this._pTotalDelta.z=0};return e}(s);e.exports=n},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/animators/nodes/AnimationNodeBase":undefined}],"awayjs-renderergl/lib/animators/nodes/ParticleAccelerationNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var n=t("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var o=t("awayjs-renderergl/lib/animators/states/ParticleAccelerationState");var h=function(t){r(e,t);function e(e,i){if(i===void 0){i=null}t.call(this,"ParticleAcceleration",e,3);this._pStateClass=o;this._acceleration=i||new a}e.prototype.pGetAGALVertexCode=function(t,e){var i=this._pMode==s.GLOBAL?e.getFreeVertexConstant():e.getFreeVertexAttribute();e.setRegisterIndex(this,o.ACCELERATION_INDEX,i.index);var r=e.getFreeVertexVectorTemp();e.addVertexTempUsages(r,1);var a="mul "+r+","+e.vertexTime+","+i+"\n";if(e.needVelocity){var n=e.getFreeVertexVectorTemp();a+="mul "+n+","+r+","+e.vertexTwoConst+"\n";a+="add "+e.velocityTarget+".xyz,"+n+".xyz,"+e.velocityTarget+".xyz\n"}e.removeVertexTempUsage(r);a+="mul "+r+","+r+","+e.vertexTime+"\n";a+="add "+e.positionTarget+".xyz,"+r+","+e.positionTarget+".xyz\n";return a};e.prototype.getAnimationState=function(t){return t.getAnimationState(this)};e.prototype._iGeneratePropertyOfOneParticle=function(t){var i=t[e.ACCELERATION_VECTOR3D];if(!i)throw new Error("there is no "+e.ACCELERATION_VECTOR3D+" in param!");this._pOneData[0]=i.x/2;this._pOneData[1]=i.y/2;this._pOneData[2]=i.z/2};e.ACCELERATION_VECTOR3D="AccelerationVector3D";return e}(n);e.exports=h},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":undefined,"awayjs-renderergl/lib/animators/states/ParticleAccelerationState":undefined}],"awayjs-renderergl/lib/animators/nodes/ParticleBezierCurveNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-stagegl/lib/materials/compilation/ShaderRegisterElement");var n=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=t("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var h=t("awayjs-renderergl/lib/animators/states/ParticleBezierCurveState");var l=function(t){r(e,t);function e(e,i,r){if(i===void 0){i=null}if(r===void 0){r=null}t.call(this,"ParticleBezierCurve",e,6);this._pStateClass=h;this._iControlPoint=i||new a;this._iEndPoint=r||new a}e.prototype.getAGALVertexCode=function(t,e){var i=this._pMode==n.GLOBAL?e.getFreeVertexConstant():e.getFreeVertexAttribute();e.setRegisterIndex(this,h.BEZIER_CONTROL_INDEX,i.index);var r=this._pMode==n.GLOBAL?e.getFreeVertexConstant():e.getFreeVertexAttribute();e.setRegisterIndex(this,h.BEZIER_END_INDEX,r.index);var a=e.getFreeVertexVectorTemp();var o=new s(a.regName,a.index,0);var l=new s(a.regName,a.index,1);var u=new s(a.regName,a.index,2);e.addVertexTempUsages(a,1);var p=e.getFreeVertexVectorTemp();var c=new s(p.regName,p.index);e.removeVertexTempUsage(a);var d="";d+="sub "+o+","+e.vertexOneConst+","+e.vertexLife+"\n";d+="mul "+l+","+e.vertexLife+","+e.vertexLife+"\n";d+="mul "+u+","+e.vertexLife+","+o+"\n";d+="mul "+u+","+u+","+e.vertexTwoConst+"\n";d+="mul "+c+".xyz,"+u+","+i+"\n";d+="add "+e.positionTarget+".xyz,"+c+".xyz,"+e.positionTarget+".xyz\n";d+="mul "+c+".xyz,"+l+","+r+"\n";d+="add "+e.positionTarget+".xyz,"+c+".xyz,"+e.positionTarget+".xyz\n";if(e.needVelocity){d+="mul "+l+","+e.vertexLife+","+e.vertexTwoConst+"\n";d+="sub "+u+","+e.vertexOneConst+","+l+"\n";d+="mul "+u+","+e.vertexTwoConst+","+u+"\n";d+="mul "+c+".xyz,"+i+","+u+"\n";d+="add "+e.velocityTarget+".xyz,"+c+".xyz,"+e.velocityTarget+".xyz\n";d+="mul "+c+".xyz,"+r+","+l+"\n";d+="add "+e.velocityTarget+".xyz,"+c+".xyz,"+e.velocityTarget+".xyz\n"}return d};e.prototype.getAnimationState=function(t){return t.getAnimationState(this)};e.prototype._iGeneratePropertyOfOneParticle=function(t){var i=t[e.BEZIER_CONTROL_VECTOR3D];if(!i)throw new Error("there is no "+e.BEZIER_CONTROL_VECTOR3D+" in param!");var r=t[e.BEZIER_END_VECTOR3D];if(!r)throw new Error("there is no "+e.BEZIER_END_VECTOR3D+" in param!");this._pOneData[0]=i.x;this._pOneData[1]=i.y;this._pOneData[2]=i.z;this._pOneData[3]=r.x;this._pOneData[4]=r.y;this._pOneData[5]=r.z};e.BEZIER_CONTROL_VECTOR3D="BezierControlVector3D";e.BEZIER_END_VECTOR3D="BezierEndVector3D";return e}(o);e.exports=l},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":undefined,"awayjs-renderergl/lib/animators/states/ParticleBezierCurveState":undefined,"awayjs-stagegl/lib/materials/compilation/ShaderRegisterElement":undefined}],"awayjs-renderergl/lib/animators/nodes/ParticleBillboardNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var s=t("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var n=t("awayjs-renderergl/lib/animators/states/ParticleBillboardState");var o=function(t){r(e,t);function e(e){if(e===void 0){e=null}t.call(this,"ParticleBillboard",a.GLOBAL,0,4);this._pStateClass=n;this._iBillboardAxis=e}e.prototype.getAGALVertexCode=function(t,e){var i=e.getFreeVertexConstant();e.setRegisterIndex(this,n.MATRIX_INDEX,i.index);e.getFreeVertexConstant();e.getFreeVertexConstant();e.getFreeVertexConstant();var r=e.getFreeVertexVectorTemp();var a="m33 "+r+".xyz,"+e.scaleAndRotateTarget+","+i+"\n"+"mov "+e.scaleAndRotateTarget+".xyz,"+r+"\n";var s;for(var o=0;o<e.rotationRegisters.length;o++){s=e.rotationRegisters[o];a+="m33 "+r+".xyz,"+s+","+i+"\n"+"mov "+s+".xyz,"+s+"\n"}return a};e.prototype.getAnimationState=function(t){return t.getAnimationState(this)};e.prototype._iProcessAnimationSetting=function(t){t.hasBillboard=true};return e}(s);e.exports=o},{"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":undefined,"awayjs-renderergl/lib/animators/states/ParticleBillboardState":undefined}],"awayjs-renderergl/lib/animators/nodes/ParticleColorNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/ColorTransform");var s=t("awayjs-renderergl/lib/animators/ParticleAnimationSet");var n=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=t("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var h=t("awayjs-renderergl/lib/animators/states/ParticleColorState");var l=function(t){r(e,t);function e(e,i,r,n,o,l,u,p,c){if(i===void 0){i=true}if(r===void 0){r=true}if(n===void 0){n=false}if(o===void 0){o=false}if(l===void 0){l=null}if(u===void 0){u=null}if(p===void 0){p=1}if(c===void 0){c=0}t.call(this,"ParticleColor",e,i&&r?16:8,s.COLOR_PRIORITY);this._pStateClass=h;this._iUsesMultiplier=i;this._iUsesOffset=r;this._iUsesCycle=n;this._iUsesPhase=o;this._iStartColor=l||new a;this._iEndColor=u||new a;this._iCycleDuration=p;this._iCyclePhase=c}e.prototype.getAGALVertexCode=function(t,e){var i="";if(e.needFragmentAnimation){var r=e.getFreeVertexVectorTemp();if(this._iUsesCycle){var a=e.getFreeVertexConstant();e.setRegisterIndex(this,h.CYCLE_INDEX,a.index);e.addVertexTempUsages(r,1);var s=e.getFreeVertexSingleTemp();e.removeVertexTempUsage(r);i+="mul "+s+","+e.vertexTime+","+a+".x\n";if(this._iUsesPhase)i+="add "+s+","+s+","+a+".y\n";i+="sin "+s+","+s+"\n"}if(this._iUsesMultiplier){var o=this._pMode==n.GLOBAL?e.getFreeVertexConstant():e.getFreeVertexAttribute();var l=this._pMode==n.GLOBAL?e.getFreeVertexConstant():e.getFreeVertexAttribute();e.setRegisterIndex(this,h.START_MULTIPLIER_INDEX,o.index);e.setRegisterIndex(this,h.DELTA_MULTIPLIER_INDEX,l.index);i+="mul "+r+","+l+","+(this._iUsesCycle?s:e.vertexLife)+"\n";i+="add "+r+","+r+","+o+"\n";i+="mul "+e.colorMulTarget+","+r+","+e.colorMulTarget+"\n"}if(this._iUsesOffset){var u=this._pMode==n.LOCAL_STATIC?e.getFreeVertexAttribute():e.getFreeVertexConstant();var p=this._pMode==n.LOCAL_STATIC?e.getFreeVertexAttribute():e.getFreeVertexConstant();e.setRegisterIndex(this,h.START_OFFSET_INDEX,u.index);e.setRegisterIndex(this,h.DELTA_OFFSET_INDEX,p.index);i+="mul "+r+","+p+","+(this._iUsesCycle?s:e.vertexLife)+"\n";i+="add "+r+","+r+","+u+"\n";i+="add "+e.colorAddTarget+","+r+","+e.colorAddTarget+"\n"}}return i};e.prototype.getAnimationState=function(t){return t.getAnimationState(this)};e.prototype._iProcessAnimationSetting=function(t){if(this._iUsesMultiplier)t.hasColorMulNode=true;if(this._iUsesOffset)t.hasColorAddNode=true};e.prototype._iGeneratePropertyOfOneParticle=function(t){var i=t[e.COLOR_START_COLORTRANSFORM];if(!i)throw new Error("there is no "+e.COLOR_START_COLORTRANSFORM+" in param!");var r=t[e.COLOR_END_COLORTRANSFORM];if(!r)throw new Error("there is no "+e.COLOR_END_COLORTRANSFORM+" in param!");var a=0;if(!this._iUsesCycle){if(this._iUsesMultiplier){this._pOneData[a++]=i.redMultiplier;this._pOneData[a++]=i.greenMultiplier;this._pOneData[a++]=i.blueMultiplier;this._pOneData[a++]=i.alphaMultiplier;this._pOneData[a++]=r.redMultiplier-i.redMultiplier;this._pOneData[a++]=r.greenMultiplier-i.greenMultiplier;this._pOneData[a++]=r.blueMultiplier-i.blueMultiplier;this._pOneData[a++]=r.alphaMultiplier-i.alphaMultiplier}if(this._iUsesOffset){this._pOneData[a++]=i.redOffset/255;this._pOneData[a++]=i.greenOffset/255;this._pOneData[a++]=i.blueOffset/255;this._pOneData[a++]=i.alphaOffset/255;this._pOneData[a++]=(r.redOffset-i.redOffset)/255;this._pOneData[a++]=(r.greenOffset-i.greenOffset)/255;this._pOneData[a++]=(r.blueOffset-i.blueOffset)/255;this._pOneData[a++]=(r.alphaOffset-i.alphaOffset)/255}}else{if(this._iUsesMultiplier){this._pOneData[a++]=(i.redMultiplier+r.redMultiplier)/2;this._pOneData[a++]=(i.greenMultiplier+r.greenMultiplier)/2;this._pOneData[a++]=(i.blueMultiplier+r.blueMultiplier)/2;this._pOneData[a++]=(i.alphaMultiplier+r.alphaMultiplier)/2;this._pOneData[a++]=(i.redMultiplier-r.redMultiplier)/2;this._pOneData[a++]=(i.greenMultiplier-r.greenMultiplier)/2;this._pOneData[a++]=(i.blueMultiplier-r.blueMultiplier)/2;this._pOneData[a++]=(i.alphaMultiplier-r.alphaMultiplier)/2}if(this._iUsesOffset){this._pOneData[a++]=(i.redOffset+r.redOffset)/(255*2);this._pOneData[a++]=(i.greenOffset+r.greenOffset)/(255*2);this._pOneData[a++]=(i.blueOffset+r.blueOffset)/(255*2);this._pOneData[a++]=(i.alphaOffset+r.alphaOffset)/(255*2);this._pOneData[a++]=(i.redOffset-r.redOffset)/(255*2);this._pOneData[a++]=(i.greenOffset-r.greenOffset)/(255*2);this._pOneData[a++]=(i.blueOffset-r.blueOffset)/(255*2);this._pOneData[a++]=(i.alphaOffset-r.alphaOffset)/(255*2)}}};e.COLOR_START_COLORTRANSFORM="ColorStartColorTransform";e.COLOR_END_COLORTRANSFORM="ColorEndColorTransform";return e}(o);e.exports=l},{"awayjs-core/lib/geom/ColorTransform":undefined,"awayjs-renderergl/lib/animators/ParticleAnimationSet":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":undefined,"awayjs-renderergl/lib/animators/states/ParticleColorState":undefined}],"awayjs-renderergl/lib/animators/nodes/ParticleFollowNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-renderergl/lib/animators/ParticleAnimationSet");var s=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var n=t("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var o=t("awayjs-renderergl/lib/animators/states/ParticleFollowState");var h=function(t){r(e,t);function e(e,i,r){if(e===void 0){e=true}if(i===void 0){i=true}if(r===void 0){r=false}t.call(this,"ParticleFollow",s.LOCAL_DYNAMIC,e&&i?6:3,a.POST_PRIORITY);this._pStateClass=o;this._iUsesPosition=e;this._iUsesRotation=i;this._iSmooth=r}e.prototype.getAGALVertexCode=function(t,e){var i="";if(this._iUsesRotation){var r=e.getFreeVertexAttribute();e.setRegisterIndex(this,o.FOLLOW_ROTATION_INDEX,r.index);var a=e.getFreeVertexVectorTemp();e.addVertexTempUsages(a,1);var s=e.getFreeVertexVectorTemp();e.addVertexTempUsages(s,1);var n=e.getFreeVertexVectorTemp();var h;if(e.hasBillboard){e.addVertexTempUsages(n,1);h=e.getFreeVertexVectorTemp()}e.removeVertexTempUsage(a);e.removeVertexTempUsage(s);if(e.hasBillboard)e.removeVertexTempUsage(n);var l=e.rotationRegisters.length;var u;i+="mov "+a+","+e.vertexZeroConst+"\n";i+="mov "+a+".x,"+e.vertexOneConst+"\n";i+="mov "+n+","+e.vertexZeroConst+"\n";i+="sin "+n+".y,"+r+".x\n";i+="cos "+n+".z,"+r+".x\n";i+="mov "+s+".x,"+e.vertexZeroConst+"\n";i+="mov "+s+".y,"+n+".z\n";i+="neg "+s+".z,"+n+".y\n";if(e.hasBillboard)i+="m33 "+h+".xyz,"+e.positionTarget+".xyz,"+a+"\n";else{i+="m33 "+e.scaleAndRotateTarget+".xyz,"+e.scaleAndRotateTarget+".xyz,"+a+"\n";for(u=0;u<l;u++)i+="m33 "+e.rotationRegisters[u]+".xyz,"+e.rotationRegisters[u]+","+a+"\n"}i+="mov "+a+","+e.vertexZeroConst+"\n";i+="cos "+a+".x,"+r+".y\n";i+="sin "+a+".z,"+r+".y\n";i+="mov "+s+","+e.vertexZeroConst+"\n";i+="mov "+s+".y,"+e.vertexOneConst+"\n";i+="mov "+n+","+e.vertexZeroConst+"\n";i+="neg "+n+".x,"+a+".z\n";i+="mov "+n+".z,"+a+".x\n";if(e.hasBillboard)i+="m33 "+h+".xyz,"+h+".xyz,"+a+"\n";else{i+="m33 "+e.scaleAndRotateTarget+".xyz,"+e.scaleAndRotateTarget+".xyz,"+a+"\n";for(u=0;u<l;u++)i+="m33 "+e.rotationRegisters[u]+".xyz,"+e.rotationRegisters[u]+","+a+"\n"}i+="mov "+s+","+e.vertexZeroConst+"\n";i+="sin "+s+".x,"+r+".z\n";i+="cos "+s+".y,"+r+".z\n";i+="mov "+a+","+e.vertexZeroConst+"\n";i+="mov "+a+".x,"+s+".y\n";i+="neg "+a+".y,"+s+".x\n";i+="mov "+n+","+e.vertexZeroConst+"\n";i+="mov "+n+".z,"+e.vertexOneConst+"\n";if(e.hasBillboard){i+="m33 "+h+".xyz,"+h+".xyz,"+a+"\n";i+="sub "+h+".xyz,"+h+".xyz,"+e.positionTarget+".xyz\n";i+="add "+e.scaleAndRotateTarget+".xyz,"+h+".xyz,"+e.scaleAndRotateTarget+".xyz\n"}else{i+="m33 "+e.scaleAndRotateTarget+".xyz,"+e.scaleAndRotateTarget+".xyz,"+a+"\n";for(u=0;u<l;u++)i+="m33 "+e.rotationRegisters[u]+".xyz,"+e.rotationRegisters[u]+","+a+"\n"}}if(this._iUsesPosition){var p=e.getFreeVertexAttribute();e.setRegisterIndex(this,o.FOLLOW_POSITION_INDEX,p.index);i+="add "+e.scaleAndRotateTarget+".xyz,"+p+","+e.scaleAndRotateTarget+".xyz\n"}return i};e.prototype.getAnimationState=function(t){return t.getAnimationState(this)};return e}(n);e.exports=h},{"awayjs-renderergl/lib/animators/ParticleAnimationSet":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":undefined,"awayjs-renderergl/lib/animators/states/ParticleFollowState":undefined}],"awayjs-renderergl/lib/animators/nodes/ParticleInitialColorNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/ColorTransform");var s=t("awayjs-renderergl/lib/animators/ParticleAnimationSet");var n=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=t("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var h=t("awayjs-renderergl/lib/animators/states/ParticleInitialColorState");var l=function(t){r(e,t);function e(e,i,r,n){if(i===void 0){i=true}if(r===void 0){r=false}if(n===void 0){n=null}t.call(this,"ParticleInitialColor",e,i&&r?8:4,s.COLOR_PRIORITY);this._pStateClass=h;this._iUsesMultiplier=i;this._iUsesOffset=r;this._iInitialColor=n||new a}e.prototype.getAGALVertexCode=function(t,e){var i="";if(e.needFragmentAnimation){if(this._iUsesMultiplier){var r=this._pMode==n.GLOBAL?e.getFreeVertexConstant():e.getFreeVertexAttribute();e.setRegisterIndex(this,h.MULTIPLIER_INDEX,r.index);i+="mul "+e.colorMulTarget+","+r+","+e.colorMulTarget+"\n"}if(this._iUsesOffset){var a=this._pMode==n.LOCAL_STATIC?e.getFreeVertexAttribute():e.getFreeVertexConstant();e.setRegisterIndex(this,h.OFFSET_INDEX,a.index);i+="add "+e.colorAddTarget+","+a+","+e.colorAddTarget+"\n"}}return i};e.prototype._iProcessAnimationSetting=function(t){if(this._iUsesMultiplier)t.hasColorMulNode=true;if(this._iUsesOffset)t.hasColorAddNode=true};e.prototype._iGeneratePropertyOfOneParticle=function(t){var i=t[e.COLOR_INITIAL_COLORTRANSFORM];if(!i)throw new Error("there is no "+e.COLOR_INITIAL_COLORTRANSFORM+" in param!");var r=0;if(this._iUsesMultiplier){this._pOneData[r++]=i.redMultiplier;this._pOneData[r++]=i.greenMultiplier;this._pOneData[r++]=i.blueMultiplier;this._pOneData[r++]=i.alphaMultiplier}if(this._iUsesOffset){this._pOneData[r++]=i.redOffset/255;this._pOneData[r++]=i.greenOffset/255;this._pOneData[r++]=i.blueOffset/255;this._pOneData[r++]=i.alphaOffset/255}};e.COLOR_INITIAL_COLORTRANSFORM="ColorInitialColorTransform";return e}(o);e.exports=l},{"awayjs-core/lib/geom/ColorTransform":undefined,"awayjs-renderergl/lib/animators/ParticleAnimationSet":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":undefined,"awayjs-renderergl/lib/animators/states/ParticleInitialColorState":undefined}],"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/animators/nodes/AnimationNodeBase");var s=function(t){r(e,t);function e(i,r,a,s){if(s===void 0){s=1}t.call(this);this._pDataLength=3;i=i+e.MODES[r];this.name=i;this._pMode=r;this._priority=s;this._pDataLength=a;this._pOneData=new Array(this._pDataLength)}Object.defineProperty(e.prototype,"mode",{get:function(){return this._pMode},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"priority",{get:function(){return this._priority},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"dataLength",{get:function(){return this._pDataLength},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"oneData",{get:function(){return this._pOneData},enumerable:true,configurable:true});e.prototype.getAGALVertexCode=function(t,e){return""};e.prototype.getAGALFragmentCode=function(t,e){return""};e.prototype.getAGALUVCode=function(t,e){return""};e.prototype._iGeneratePropertyOfOneParticle=function(t){};e.prototype._iProcessAnimationSetting=function(t){};e.GLOBAL="Global";e.LOCAL_STATIC="LocalStatic";e.LOCAL_DYNAMIC="LocalDynamic";e.MODES={0:e.GLOBAL,1:e.LOCAL_STATIC,2:e.LOCAL_DYNAMIC};return e}(a);e.exports=s},{"awayjs-display/lib/animators/nodes/AnimationNodeBase":undefined}],"awayjs-renderergl/lib/animators/nodes/ParticleOrbitNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-stagegl/lib/materials/compilation/ShaderRegisterElement");var n=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=t("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var h=t("awayjs-renderergl/lib/animators/states/ParticleOrbitState");var l=function(t){r(e,t);function e(e,i,r,s,n,o,l,u){if(i===void 0){i=true}if(r===void 0){r=false}if(s===void 0){s=false}if(n===void 0){n=100}if(o===void 0){o=1}if(l===void 0){l=0}if(u===void 0){u=null}var p=3;if(s)p++;t.call(this,"ParticleOrbit",e,p);this._pStateClass=h;this._iUsesEulers=i;this._iUsesCycle=r;this._iUsesPhase=s;this._iRadius=n;this._iCycleDuration=o;this._iCyclePhase=l;this._iEulers=u||new a}e.prototype.getAGALVertexCode=function(t,e){var i=this._pMode==n.GLOBAL?e.getFreeVertexConstant():e.getFreeVertexAttribute();e.setRegisterIndex(this,h.ORBIT_INDEX,i.index);var r=e.getFreeVertexConstant();e.setRegisterIndex(this,h.EULERS_INDEX,r.index);e.getFreeVertexConstant();e.getFreeVertexConstant();e.getFreeVertexConstant();var a=e.getFreeVertexVectorTemp();e.addVertexTempUsages(a,1);var o=new s(a.regName,a.index);var l=e.getFreeVertexVectorTemp();var u=new s(l.regName,l.index,0);var p=new s(l.regName,l.index,1);var c=new s(l.regName,l.index,2);e.removeVertexTempUsage(a);var d="";if(this._iUsesCycle){d+="mul "+c+","+e.vertexTime+","+i+".y\n";if(this._iUsesPhase)d+="add "+c+","+c+","+i+".w\n"}else d+="mul "+c+","+e.vertexLife+","+i+".y\n";d+="cos "+u+","+c+"\n";d+="sin "+p+","+c+"\n";d+="mul "+o+".x,"+u+","+i+".x\n";d+="mul "+o+".y,"+p+","+i+".x\n";d+="mov "+o+".wz"+e.vertexZeroConst+"\n";if(this._iUsesEulers)d+="m44 "+o+","+o+","+r+"\n";d+="add "+e.positionTarget+".xyz,"+o+".xyz,"+e.positionTarget+".xyz\n";if(e.needVelocity){d+="neg "+o+".x,"+p+"\n";d+="mov "+o+".y,"+u+"\n";d+="mov "+o+".zw,"+e.vertexZeroConst+"\n";if(this._iUsesEulers)d+="m44 "+o+","+o+","+r+"\n";
d+="mul "+o+","+o+","+i+".z\n";d+="div "+o+","+o+","+i+".y\n";if(!this._iUsesCycle)d+="div "+o+","+o+","+e.vertexLife+"\n";d+="add "+e.velocityTarget+".xyz,"+e.velocityTarget+".xyz,"+o+".xyz\n"}return d};e.prototype.getAnimationState=function(t){return t.getAnimationState(this)};e.prototype._iGeneratePropertyOfOneParticle=function(t){var i=t[e.ORBIT_VECTOR3D];if(!i)throw new Error("there is no "+e.ORBIT_VECTOR3D+" in param!");this._pOneData[0]=i.x;if(this._iUsesCycle&&i.y<=0)throw new Error("the cycle duration must be greater than zero");this._pOneData[1]=Math.PI*2/(!this._iUsesCycle?1:i.y);this._pOneData[2]=i.x*Math.PI*2;if(this._iUsesPhase)this._pOneData[3]=i.z*Math.PI/180};e.ORBIT_VECTOR3D="OrbitVector3D";return e}(o);e.exports=l},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":undefined,"awayjs-renderergl/lib/animators/states/ParticleOrbitState":undefined,"awayjs-stagegl/lib/materials/compilation/ShaderRegisterElement":undefined}],"awayjs-renderergl/lib/animators/nodes/ParticleOscillatorNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-stagegl/lib/materials/compilation/ShaderRegisterElement");var n=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=t("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var h=t("awayjs-renderergl/lib/animators/states/ParticleOscillatorState");var l=function(t){r(e,t);function e(e,i){if(i===void 0){i=null}t.call(this,"ParticleOscillator",e,4);this._pStateClass=h;this._iOscillator=i||new a}e.prototype.getAGALVertexCode=function(t,e){var i=this._pMode==n.GLOBAL?e.getFreeVertexConstant():e.getFreeVertexAttribute();e.setRegisterIndex(this,h.OSCILLATOR_INDEX,i.index);var r=e.getFreeVertexVectorTemp();var a=new s(r.regName,r.index,0);var o=new s(r.regName,r.index,1);var l=new s(r.regName,r.index,2);e.addVertexTempUsages(r,1);var u=e.getFreeVertexVectorTemp();var p=new s(u.regName,u.index);e.removeVertexTempUsage(r);var c="";c+="mul "+a+","+e.vertexTime+","+i+".w\n";c+="sin "+o+","+a+"\n";c+="mul "+p+".xyz,"+o+","+i+".xyz\n";c+="add "+e.positionTarget+".xyz,"+p+".xyz,"+e.positionTarget+".xyz\n";if(e.needVelocity){c+="cos "+l+","+a+"\n";c+="mul "+p+".xyz,"+l+","+i+".xyz\n";c+="add "+e.velocityTarget+".xyz,"+p+".xyz,"+e.velocityTarget+".xyz\n"}return c};e.prototype.getAnimationState=function(t){return t.getAnimationState(this)};e.prototype._iGeneratePropertyOfOneParticle=function(t){var i=t[e.OSCILLATOR_VECTOR3D];if(!i)throw new Error("there is no "+e.OSCILLATOR_VECTOR3D+" in param!");this._pOneData[0]=i.x;this._pOneData[1]=i.y;this._pOneData[2]=i.z;if(i.w<=0)throw new Error("the cycle duration must greater than zero");this._pOneData[3]=Math.PI*2/i.w};e.OSCILLATOR_VECTOR3D="OscillatorVector3D";return e}(o);e.exports=l},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":undefined,"awayjs-renderergl/lib/animators/states/ParticleOscillatorState":undefined,"awayjs-stagegl/lib/materials/compilation/ShaderRegisterElement":undefined}],"awayjs-renderergl/lib/animators/nodes/ParticlePositionNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var n=t("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var o=t("awayjs-renderergl/lib/animators/states/ParticlePositionState");var h=function(t){r(e,t);function e(e,i){if(i===void 0){i=null}t.call(this,"ParticlePosition",e,3);this._pStateClass=o;this._iPosition=i||new a}e.prototype.getAGALVertexCode=function(t,e){var i=this._pMode==s.GLOBAL?e.getFreeVertexConstant():e.getFreeVertexAttribute();e.setRegisterIndex(this,o.POSITION_INDEX,i.index);return"add "+e.positionTarget+".xyz,"+i+".xyz,"+e.positionTarget+".xyz\n"};e.prototype.getAnimationState=function(t){return t.getAnimationState(this)};e.prototype._iGeneratePropertyOfOneParticle=function(t){var i=t[e.POSITION_VECTOR3D];if(!i)throw new Error("there is no "+e.POSITION_VECTOR3D+" in param!");this._pOneData[0]=i.x;this._pOneData[1]=i.y;this._pOneData[2]=i.z};e.POSITION_VECTOR3D="PositionVector3D";return e}(n);e.exports=h},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":undefined,"awayjs-renderergl/lib/animators/states/ParticlePositionState":undefined}],"awayjs-renderergl/lib/animators/nodes/ParticleRotateToHeadingNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/compilation/ShaderRegisterElement");var s=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var n=t("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var o=t("awayjs-renderergl/lib/animators/states/ParticleRotateToHeadingState");var h=function(t){r(e,t);function e(){t.call(this,"ParticleRotateToHeading",s.GLOBAL,0,3);this._pStateClass=o}e.prototype.getAGALVertexCode=function(t,e){var i="";var r=e.rotationRegisters.length;var s;if(e.hasBillboard){var n=e.getFreeVertexVectorTemp();e.addVertexTempUsages(n,1);var h=e.getFreeVertexVectorTemp();e.addVertexTempUsages(h,1);var l=e.getFreeVertexVectorTemp();var u=e.getFreeVertexConstant();e.setRegisterIndex(this,o.MATRIX_INDEX,u.index);e.getFreeVertexConstant();e.getFreeVertexConstant();e.getFreeVertexConstant();e.removeVertexTempUsage(n);e.removeVertexTempUsage(h);i+="m33 "+n+".xyz,"+e.velocityTarget+".xyz,"+u+"\n";i+="mov "+l+","+e.vertexZeroConst+"\n";i+="mov "+l+".xy,"+n+".xy\n";i+="nrm "+l+".xyz,"+l+".xyz\n";i+="mov "+h+","+e.vertexZeroConst+"\n";i+="mov "+h+".x,"+l+".y\n";i+="mov "+h+".y,"+l+".x\n";i+="mov "+n+","+e.vertexZeroConst+"\n";i+="mov "+n+".x,"+l+".x\n";i+="neg "+n+".y,"+l+".y\n";i+="mov "+l+","+e.vertexZeroConst+"\n";i+="mov "+l+".z,"+e.vertexOneConst+"\n";i+="m33 "+e.scaleAndRotateTarget+".xyz,"+e.scaleAndRotateTarget+".xyz,"+n+"\n";for(s=0;s<r;s++)i+="m33 "+e.rotationRegisters[s]+".xyz,"+e.rotationRegisters[s]+","+n+"\n"}else{var p=e.getFreeVertexVectorTemp();e.addVertexTempUsages(p,1);var c=e.getFreeVertexVectorTemp();e.addVertexTempUsages(c,1);var d=e.getFreeVertexVectorTemp();e.addVertexTempUsages(d,1);var f=e.getFreeVertexVectorTemp();var _=new a(d.regName,d.index,3);var y=new a(f.regName,f.index,3);var g=new a(p.regName,p.index,3);var m=y;e.removeVertexTempUsage(p);e.removeVertexTempUsage(c);e.removeVertexTempUsage(d);i+="mov "+c+".x,"+e.vertexOneConst+"\n";i+="mov "+c+".yz,"+e.vertexZeroConst+"\n";i+="nrm "+p+".xyz,"+e.velocityTarget+".xyz\n";i+="dp3 "+g+","+p+".xyz,"+c+".xyz\n";i+="crs "+p+".xyz,"+c+".xyz,"+p+".xyz\n";i+="nrm "+p+".xyz,"+p+".xyz\n";i+="dp3 "+d+".x,"+p+".xyz,"+p+".xyz\n";i+="sge "+d+".x,"+e.vertexZeroConst+","+d+".x\n";i+="add "+p+".z,"+d+".x,"+p+".z\n";i+="add "+m+","+g+","+e.vertexOneConst+"\n";i+="div "+m+","+m+","+e.vertexTwoConst+"\n";i+="sqt "+_+","+m+"\n";i+="sub "+m+","+e.vertexOneConst+","+g+"\n";i+="div "+m+","+m+","+e.vertexTwoConst+"\n";i+="sqt "+y+","+m+"\n";i+="mul "+d+".xyz,"+y+","+p+".xyz\n";i+="mul "+f+".xyz,"+y+","+p+".xyz\n";i+="neg "+f+".xyz,"+f+".xyz\n";i+="crs "+p+".xyz,"+d+".xyz,"+e.scaleAndRotateTarget+".xyz\n";i+="mul "+c+".xyz,"+_+","+e.scaleAndRotateTarget+".xyz\n";i+="add "+p+".xyz,"+p+".xyz,"+c+".xyz\n";i+="dp3 "+c+".w,"+d+".xyz,"+e.scaleAndRotateTarget+".xyz\n";i+="neg "+p+".w,"+c+".w\n";i+="crs "+d+".xyz,"+p+".xyz,"+f+".xyz\n";i+="mul "+c+".xyzw,"+p+".xyzw,"+_+"\n";i+="add "+d+".xyz,"+d+".xyz,"+c+".xyz\n";i+="mul "+c+".xyz,"+p+".w,"+f+".xyz\n";i+="add "+e.scaleAndRotateTarget+".xyz,"+d+".xyz,"+c+".xyz\n";for(s=0;s<r;s++){i+="mov "+c+".x,"+e.vertexOneConst+"\n";i+="mov "+c+".yz,"+e.vertexZeroConst+"\n";i+="nrm "+p+".xyz,"+e.velocityTarget+".xyz\n";i+="dp3 "+g+","+p+".xyz,"+c+".xyz\n";i+="crs "+p+".xyz,"+c+".xyz,"+p+".xyz\n";i+="nrm "+p+".xyz,"+p+".xyz\n";i+="dp3 "+d+".x,"+p+".xyz,"+p+".xyz\n";i+="sge "+d+".x,"+e.vertexZeroConst+","+d+".x\n";i+="add "+p+".z,"+d+".x,"+p+".z\n";i+="add "+m+","+g+","+e.vertexOneConst+"\n";i+="div "+m+","+m+","+e.vertexTwoConst+"\n";i+="sqt "+_+","+m+"\n";i+="sub "+m+","+e.vertexOneConst+","+g+"\n";i+="div "+m+","+m+","+e.vertexTwoConst+"\n";i+="sqt "+y+","+m+"\n";i+="mul "+d+".xyz,"+y+","+p+".xyz\n";i+="mul "+f+".xyz,"+y+","+p+".xyz\n";i+="neg "+f+".xyz,"+f+".xyz\n";i+="crs "+p+".xyz,"+d+".xyz,"+e.rotationRegisters[s]+".xyz\n";i+="mul "+c+".xyz,"+_+","+e.rotationRegisters[s]+".xyz\n";i+="add "+p+".xyz,"+p+".xyz,"+c+".xyz\n";i+="dp3 "+c+".w,"+d+".xyz,"+e.rotationRegisters[s]+".xyz\n";i+="neg "+p+".w,"+c+".w\n";i+="crs "+d+".xyz,"+p+".xyz,"+f+".xyz\n";i+="mul "+c+".xyzw,"+p+".xyzw,"+_+"\n";i+="add "+d+".xyz,"+d+".xyz,"+c+".xyz\n";i+="mul "+c+".xyz,"+p+".w,"+f+".xyz\n";i+="add "+e.rotationRegisters[s]+".xyz,"+d+".xyz,"+c+".xyz\n"}}return i};e.prototype.getAnimationState=function(t){return t.getAnimationState(this)};e.prototype._iProcessAnimationSetting=function(t){t.needVelocity=true};return e}(n);e.exports=h},{"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":undefined,"awayjs-renderergl/lib/animators/states/ParticleRotateToHeadingState":undefined,"awayjs-stagegl/lib/materials/compilation/ShaderRegisterElement":undefined}],"awayjs-renderergl/lib/animators/nodes/ParticleRotateToPositionNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-stagegl/lib/materials/compilation/ShaderRegisterElement");var n=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=t("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var h=t("awayjs-renderergl/lib/animators/states/ParticleRotateToPositionState");var l=function(t){r(e,t);function e(e,i){if(i===void 0){i=null}t.call(this,"ParticleRotateToPosition",e,3,3);this._pStateClass=h;this._iPosition=i||new a}e.prototype.getAGALVertexCode=function(t,e){var i=this._pMode==n.GLOBAL?e.getFreeVertexConstant():e.getFreeVertexAttribute();e.setRegisterIndex(this,h.POSITION_INDEX,i.index);var r="";var a=e.rotationRegisters.length;var o;if(e.hasBillboard){var l=e.getFreeVertexVectorTemp();e.addVertexTempUsages(l,1);var u=e.getFreeVertexVectorTemp();e.addVertexTempUsages(u,1);var p=e.getFreeVertexVectorTemp();var c=e.getFreeVertexConstant();e.setRegisterIndex(this,h.MATRIX_INDEX,c.index);e.getFreeVertexConstant();e.getFreeVertexConstant();e.getFreeVertexConstant();e.removeVertexTempUsage(l);e.removeVertexTempUsage(u);r+="sub "+l+".xyz,"+i+".xyz,"+e.positionTarget+".xyz\n";r+="m33 "+l+".xyz,"+l+".xyz,"+c+"\n";r+="mov "+p+","+e.vertexZeroConst+"\n";r+="mov "+p+".xy,"+l+".xy\n";r+="nrm "+p+".xyz,"+p+".xyz\n";r+="mov "+u+","+e.vertexZeroConst+"\n";r+="mov "+u+".x,"+p+".y\n";r+="mov "+u+".y,"+p+".x\n";r+="mov "+l+","+e.vertexZeroConst+"\n";r+="mov "+l+".x,"+p+".x\n";r+="neg "+l+".y,"+p+".y\n";r+="mov "+p+","+e.vertexZeroConst+"\n";r+="mov "+p+".z,"+e.vertexOneConst+"\n";r+="m33 "+e.scaleAndRotateTarget+".xyz,"+e.scaleAndRotateTarget+".xyz,"+l+"\n";for(o=0;o<a;o++)r+="m33 "+e.rotationRegisters[o]+".xyz,"+e.rotationRegisters[o]+","+l+"\n"}else{var d=e.getFreeVertexVectorTemp();e.addVertexTempUsages(d,1);var f=e.getFreeVertexVectorTemp();e.addVertexTempUsages(f,1);var _=new s(f.regName,f.index,0);var y=new s(f.regName,f.index,1);var g=new s(f.regName,f.index,2);var m=new s(f.regName,f.index,3);var b=e.getFreeVertexVectorTemp();e.addVertexTempUsages(b,1);e.removeVertexTempUsage(d);e.removeVertexTempUsage(f);e.removeVertexTempUsage(b);r+="sub "+d+".xyz,"+i+".xyz,"+e.positionTarget+".xyz\n";r+="nrm "+d+".xyz,"+d+".xyz\n";r+="mov "+y+","+d+".y\n";r+="mul "+_+","+y+","+y+"\n";r+="sub "+_+","+e.vertexOneConst+","+_+"\n";r+="sqt "+_+","+_+"\n";r+="mul "+b+".x,"+_+","+e.scaleAndRotateTarget+".y\n";r+="mul "+b+".y,"+y+","+e.scaleAndRotateTarget+".z\n";r+="mul "+b+".z,"+y+","+e.scaleAndRotateTarget+".y\n";r+="mul "+b+".w,"+_+","+e.scaleAndRotateTarget+".z\n";r+="sub "+e.scaleAndRotateTarget+".y,"+b+".x,"+b+".y\n";r+="add "+e.scaleAndRotateTarget+".z,"+b+".z,"+b+".w\n";r+="abs "+b+".y,"+d+".y\n";r+="sge "+b+".z,"+b+".y,"+e.vertexOneConst+"\n";r+="mul "+b+".x,"+b+".y,"+d+".y\n";r+="mov "+d+".y,"+e.vertexZeroConst+"\n";r+="dp3 "+y+","+d+".xyz,"+d+".xyz\n";r+="sge "+m+","+e.vertexZeroConst+","+y+"\n";r+="mov "+d+".y,"+e.vertexZeroConst+"\n";r+="nrm "+d+".xyz,"+d+".xyz\n";r+="sub "+y+","+e.vertexOneConst+","+m+"\n";r+="mul "+y+","+y+","+d+".x\n";r+="mov "+_+","+d+".z\n";r+="neg "+_+","+_+"\n";r+="sub "+g+","+e.vertexOneConst+","+_+"\n";r+="mul "+g+","+b+".x,"+m+"\n";r+="add "+_+","+_+","+g+"\n";r+="mul "+b+".x,"+_+","+e.scaleAndRotateTarget+".x\n";r+="mul "+b+".y,"+y+","+e.scaleAndRotateTarget+".z\n";r+="mul "+b+".z,"+y+","+e.scaleAndRotateTarget+".x\n";r+="mul "+b+".w,"+_+","+e.scaleAndRotateTarget+".z\n";r+="sub "+e.scaleAndRotateTarget+".x,"+b+".x,"+b+".y\n";r+="add "+e.scaleAndRotateTarget+".z,"+b+".z,"+b+".w\n";for(o=0;o<a;o++){r+="sub "+d+".xyz,"+i+".xyz,"+e.positionTarget+".xyz\n";r+="nrm "+d+".xyz,"+d+".xyz\n";r+="mov "+y+","+d+".y\n";r+="mul "+_+","+y+","+y+"\n";r+="sub "+_+","+e.vertexOneConst+","+_+"\n";r+="sqt "+_+","+_+"\n";r+="mul "+b+".x,"+_+","+e.rotationRegisters[o]+".y\n";r+="mul "+b+".y,"+y+","+e.rotationRegisters[o]+".z\n";r+="mul "+b+".z,"+y+","+e.rotationRegisters[o]+".y\n";r+="mul "+b+".w,"+_+","+e.rotationRegisters[o]+".z\n";r+="sub "+e.rotationRegisters[o]+".y,"+b+".x,"+b+".y\n";r+="add "+e.rotationRegisters[o]+".z,"+b+".z,"+b+".w\n";r+="abs "+b+".y,"+d+".y\n";r+="sge "+b+".z,"+b+".y,"+e.vertexOneConst+"\n";r+="mul "+b+".x,"+b+".y,"+d+".y\n";r+="mov "+d+".y,"+e.vertexZeroConst+"\n";r+="dp3 "+y+","+d+".xyz,"+d+".xyz\n";r+="sge "+m+","+e.vertexZeroConst+","+y+"\n";r+="mov "+d+".y,"+e.vertexZeroConst+"\n";r+="nrm "+d+".xyz,"+d+".xyz\n";r+="sub "+y+","+e.vertexOneConst+","+m+"\n";r+="mul "+y+","+y+","+d+".x\n";r+="mov "+_+","+d+".z\n";r+="neg "+_+","+_+"\n";r+="sub "+g+","+e.vertexOneConst+","+_+"\n";r+="mul "+g+","+b+".x,"+m+"\n";r+="add "+_+","+_+","+g+"\n";r+="mul "+b+".x,"+_+","+e.rotationRegisters[o]+".x\n";r+="mul "+b+".y,"+y+","+e.rotationRegisters[o]+".z\n";r+="mul "+b+".z,"+y+","+e.rotationRegisters[o]+".x\n";r+="mul "+b+".w,"+_+","+e.rotationRegisters[o]+".z\n";r+="sub "+e.rotationRegisters[o]+".x,"+b+".x,"+b+".y\n";r+="add "+e.rotationRegisters[o]+".z,"+b+".z,"+b+".w\n"}}return r};e.prototype.getAnimationState=function(t){return t.getAnimationState(this)};e.prototype._iGeneratePropertyOfOneParticle=function(t){var i=t[e.POSITION_VECTOR3D];if(!i)throw new Error("there is no "+e.POSITION_VECTOR3D+" in param!");this._pOneData[0]=i.x;this._pOneData[1]=i.y;this._pOneData[2]=i.z};e.POSITION_VECTOR3D="RotateToPositionVector3D";return e}(o);e.exports=l},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":undefined,"awayjs-renderergl/lib/animators/states/ParticleRotateToPositionState":undefined,"awayjs-stagegl/lib/materials/compilation/ShaderRegisterElement":undefined}],"awayjs-renderergl/lib/animators/nodes/ParticleRotationalVelocityNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-stagegl/lib/materials/compilation/ShaderRegisterElement");var n=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=t("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var h=t("awayjs-renderergl/lib/animators/states/ParticleRotationalVelocityState");var l=function(t){r(e,t);function e(e,i){if(i===void 0){i=null}t.call(this,"ParticleRotationalVelocity",e,4);this._pStateClass=h;this._iRotationalVelocity=i||new a}e.prototype.getAGALVertexCode=function(t,e){var i=this._pMode==n.GLOBAL?e.getFreeVertexConstant():e.getFreeVertexAttribute();e.setRegisterIndex(this,h.ROTATIONALVELOCITY_INDEX,i.index);var r=e.getFreeVertexVectorTemp();e.addVertexTempUsages(r,1);var a=e.getFreeVertexVectorTemp();e.addVertexTempUsages(a,1);var o=e.getFreeVertexVectorTemp();e.addVertexTempUsages(o,1);var l=new s(o.regName,o.index);var u=e.getFreeVertexVectorTemp();u=new s(u.regName,u.index);var p=new s(l.regName,l.index,3);var c=new s(u.regName,u.index,3);e.removeVertexTempUsage(r);e.removeVertexTempUsage(a);e.removeVertexTempUsage(o);var d="";d+="mov "+r+".xyz,"+i+".xyz\n";d+="mov "+r+".w,"+e.vertexZeroConst+"\n";d+="mul "+p+","+e.vertexTime+","+i+".w\n";d+="sin "+c+","+p+"\n";d+="cos "+p+","+p+"\n";d+="mul "+l+".xyz,"+c+","+r+".xyz\n";d+="mul "+u+".xyz,"+c+","+r+".xyz\n";d+="neg "+u+".xyz,"+u+".xyz\n";d+="crs "+r+".xyz,"+l+".xyz,"+e.scaleAndRotateTarget+".xyz\n";d+="mul "+a+".xyz,"+p+","+e.scaleAndRotateTarget+".xyz\n";d+="add "+r+".xyz,"+r+".xyz,"+a+".xyz\n";d+="dp3 "+a+".w,"+l+".xyz,"+e.scaleAndRotateTarget+".xyz\n";d+="neg "+r+".w,"+a+".w\n";d+="crs "+l+".xyz,"+r+".xyz,"+u+".xyz\n";d+="mul "+a+".xyzw,"+r+".xyzw,"+p+"\n";d+="add "+l+".xyz,"+l+".xyz,"+a+".xyz\n";d+="mul "+a+".xyz,"+r+".w,"+u+".xyz\n";d+="add "+e.scaleAndRotateTarget+".xyz,"+l+".xyz,"+a+".xyz\n";var f=e.rotationRegisters.length;for(var _=0;_<f;_++){d+="mov "+r+".xyz,"+i+".xyz\n";d+="mov "+r+".w,"+e.vertexZeroConst+"\n";d+="mul "+p+","+e.vertexTime+","+i+".w\n";d+="sin "+c+","+p+"\n";d+="cos "+p+","+p+"\n";d+="mul "+l+".xyz,"+c+","+r+".xyz\n";d+="mul "+u+".xyz,"+c+","+r+".xyz\n";d+="neg "+u+".xyz,"+u+".xyz\n";d+="crs "+r+".xyz,"+l+".xyz,"+e.rotationRegisters[_]+".xyz\n";d+="mul "+a+".xyz,"+p+","+e.rotationRegisters[_]+"\n";d+="add "+r+".xyz,"+r+".xyz,"+a+".xyz\n";d+="dp3 "+a+".w,"+l+".xyz,"+e.rotationRegisters[_]+"\n";d+="neg "+r+".w,"+a+".w\n";d+="crs "+l+".xyz,"+r+".xyz,"+u+".xyz\n";d+="mul "+a+".xyzw,"+r+".xyzw,"+p+"\n";d+="add "+l+".xyz,"+l+".xyz,"+a+".xyz\n";d+="mul "+a+".xyz,"+r+".w,"+u+".xyz\n";d+="add "+e.rotationRegisters[_]+","+l+".xyz,"+a+".xyz\n"}return d};e.prototype.getAnimationState=function(t){return t.getAnimationState(this)};e.prototype._iGeneratePropertyOfOneParticle=function(t){var i=t[e.ROTATIONALVELOCITY_VECTOR3D];if(!i)throw new Error("there is no "+e.ROTATIONALVELOCITY_VECTOR3D+" in param!");if(i.length<=0)i.z=1;else i.normalize();this._pOneData[0]=i.x;this._pOneData[1]=i.y;this._pOneData[2]=i.z;if(i.w<=0)throw new Error("the cycle duration must greater than zero");this._pOneData[3]=Math.PI/i.w};e.ROTATIONALVELOCITY_VECTOR3D="RotationalVelocityVector3D";return e}(o);e.exports=l},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":undefined,"awayjs-renderergl/lib/animators/states/ParticleRotationalVelocityState":undefined,"awayjs-stagegl/lib/materials/compilation/ShaderRegisterElement":undefined}],"awayjs-renderergl/lib/animators/nodes/ParticleScaleNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var s=t("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var n=t("awayjs-renderergl/lib/animators/states/ParticleScaleState");var o=function(t){r(e,t);function e(e,i,r,a,s,o,h){if(a===void 0){a=1}if(s===void 0){s=1}if(o===void 0){o=1}if(h===void 0){h=0}t.call(this,"ParticleScale",e,i&&r?4:i||r?3:2,3);this._pStateClass=n;this._iUsesCycle=i;this._iUsesPhase=r;this._iMinScale=a;this._iMaxScale=s;this._iCycleDuration=o;this._iCyclePhase=h}e.prototype.getAGALVertexCode=function(t,e){var i="";var r=e.getFreeVertexSingleTemp();var s=this._pMode==a.GLOBAL?e.getFreeVertexConstant():e.getFreeVertexAttribute();e.setRegisterIndex(this,n.SCALE_INDEX,s.index);if(this._iUsesCycle){i+="mul "+r+","+e.vertexTime+","+s+".z\n";if(this._iUsesPhase)i+="add "+r+","+r+","+s+".w\n";i+="sin "+r+","+r+"\n"}i+="mul "+r+","+s+".y,"+(this._iUsesCycle?r:e.vertexLife)+"\n";i+="add "+r+","+s+".x,"+r+"\n";i+="mul "+e.scaleAndRotateTarget+".xyz,"+e.scaleAndRotateTarget+".xyz,"+r+"\n";return i};e.prototype.getAnimationState=function(t){return t.getAnimationState(this)};e.prototype._iGeneratePropertyOfOneParticle=function(t){var i=t[e.SCALE_VECTOR3D];if(!i)throw new Error("there is no "+e.SCALE_VECTOR3D+" in param!");if(this._iUsesCycle){this._pOneData[0]=(i.x+i.y)/2;this._pOneData[1]=Math.abs(i.x-i.y)/2;if(i.z<=0)throw new Error("the cycle duration must be greater than zero");this._pOneData[2]=Math.PI*2/i.z;if(this._iUsesPhase)this._pOneData[3]=i.w*Math.PI/180}else{this._pOneData[0]=i.x;this._pOneData[1]=i.y-i.x}};e.SCALE_VECTOR3D="ScaleVector3D";return e}(s);e.exports=o},{"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":undefined,"awayjs-renderergl/lib/animators/states/ParticleScaleState":undefined}],"awayjs-renderergl/lib/animators/nodes/ParticleSegmentedColorNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/compilation/ShaderRegisterElement");var s=t("awayjs-renderergl/lib/animators/ParticleAnimationSet");var n=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=t("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var h=t("awayjs-renderergl/lib/animators/states/ParticleSegmentedColorState");var l=function(t){r(e,t);function e(e,i,r,a,o,l){t.call(this,"ParticleSegmentedColor",n.GLOBAL,0,s.COLOR_PRIORITY);this._pStateClass=h;if(r>4)throw new Error("the numSegmentPoint must be less or equal 4");this._iUsesMultiplier=e;this._iUsesOffset=i;this._iNumSegmentPoint=r;this._iStartColor=a;this._iEndColor=o;this._iSegmentPoints=l}e.prototype._iProcessAnimationSetting=function(t){if(this._iUsesMultiplier)t.hasColorMulNode=true;if(this._iUsesOffset)t.hasColorAddNode=true};e.prototype.getAGALVertexCode=function(t,e){var i="";if(e.needFragmentAnimation){var r;if(this._iUsesMultiplier){r=e.getFreeVertexVectorTemp();e.addVertexTempUsages(r,1)}var s=e.getFreeVertexVectorTemp();e.addVertexTempUsages(s,1);var n=e.getFreeVertexVectorTemp();var o=new a(n.regName,n.index,0);var l=new a(n.regName,n.index,1);if(this._iUsesMultiplier)e.removeVertexTempUsage(r);e.removeVertexTempUsage(s);var u=e.getFreeVertexConstant();e.setRegisterIndex(this,h.TIME_DATA_INDEX,u.index);var p;var c;var d;if(this._iUsesMultiplier){c=e.getFreeVertexConstant();e.setRegisterIndex(this,h.START_MULTIPLIER_INDEX,c.index);d=new Array;for(p=0;p<this._iNumSegmentPoint+1;p++)d.push(e.getFreeVertexConstant())}var f;var _;if(this._iUsesOffset){f=e.getFreeVertexConstant();e.setRegisterIndex(this,h.START_OFFSET_INDEX,f.index);_=new Array;for(p=0;p<this._iNumSegmentPoint+1;p++)_.push(e.getFreeVertexConstant())}if(this._iUsesMultiplier)i+="mov "+r+","+c+"\n";if(this._iUsesOffset)i+="add "+e.colorAddTarget+","+e.colorAddTarget+","+f+"\n";for(p=0;p<this._iNumSegmentPoint;p++){switch(p){case 0:i+="min "+l+","+e.vertexLife+","+u+".x\n";break;case 1:i+="sub "+o+","+e.vertexLife+","+u+".x\n";i+="max "+l+","+o+","+e.vertexZeroConst+"\n";i+="min "+l+","+l+","+u+".y\n";break;case 2:i+="sub "+o+","+o+","+u+".y\n";i+="max "+l+","+o+","+e.vertexZeroConst+"\n";i+="min "+l+","+l+","+u+".z\n";break;case 3:i+="sub "+o+","+o+","+u+".z\n";i+="max "+l+","+o+","+e.vertexZeroConst+"\n";i+="min "+l+","+l+","+u+".w\n";break}if(this._iUsesMultiplier){i+="mul "+s+","+l+","+d[p]+"\n";i+="add "+r+","+r+","+s+"\n"}if(this._iUsesOffset){i+="mul "+s+","+l+","+_[p]+"\n";i+="add "+e.colorAddTarget+","+e.colorAddTarget+","+s+"\n"}}if(this._iNumSegmentPoint==0)l=e.vertexLife;else{switch(this._iNumSegmentPoint){case 1:i+="sub "+o+","+e.vertexLife+","+u+".x\n";break;case 2:i+="sub "+o+","+o+","+u+".y\n";break;case 3:i+="sub "+o+","+o+","+u+".z\n";break;case 4:i+="sub "+o+","+o+","+u+".w\n";break}i+="max "+l+","+o+","+e.vertexZeroConst+"\n"}if(this._iUsesMultiplier){i+="mul "+s+","+l+","+d[this._iNumSegmentPoint]+"\n";i+="add "+r+","+r+","+s+"\n";i+="mul "+e.colorMulTarget+","+e.colorMulTarget+","+r+"\n"}if(this._iUsesOffset){i+="mul "+s+","+l+","+_[this._iNumSegmentPoint]+"\n";i+="add "+e.colorAddTarget+","+e.colorAddTarget+","+s+"\n"}}return i};return e}(o);e.exports=l},{"awayjs-renderergl/lib/animators/ParticleAnimationSet":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":undefined,"awayjs-renderergl/lib/animators/states/ParticleSegmentedColorState":undefined,"awayjs-stagegl/lib/materials/compilation/ShaderRegisterElement":undefined}],"awayjs-renderergl/lib/animators/nodes/ParticleSpriteSheetNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/compilation/ShaderRegisterElement");var s=t("awayjs-renderergl/lib/animators/ParticleAnimationSet");var n=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=t("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var h=t("awayjs-renderergl/lib/animators/states/ParticleSpriteSheetState");var l=function(t){r(e,t);function e(e,i,r,a,n,o,l,u){if(a===void 0){a=1}if(n===void 0){n=1}if(o===void 0){o=1}if(l===void 0){l=0}if(u===void 0){u=Number.MAX_VALUE}t.call(this,"ParticleSpriteSheet",e,i?r?3:2:1,s.POST_PRIORITY+1);this._pStateClass=h;this._iUsesCycle=i;this._iUsesPhase=r;this._iNumColumns=a;this._iNumRows=n;this._iCyclePhase=l;this._iCycleDuration=o;this._iTotalFrames=Math.min(u,a*n)}Object.defineProperty(e.prototype,"numColumns",{get:function(){return this._iNumColumns},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numRows",{get:function(){return this._iNumRows},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"totalFrames",{get:function(){return this._iTotalFrames},enumerable:true,configurable:true});e.prototype.getAGALUVCode=function(t,e){var i=e.getFreeVertexConstant();var r=this._pMode==n.GLOBAL?e.getFreeVertexConstant():e.getFreeVertexAttribute();e.setRegisterIndex(this,h.UV_INDEX_0,i.index);e.setRegisterIndex(this,h.UV_INDEX_1,r.index);var s=new a(i.regName,i.index,0);var o=new a(i.regName,i.index,1);var l=new a(i.regName,i.index,2);var u=new a(r.regName,r.index,0);var p=new a(r.regName,r.index,1);var c=new a(r.regName,r.index,2);var d=e.getFreeVertexVectorTemp();var f=new a(d.regName,d.index,0);var _=new a(d.regName,d.index,1);d=new a(d.regName,d.index,2);var y=new a(d.regName,d.index,3);var g=new a(e.uvTarget.regName,e.uvTarget.index,0);var m=new a(e.uvTarget.regName,e.uvTarget.index,1);var b="";b+="mul "+g+","+g+","+o+"\n";if(this._iNumRows>1)b+="mul "+m+","+m+","+l+"\n";if(this._iUsesCycle){if(this._iUsesPhase)b+="add "+f+","+e.vertexTime+","+c+"\n";else b+="mov "+f+","+e.vertexTime+"\n";b+="div "+f+","+f+","+p+"\n";b+="frc "+f+","+f+"\n";b+="mul "+f+","+f+","+p+"\n";b+="mul "+d+","+f+","+u+"\n"}else b+="mul "+d.toString()+","+e.vertexLife+","+s+"\n";if(this._iNumRows>1){b+="frc "+y+","+d+"\n";b+="sub "+_+","+d+","+y+"\n";b+="mul "+_+","+_+","+l+"\n";b+="add "+m+","+m+","+_+"\n"}b+="div "+y+","+d+","+o+"\n";b+="frc "+d+","+y+"\n";b+="sub "+y+","+y+","+d+"\n";b+="mul "+d+","+y+","+o+"\n";if(this._iNumRows>1)b+="frc "+d+","+d+"\n";b+="add "+g+","+g+","+d+"\n";return b};e.prototype.getAnimationState=function(t){return t.getAnimationState(this)};e.prototype._iProcessAnimationSetting=function(t){t.hasUVNode=true};e.prototype._iGeneratePropertyOfOneParticle=function(t){if(this._iUsesCycle){var i=t[e.UV_VECTOR3D];if(!i)throw new Error("there is no "+e.UV_VECTOR3D+" in param!");if(i.x<=0)throw new Error("the cycle duration must be greater than zero");var r=this._iTotalFrames/this._iNumColumns;this._pOneData[0]=r/i.x;this._pOneData[1]=i.x;if(this._iUsesPhase)this._pOneData[2]=i.y}};e.UV_VECTOR3D="UVVector3D";return e}(o);e.exports=l},{"awayjs-renderergl/lib/animators/ParticleAnimationSet":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":undefined,"awayjs-renderergl/lib/animators/states/ParticleSpriteSheetState":undefined,"awayjs-stagegl/lib/materials/compilation/ShaderRegisterElement":undefined}],"awayjs-renderergl/lib/animators/nodes/ParticleTimeNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var s=t("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var n=t("awayjs-renderergl/lib/animators/states/ParticleTimeState");var o=function(t){r(e,t);function e(e,i,r){if(e===void 0){e=false}if(i===void 0){i=false}if(r===void 0){r=false}this._pStateClass=n;this._iUsesDuration=e;this._iUsesLooping=i;this._iUsesDelay=r;t.call(this,"ParticleTime",a.LOCAL_STATIC,4,0)}e.prototype.getAGALVertexCode=function(t,e){var i=e.getFreeVertexAttribute();e.setRegisterIndex(this,n.TIME_STREAM_INDEX,i.index);var r=e.getFreeVertexConstant();e.setRegisterIndex(this,n.TIME_CONSTANT_INDEX,r.index);var a="";a+="sub "+e.vertexTime+","+r+","+i+".x\n";var s=e.getFreeVertexSingleTemp();a+="sge "+s+","+e.vertexTime+","+e.vertexZeroConst+"\n";a+="mul "+e.scaleAndRotateTarget+".xyz,"+e.scaleAndRotateTarget+".xyz,"+s+"\n";if(this._iUsesDuration){if(this._iUsesLooping){var o=e.getFreeVertexSingleTemp();if(this._iUsesDelay){a+="div "+o+","+e.vertexTime+","+i+".z\n";a+="frc "+o+","+o+"\n";a+="mul "+e.vertexTime+","+o+","+i+".z\n";a+="slt "+o+","+e.vertexTime+","+i+".y\n";a+="mul "+e.scaleAndRotateTarget+".xyz,"+e.scaleAndRotateTarget+".xyz,"+o+"\n"}else{a+="mul "+o+","+e.vertexTime+","+i+".w\n";a+="frc "+o+","+o+"\n";a+="mul "+e.vertexTime+","+o+","+i+".y\n"}}else{var h=e.getFreeVertexSingleTemp();a+="sge "+h+","+i+".y,"+e.vertexTime+"\n";a+="mul "+e.scaleAndRotateTarget+".xyz,"+e.scaleAndRotateTarget+".xyz,"+h+"\n"}}a+="mul "+e.vertexLife+","+e.vertexTime+","+i+".w\n";return a};e.prototype.getAnimationState=function(t){return t.getAnimationState(this)};e.prototype._iGeneratePropertyOfOneParticle=function(t){this._pOneData[0]=t.startTime;this._pOneData[1]=t.duration;this._pOneData[2]=t.delay+t.duration;this._pOneData[3]=1/t.duration};return e}(s);e.exports=o},{"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":undefined,"awayjs-renderergl/lib/animators/states/ParticleTimeState":undefined}],"awayjs-renderergl/lib/animators/nodes/ParticleUVNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-stagegl/lib/materials/compilation/ShaderRegisterElement");var n=t("awayjs-renderergl/lib/animators/ParticleAnimationSet");var o=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var h=t("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var l=t("awayjs-renderergl/lib/animators/states/ParticleUVState");var u=function(t){r(e,t);function e(e,i,r,a){if(i===void 0){i=1
}if(r===void 0){r=1}if(a===void 0){a="x"}t.call(this,"ParticleUV",o.GLOBAL,4,n.POST_PRIORITY+1);this._pStateClass=l;this._cycle=i;this._scale=r;this._axis=a;this.updateUVData()}Object.defineProperty(e.prototype,"cycle",{get:function(){return this._cycle},set:function(t){this._cycle=t;this.updateUVData()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scale",{get:function(){return this._scale},set:function(t){this._scale=t;this.updateUVData()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"axis",{get:function(){return this._axis},set:function(t){this._axis=t},enumerable:true,configurable:true});e.prototype.getAGALUVCode=function(t,e){var i="";var r=e.getFreeVertexConstant();e.setRegisterIndex(this,l.UV_INDEX,r.index);var a=this._axis=="x"?0:this._axis=="y"?1:2;var n=new s(e.uvTarget.regName,e.uvTarget.index,a);var o=e.getFreeVertexSingleTemp();if(this._scale!=1)i+="mul "+n+","+n+","+r+".y\n";i+="mul "+o+","+e.vertexTime+","+r+".x\n";i+="sin "+o+","+o+"\n";i+="add "+n+","+n+","+o+"\n";return i};e.prototype.getAnimationState=function(t){return t.getAnimationState(this)};e.prototype.updateUVData=function(){this._iUvData=new a(Math.PI*2/this._cycle,this._scale,0,0)};e.prototype._iProcessAnimationSetting=function(t){t.hasUVNode=true};e.U_AXIS="x";e.V_AXIS="y";return e}(h);e.exports=u},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/ParticleAnimationSet":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":undefined,"awayjs-renderergl/lib/animators/states/ParticleUVState":undefined,"awayjs-stagegl/lib/materials/compilation/ShaderRegisterElement":undefined}],"awayjs-renderergl/lib/animators/nodes/ParticleVelocityNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var n=t("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var o=t("awayjs-renderergl/lib/animators/states/ParticleVelocityState");var h=function(t){r(e,t);function e(e,i){if(i===void 0){i=null}t.call(this,"ParticleVelocity",e,3);this._pStateClass=o;this._iVelocity=i||new a}e.prototype.getAGALVertexCode=function(t,e){var i=this._pMode==s.GLOBAL?e.getFreeVertexConstant():e.getFreeVertexAttribute();e.setRegisterIndex(this,o.VELOCITY_INDEX,i.index);var r=e.getFreeVertexVectorTemp();var a="";a+="mul "+r+","+e.vertexTime+","+i+"\n";a+="add "+e.positionTarget+".xyz,"+r+","+e.positionTarget+".xyz\n";if(e.needVelocity)a+="add "+e.velocityTarget+".xyz,"+i+".xyz,"+e.velocityTarget+".xyz\n";return a};e.prototype.getAnimationState=function(t){return t.getAnimationState(this)};e.prototype._iGeneratePropertyOfOneParticle=function(t){var i=t[e.VELOCITY_VECTOR3D];if(!i)throw new Error("there is no "+e.VELOCITY_VECTOR3D+" in param!");this._pOneData[0]=i.x;this._pOneData[1]=i.y;this._pOneData[2]=i.z};e.VELOCITY_VECTOR3D="VelocityVector3D";return e}(n);e.exports=h},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":undefined,"awayjs-renderergl/lib/animators/states/ParticleVelocityState":undefined}],"awayjs-renderergl/lib/animators/nodes/SkeletonBinaryLERPNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/animators/nodes/AnimationNodeBase");var s=t("awayjs-renderergl/lib/animators/states/SkeletonBinaryLERPState");var n=function(t){r(e,t);function e(){t.call(this);this._pStateClass=s}e.prototype.getAnimationState=function(t){return t.getAnimationState(this)};return e}(a);e.exports=n},{"awayjs-display/lib/animators/nodes/AnimationNodeBase":undefined,"awayjs-renderergl/lib/animators/states/SkeletonBinaryLERPState":undefined}],"awayjs-renderergl/lib/animators/nodes/SkeletonClipNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase");var s=t("awayjs-renderergl/lib/animators/states/SkeletonClipState");var n=function(t){r(e,t);function e(){t.call(this);this._frames=new Array;this.highQuality=false;this._pStateClass=s}Object.defineProperty(e.prototype,"frames",{get:function(){return this._frames},enumerable:true,configurable:true});e.prototype.addFrame=function(t,e){this._frames.push(t);this._pDurations.push(e);this._pNumFrames=this._pDurations.length;this._pStitchDirty=true};e.prototype.getAnimationState=function(t){return t.getAnimationState(this)};e.prototype._pUpdateStitch=function(){t.prototype._pUpdateStitch.call(this);var e=this._pNumFrames-1;var i,r,a;while(e--){this._pTotalDuration+=this._pDurations[e];i=this._frames[e].jointPoses[0].translation;r=this._frames[e+1].jointPoses[0].translation;a=r.subtract(i);this._pTotalDelta.x+=a.x;this._pTotalDelta.y+=a.y;this._pTotalDelta.z+=a.z}if(this._pStitchFinalFrame||!this._pLooping){this._pTotalDuration+=this._pDurations[this._pNumFrames-1];i=this._frames[0].jointPoses[0].translation;r=this._frames[1].jointPoses[0].translation;a=r.subtract(i);this._pTotalDelta.x+=a.x;this._pTotalDelta.y+=a.y;this._pTotalDelta.z+=a.z}};return e}(a);e.exports=n},{"awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase":undefined,"awayjs-renderergl/lib/animators/states/SkeletonClipState":undefined}],"awayjs-renderergl/lib/animators/nodes/SkeletonDifferenceNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/animators/nodes/AnimationNodeBase");var s=t("awayjs-renderergl/lib/animators/states/SkeletonDifferenceState");var n=function(t){r(e,t);function e(){t.call(this);this._pStateClass=s}e.prototype.getAnimationState=function(t){return t.getAnimationState(this)};return e}(a);e.exports=n},{"awayjs-display/lib/animators/nodes/AnimationNodeBase":undefined,"awayjs-renderergl/lib/animators/states/SkeletonDifferenceState":undefined}],"awayjs-renderergl/lib/animators/nodes/SkeletonDirectionalNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/animators/nodes/AnimationNodeBase");var s=t("awayjs-renderergl/lib/animators/states/SkeletonDirectionalState");var n=function(t){r(e,t);function e(){t.call(this);this._pStateClass=s}e.prototype.getAnimationState=function(t){return t.getAnimationState(this)};return e}(a);e.exports=n},{"awayjs-display/lib/animators/nodes/AnimationNodeBase":undefined,"awayjs-renderergl/lib/animators/states/SkeletonDirectionalState":undefined}],"awayjs-renderergl/lib/animators/nodes/SkeletonNaryLERPNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/animators/nodes/AnimationNodeBase");var s=t("awayjs-renderergl/lib/animators/states/SkeletonNaryLERPState");var n=function(t){r(e,t);function e(){t.call(this);this._iInputs=new Array;this._pStateClass=s}Object.defineProperty(e.prototype,"numInputs",{get:function(){return this._numInputs},enumerable:true,configurable:true});e.prototype.getInputIndex=function(t){return this._iInputs.indexOf(t)};e.prototype.getInputAt=function(t){return this._iInputs[t]};e.prototype.addInput=function(t){this._iInputs[this._numInputs++]=t};e.prototype.getAnimationState=function(t){return t.getAnimationState(this)};return e}(a);e.exports=n},{"awayjs-display/lib/animators/nodes/AnimationNodeBase":undefined,"awayjs-renderergl/lib/animators/states/SkeletonNaryLERPState":undefined}],"awayjs-renderergl/lib/animators/nodes/VertexClipNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase");var n=t("awayjs-renderergl/lib/animators/states/VertexClipState");var o=function(t){r(e,t);function e(){t.call(this);this._frames=new Array;this._translations=new Array;this._pStateClass=n}Object.defineProperty(e.prototype,"frames",{get:function(){return this._frames},enumerable:true,configurable:true});e.prototype.addFrame=function(t,e,i){if(i===void 0){i=null}this._frames.push(t);this._pDurations.push(e);this._translations.push(i||new a);this._pNumFrames=this._pDurations.length;this._pStitchDirty=true};e.prototype._pUpdateStitch=function(){t.prototype._pUpdateStitch.call(this);var e=this._pNumFrames-1;var i,r,a;while(e--){this._pTotalDuration+=this._pDurations[e];i=this._translations[e];r=this._translations[e+1];a=r.subtract(i);this._pTotalDelta.x+=a.x;this._pTotalDelta.y+=a.y;this._pTotalDelta.z+=a.z}if(this._pNumFrames>1&&(this._pStitchFinalFrame||!this._pLooping)){this._pTotalDuration+=this._pDurations[this._pNumFrames-1];i=this._translations[0];r=this._translations[1];a=r.subtract(i);this._pTotalDelta.x+=a.x;this._pTotalDelta.y+=a.y;this._pTotalDelta.z+=a.z}};return e}(s);e.exports=o},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase":undefined,"awayjs-renderergl/lib/animators/states/VertexClipState":undefined}],"awayjs-renderergl/lib/animators/states/AnimationClipState":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-renderergl/lib/animators/states/AnimationStateBase");var s=t("awayjs-renderergl/lib/events/AnimationStateEvent");var n=function(t){r(e,t);function e(e,i){t.call(this,e,i);this._pFramesDirty=true;this._animationClipNode=i}Object.defineProperty(e.prototype,"blendWeight",{get:function(){if(this._pFramesDirty)this._pUpdateFrames();return this._pBlendWeight},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"currentFrame",{get:function(){if(this._pFramesDirty)this._pUpdateFrames();return this._pCurrentFrame},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"nextFrame",{get:function(){if(this._pFramesDirty)this._pUpdateFrames();return this._pNextFrame},enumerable:true,configurable:true});e.prototype.update=function(t){if(!this._animationClipNode.looping){if(t>this._pStartTime+this._animationClipNode.totalDuration)t=this._pStartTime+this._animationClipNode.totalDuration;else if(t<this._pStartTime)t=this._pStartTime}if(this._pTime==t-this._pStartTime)return;this._pUpdateTime(t)};e.prototype.phase=function(t){var e=t*this._animationClipNode.totalDuration+this._pStartTime;if(this._pTime==e-this._pStartTime)return;this._pUpdateTime(e)};e.prototype._pUpdateTime=function(e){this._pFramesDirty=true;this._pTimeDir=e-this._pStartTime>this._pTime?1:-1;t.prototype._pUpdateTime.call(this,e)};e.prototype._pUpdateFrames=function(){this._pFramesDirty=false;var t=this._animationClipNode.looping;var e=this._animationClipNode.totalDuration;var i=this._animationClipNode.lastFrame;var r=this._pTime;if(t&&(r>=e||r<0)){r%=e;if(r<0)r+=e}if(!t&&r>=e){this.notifyPlaybackComplete();this._pCurrentFrame=i;this._pNextFrame=i;this._pBlendWeight=0}else if(!t&&r<=0){this._pCurrentFrame=0;this._pNextFrame=0;this._pBlendWeight=0}else if(this._animationClipNode.fixedFrameRate){var a=r/e*i;this._pCurrentFrame=Math.floor(a);this._pBlendWeight=a-this._pCurrentFrame;this._pNextFrame=this._pCurrentFrame+1}else{this._pCurrentFrame=0;this._pNextFrame=0;var s=0,n;var o=this._animationClipNode.durations;do{n=s;s+=o[this._pNextFrame];this._pCurrentFrame=this._pNextFrame++}while(r>s);if(this._pCurrentFrame==i){this._pCurrentFrame=0;this._pNextFrame=1}this._pBlendWeight=(r-n)/o[this._pCurrentFrame]}};e.prototype.notifyPlaybackComplete=function(){if(this._animationStatePlaybackComplete==null)this._animationStatePlaybackComplete=new s(s.PLAYBACK_COMPLETE,this._pAnimator,this,this._animationClipNode);this._animationClipNode.dispatchEvent(this._animationStatePlaybackComplete)};return e}(a);e.exports=n},{"awayjs-renderergl/lib/animators/states/AnimationStateBase":undefined,"awayjs-renderergl/lib/events/AnimationStateEvent":undefined}],"awayjs-renderergl/lib/animators/states/AnimationStateBase":[function(t,e,i){var r=t("awayjs-core/lib/geom/Vector3D");var a=function(){function t(t,e){this._pRootDelta=new r;this._pPositionDeltaDirty=true;this._pStartTime=0;this._pAnimator=t;this._pAnimationNode=e}Object.defineProperty(t.prototype,"positionDelta",{get:function(){if(this._pPositionDeltaDirty){this._pUpdatePositionDelta()}return this._pRootDelta},enumerable:true,configurable:true});t.prototype.offset=function(t){this._pStartTime=t;this._pPositionDeltaDirty=true};t.prototype.update=function(t){if(this._pTime==t-this._pStartTime){return}this._pUpdateTime(t)};t.prototype.phase=function(t){};t.prototype._pUpdateTime=function(t){this._pTime=t-this._pStartTime;this._pPositionDeltaDirty=true};t.prototype._pUpdatePositionDelta=function(){};return t}();e.exports=a},{"awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-renderergl/lib/animators/states/ISkeletonAnimationState":[function(t,e,i){},{}],"awayjs-renderergl/lib/animators/states/IVertexAnimationState":[function(t,e,i){},{}],"awayjs-renderergl/lib/animators/states/ParticleAccelerationState":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var n=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=t("awayjs-renderergl/lib/animators/states/ParticleStateBase");var h=function(t){r(e,t);function e(e,i){t.call(this,e,i);this._particleAccelerationNode=i;this._acceleration=this._particleAccelerationNode._acceleration;this.updateAccelerationData()}Object.defineProperty(e.prototype,"acceleration",{get:function(){return this._acceleration},set:function(t){this._acceleration.x=t.x;this._acceleration.y=t.y;this._acceleration.z=t.z;this.updateAccelerationData()},enumerable:true,configurable:true});e.prototype.setRenderState=function(t,i,r,a,o){var h=a.getRegisterIndex(this._pAnimationNode,e.ACCELERATION_INDEX);if(this._particleAccelerationNode.mode==n.LOCAL_STATIC)r.activateVertexBuffer(h,this._particleAccelerationNode._iDataOffset,t,s.FLOAT_3);else a.setVertexConst(h,this._halfAcceleration.x,this._halfAcceleration.y,this._halfAcceleration.z)};e.prototype.updateAccelerationData=function(){if(this._particleAccelerationNode.mode==n.GLOBAL)this._halfAcceleration=new a(this._acceleration.x/2,this._acceleration.y/2,this._acceleration.z/2)};e.ACCELERATION_INDEX=0;return e}(o);e.exports=h},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/states/ParticleStateBase":undefined,"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/ParticleBezierCurveState":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var s=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var n=t("awayjs-renderergl/lib/animators/states/ParticleStateBase");var o=function(t){r(e,t);function e(e,i){t.call(this,e,i);this._particleBezierCurveNode=i;this._controlPoint=this._particleBezierCurveNode._iControlPoint;this._endPoint=this._particleBezierCurveNode._iEndPoint}Object.defineProperty(e.prototype,"controlPoint",{get:function(){return this._controlPoint},set:function(t){this._controlPoint=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"endPoint",{get:function(){return this._endPoint},set:function(t){this._endPoint=t},enumerable:true,configurable:true});e.prototype.setRenderState=function(t,i,r,n,o){var h=n.getRegisterIndex(this._pAnimationNode,e.BEZIER_CONTROL_INDEX);var l=n.getRegisterIndex(this._pAnimationNode,e.BEZIER_END_INDEX);if(this._particleBezierCurveNode.mode==s.LOCAL_STATIC){r.activateVertexBuffer(h,this._particleBezierCurveNode._iDataOffset,t,a.FLOAT_3);r.activateVertexBuffer(l,this._particleBezierCurveNode._iDataOffset+3,t,a.FLOAT_3)}else{n.setVertexConst(h,this._controlPoint.x,this._controlPoint.y,this._controlPoint.z);n.setVertexConst(l,this._endPoint.x,this._endPoint.y,this._endPoint.z)}};e.BEZIER_CONTROL_INDEX=0;e.BEZIER_END_INDEX=1;return e}(n);e.exports=o},{"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/states/ParticleStateBase":undefined,"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/ParticleBillboardState":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/MathConsts");var s=t("awayjs-core/lib/geom/Matrix3D");var n=t("awayjs-core/lib/geom/Orientation3D");var o=t("awayjs-renderergl/lib/animators/states/ParticleStateBase");var h=function(t){r(e,t);function e(e,i){t.call(this,e,i);this._matrix=new s;this._billboardAxis=i._iBillboardAxis}e.prototype.setRenderState=function(t,i,r,s,o){var h;if(this._billboardAxis){var l=i.sourceEntity.sceneTransform.position;var u=o.sceneTransform.position.subtract(l);var p=u.crossProduct(this._billboardAxis);p.normalize();u=this.billboardAxis.crossProduct(p);u.normalize();this._matrix.copyFrom(i.sourceEntity.sceneTransform);h=this._matrix.decompose(n.AXIS_ANGLE);this._matrix.copyColumnFrom(0,p);this._matrix.copyColumnFrom(1,this.billboardAxis);this._matrix.copyColumnFrom(2,u);this._matrix.copyColumnFrom(3,l);this._matrix.appendRotation(-h[1].w*a.RADIANS_TO_DEGREES,h[1])}else{this._matrix.copyFrom(i.sourceEntity.sceneTransform);this._matrix.append(o.inverseSceneTransform);h=this._matrix.decompose(n.AXIS_ANGLE);this._matrix.identity();this._matrix.appendRotation(-h[1].w*a.RADIANS_TO_DEGREES,h[1])}s.setVertexConstFromMatrix(s.getRegisterIndex(this._pAnimationNode,e.MATRIX_INDEX),this._matrix)};Object.defineProperty(e.prototype,"billboardAxis",{get:function(){return this.billboardAxis},set:function(t){this.billboardAxis=t?t.clone():null;if(this.billboardAxis)this.billboardAxis.normalize()},enumerable:true,configurable:true});e.MATRIX_INDEX=0;return e}(o);e.exports=h},{"awayjs-core/lib/geom/MathConsts":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Orientation3D":undefined,"awayjs-renderergl/lib/animators/states/ParticleStateBase":undefined}],"awayjs-renderergl/lib/animators/states/ParticleColorState":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var n=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=t("awayjs-renderergl/lib/animators/states/ParticleStateBase");var h=function(t){r(e,t);function e(e,i){t.call(this,e,i);this._particleColorNode=i;this._usesMultiplier=this._particleColorNode._iUsesMultiplier;this._usesOffset=this._particleColorNode._iUsesOffset;this._usesCycle=this._particleColorNode._iUsesCycle;this._usesPhase=this._particleColorNode._iUsesPhase;this._startColor=this._particleColorNode._iStartColor;this._endColor=this._particleColorNode._iEndColor;this._cycleDuration=this._particleColorNode._iCycleDuration;this._cyclePhase=this._particleColorNode._iCyclePhase;this.updateColorData()}Object.defineProperty(e.prototype,"startColor",{get:function(){return this._startColor},set:function(t){this._startColor=t;this.updateColorData()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"endColor",{get:function(){return this._endColor},set:function(t){this._endColor=t;this.updateColorData()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"cycleDuration",{get:function(){return this._cycleDuration},set:function(t){this._cycleDuration=t;this.updateColorData()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"cyclePhase",{get:function(){return this._cyclePhase},set:function(t){this._cyclePhase=t;this.updateColorData()},enumerable:true,configurable:true});e.prototype.setRenderState=function(t,i,r,a,o){if(a.needFragmentAnimation){var h=this._particleColorNode._iDataOffset;if(this._usesCycle)a.setVertexConst(a.getRegisterIndex(this._pAnimationNode,e.CYCLE_INDEX),this._cycleData.x,this._cycleData.y,this._cycleData.z,this._cycleData.w);if(this._usesMultiplier){if(this._particleColorNode.mode==n.LOCAL_STATIC){r.activateVertexBuffer(a.getRegisterIndex(this._pAnimationNode,e.START_MULTIPLIER_INDEX),h,t,s.FLOAT_4);h+=4;r.activateVertexBuffer(a.getRegisterIndex(this._pAnimationNode,e.DELTA_MULTIPLIER_INDEX),h,t,s.FLOAT_4);h+=4}else{a.setVertexConst(a.getRegisterIndex(this._pAnimationNode,e.START_MULTIPLIER_INDEX),this._startMultiplierData.x,this._startMultiplierData.y,this._startMultiplierData.z,this._startMultiplierData.w);a.setVertexConst(a.getRegisterIndex(this._pAnimationNode,e.DELTA_MULTIPLIER_INDEX),this._deltaMultiplierData.x,this._deltaMultiplierData.y,this._deltaMultiplierData.z,this._deltaMultiplierData.w)}}if(this._usesOffset){if(this._particleColorNode.mode==n.LOCAL_STATIC){r.activateVertexBuffer(a.getRegisterIndex(this._pAnimationNode,e.START_OFFSET_INDEX),h,t,s.FLOAT_4);h+=4;r.activateVertexBuffer(a.getRegisterIndex(this._pAnimationNode,e.DELTA_OFFSET_INDEX),h,t,s.FLOAT_4);h+=4}else{a.setVertexConst(a.getRegisterIndex(this._pAnimationNode,e.START_OFFSET_INDEX),this._startOffsetData.x,this._startOffsetData.y,this._startOffsetData.z,this._startOffsetData.w);a.setVertexConst(a.getRegisterIndex(this._pAnimationNode,e.DELTA_OFFSET_INDEX),this._deltaOffsetData.x,this._deltaOffsetData.y,this._deltaOffsetData.z,this._deltaOffsetData.w)}}}};e.prototype.updateColorData=function(){if(this._usesCycle){if(this._cycleDuration<=0)throw new Error("the cycle duration must be greater than zero");this._cycleData=new a(Math.PI*2/this._cycleDuration,this._cyclePhase*Math.PI/180,0,0)}if(this._particleColorNode.mode==n.GLOBAL){if(this._usesCycle){if(this._usesMultiplier){this._startMultiplierData=new a((this._startColor.redMultiplier+this._endColor.redMultiplier)/2,(this._startColor.greenMultiplier+this._endColor.greenMultiplier)/2,(this._startColor.blueMultiplier+this._endColor.blueMultiplier)/2,(this._startColor.alphaMultiplier+this._endColor.alphaMultiplier)/2);this._deltaMultiplierData=new a((this._endColor.redMultiplier-this._startColor.redMultiplier)/2,(this._endColor.greenMultiplier-this._startColor.greenMultiplier)/2,(this._endColor.blueMultiplier-this._startColor.blueMultiplier)/2,(this._endColor.alphaMultiplier-this._startColor.alphaMultiplier)/2)}if(this._usesOffset){this._startOffsetData=new a((this._startColor.redOffset+this._endColor.redOffset)/(255*2),(this._startColor.greenOffset+this._endColor.greenOffset)/(255*2),(this._startColor.blueOffset+this._endColor.blueOffset)/(255*2),(this._startColor.alphaOffset+this._endColor.alphaOffset)/(255*2));this._deltaOffsetData=new a((this._endColor.redOffset-this._startColor.redOffset)/(255*2),(this._endColor.greenOffset-this._startColor.greenOffset)/(255*2),(this._endColor.blueOffset-this._startColor.blueOffset)/(255*2),(this._endColor.alphaOffset-this._startColor.alphaOffset)/(255*2))}}else{if(this._usesMultiplier){this._startMultiplierData=new a(this._startColor.redMultiplier,this._startColor.greenMultiplier,this._startColor.blueMultiplier,this._startColor.alphaMultiplier);this._deltaMultiplierData=new a(this._endColor.redMultiplier-this._startColor.redMultiplier,this._endColor.greenMultiplier-this._startColor.greenMultiplier,this._endColor.blueMultiplier-this._startColor.blueMultiplier,this._endColor.alphaMultiplier-this._startColor.alphaMultiplier)}if(this._usesOffset){this._startOffsetData=new a(this._startColor.redOffset/255,this._startColor.greenOffset/255,this._startColor.blueOffset/255,this._startColor.alphaOffset/255);this._deltaOffsetData=new a((this._endColor.redOffset-this._startColor.redOffset)/255,(this._endColor.greenOffset-this._startColor.greenOffset)/255,(this._endColor.blueOffset-this._startColor.blueOffset)/255,(this._endColor.alphaOffset-this._startColor.alphaOffset)/255)}}}};e.START_MULTIPLIER_INDEX=0;e.DELTA_MULTIPLIER_INDEX=1;e.START_OFFSET_INDEX=2;e.DELTA_OFFSET_INDEX=3;e.CYCLE_INDEX=4;return e}(o);e.exports=h},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/states/ParticleStateBase":undefined,"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/ParticleFollowState":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/MathConsts");var s=t("awayjs-core/lib/geom/Vector3D");var n=t("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var o=t("awayjs-renderergl/lib/animators/states/ParticleStateBase");var h=function(t){r(e,t);function e(e,i){t.call(this,e,i,true);this._targetPos=new s;this._targetEuler=new s;this._temp=new s;this._particleFollowNode=i;this._smooth=i._iSmooth}Object.defineProperty(e.prototype,"followTarget",{get:function(){return this._followTarget},set:function(t){this._followTarget=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"smooth",{get:function(){return this._smooth},set:function(t){this._smooth=t},enumerable:true,configurable:true});e.prototype.setRenderState=function(t,i,r,s,o){if(this._followTarget){if(this._particleFollowNode._iUsesPosition){this._targetPos.x=this._followTarget.transform.position.x/i.sourceEntity.scaleX;this._targetPos.y=this._followTarget.transform.position.y/i.sourceEntity.scaleY;this._targetPos.z=this._followTarget.transform.position.z/i.sourceEntity.scaleZ}if(this._particleFollowNode._iUsesRotation){this._targetEuler.x=this._followTarget.rotationX;this._targetEuler.y=this._followTarget.rotationY;this._targetEuler.z=this._followTarget.rotationZ;this._targetEuler.scaleBy(a.DEGREES_TO_RADIANS)}}if(!this._prePos)this._prePos=this._targetPos.clone();if(!this._preEuler)this._preEuler=this._targetEuler.clone();var h=this._pTime/1e3;var l=r.previousTime;var u=h-l;var p=l!=h;if(this._particleFollowNode._iUsesPosition&&this._particleFollowNode._iUsesRotation){if(p)this.processPositionAndRotation(h,u,r);r.activateVertexBuffer(s.getRegisterIndex(this._pAnimationNode,e.FOLLOW_POSITION_INDEX),this._particleFollowNode._iDataOffset,t,n.FLOAT_3);r.activateVertexBuffer(s.getRegisterIndex(this._pAnimationNode,e.FOLLOW_ROTATION_INDEX),this._particleFollowNode._iDataOffset+3,t,n.FLOAT_3)}else if(this._particleFollowNode._iUsesPosition){if(p)this.processPosition(h,u,r);r.activateVertexBuffer(s.getRegisterIndex(this._pAnimationNode,e.FOLLOW_POSITION_INDEX),this._particleFollowNode._iDataOffset,t,n.FLOAT_3)}else if(this._particleFollowNode._iUsesRotation){if(p)this.precessRotation(h,u,r);r.activateVertexBuffer(s.getRegisterIndex(this._pAnimationNode,e.FOLLOW_ROTATION_INDEX),this._particleFollowNode._iDataOffset,t,n.FLOAT_3)}this._prePos.copyFrom(this._targetPos);this._targetEuler.copyFrom(this._targetEuler);r.previousTime=h};e.prototype.processPosition=function(t,e,i){var r=i.animationParticles;var a=i.vertexData;var s=false;var n=r.length;var o;var h;if(this._smooth){h=this._prePos.subtract(this._targetPos);h.scaleBy(1/e)}else o=this._targetPos;for(var l=0;l<n;l++){var u=(t-r[l].startTime)/r[l].totalTime;var p=(u-Math.floor(u))*r[l].totalTime;if(p-e<=0){var c=r[l].startVertexIndex*i.totalLenOfOneVertex+this._particleFollowNode._iDataOffset;if(this._smooth){this._temp.copyFrom(h);this._temp.scaleBy(p);o=this._targetPos.add(this._temp)}if(a[c]!=o.x||a[c+1]!=o.y||a[c+2]!=o.z){s=true;for(var d=0;d<r[l].numVertices;d++){a[c++]=o.x;a[c++]=o.y;a[c++]=o.z}}}}if(s)i.invalidateBuffer()};e.prototype.precessRotation=function(t,e,i){var r=i.animationParticles;var a=i.vertexData;var s=false;var n=r.length;var o;var h;if(this._smooth){h=this._preEuler.subtract(this._targetEuler);h.scaleBy(1/e)}else o=this._targetEuler;for(var l=0;l<n;l++){var u=(t-r[l].startTime)/r[l].totalTime;var p=(u-Math.floor(u))*r[l].totalTime;if(p-e<=0){var c=r[l].startVertexIndex*i.totalLenOfOneVertex+this._particleFollowNode._iDataOffset;if(this._smooth){this._temp.copyFrom(h);this._temp.scaleBy(p);o=this._targetEuler.add(this._temp)}if(a[c]!=o.x||a[c+1]!=o.y||a[c+2]!=o.z){s=true;for(var d=0;d<r[l].numVertices;d++){a[c++]=o.x;a[c++]=o.y;a[c++]=o.z}}}}if(s)i.invalidateBuffer()};e.prototype.processPositionAndRotation=function(t,e,i){var r=i.animationParticles;var a=i.vertexData;var s=false;var n=r.length;var o;var h;var l;var u;if(this._smooth){l=this._prePos.subtract(this._targetPos);l.scaleBy(1/e);u=this._preEuler.subtract(this._targetEuler);u.scaleBy(1/e)}else{o=this._targetPos;h=this._targetEuler}for(var p=0;p<n;p++){var c=(t-r[p].startTime)/r[p].totalTime;var d=(c-Math.floor(c))*r[p].totalTime;if(d-e<=0){var f=r[p].startVertexIndex*i.totalLenOfOneVertex+this._particleFollowNode._iDataOffset;if(this._smooth){this._temp.copyFrom(l);this._temp.scaleBy(d);o=this._targetPos.add(this._temp);this._temp.copyFrom(u);this._temp.scaleBy(d);h=this._targetEuler.add(this._temp)}if(a[f]!=o.x||a[f+1]!=o.y||a[f+2]!=o.z||a[f+3]!=h.x||a[f+4]!=h.y||a[f+5]!=h.z){s=true;for(var _=0;_<r[p].numVertices;_++){a[f++]=o.x;a[f++]=o.y;a[f++]=o.z;a[f++]=h.x;a[f++]=h.y;a[f++]=h.z}}}}if(s)i.invalidateBuffer()};e.FOLLOW_POSITION_INDEX=0;e.FOLLOW_ROTATION_INDEX=1;return e}(o);e.exports=h},{"awayjs-core/lib/geom/MathConsts":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/states/ParticleStateBase":undefined,"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/ParticleInitialColorState":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var n=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=t("awayjs-renderergl/lib/animators/states/ParticleStateBase");var h=function(t){r(e,t);function e(e,i){t.call(this,e,i);this._particleInitialColorNode=i;this._usesMultiplier=i._iUsesMultiplier;this._usesOffset=i._iUsesOffset;this._initialColor=i._iInitialColor;this.updateColorData()}Object.defineProperty(e.prototype,"initialColor",{get:function(){return this._initialColor},set:function(t){this._initialColor=t},enumerable:true,configurable:true});e.prototype.setRenderState=function(t,i,r,a,o){i=i;o=o;if(a.needFragmentAnimation){if(this._particleInitialColorNode.mode==n.LOCAL_STATIC){var h=this._particleInitialColorNode._iDataOffset;if(this._usesMultiplier){r.activateVertexBuffer(a.getRegisterIndex(this._pAnimationNode,e.MULTIPLIER_INDEX),h,t,s.FLOAT_4);h+=4}if(this._usesOffset)r.activateVertexBuffer(a.getRegisterIndex(this._pAnimationNode,e.OFFSET_INDEX),h,t,s.FLOAT_4)
}else{if(this._usesMultiplier)a.setVertexConst(a.getRegisterIndex(this._pAnimationNode,e.MULTIPLIER_INDEX),this._multiplierData.x,this._multiplierData.y,this._multiplierData.z,this._multiplierData.w);if(this._usesOffset)a.setVertexConst(a.getRegisterIndex(this._pAnimationNode,e.OFFSET_INDEX),this._offsetData.x,this._offsetData.y,this._offsetData.z,this._offsetData.w)}}};e.prototype.updateColorData=function(){if(this._particleInitialColorNode.mode==n.GLOBAL){if(this._usesMultiplier)this._multiplierData=new a(this._initialColor.redMultiplier,this._initialColor.greenMultiplier,this._initialColor.blueMultiplier,this._initialColor.alphaMultiplier);if(this._usesOffset)this._offsetData=new a(this._initialColor.redOffset/255,this._initialColor.greenOffset/255,this._initialColor.blueOffset/255,this._initialColor.alphaOffset/255)}};e.MULTIPLIER_INDEX=0;e.OFFSET_INDEX=1;return e}(o);e.exports=h},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/states/ParticleStateBase":undefined,"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/ParticleOrbitState":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Matrix3D");var s=t("awayjs-core/lib/geom/Vector3D");var n=t("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var o=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var h=t("awayjs-renderergl/lib/animators/states/ParticleStateBase");var l=function(t){r(e,t);function e(e,i){t.call(this,e,i);this._particleOrbitNode=i;this._usesEulers=this._particleOrbitNode._iUsesEulers;this._usesCycle=this._particleOrbitNode._iUsesCycle;this._usesPhase=this._particleOrbitNode._iUsesPhase;this._eulers=this._particleOrbitNode._iEulers;this._radius=this._particleOrbitNode._iRadius;this._cycleDuration=this._particleOrbitNode._iCycleDuration;this._cyclePhase=this._particleOrbitNode._iCyclePhase;this.updateOrbitData()}Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t;this.updateOrbitData()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"cycleDuration",{get:function(){return this._cycleDuration},set:function(t){this._cycleDuration=t;this.updateOrbitData()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"cyclePhase",{get:function(){return this._cyclePhase},set:function(t){this._cyclePhase=t;this.updateOrbitData()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"eulers",{get:function(){return this._eulers},set:function(t){this._eulers=t;this.updateOrbitData()},enumerable:true,configurable:true});e.prototype.setRenderState=function(t,i,r,a,s){var h=a.getRegisterIndex(this._pAnimationNode,e.ORBIT_INDEX);if(this._particleOrbitNode.mode==o.LOCAL_STATIC){if(this._usesPhase)r.activateVertexBuffer(h,this._particleOrbitNode._iDataOffset,t,n.FLOAT_4);else r.activateVertexBuffer(h,this._particleOrbitNode._iDataOffset,t,n.FLOAT_3)}else a.setVertexConst(h,this._orbitData.x,this._orbitData.y,this._orbitData.z,this._orbitData.w);if(this._usesEulers)a.setVertexConstFromMatrix(a.getRegisterIndex(this._pAnimationNode,e.EULERS_INDEX),this._eulersMatrix)};e.prototype.updateOrbitData=function(){if(this._usesEulers){this._eulersMatrix=new a;this._eulersMatrix.appendRotation(this._eulers.x,s.X_AXIS);this._eulersMatrix.appendRotation(this._eulers.y,s.Y_AXIS);this._eulersMatrix.appendRotation(this._eulers.z,s.Z_AXIS)}if(this._particleOrbitNode.mode==o.GLOBAL){this._orbitData=new s(this._radius,0,this._radius*Math.PI*2,this._cyclePhase*Math.PI/180);if(this._usesCycle){if(this._cycleDuration<=0)throw new Error("the cycle duration must be greater than zero");this._orbitData.y=Math.PI*2/this._cycleDuration}else this._orbitData.y=Math.PI*2}};e.ORBIT_INDEX=0;e.EULERS_INDEX=1;return e}(h);e.exports=l},{"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/states/ParticleStateBase":undefined,"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/ParticleOscillatorState":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var n=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=t("awayjs-renderergl/lib/animators/states/ParticleStateBase");var h=function(t){r(e,t);function e(e,i){t.call(this,e,i);this._particleOscillatorNode=i;this._oscillator=this._particleOscillatorNode._iOscillator;this.updateOscillatorData()}Object.defineProperty(e.prototype,"oscillator",{get:function(){return this._oscillator},set:function(t){this._oscillator=t;this.updateOscillatorData()},enumerable:true,configurable:true});e.prototype.setRenderState=function(t,i,r,a,o){var h=a.getRegisterIndex(this._pAnimationNode,e.OSCILLATOR_INDEX);if(this._particleOscillatorNode.mode==n.LOCAL_STATIC)r.activateVertexBuffer(h,this._particleOscillatorNode._iDataOffset,t,s.FLOAT_4);else a.setVertexConst(h,this._oscillatorData.x,this._oscillatorData.y,this._oscillatorData.z,this._oscillatorData.w)};e.prototype.updateOscillatorData=function(){if(this._particleOscillatorNode.mode==n.GLOBAL){if(this._oscillator.w<=0)throw new Error("the cycle duration must greater than zero");if(this._oscillatorData==null)this._oscillatorData=new a;this._oscillatorData.x=this._oscillator.x;this._oscillatorData.y=this._oscillator.y;this._oscillatorData.z=this._oscillator.z;this._oscillatorData.w=Math.PI*2/this._oscillator.w}};e.OSCILLATOR_INDEX=0;return e}(o);e.exports=h},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/states/ParticleStateBase":undefined,"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/ParticlePositionState":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var s=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var n=t("awayjs-renderergl/lib/animators/states/ParticleStateBase");var o=function(t){r(e,t);function e(e,i){t.call(this,e,i);this._particlePositionNode=i;this._position=this._particlePositionNode._iPosition}Object.defineProperty(e.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t},enumerable:true,configurable:true});e.prototype.getPositions=function(){return this._pDynamicProperties};e.prototype.setPositions=function(t){this._pDynamicProperties=t;this._pDynamicPropertiesDirty=new Object};e.prototype.setRenderState=function(t,i,r,n,o){if(this._particlePositionNode.mode==s.LOCAL_DYNAMIC&&!this._pDynamicPropertiesDirty[r._iUniqueId])this._pUpdateDynamicProperties(r);var h=n.getRegisterIndex(this._pAnimationNode,e.POSITION_INDEX);if(this._particlePositionNode.mode==s.GLOBAL)n.setVertexConst(h,this._position.x,this._position.y,this._position.z);else r.activateVertexBuffer(h,this._particlePositionNode._iDataOffset,t,a.FLOAT_3)};e.POSITION_INDEX=0;return e}(n);e.exports=o},{"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/states/ParticleStateBase":undefined,"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/ParticleRotateToHeadingState":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Matrix3D");var s=t("awayjs-renderergl/lib/animators/states/ParticleStateBase");var n=function(t){r(e,t);function e(e,i){t.call(this,e,i);this._matrix=new a}e.prototype.setRenderState=function(t,i,r,a,s){if(a.hasBillboard){this._matrix.copyFrom(i.sourceEntity.sceneTransform);this._matrix.append(s.inverseSceneTransform);a.setVertexConstFromMatrix(a.getRegisterIndex(this._pAnimationNode,e.MATRIX_INDEX),this._matrix)}};e.MATRIX_INDEX=0;return e}(s);e.exports=n},{"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-renderergl/lib/animators/states/ParticleStateBase":undefined}],"awayjs-renderergl/lib/animators/states/ParticleRotateToPositionState":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Matrix3D");var s=t("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var n=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=t("awayjs-renderergl/lib/animators/states/ParticleStateBase");var h=function(t){r(e,t);function e(e,i){t.call(this,e,i);this._matrix=new a;this._particleRotateToPositionNode=i;this._position=this._particleRotateToPositionNode._iPosition}Object.defineProperty(e.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t},enumerable:true,configurable:true});e.prototype.setRenderState=function(t,i,r,a,o){var h=a.getRegisterIndex(this._pAnimationNode,e.POSITION_INDEX);if(a.hasBillboard){this._matrix.copyFrom(i.sourceEntity.sceneTransform);this._matrix.append(o.inverseSceneTransform);a.setVertexConstFromMatrix(a.getRegisterIndex(this._pAnimationNode,e.MATRIX_INDEX),this._matrix)}if(this._particleRotateToPositionNode.mode==n.GLOBAL){this._offset=i.sourceEntity.inverseSceneTransform.transformVector(this._position);a.setVertexConst(h,this._offset.x,this._offset.y,this._offset.z)}else r.activateVertexBuffer(h,this._particleRotateToPositionNode._iDataOffset,t,s.FLOAT_3)};e.MATRIX_INDEX=0;e.POSITION_INDEX=1;return e}(o);e.exports=h},{"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/states/ParticleStateBase":undefined,"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/ParticleRotationalVelocityState":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var n=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=t("awayjs-renderergl/lib/animators/states/ParticleStateBase");var h=function(t){r(e,t);function e(e,i){t.call(this,e,i);this._particleRotationalVelocityNode=i;this._rotationalVelocity=this._particleRotationalVelocityNode._iRotationalVelocity;this.updateRotationalVelocityData()}Object.defineProperty(e.prototype,"rotationalVelocity",{get:function(){return this._rotationalVelocity},set:function(t){this._rotationalVelocity=t;this.updateRotationalVelocityData()},enumerable:true,configurable:true});e.prototype.getRotationalVelocities=function(){return this._pDynamicProperties};e.prototype.setRotationalVelocities=function(t){this._pDynamicProperties=t;this._pDynamicPropertiesDirty=new Object};e.prototype.setRenderState=function(t,i,r,a,o){if(this._particleRotationalVelocityNode.mode==n.LOCAL_DYNAMIC&&!this._pDynamicPropertiesDirty[r._iUniqueId])this._pUpdateDynamicProperties(r);var h=a.getRegisterIndex(this._pAnimationNode,e.ROTATIONALVELOCITY_INDEX);if(this._particleRotationalVelocityNode.mode==n.GLOBAL)a.setVertexConst(h,this._rotationalVelocityData.x,this._rotationalVelocityData.y,this._rotationalVelocityData.z,this._rotationalVelocityData.w);else r.activateVertexBuffer(h,this._particleRotationalVelocityNode._iDataOffset,t,s.FLOAT_4)};e.prototype.updateRotationalVelocityData=function(){if(this._particleRotationalVelocityNode.mode==n.GLOBAL){if(this._rotationalVelocity.w<=0)throw new Error("the cycle duration must greater than zero");var t=this._rotationalVelocity.clone();if(t.length<=0)t.z=1;else t.normalize();this._rotationalVelocityData=new a(t.x,t.y,t.z,Math.PI/t.w)}};e.ROTATIONALVELOCITY_INDEX=0;return e}(o);e.exports=h},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/states/ParticleStateBase":undefined,"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/ParticleScaleState":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var n=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=t("awayjs-renderergl/lib/animators/states/ParticleStateBase");var h=function(t){r(e,t);function e(e,i){t.call(this,e,i);this._particleScaleNode=i;this._usesCycle=this._particleScaleNode._iUsesCycle;this._usesPhase=this._particleScaleNode._iUsesPhase;this._minScale=this._particleScaleNode._iMinScale;this._maxScale=this._particleScaleNode._iMaxScale;this._cycleDuration=this._particleScaleNode._iCycleDuration;this._cyclePhase=this._particleScaleNode._iCyclePhase;this.updateScaleData()}Object.defineProperty(e.prototype,"minScale",{get:function(){return this._minScale},set:function(t){this._minScale=t;this.updateScaleData()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"maxScale",{get:function(){return this._maxScale},set:function(t){this._maxScale=t;this.updateScaleData()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"cycleDuration",{get:function(){return this._cycleDuration},set:function(t){this._cycleDuration=t;this.updateScaleData()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"cyclePhase",{get:function(){return this._cyclePhase},set:function(t){this._cyclePhase=t;this.updateScaleData()},enumerable:true,configurable:true});e.prototype.setRenderState=function(t,i,r,a,o){var h=a.getRegisterIndex(this._pAnimationNode,e.SCALE_INDEX);if(this._particleScaleNode.mode==n.LOCAL_STATIC){if(this._usesCycle){if(this._usesPhase)r.activateVertexBuffer(h,this._particleScaleNode._iDataOffset,t,s.FLOAT_4);else r.activateVertexBuffer(h,this._particleScaleNode._iDataOffset,t,s.FLOAT_3)}else r.activateVertexBuffer(h,this._particleScaleNode._iDataOffset,t,s.FLOAT_2)}else a.setVertexConst(h,this._scaleData.x,this._scaleData.y,this._scaleData.z,this._scaleData.w)};e.prototype.updateScaleData=function(){if(this._particleScaleNode.mode==n.GLOBAL){if(this._usesCycle){if(this._cycleDuration<=0)throw new Error("the cycle duration must be greater than zero");this._scaleData=new a((this._minScale+this._maxScale)/2,Math.abs(this._minScale-this._maxScale)/2,Math.PI*2/this._cycleDuration,this._cyclePhase*Math.PI/180)}else this._scaleData=new a(this._minScale,this._maxScale-this._minScale,0,0)}};e.SCALE_INDEX=0;return e}(o);e.exports=h},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/states/ParticleStateBase":undefined,"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/ParticleSegmentedColorState":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-renderergl/lib/animators/states/ParticleStateBase");var s=function(t){r(e,t);function e(e,i){t.call(this,e,i);this._usesMultiplier=i._iUsesMultiplier;this._usesOffset=i._iUsesOffset;this._startColor=i._iStartColor;this._endColor=i._iEndColor;this._segmentPoints=i._iSegmentPoints;this._numSegmentPoint=i._iNumSegmentPoint;this.updateColorData()}Object.defineProperty(e.prototype,"startColor",{get:function(){return this._startColor},set:function(t){this._startColor=t;this.updateColorData()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"endColor",{get:function(){return this._endColor},set:function(t){this._endColor=t;this.updateColorData()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numSegmentPoint",{get:function(){return this._numSegmentPoint},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentPoints",{get:function(){return this._segmentPoints},set:function(t){this._segmentPoints=t;this.updateColorData()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"usesMultiplier",{get:function(){return this._usesMultiplier},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"usesOffset",{get:function(){return this._usesOffset},enumerable:true,configurable:true});e.prototype.setRenderState=function(t,i,r,a,s){if(a.needFragmentAnimation){if(this._numSegmentPoint>0)a.setVertexConst(a.getRegisterIndex(this._pAnimationNode,e.TIME_DATA_INDEX),this._timeLifeData[0],this._timeLifeData[1],this._timeLifeData[2],this._timeLifeData[3]);if(this._usesMultiplier)a.setVertexConstFromArray(a.getRegisterIndex(this._pAnimationNode,e.START_MULTIPLIER_INDEX),this._multiplierData);if(this._usesOffset)a.setVertexConstFromArray(a.getRegisterIndex(this._pAnimationNode,e.START_OFFSET_INDEX),this._offsetData)}};e.prototype.updateColorData=function(){this._timeLifeData=new Array;this._multiplierData=new Array;this._offsetData=new Array;var t;for(t=0;t<this._numSegmentPoint;t++){if(t==0)this._timeLifeData.push(this._segmentPoints[t].life);else this._timeLifeData.push(this._segmentPoints[t].life-this._segmentPoints[t-1].life)}if(this._numSegmentPoint==0)this._timeLifeData.push(1);else this._timeLifeData.push(1-this._segmentPoints[t-1].life);if(this._usesMultiplier){this._multiplierData.push(this._startColor.redMultiplier,this._startColor.greenMultiplier,this._startColor.blueMultiplier,this._startColor.alphaMultiplier);for(t=0;t<this._numSegmentPoint;t++){if(t==0)this._multiplierData.push((this._segmentPoints[t].color.redMultiplier-this._startColor.redMultiplier)/this._timeLifeData[t],(this._segmentPoints[t].color.greenMultiplier-this._startColor.greenMultiplier)/this._timeLifeData[t],(this._segmentPoints[t].color.blueMultiplier-this._startColor.blueMultiplier)/this._timeLifeData[t],(this._segmentPoints[t].color.alphaMultiplier-this._startColor.alphaMultiplier)/this._timeLifeData[t]);else this._multiplierData.push((this._segmentPoints[t].color.redMultiplier-this._segmentPoints[t-1].color.redMultiplier)/this._timeLifeData[t],(this._segmentPoints[t].color.greenMultiplier-this._segmentPoints[t-1].color.greenMultiplier)/this._timeLifeData[t],(this._segmentPoints[t].color.blueMultiplier-this._segmentPoints[t-1].color.blueMultiplier)/this._timeLifeData[t],(this._segmentPoints[t].color.alphaMultiplier-this._segmentPoints[t-1].color.alphaMultiplier)/this._timeLifeData[t])}if(this._numSegmentPoint==0)this._multiplierData.push(this._endColor.redMultiplier-this._startColor.redMultiplier,this._endColor.greenMultiplier-this._startColor.greenMultiplier,this._endColor.blueMultiplier-this._startColor.blueMultiplier,this._endColor.alphaMultiplier-this._startColor.alphaMultiplier);else this._multiplierData.push((this._endColor.redMultiplier-this._segmentPoints[t-1].color.redMultiplier)/this._timeLifeData[t],(this._endColor.greenMultiplier-this._segmentPoints[t-1].color.greenMultiplier)/this._timeLifeData[t],(this._endColor.blueMultiplier-this._segmentPoints[t-1].color.blueMultiplier)/this._timeLifeData[t],(this._endColor.alphaMultiplier-this._segmentPoints[t-1].color.alphaMultiplier)/this._timeLifeData[t])}if(this._usesOffset){this._offsetData.push(this._startColor.redOffset/255,this._startColor.greenOffset/255,this._startColor.blueOffset/255,this._startColor.alphaOffset/255);for(t=0;t<this._numSegmentPoint;t++){if(t==0)this._offsetData.push((this._segmentPoints[t].color.redOffset-this._startColor.redOffset)/this._timeLifeData[t]/255,(this._segmentPoints[t].color.greenOffset-this._startColor.greenOffset)/this._timeLifeData[t]/255,(this._segmentPoints[t].color.blueOffset-this._startColor.blueOffset)/this._timeLifeData[t]/255,(this._segmentPoints[t].color.alphaOffset-this._startColor.alphaOffset)/this._timeLifeData[t]/255);else this._offsetData.push((this._segmentPoints[t].color.redOffset-this._segmentPoints[t-1].color.redOffset)/this._timeLifeData[t]/255,(this._segmentPoints[t].color.greenOffset-this._segmentPoints[t-1].color.greenOffset)/this._timeLifeData[t]/255,(this._segmentPoints[t].color.blueOffset-this._segmentPoints[t-1].color.blueOffset)/this._timeLifeData[t]/255,(this._segmentPoints[t].color.alphaOffset-this._segmentPoints[t-1].color.alphaOffset)/this._timeLifeData[t]/255)}if(this._numSegmentPoint==0)this._offsetData.push((this._endColor.redOffset-this._startColor.redOffset)/255,(this._endColor.greenOffset-this._startColor.greenOffset)/255,(this._endColor.blueOffset-this._startColor.blueOffset)/255,(this._endColor.alphaOffset-this._startColor.alphaOffset)/255);else this._offsetData.push((this._endColor.redOffset-this._segmentPoints[t-1].color.redOffset)/this._timeLifeData[t]/255,(this._endColor.greenOffset-this._segmentPoints[t-1].color.greenOffset)/this._timeLifeData[t]/255,(this._endColor.blueOffset-this._segmentPoints[t-1].color.blueOffset)/this._timeLifeData[t]/255,(this._endColor.alphaOffset-this._segmentPoints[t-1].color.alphaOffset)/this._timeLifeData[t]/255)}this._timeLifeData.length=4};e.START_MULTIPLIER_INDEX=0;e.START_OFFSET_INDEX=1;e.TIME_DATA_INDEX=2;return e}(a);e.exports=s},{"awayjs-renderergl/lib/animators/states/ParticleStateBase":undefined}],"awayjs-renderergl/lib/animators/states/ParticleSpriteSheetState":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var s=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var n=t("awayjs-renderergl/lib/animators/states/ParticleStateBase");var o=function(t){r(e,t);function e(e,i){t.call(this,e,i);this._particleSpriteSheetNode=i;this._usesCycle=this._particleSpriteSheetNode._iUsesCycle;this._usesPhase=this._particleSpriteSheetNode._iUsesCycle;this._totalFrames=this._particleSpriteSheetNode._iTotalFrames;this._numColumns=this._particleSpriteSheetNode._iNumColumns;this._numRows=this._particleSpriteSheetNode._iNumRows;this._cycleDuration=this._particleSpriteSheetNode._iCycleDuration;this._cyclePhase=this._particleSpriteSheetNode._iCyclePhase;this.updateSpriteSheetData()}Object.defineProperty(e.prototype,"cyclePhase",{get:function(){return this._cyclePhase},set:function(t){this._cyclePhase=t;this.updateSpriteSheetData()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"cycleDuration",{get:function(){return this._cycleDuration},set:function(t){this._cycleDuration=t;this.updateSpriteSheetData()},enumerable:true,configurable:true});e.prototype.setRenderState=function(t,i,r,n,o){if(n.needUVAnimation){n.setVertexConst(n.getRegisterIndex(this._pAnimationNode,e.UV_INDEX_0),this._spriteSheetData[0],this._spriteSheetData[1],this._spriteSheetData[2],this._spriteSheetData[3]);if(this._usesCycle){var h=n.getRegisterIndex(this._pAnimationNode,e.UV_INDEX_1);if(this._particleSpriteSheetNode.mode==s.LOCAL_STATIC){if(this._usesPhase)r.activateVertexBuffer(h,this._particleSpriteSheetNode._iDataOffset,t,a.FLOAT_3);else r.activateVertexBuffer(h,this._particleSpriteSheetNode._iDataOffset,t,a.FLOAT_2)}else n.setVertexConst(h,this._spriteSheetData[4],this._spriteSheetData[5])}}};e.prototype.updateSpriteSheetData=function(){this._spriteSheetData=new Array(8);var t=this._totalFrames/this._numColumns;this._spriteSheetData[0]=t;this._spriteSheetData[1]=1/this._numColumns;this._spriteSheetData[2]=1/this._numRows;if(this._usesCycle){if(this._cycleDuration<=0)throw new Error("the cycle duration must be greater than zero");this._spriteSheetData[4]=t/this._cycleDuration;this._spriteSheetData[5]=this._cycleDuration;if(this._usesPhase)this._spriteSheetData[6]=this._cyclePhase}};e.UV_INDEX_0=0;e.UV_INDEX_1=1;return e}(n);e.exports=o},{"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/states/ParticleStateBase":undefined,"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/ParticleStateBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-renderergl/lib/animators/states/AnimationStateBase");var s=function(t){r(e,t);function e(e,i,r){if(r===void 0){r=false}t.call(this,e,i);this._pDynamicProperties=new Array;this._pDynamicPropertiesDirty=new Object;this._particleNode=i;this._pNeedUpdateTime=r}Object.defineProperty(e.prototype,"needUpdateTime",{get:function(){return this._pNeedUpdateTime},enumerable:true,configurable:true});e.prototype.setRenderState=function(t,e,i,r,a){};e.prototype._pUpdateDynamicProperties=function(t){this._pDynamicPropertiesDirty[t._iUniqueId]=true;var e=t.animationParticles;var i=t.vertexData;var r=t.totalLenOfOneVertex;var a=this._particleNode.dataLength;var s=this._particleNode._iDataOffset;var n;var o;var h;var l;var u;var p=this._pDynamicProperties.length;var c=0;var d=0;var f=0;while(c<p){while(d<p&&(u=e[d]).index==c){l=this._pDynamicProperties[c];n=u.numVertices*r;o=u.startVertexIndex*r+s;for(f=0;f<n;f+=r){h=o+f;for(f=0;f<n;f+=r){h=o+f;i[h++]=l.x;i[h++]=l.y;i[h++]=l.z;if(a==4)i[h++]=l.w}}d++}c++}t.invalidateBuffer()};return e}(a);e.exports=s},{"awayjs-renderergl/lib/animators/states/AnimationStateBase":undefined}],"awayjs-renderergl/lib/animators/states/ParticleTimeState":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var s=t("awayjs-renderergl/lib/animators/states/ParticleStateBase");var n=function(t){r(e,t);function e(e,i){t.call(this,e,i,true);this._particleTimeNode=i}e.prototype.setRenderState=function(t,i,r,s,n){r.activateVertexBuffer(s.getRegisterIndex(this._pAnimationNode,e.TIME_STREAM_INDEX),this._particleTimeNode._iDataOffset,t,a.FLOAT_4);var o=this._pTime/1e3;s.setVertexConst(s.getRegisterIndex(this._pAnimationNode,e.TIME_CONSTANT_INDEX),o,o,o,o)};e.TIME_STREAM_INDEX=0;e.TIME_CONSTANT_INDEX=1;return e}(s);e.exports=n},{"awayjs-renderergl/lib/animators/states/ParticleStateBase":undefined,"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/ParticleUVState":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-renderergl/lib/animators/states/ParticleStateBase");var s=function(t){r(e,t);function e(e,i){t.call(this,e,i);this._particleUVNode=i}e.prototype.setRenderState=function(t,i,r,a,s){if(a.needUVAnimation){var n=a.getRegisterIndex(this._pAnimationNode,e.UV_INDEX);var o=this._particleUVNode._iUvData;a.setVertexConst(n,o.x,o.y)}};e.UV_INDEX=0;return e}(a);e.exports=s},{"awayjs-renderergl/lib/animators/states/ParticleStateBase":undefined}],"awayjs-renderergl/lib/animators/states/ParticleVelocityState":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var s=t("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var n=t("awayjs-renderergl/lib/animators/states/ParticleStateBase");var o=function(t){r(e,t);function e(e,i){t.call(this,e,i);this._particleVelocityNode=i;this._velocity=this._particleVelocityNode._iVelocity}Object.defineProperty(e.prototype,"velocity",{get:function(){return this._velocity},set:function(t){this._velocity=t},enumerable:true,configurable:true});e.prototype.getVelocities=function(){return this._pDynamicProperties};e.prototype.setVelocities=function(t){this._pDynamicProperties=t;this._pDynamicPropertiesDirty=new Object};e.prototype.setRenderState=function(t,i,r,n,o){if(this._particleVelocityNode.mode==s.LOCAL_DYNAMIC&&!this._pDynamicPropertiesDirty[r._iUniqueId])this._pUpdateDynamicProperties(r);var h=n.getRegisterIndex(this._pAnimationNode,e.VELOCITY_INDEX);if(this._particleVelocityNode.mode==s.GLOBAL)n.setVertexConst(h,this._velocity.x,this._velocity.y,this._velocity.z);else r.activateVertexBuffer(h,this._particleVelocityNode._iDataOffset,t,a.FLOAT_3)};e.VELOCITY_INDEX=0;return e}(n);e.exports=o},{"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":undefined,"awayjs-renderergl/lib/animators/states/ParticleStateBase":undefined,"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/SkeletonBinaryLERPState":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-renderergl/lib/animators/data/JointPose");var s=t("awayjs-renderergl/lib/animators/data/SkeletonPose");var n=t("awayjs-renderergl/lib/animators/states/AnimationStateBase");var o=function(t){r(e,t);function e(e,i){t.call(this,e,i);this._blendWeight=0;this._skeletonPose=new s;this._skeletonPoseDirty=true;this._skeletonAnimationNode=i;this._inputA=e.getAnimationState(this._skeletonAnimationNode.inputA);this._inputB=e.getAnimationState(this._skeletonAnimationNode.inputB)}Object.defineProperty(e.prototype,"blendWeight",{get:function(){return this._blendWeight},set:function(t){this._blendWeight=t;this._pPositionDeltaDirty=true;this._skeletonPoseDirty=true},enumerable:true,configurable:true});e.prototype.phase=function(t){this._skeletonPoseDirty=true;this._pPositionDeltaDirty=true;this._inputA.phase(t);this._inputB.phase(t)};e.prototype._pUpdateTime=function(e){this._skeletonPoseDirty=true;this._inputA.update(e);this._inputB.update(e);t.prototype._pUpdateTime.call(this,e)};e.prototype.getSkeletonPose=function(t){if(this._skeletonPoseDirty)this.updateSkeletonPose(t);return this._skeletonPose};e.prototype._pUpdatePositionDelta=function(){this._pPositionDeltaDirty=false;var t=this._inputA.positionDelta;var e=this._inputB.positionDelta;this._pRootDelta.x=t.x+this._blendWeight*(e.x-t.x);this._pRootDelta.y=t.y+this._blendWeight*(e.y-t.y);this._pRootDelta.z=t.z+this._blendWeight*(e.z-t.z)};e.prototype.updateSkeletonPose=function(t){this._skeletonPoseDirty=false;var e;var i=this._skeletonPose.jointPoses;var r=this._inputA.getSkeletonPose(t).jointPoses;var s=this._inputB.getSkeletonPose(t).jointPoses;var n,o;var h,l;var u;var p=t.numJoints;if(i.length!=p)i.length=p;for(var c=0;c<p;++c){e=i[c];if(e==null)e=i[c]=new a;n=r[c];o=s[c];h=n.translation;l=o.translation;e.orientation.lerp(n.orientation,o.orientation,this._blendWeight);u=e.translation;u.x=h.x+this._blendWeight*(l.x-h.x);u.y=h.y+this._blendWeight*(l.y-h.y);u.z=h.z+this._blendWeight*(l.z-h.z)}};return e}(n);e.exports=o},{"awayjs-renderergl/lib/animators/data/JointPose":undefined,"awayjs-renderergl/lib/animators/data/SkeletonPose":undefined,"awayjs-renderergl/lib/animators/states/AnimationStateBase":undefined}],"awayjs-renderergl/lib/animators/states/SkeletonClipState":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];
function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-renderergl/lib/animators/data/JointPose");var n=t("awayjs-renderergl/lib/animators/data/SkeletonPose");var o=t("awayjs-renderergl/lib/animators/states/AnimationClipState");var h=function(t){r(e,t);function e(e,i){t.call(this,e,i);this._rootPos=new a;this._skeletonPose=new n;this._skeletonPoseDirty=true;this._skeletonClipNode=i;this._frames=this._skeletonClipNode.frames}Object.defineProperty(e.prototype,"currentPose",{get:function(){if(this._pFramesDirty)this._pUpdateFrames();return this._currentPose},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"nextPose",{get:function(){if(this._pFramesDirty)this._pUpdateFrames();return this._nextPose},enumerable:true,configurable:true});e.prototype.getSkeletonPose=function(t){if(this._skeletonPoseDirty)this.updateSkeletonPose(t);return this._skeletonPose};e.prototype._pUpdateTime=function(e){this._skeletonPoseDirty=true;t.prototype._pUpdateTime.call(this,e)};e.prototype._pUpdateFrames=function(){t.prototype._pUpdateFrames.call(this);this._currentPose=this._frames[this._pCurrentFrame];if(this._skeletonClipNode.looping&&this._pNextFrame>=this._skeletonClipNode.lastFrame){this._nextPose=this._frames[0];this._pAnimator.dispatchCycleEvent()}else this._nextPose=this._frames[this._pNextFrame]};e.prototype.updateSkeletonPose=function(t){this._skeletonPoseDirty=false;if(!this._skeletonClipNode.totalDuration)return;if(this._pFramesDirty)this._pUpdateFrames();var e=this._currentPose.jointPoses;var i=this._nextPose.jointPoses;var r=t.numJoints;var a,n;var o,h;var l=this._skeletonPose.jointPoses;var u;var p;if(l.length!=r)l.length=r;if(r!=e.length||r!=i.length)throw new Error("joint counts don't match!");for(var c=0;c<r;++c){u=l[c];if(u==null)u=l[c]=new s;o=e[c];h=i[c];a=o.translation;n=h.translation;if(this._skeletonClipNode.highQuality)u.orientation.slerp(o.orientation,h.orientation,this._pBlendWeight);else u.orientation.lerp(o.orientation,h.orientation,this._pBlendWeight);if(c>0){p=u.translation;p.x=a.x+this._pBlendWeight*(n.x-a.x);p.y=a.y+this._pBlendWeight*(n.y-a.y);p.z=a.z+this._pBlendWeight*(n.z-a.z)}}};e.prototype._pUpdatePositionDelta=function(){this._pPositionDeltaDirty=false;if(this._pFramesDirty)this._pUpdateFrames();var t,e,i;var r=this._skeletonClipNode.totalDelta;if(this._pTimeDir>0&&this._pNextFrame<this._pOldFrame||this._pTimeDir<0&&this._pNextFrame>this._pOldFrame){this._rootPos.x-=r.x*this._pTimeDir;this._rootPos.y-=r.y*this._pTimeDir;this._rootPos.z-=r.z*this._pTimeDir}var a=this._rootPos.x;var s=this._rootPos.y;var n=this._rootPos.z;if(this._skeletonClipNode.stitchFinalFrame&&this._pNextFrame==this._skeletonClipNode.lastFrame){t=this._frames[0].jointPoses[0].translation;e=this._frames[1].jointPoses[0].translation;i=this._currentPose.jointPoses[0].translation;this._rootPos.x=i.x+t.x+this._pBlendWeight*(e.x-t.x);this._rootPos.y=i.y+t.y+this._pBlendWeight*(e.y-t.y);this._rootPos.z=i.z+t.z+this._pBlendWeight*(e.z-t.z)}else{t=this._currentPose.jointPoses[0].translation;e=this._frames[this._pNextFrame].jointPoses[0].translation;this._rootPos.x=t.x+this._pBlendWeight*(e.x-t.x);this._rootPos.y=t.y+this._pBlendWeight*(e.y-t.y);this._rootPos.z=t.z+this._pBlendWeight*(e.z-t.z)}this._pRootDelta.x=this._rootPos.x-a;this._pRootDelta.y=this._rootPos.y-s;this._pRootDelta.z=this._rootPos.z-n;this._pOldFrame=this._pNextFrame};return e}(o);e.exports=h},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/JointPose":undefined,"awayjs-renderergl/lib/animators/data/SkeletonPose":undefined,"awayjs-renderergl/lib/animators/states/AnimationClipState":undefined}],"awayjs-renderergl/lib/animators/states/SkeletonDifferenceState":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Quaternion");var s=t("awayjs-renderergl/lib/animators/data/JointPose");var n=t("awayjs-renderergl/lib/animators/data/SkeletonPose");var o=t("awayjs-renderergl/lib/animators/states/AnimationStateBase");var h=function(t){r(e,t);function e(e,i){t.call(this,e,i);this._blendWeight=0;this._skeletonPose=new n;this._skeletonPoseDirty=true;this._skeletonAnimationNode=i;this._baseInput=e.getAnimationState(this._skeletonAnimationNode.baseInput);this._differenceInput=e.getAnimationState(this._skeletonAnimationNode.differenceInput)}Object.defineProperty(e.prototype,"blendWeight",{get:function(){return this._blendWeight},set:function(t){this._blendWeight=t;this._pPositionDeltaDirty=true;this._skeletonPoseDirty=true},enumerable:true,configurable:true});e.prototype.phase=function(t){this._skeletonPoseDirty=true;this._pPositionDeltaDirty=true;this._baseInput.phase(t);this._baseInput.phase(t)};e.prototype._pUpdateTime=function(e){this._skeletonPoseDirty=true;this._baseInput.update(e);this._differenceInput.update(e);t.prototype._pUpdateTime.call(this,e)};e.prototype.getSkeletonPose=function(t){if(this._skeletonPoseDirty)this.updateSkeletonPose(t);return this._skeletonPose};e.prototype._pUpdatePositionDelta=function(){this._pPositionDeltaDirty=false;var t=this._baseInput.positionDelta;var e=this._differenceInput.positionDelta;this.positionDelta.x=t.x+this._blendWeight*e.x;this.positionDelta.y=t.y+this._blendWeight*e.y;this.positionDelta.z=t.z+this._blendWeight*e.z};e.prototype.updateSkeletonPose=function(t){this._skeletonPoseDirty=false;var i;var r=this._skeletonPose.jointPoses;var a=this._baseInput.getSkeletonPose(t).jointPoses;var n=this._differenceInput.getSkeletonPose(t).jointPoses;var o,h;var l,u;var p;var c=t.numJoints;if(r.length!=c)r.length=c;for(var d=0;d<c;++d){i=r[d];if(i==null)i=r[d]=new s;o=a[d];h=n[d];l=o.translation;u=h.translation;e._tempQuat.multiply(h.orientation,o.orientation);i.orientation.lerp(o.orientation,e._tempQuat,this._blendWeight);p=i.translation;p.x=l.x+this._blendWeight*u.x;p.y=l.y+this._blendWeight*u.y;p.z=l.z+this._blendWeight*u.z}};e._tempQuat=new a;return e}(o);e.exports=h},{"awayjs-core/lib/geom/Quaternion":undefined,"awayjs-renderergl/lib/animators/data/JointPose":undefined,"awayjs-renderergl/lib/animators/data/SkeletonPose":undefined,"awayjs-renderergl/lib/animators/states/AnimationStateBase":undefined}],"awayjs-renderergl/lib/animators/states/SkeletonDirectionalState":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-renderergl/lib/animators/data/JointPose");var s=t("awayjs-renderergl/lib/animators/data/SkeletonPose");var n=t("awayjs-renderergl/lib/animators/states/AnimationStateBase");var o=function(t){r(e,t);function e(e,i){t.call(this,e,i);this._skeletonPose=new s;this._skeletonPoseDirty=true;this._blendWeight=0;this._direction=0;this._blendDirty=true;this._skeletonAnimationNode=i;this._forward=e.getAnimationState(this._skeletonAnimationNode.forward);this._backward=e.getAnimationState(this._skeletonAnimationNode.backward);this._left=e.getAnimationState(this._skeletonAnimationNode.left);this._right=e.getAnimationState(this._skeletonAnimationNode.right)}Object.defineProperty(e.prototype,"direction",{get:function(){return this._direction},set:function(t){if(this._direction==t)return;this._direction=t;this._blendDirty=true;this._skeletonPoseDirty=true;this._pPositionDeltaDirty=true},enumerable:true,configurable:true});e.prototype.phase=function(t){if(this._blendDirty)this.updateBlend();this._skeletonPoseDirty=true;this._pPositionDeltaDirty=true;this._inputA.phase(t);this._inputB.phase(t)};e.prototype._pUdateTime=function(e){if(this._blendDirty)this.updateBlend();this._skeletonPoseDirty=true;this._inputA.update(e);this._inputB.update(e);t.prototype._pUpdateTime.call(this,e)};e.prototype.getSkeletonPose=function(t){if(this._skeletonPoseDirty)this.updateSkeletonPose(t);return this._skeletonPose};e.prototype._pUpdatePositionDelta=function(){this._pPositionDeltaDirty=false;if(this._blendDirty)this.updateBlend();var t=this._inputA.positionDelta;var e=this._inputB.positionDelta;this.positionDelta.x=t.x+this._blendWeight*(e.x-t.x);this.positionDelta.y=t.y+this._blendWeight*(e.y-t.y);this.positionDelta.z=t.z+this._blendWeight*(e.z-t.z)};e.prototype.updateSkeletonPose=function(t){this._skeletonPoseDirty=false;if(this._blendDirty)this.updateBlend();var e;var i=this._skeletonPose.jointPoses;var r=this._inputA.getSkeletonPose(t).jointPoses;var s=this._inputB.getSkeletonPose(t).jointPoses;var n,o;var h,l;var u;var p=t.numJoints;if(i.length!=p)i.length=p;for(var c=0;c<p;++c){e=i[c];if(e==null)e=i[c]=new a;n=r[c];o=s[c];h=n.translation;l=o.translation;e.orientation.lerp(n.orientation,o.orientation,this._blendWeight);u=e.translation;u.x=h.x+this._blendWeight*(l.x-h.x);u.y=h.y+this._blendWeight*(l.y-h.y);u.z=h.z+this._blendWeight*(l.z-h.z)}};e.prototype.updateBlend=function(){this._blendDirty=false;if(this._direction<0||this._direction>360){this._direction%=360;if(this._direction<0)this._direction+=360}if(this._direction<90){this._inputA=this._forward;this._inputB=this._right;this._blendWeight=this._direction/90}else if(this._direction<180){this._inputA=this._right;this._inputB=this._backward;this._blendWeight=(this._direction-90)/90}else if(this._direction<270){this._inputA=this._backward;this._inputB=this._left;this._blendWeight=(this._direction-180)/90}else{this._inputA=this._left;this._inputB=this._forward;this._blendWeight=(this._direction-270)/90}};return e}(n);e.exports=o},{"awayjs-renderergl/lib/animators/data/JointPose":undefined,"awayjs-renderergl/lib/animators/data/SkeletonPose":undefined,"awayjs-renderergl/lib/animators/states/AnimationStateBase":undefined}],"awayjs-renderergl/lib/animators/states/SkeletonNaryLERPState":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-renderergl/lib/animators/data/JointPose");var s=t("awayjs-renderergl/lib/animators/data/SkeletonPose");var n=t("awayjs-renderergl/lib/animators/states/AnimationStateBase");var o=function(t){r(e,t);function e(e,i){t.call(this,e,i);this._skeletonPose=new s;this._skeletonPoseDirty=true;this._blendWeights=new Array;this._inputs=new Array;this._skeletonAnimationNode=i;var r=this._skeletonAnimationNode.numInputs;while(r--)this._inputs[r]=e.getAnimationState(this._skeletonAnimationNode._iInputs[r])}e.prototype.phase=function(t){this._skeletonPoseDirty=true;this._pPositionDeltaDirty=true;for(var e=0;e<this._skeletonAnimationNode.numInputs;++e){if(this._blendWeights[e])this._inputs[e].update(t)}};e.prototype._pUdateTime=function(e){for(var i=0;i<this._skeletonAnimationNode.numInputs;++i){if(this._blendWeights[i])this._inputs[i].update(e)}t.prototype._pUpdateTime.call(this,e)};e.prototype.getSkeletonPose=function(t){if(this._skeletonPoseDirty)this.updateSkeletonPose(t);return this._skeletonPose};e.prototype.getBlendWeightAt=function(t){return this._blendWeights[t]};e.prototype.setBlendWeightAt=function(t,e){this._blendWeights[t]=e;this._pPositionDeltaDirty=true;this._skeletonPoseDirty=true};e.prototype._pUpdatePositionDelta=function(){this._pPositionDeltaDirty=false;var t;var e;this.positionDelta.x=0;this.positionDelta.y=0;this.positionDelta.z=0;for(var i=0;i<this._skeletonAnimationNode.numInputs;++i){e=this._blendWeights[i];if(e){t=this._inputs[i].positionDelta;this.positionDelta.x+=e*t.x;this.positionDelta.y+=e*t.y;this.positionDelta.z+=e*t.z}}};e.prototype.updateSkeletonPose=function(t){this._skeletonPoseDirty=false;var e;var i=this._skeletonPose.jointPoses;var r;var s,n;var o,h;var l,u;var p;var c;var d,f,_,y;var g,m,b,v;var w=t.numJoints;if(i.length!=w)i.length=w;for(var x=0;x<this._skeletonAnimationNode.numInputs;++x){e=this._blendWeights[x];if(!e)continue;r=this._inputs[x].getSkeletonPose(t).jointPoses;if(!p){p=r;for(c=0;c<w;++c){s=i[c];if(s==null)s=i[c]=new a;n=r[c];u=n.orientation;h=n.translation;l=s.orientation;l.x=e*u.x;l.y=e*u.y;l.z=e*u.z;l.w=e*u.w;o=s.translation;o.x=e*h.x;o.y=e*h.y;o.z=e*h.z}}else{for(c=0;c<t.numJoints;++c){s=i[c];n=r[c];u=p[c].orientation;f=u.x;_=u.y;y=u.z;d=u.w;u=n.orientation;h=n.translation;m=u.x;b=u.y;v=u.z;g=u.w;if(f*m+_*b+y*v+d*g<0){m=-m;b=-b;v=-v;g=-g}l=s.orientation;l.x+=e*m;l.y+=e*b;l.z+=e*v;l.w+=e*g;o=s.translation;o.x+=e*h.x;o.y+=e*h.y;o.z+=e*h.z}}}for(c=0;c<t.numJoints;++c)i[c].orientation.normalize()};return e}(n);e.exports=o},{"awayjs-renderergl/lib/animators/data/JointPose":undefined,"awayjs-renderergl/lib/animators/data/SkeletonPose":undefined,"awayjs-renderergl/lib/animators/states/AnimationStateBase":undefined}],"awayjs-renderergl/lib/animators/states/VertexClipState":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-renderergl/lib/animators/states/AnimationClipState");var s=function(t){r(e,t);function e(e,i){t.call(this,e,i);this._vertexClipNode=i;this._frames=this._vertexClipNode.frames}Object.defineProperty(e.prototype,"currentGeometry",{get:function(){if(this._pFramesDirty)this._pUpdateFrames();return this._currentGeometry},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"nextGeometry",{get:function(){if(this._pFramesDirty)this._pUpdateFrames();return this._nextGeometry},enumerable:true,configurable:true});e.prototype._pUpdateFrames=function(){t.prototype._pUpdateFrames.call(this);this._currentGeometry=this._frames[this._pCurrentFrame];if(this._vertexClipNode.looping&&this._pNextFrame>=this._vertexClipNode.lastFrame){this._nextGeometry=this._frames[0];this._pAnimator.dispatchCycleEvent()}else this._nextGeometry=this._frames[this._pNextFrame]};e.prototype._pUpdatePositionDelta=function(){};return e}(a);e.exports=s},{"awayjs-renderergl/lib/animators/states/AnimationClipState":undefined}],"awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-renderergl/lib/animators/nodes/SkeletonBinaryLERPNode");var s=t("awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionState");var n=function(t){r(e,t);function e(){t.call(this);this._pStateClass=s}return e}(a);e.exports=n},{"awayjs-renderergl/lib/animators/nodes/SkeletonBinaryLERPNode":undefined,"awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionState":undefined}],"awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionState":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-renderergl/lib/animators/states/SkeletonBinaryLERPState");var s=t("awayjs-renderergl/lib/events/AnimationStateEvent");var n=function(t){r(e,t);function e(e,i){t.call(this,e,i);this._crossfadeTransitionNode=i}e.prototype._pUpdateTime=function(e){this.blendWeight=Math.abs(e-this._crossfadeTransitionNode.startBlend)/(1e3*this._crossfadeTransitionNode.blendSpeed);if(this.blendWeight>=1){this.blendWeight=1;if(this._animationStateTransitionComplete==null)this._animationStateTransitionComplete=new s(s.TRANSITION_COMPLETE,this._pAnimator,this,this._crossfadeTransitionNode);this._crossfadeTransitionNode.dispatchEvent(this._animationStateTransitionComplete)}t.prototype._pUpdateTime.call(this,e)};return e}(a);e.exports=n},{"awayjs-renderergl/lib/animators/states/SkeletonBinaryLERPState":undefined,"awayjs-renderergl/lib/events/AnimationStateEvent":undefined}],"awayjs-renderergl/lib/animators/transitions/CrossfadeTransition":[function(t,e,i){var r=t("awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionNode");var a=function(){function t(t){this.blendSpeed=.5;this.blendSpeed=t}t.prototype.getAnimationNode=function(t,e,i,a){var s=new r;s.inputA=e;s.inputB=i;s.blendSpeed=this.blendSpeed;s.startBlend=a;return s};return t}();e.exports=a},{"awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionNode":undefined}],"awayjs-renderergl/lib/animators/transitions/IAnimationTransition":[function(t,e,i){},{}],"awayjs-renderergl/lib/base/ParticleGeometry":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/base/Geometry");var s=function(t){r(e,t);function e(){t.apply(this,arguments)}return e}(a);e.exports=s},{"awayjs-display/lib/base/Geometry":undefined}],"awayjs-renderergl/lib/events/AnimationStateEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e,i,r,a){t.call(this,e);this._animator=i;this._animationState=r;this._animationNode=a}Object.defineProperty(e.prototype,"animator",{get:function(){return this._animator},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"animationState",{get:function(){return this._animationState},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"animationNode",{get:function(){return this._animationNode},enumerable:true,configurable:true});e.prototype.clone=function(){return new e(this.type,this._animator,this._animationState,this._animationNode)};e.PLAYBACK_COMPLETE="playbackComplete";e.TRANSITION_COMPLETE="transitionComplete";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":undefined}],"awayjs-renderergl/lib/materials/methods/AmbientEnvMapMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/methods/AmbientBasicMethod");var s=t("awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper");var n=function(t){r(e,t);function e(e){t.call(this);this._cubeTexture=e}e.prototype.iInitVO=function(e,i){t.prototype.iInitVO.call(this,e,i);i.needsNormals=true};Object.defineProperty(e.prototype,"envMap",{get:function(){return this._cubeTexture},set:function(t){this._cubeTexture=t},enumerable:true,configurable:true});e.prototype.iActivate=function(e,i,r){t.prototype.iActivate.call(this,e,i,r);r.context.activateCubeTexture(i.texturesIndex,this._cubeTexture)};e.prototype.iGetFragmentCode=function(t,e,i,r,a){var n="";var o;var h=r.getFreeTextureReg();e.texturesIndex=h.index;n+=s.getTexCubeSampleCode(i,h,this._cubeTexture,t.useSmoothTextures,t.useMipmapping,a.normalFragment);o=r.getFreeFragmentConstant();e.fragmentConstantsIndex=o.index;n+="add "+i+".xyz, "+i+".xyz, "+o+".xyz\n";return n};return e}(a);e.exports=n},{"awayjs-stagegl/lib/materials/methods/AmbientBasicMethod":undefined,"awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper":undefined}],"awayjs-renderergl/lib/materials/methods/DiffuseCelMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-renderergl/lib/materials/methods/DiffuseCompositeMethod");var s=function(t){r(e,t);function e(e,i){var r=this;if(e===void 0){e=3}if(i===void 0){i=null}t.call(this,null,i);this._smoothness=.1;this.baseMethod._iModulateMethod=function(t,e,i,a,s){return r.clampDiffuse(t,e,i,a,s)};this._levels=e}e.prototype.iInitConstants=function(e,i){var r=e.fragmentConstantData;var a=i.secondaryFragmentConstantsIndex;t.prototype.iInitConstants.call(this,e,i);r[a+1]=1;r[a+2]=0};Object.defineProperty(e.prototype,"levels",{get:function(){return this._levels},set:function(t){this._levels=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"smoothness",{get:function(){return this._smoothness},set:function(t){this._smoothness=t},enumerable:true,configurable:true});e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this);this._dataReg=null};e.prototype.iGetFragmentPreLightingCode=function(e,i,r,a){this._dataReg=r.getFreeFragmentConstant();i.secondaryFragmentConstantsIndex=this._dataReg.index*4;return t.prototype.iGetFragmentPreLightingCode.call(this,e,i,r,a)};e.prototype.iActivate=function(e,i,r){t.prototype.iActivate.call(this,e,i,r);var a=e.fragmentConstantData;var s=i.secondaryFragmentConstantsIndex;a[s]=this._levels;a[s+3]=this._smoothness};e.prototype.clampDiffuse=function(t,e,i,r,a){return"mul "+i+".w, "+i+".w, "+this._dataReg+".x\n"+"frc "+i+".z, "+i+".w\n"+"sub "+i+".y, "+i+".w, "+i+".z\n"+"mov "+i+".x, "+this._dataReg+".x\n"+"sub "+i+".x, "+i+".x, "+this._dataReg+".y\n"+"rcp "+i+".x,"+i+".x\n"+"mul "+i+".w, "+i+".y, "+i+".x\n"+"sub "+i+".y, "+i+".w, "+i+".x\n"+"div "+i+".z, "+i+".z, "+this._dataReg+".w\n"+"sat "+i+".z, "+i+".z\n"+"mul "+i+".w, "+i+".w, "+i+".z\n"+"sub "+i+".z, "+this._dataReg+".y, "+i+".z\n"+"mul "+i+".y, "+i+".y, "+i+".z\n"+"add "+i+".w, "+i+".w, "+i+".y\n"+"sat "+i+".w, "+i+".w\n"};return e}(a);e.exports=s},{"awayjs-renderergl/lib/materials/methods/DiffuseCompositeMethod":undefined}],"awayjs-renderergl/lib/materials/methods/DiffuseCompositeMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/events/ShadingMethodEvent");var s=t("awayjs-stagegl/lib/materials/methods/DiffuseBasicMethod");var n=function(t){r(e,t);function e(e,i){var r=this;if(i===void 0){i=null}t.call(this);this._onShaderInvalidatedDelegate=function(t){return r.onShaderInvalidated(t)};this.pBaseMethod=i||new s;this.pBaseMethod._iModulateMethod=e;this.pBaseMethod.addEventListener(a.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate)}Object.defineProperty(e.prototype,"baseMethod",{get:function(){return this.pBaseMethod},set:function(t){if(this.pBaseMethod==t)return;this.pBaseMethod.removeEventListener(a.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate);this.pBaseMethod=t;this.pBaseMethod.addEventListener(a.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate);this.iInvalidateShaderProgram()},enumerable:true,configurable:true});e.prototype.iInitVO=function(t,e){this.pBaseMethod.iInitVO(t,e)};e.prototype.iInitConstants=function(t,e){this.pBaseMethod.iInitConstants(t,e)};e.prototype.dispose=function(){this.pBaseMethod.removeEventListener(a.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate);this.pBaseMethod.dispose()};Object.defineProperty(e.prototype,"texture",{get:function(){return this.pBaseMethod.texture},set:function(t){this.pBaseMethod.texture=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"diffuseColor",{get:function(){return this.pBaseMethod.diffuseColor},set:function(t){this.pBaseMethod.diffuseColor=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"ambientColor",{get:function(){return this.pBaseMethod.ambientColor},set:function(t){this.pBaseMethod.ambientColor=t},enumerable:true,configurable:true});e.prototype.iGetFragmentPreLightingCode=function(t,e,i,r){return this.pBaseMethod.iGetFragmentPreLightingCode(t,e,i,r)};e.prototype.iGetFragmentCodePerLight=function(t,e,i,r,a,s){var n=this.pBaseMethod.iGetFragmentCodePerLight(t,e,i,r,a,s);this._pTotalLightColorReg=this.pBaseMethod._pTotalLightColorReg;return n};e.prototype.iGetFragmentCodePerProbe=function(t,e,i,r,a,s){var n=this.pBaseMethod.iGetFragmentCodePerProbe(t,e,i,r,a,s);this._pTotalLightColorReg=this.pBaseMethod._pTotalLightColorReg;return n};e.prototype.iActivate=function(t,e,i){this.pBaseMethod.iActivate(t,e,i)};e.prototype.iSetRenderState=function(t,e,i,r,a){this.pBaseMethod.iSetRenderState(t,e,i,r,a)};e.prototype.iDeactivate=function(t,e,i){this.pBaseMethod.iDeactivate(t,e,i)};e.prototype.iGetVertexCode=function(t,e,i,r){return this.pBaseMethod.iGetVertexCode(t,e,i,r)};e.prototype.iGetFragmentPostLightingCode=function(t,e,i,r,a){return this.pBaseMethod.iGetFragmentPostLightingCode(t,e,i,r,a)};e.prototype.iReset=function(){this.pBaseMethod.iReset()};e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this);this.pBaseMethod.iCleanCompilationData()};e.prototype.onShaderInvalidated=function(t){this.iInvalidateShaderProgram()};return e}(s);e.exports=n},{"awayjs-stagegl/lib/events/ShadingMethodEvent":undefined,"awayjs-stagegl/lib/materials/methods/DiffuseBasicMethod":undefined}],"awayjs-renderergl/lib/materials/methods/DiffuseDepthMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/methods/DiffuseBasicMethod");var s=t("awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper");var n=function(t){r(e,t);function e(){t.call(this)}e.prototype.iInitConstants=function(t,e){var i=t.fragmentConstantData;var r=e.fragmentConstantsIndex;i[r]=1;i[r+1]=1/255;i[r+2]=1/65025;i[r+3]=1/16581375};e.prototype.iGetFragmentPostLightingCode=function(t,e,i,r,a){var n="";var o;var h;if(!this._pUseTexture)throw new Error("DiffuseDepthMethod requires texture!");if(t.numLights>0){if(a.shadowTarget)n+="mul "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+".xyz, "+a.shadowTarget+".w\n";n+="add "+i+".xyz, "+this._pTotalLightColorReg+".xyz, "+i+".xyz\n"+"sat "+i+".xyz, "+i+".xyz\n";r.removeFragmentTempUsage(this._pTotalLightColorReg)}o=t.numLights>0?r.getFreeFragmentVectorTemp():i;this._pDiffuseInputRegister=r.getFreeTextureReg();e.texturesIndex=this._pDiffuseInputRegister.index;h=r.getFreeFragmentConstant();e.fragmentConstantsIndex=h.index*4;n+=s.getTex2DSampleCode(o,a,this._pDiffuseInputRegister,this.texture,t.useSmoothTextures,t.repeatTextures,t.useMipmapping)+"dp4 "+o+".x, "+o+", "+h+"\n"+"mov "+o+".yz, "+o+".xx			\n"+"mov "+o+".w, "+h+".x\n"+"sub "+o+".xyz, "+h+".xxx, "+o+".xyz\n";if(t.numLights==0)return n;n+="mul "+i+".xyz, "+o+".xyz, "+i+".xyz\n"+"mov "+i+".w, "+o+".w\n";return n};return e}(a);e.exports=n},{"awayjs-stagegl/lib/materials/methods/DiffuseBasicMethod":undefined,"awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper":undefined}],"awayjs-renderergl/lib/materials/methods/DiffuseGradientMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/methods/DiffuseBasicMethod");var s=t("awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper");var n=function(t){r(e,t);function e(e){t.call(this);this._gradient=e}Object.defineProperty(e.prototype,"gradient",{get:function(){return this._gradient},set:function(t){if(t.hasMipmaps!=this._gradient.hasMipmaps||t.format!=this._gradient.format)this.iInvalidateShaderProgram();this._gradient=t},enumerable:true,configurable:true});e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this);this._gradientTextureRegister=null};e.prototype.iGetFragmentPreLightingCode=function(e,i,r,a){var s=t.prototype.iGetFragmentPreLightingCode.call(this,e,i,r,a);this._pIsFirstLight=true;if(e.numLights>0){this._gradientTextureRegister=r.getFreeTextureReg();i.secondaryTexturesIndex=this._gradientTextureRegister.index}return s};e.prototype.iGetFragmentCodePerLight=function(t,e,i,r,a,n){var o="";var h;if(this._pIsFirstLight)h=this._pTotalLightColorReg;else{h=a.getFreeFragmentVectorTemp();a.addFragmentTempUsages(h,1)}o+="dp3 "+h+".w, "+i+".xyz, "+n.normalFragment+".xyz\n"+"mul "+h+".w, "+h+".w, "+n.commons+".x\n"+"add "+h+".w, "+h+".w, "+n.commons+".x\n"+"mul "+h+".xyz, "+h+".w, "+i+".w\n";if(this._iModulateMethod!=null)o+=this._iModulateMethod(t,e,h,a,n);o+=s.getTex2DSampleCode(h,n,this._gradientTextureRegister,this._gradient,t.useSmoothTextures,t.repeatTextures,t.useMipmapping,h,"clamp")+"mul "+h+".xyz, "+h+".xyz, "+r+".xyz\n";if(!this._pIsFirstLight){o+="add "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+".xyz, "+h+".xyz\n";a.removeFragmentTempUsage(h)}this._pIsFirstLight=false;return o};e.prototype.pApplyShadow=function(t,e,i,r){var a=i.getFreeFragmentVectorTemp();return"mov "+a+", "+r.shadowTarget+".wwww\n"+s.getTex2DSampleCode(a,r,this._gradientTextureRegister,this._gradient,t.useSmoothTextures,t.repeatTextures,t.useMipmapping,a,"clamp")+"mul "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+", "+a+"\n"};e.prototype.iActivate=function(e,i,r){t.prototype.iActivate.call(this,e,i,r);r.context.activateTexture(i.secondaryTexturesIndex,this._gradient)};return e}(a);e.exports=n},{"awayjs-stagegl/lib/materials/methods/DiffuseBasicMethod":undefined,"awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper":undefined}],"awayjs-renderergl/lib/materials/methods/DiffuseLightMapMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper");var s=t("awayjs-renderergl/lib/materials/methods/DiffuseCompositeMethod");var n=function(t){r(e,t);function e(e,i,r,a){if(i===void 0){i="multiply"}if(r===void 0){r=false}if(a===void 0){a=null}t.call(this,null,a);this._useSecondaryUV=r;this._lightMapTexture=e;this.blendMode=i}e.prototype.iInitVO=function(t,e){e.needsSecondaryUV=this._useSecondaryUV;e.needsUV=!this._useSecondaryUV};Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._blendMode},set:function(t){if(t!=e.ADD&&t!=e.MULTIPLY)throw new Error("Unknown blendmode!");if(this._blendMode==t)return;this._blendMode=t;this.iInvalidateShaderProgram()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lightMapTexture",{get:function(){return this._lightMapTexture},set:function(t){this._lightMapTexture=t},enumerable:true,configurable:true});e.prototype.iActivate=function(e,i,r){r.context.activateTexture(i.secondaryTexturesIndex,this._lightMapTexture);t.prototype.iActivate.call(this,e,i,r)};e.prototype.iGetFragmentPostLightingCode=function(i,r,s,n,o){var h;var l=n.getFreeTextureReg();var u=n.getFreeFragmentVectorTemp();r.secondaryTexturesIndex=l.index;h=a.getTex2DSampleCode(u,o,l,this._lightMapTexture,i.useSmoothTextures,i.repeatTextures,i.useMipmapping,o.secondaryUVVarying);switch(this._blendMode){case e.MULTIPLY:h+="mul "+this._pTotalLightColorReg+", "+this._pTotalLightColorReg+", "+u+"\n";break;case e.ADD:h+="add "+this._pTotalLightColorReg+", "+this._pTotalLightColorReg+", "+u+"\n";break}h+=t.prototype.iGetFragmentPostLightingCode.call(this,i,r,s,n,o);return h};e.MULTIPLY="multiply";e.ADD="add";return e}(s);e.exports=n},{"awayjs-renderergl/lib/materials/methods/DiffuseCompositeMethod":undefined,"awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper":undefined}],"awayjs-renderergl/lib/materials/methods/DiffuseSubSurfaceMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-renderergl/lib/materials/methods/DiffuseCompositeMethod");var s=t("awayjs-renderergl/lib/materials/passes/SingleObjectDepthPass");var n=function(t){r(e,t);function e(e,i,r){var a=this;if(e===void 0){e=512}if(i===void 0){i=15}if(r===void 0){r=null}t.call(this,null,r);this._translucency=1;this._scatterColor=16777215;this._scatterR=1;this._scatterG=1;this._scatterB=1;this.pBaseMethod._iModulateMethod=function(t,e,i,r,s){return a.scatterLight(t,e,i,r,s)};this._passes=new Array;this._depthPass=new s;this._depthPass.textureSize=e;this._depthPass.polyOffset=i;this._passes.push(this._depthPass);this._scattering=.2;this._translucency=1}e.prototype.iInitConstants=function(e,i){t.prototype.iInitConstants.call(this,e,i);
var r=e.vertexConstantData;var a=i.secondaryVertexConstantsIndex;r[a]=.5;r[a+1]=-.5;r[a+2]=0;r[a+3]=1;r=e.fragmentConstantData;a=i.secondaryFragmentConstantsIndex;r[a+3]=1;r[a+4]=1;r[a+5]=1/255;r[a+6]=1/65025;r[a+7]=1/16581375;r[a+10]=.5;r[a+11]=-.1};e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this);this._lightProjVarying=null;this._propReg=null;this._lightColorReg=null;this._colorReg=null;this._decReg=null;this._targetReg=null};Object.defineProperty(e.prototype,"scattering",{get:function(){return this._scattering},set:function(t){this._scattering=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"translucency",{get:function(){return this._translucency},set:function(t){this._translucency=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scatterColor",{get:function(){return this._scatterColor},set:function(t){this._scatterColor=t;this._scatterR=(t>>16&255)/255;this._scatterG=(t>>8&255)/255;this._scatterB=(t&255)/255},enumerable:true,configurable:true});e.prototype.iGetVertexCode=function(e,i,r,a){var s=t.prototype.iGetVertexCode.call(this,e,i,r,a);var n;var o;var h=r.getFreeVertexVectorTemp();o=r.getFreeVertexConstant();i.secondaryVertexConstantsIndex=o.index*4;this._lightProjVarying=r.getFreeVarying();n=r.getFreeVertexConstant();r.getFreeVertexConstant();r.getFreeVertexConstant();r.getFreeVertexConstant();s+="m44 "+h+", vt0, "+n+"\n"+"div "+h+".xyz, "+h+".xyz, "+h+".w\n"+"mul "+h+".xy, "+h+".xy, "+o+".xy\n"+"add "+h+".xy, "+h+".xy, "+o+".xx\n"+"mov "+this._lightProjVarying+".xyz, "+h+".xyz\n"+"mov "+this._lightProjVarying+".w, va0.w\n";return s};e.prototype.iGetFragmentPreLightingCode=function(e,i,r,a){this._colorReg=r.getFreeFragmentConstant();this._decReg=r.getFreeFragmentConstant();this._propReg=r.getFreeFragmentConstant();i.secondaryFragmentConstantsIndex=this._colorReg.index*4;return t.prototype.iGetFragmentPreLightingCode.call(this,e,i,r,a)};e.prototype.iGetFragmentCodePerLight=function(e,i,r,a,s,n){this._pIsFirstLight=true;this._lightColorReg=a;return t.prototype.iGetFragmentCodePerLight.call(this,e,i,r,a,s,n)};e.prototype.iGetFragmentPostLightingCode=function(e,i,r,a,s){var n=t.prototype.iGetFragmentPostLightingCode.call(this,e,i,r,a,s);var o=a.getFreeFragmentVectorTemp();n+="mul "+o+".xyz, "+this._lightColorReg+".xyz, "+this._targetReg+".w\n"+"mul "+o+".xyz, "+o+".xyz, "+this._colorReg+".xyz\n"+"add "+r+".xyz, "+r+".xyz, "+o+".xyz\n";if(this._targetReg!=s.viewDirFragment)a.removeFragmentTempUsage(r);return n};e.prototype.iActivate=function(e,i,r){t.prototype.iActivate.call(this,e,i,r);var a=i.secondaryFragmentConstantsIndex;var s=e.fragmentConstantData;s[a]=this._scatterR;s[a+1]=this._scatterG;s[a+2]=this._scatterB;s[a+8]=this._scattering;s[a+9]=this._translucency};e.prototype.iSetRenderState=function(t,e,i,r,a){r.context.activateTexture(e.secondaryTexturesIndex,this._depthPass._iGetDepthMap(i));this._depthPass._iGetProjection(i).copyRawDataTo(t.vertexConstantData,e.secondaryVertexConstantsIndex+4,true)};e.prototype.scatterLight=function(t,e,i,r,a){if(!this._pIsFirstLight)return"";this._pIsFirstLight=false;var s="";var n=r.getFreeTextureReg();if(a.viewDirFragment){this._targetReg=a.viewDirFragment}else{this._targetReg=r.getFreeFragmentVectorTemp();r.addFragmentTempUsages(this._targetReg,1)}e.secondaryTexturesIndex=n.index;var o=r.getFreeFragmentVectorTemp();s+="tex "+o+", "+this._lightProjVarying+", "+n+" <2d,nearest,clamp>\n"+"dp4 "+i+".z, "+o+", "+this._decReg+"\n";s+="sub "+i+".z, "+this._lightProjVarying+".z, "+i+".z\n"+"sub "+i+".z, "+this._propReg+".x, "+i+".z\n"+"mul "+i+".z, "+this._propReg+".y, "+i+".z\n"+"sat "+i+".z, "+i+".z\n"+"neg "+i+".y, "+i+".x\n"+"mul "+i+".y, "+i+".y, "+this._propReg+".z\n"+"add "+i+".y, "+i+".y, "+this._propReg+".z\n"+"mul "+this._targetReg+".w, "+i+".z, "+i+".y\n"+"sub "+i+".y, "+this._colorReg+".w, "+this._targetReg+".w\n"+"mul "+i+".w, "+i+".w, "+i+".y\n";return s};return e}(a);e.exports=n},{"awayjs-renderergl/lib/materials/methods/DiffuseCompositeMethod":undefined,"awayjs-renderergl/lib/materials/passes/SingleObjectDepthPass":undefined}],"awayjs-renderergl/lib/materials/methods/DiffuseWrapMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/methods/DiffuseBasicMethod");var s=function(t){r(e,t);function e(e){if(e===void 0){e=.5}t.call(this);this.wrapFactor=e}e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this);this._wrapDataRegister=null};Object.defineProperty(e.prototype,"wrapFactor",{get:function(){return this._wrapFactor},set:function(t){this._wrapFactor=t;this._wrapFactor=1/(t+1)},enumerable:true,configurable:true});e.prototype.iGetFragmentPreLightingCode=function(e,i,r,a){var s=t.prototype.iGetFragmentPreLightingCode.call(this,e,i,r,a);this._pIsFirstLight=true;this._wrapDataRegister=r.getFreeFragmentConstant();i.secondaryFragmentConstantsIndex=this._wrapDataRegister.index*4;return s};e.prototype.iGetFragmentCodePerLight=function(t,e,i,r,a,s){var n="";var o;if(this._pIsFirstLight){o=this._pTotalLightColorReg}else{o=a.getFreeFragmentVectorTemp();a.addFragmentTempUsages(o,1)}n+="dp3 "+o+".x, "+i+".xyz, "+s.normalFragment+".xyz\n"+"add "+o+".y, "+o+".x, "+this._wrapDataRegister+".x\n"+"mul "+o+".y, "+o+".y, "+this._wrapDataRegister+".y\n"+"sat "+o+".w, "+o+".y\n"+"mul "+o+".xz, "+o+".w, "+i+".wz\n";if(this._iModulateMethod!=null)n+=this._iModulateMethod(t,e,i,a,s);n+="mul "+o+", "+o+".x, "+r+"\n";if(!this._pIsFirstLight){n+="add "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+".xyz, "+o+".xyz\n";a.removeFragmentTempUsage(o)}this._pIsFirstLight=false;return n};e.prototype.iActivate=function(e,i,r){t.prototype.iActivate.call(this,e,i,r);var a=i.secondaryFragmentConstantsIndex;var s=e.fragmentConstantData;s[a]=this._wrapFactor;s[a+1]=1/(this._wrapFactor+1)};return e}(a);e.exports=s},{"awayjs-stagegl/lib/materials/methods/DiffuseBasicMethod":undefined}],"awayjs-renderergl/lib/materials/methods/EffectAlphaMaskMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/methods/EffectMethodBase");var s=t("awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper");var n=function(t){r(e,t);function e(e,i){if(i===void 0){i=false}t.call(this);this._texture=e;this._useSecondaryUV=i}e.prototype.iInitVO=function(t,e){e.needsSecondaryUV=this._useSecondaryUV;e.needsUV=!this._useSecondaryUV};Object.defineProperty(e.prototype,"useSecondaryUV",{get:function(){return this._useSecondaryUV},set:function(t){if(this._useSecondaryUV==t)return;this._useSecondaryUV=t;this.iInvalidateShaderProgram()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture=t},enumerable:true,configurable:true});e.prototype.iActivate=function(t,e,i){i.context.activateTexture(e.texturesIndex,this._texture)};e.prototype.iGetFragmentCode=function(t,e,i,r,a){var n=r.getFreeTextureReg();var o=r.getFreeFragmentVectorTemp();var h=this._useSecondaryUV?a.secondaryUVVarying:a.uvVarying;e.texturesIndex=n.index;return s.getTex2DSampleCode(o,a,n,this._texture,t.useSmoothTextures,t.repeatTextures,t.useMipmapping,h)+"mul "+i+", "+i+", "+o+".x\n"};return e}(a);e.exports=n},{"awayjs-stagegl/lib/materials/methods/EffectMethodBase":undefined,"awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper":undefined}],"awayjs-renderergl/lib/materials/methods/EffectColorMatrixMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/methods/EffectMethodBase");var s=function(t){r(e,t);function e(e){t.call(this);if(e.length!=20)throw new Error("Matrix length must be 20!");this._matrix=e}Object.defineProperty(e.prototype,"colorMatrix",{get:function(){return this._matrix},set:function(t){this._matrix=t},enumerable:true,configurable:true});e.prototype.iGetFragmentCode=function(t,e,i,r,a){var s="";var n=r.getFreeFragmentConstant();r.getFreeFragmentConstant();r.getFreeFragmentConstant();r.getFreeFragmentConstant();var o=r.getFreeFragmentConstant();e.fragmentConstantsIndex=n.index*4;var h=r.getFreeFragmentVectorTemp();s+="m44 "+h+", "+i+", "+n+"\n"+"add "+i+", "+h+", "+o+"\n";return s};e.prototype.iActivate=function(t,e,i){var r=this._matrix;var a=e.fragmentConstantsIndex;var s=t.fragmentConstantData;s[a]=r[0];s[a+1]=r[1];s[a+2]=r[2];s[a+3]=r[3];s[a+4]=r[5];s[a+5]=r[6];s[a+6]=r[7];s[a+7]=r[8];s[a+8]=r[10];s[a+9]=r[11];s[a+10]=r[12];s[a+11]=r[13];s[a+12]=r[15];s[a+13]=r[16];s[a+14]=r[17];s[a+15]=r[18];s[a+16]=r[4];s[a+17]=r[9];s[a+18]=r[14];s[a+19]=r[19]};return e}(a);e.exports=s},{"awayjs-stagegl/lib/materials/methods/EffectMethodBase":undefined}],"awayjs-renderergl/lib/materials/methods/EffectEnvMapMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/methods/EffectMethodBase");var s=t("awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper");var n=function(t){r(e,t);function e(e,i){if(i===void 0){i=1}t.call(this);this._cubeTexture=e;this._alpha=i}Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},set:function(t){if(t!=this._mask||t&&this._mask&&(t.hasMipmaps!=this._mask.hasMipmaps||t.format!=this._mask.format))this.iInvalidateShaderProgram();this._mask=t},enumerable:true,configurable:true});e.prototype.iInitVO=function(t,e){e.needsNormals=true;e.needsView=true;e.needsUV=this._mask!=null};Object.defineProperty(e.prototype,"envMap",{get:function(){return this._cubeTexture},set:function(t){this._cubeTexture=t},enumerable:true,configurable:true});e.prototype.dispose=function(){};Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha=t},enumerable:true,configurable:true});e.prototype.iActivate=function(t,e,i){t.fragmentConstantData[e.fragmentConstantsIndex]=this._alpha;i.context.activateCubeTexture(e.texturesIndex,this._cubeTexture);if(this._mask)i.context.activateTexture(e.texturesIndex+1,this._mask)};e.prototype.iGetFragmentCode=function(t,e,i,r,a){var n=r.getFreeFragmentConstant();var o=r.getFreeFragmentVectorTemp();var h="";var l=r.getFreeTextureReg();e.texturesIndex=l.index;e.fragmentConstantsIndex=n.index*4;r.addFragmentTempUsages(o,1);var u=r.getFreeFragmentVectorTemp();h+="dp3 "+o+".w, "+a.viewDirFragment+".xyz, "+a.normalFragment+".xyz\n"+"add "+o+".w, "+o+".w, "+o+".w\n"+"mul "+o+".xyz, "+a.normalFragment+".xyz, "+o+".w\n"+"sub "+o+".xyz, "+o+".xyz, "+a.viewDirFragment+".xyz\n"+s.getTexCubeSampleCode(o,l,this._cubeTexture,t.useSmoothTextures,t.useMipmapping,o)+"sub "+u+".w, "+o+".w, fc0.x\n"+"kil "+u+".w\n"+"sub "+o+", "+o+", "+i+"\n";if(this._mask)h+=s.getTex2DSampleCode(u,a,r.getFreeTextureReg(),this._mask,t.useSmoothTextures,t.repeatTextures,t.useMipmapping)+"mul "+o+", "+u+", "+o+"\n";h+="mul "+o+", "+o+", "+n+".x\n"+"add "+i+", "+i+", "+o+"\n";r.removeFragmentTempUsage(o);return h};return e}(a);e.exports=n},{"awayjs-stagegl/lib/materials/methods/EffectMethodBase":undefined,"awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper":undefined}],"awayjs-renderergl/lib/materials/methods/EffectFogMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/methods/EffectMethodBase");var s=function(t){r(e,t);function e(e,i,r){if(r===void 0){r=8421504}t.call(this);this._minDistance=0;this._maxDistance=1e3;this.minDistance=e;this.maxDistance=i;this.fogColor=r}e.prototype.iInitVO=function(t,e){e.needsProjection=true};e.prototype.iInitConstants=function(t,e){var i=t.fragmentConstantData;var r=e.fragmentConstantsIndex;i[r+3]=1;i[r+6]=0;i[r+7]=0};Object.defineProperty(e.prototype,"minDistance",{get:function(){return this._minDistance},set:function(t){this._minDistance=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"maxDistance",{get:function(){return this._maxDistance},set:function(t){this._maxDistance=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"fogColor",{get:function(){return this._fogColor},set:function(t){this._fogColor=t;this._fogR=(t>>16&255)/255;this._fogG=(t>>8&255)/255;this._fogB=(t&255)/255},enumerable:true,configurable:true});e.prototype.iActivate=function(t,e,i){var r=t.fragmentConstantData;var a=e.fragmentConstantsIndex;r[a]=this._fogR;r[a+1]=this._fogG;r[a+2]=this._fogB;r[a+4]=this._minDistance;r[a+5]=1/(this._maxDistance-this._minDistance)};e.prototype.iGetFragmentCode=function(t,e,i,r,a){var s=r.getFreeFragmentConstant();var n=r.getFreeFragmentConstant();var o=r.getFreeFragmentVectorTemp();r.addFragmentTempUsages(o,1);var h=r.getFreeFragmentVectorTemp();var l="";e.fragmentConstantsIndex=s.index*4;l+="sub "+h+".w, "+a.projectionFragment+".z, "+n+".x\n"+"mul "+h+".w, "+h+".w, "+n+".y\n"+"sat "+h+".w, "+h+".w\n"+"sub "+o+", "+s+", "+i+"\n"+"mul "+o+", "+o+", "+h+".w\n"+"add "+i+", "+i+", "+o+"\n";r.removeFragmentTempUsage(o);return l};return e}(a);e.exports=s},{"awayjs-stagegl/lib/materials/methods/EffectMethodBase":undefined}],"awayjs-renderergl/lib/materials/methods/EffectFresnelEnvMapMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/methods/EffectMethodBase");var s=t("awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper");var n=function(t){r(e,t);function e(e,i){if(i===void 0){i=1}t.call(this);this._fresnelPower=5;this._normalReflectance=0;this._cubeTexture=e;this._alpha=i}e.prototype.iInitVO=function(t,e){e.needsNormals=true;e.needsView=true;e.needsUV=this._mask!=null};e.prototype.iInitConstants=function(t,e){t.fragmentConstantData[e.fragmentConstantsIndex+3]=1};Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},set:function(t){if(Boolean(t)!=Boolean(this._mask)||t&&this._mask&&(t.hasMipmaps!=this._mask.hasMipmaps||t.format!=this._mask.format)){this.iInvalidateShaderProgram()}this._mask=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"fresnelPower",{get:function(){return this._fresnelPower},set:function(t){this._fresnelPower=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"envMap",{get:function(){return this._cubeTexture},set:function(t){this._cubeTexture=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"normalReflectance",{get:function(){return this._normalReflectance},set:function(t){this._normalReflectance=t},enumerable:true,configurable:true});e.prototype.iActivate=function(t,e,i){var r=t.fragmentConstantData;var a=e.fragmentConstantsIndex;r[a]=this._alpha;r[a+1]=this._normalReflectance;r[a+2]=this._fresnelPower;i.context.activateCubeTexture(e.texturesIndex,this._cubeTexture);if(this._mask)i.context.activateTexture(e.texturesIndex+1,this._mask)};e.prototype.iGetFragmentCode=function(t,e,i,r,a){var n=r.getFreeFragmentConstant();var o=r.getFreeFragmentVectorTemp();var h="";var l=r.getFreeTextureReg();var u=a.viewDirFragment;var p=a.normalFragment;e.texturesIndex=l.index;e.fragmentConstantsIndex=n.index*4;r.addFragmentTempUsages(o,1);var c=r.getFreeFragmentVectorTemp();h+="dp3 "+o+".w, "+u+".xyz, "+p+".xyz\n"+"add "+o+".w, "+o+".w, "+o+".w\n"+"mul "+o+".xyz, "+p+".xyz, "+o+".w\n"+"sub "+o+".xyz, "+o+".xyz, "+u+".xyz\n"+s.getTexCubeSampleCode(o,l,this._cubeTexture,t.useSmoothTextures,t.useMipmapping,o)+"sub "+c+".w, "+o+".w, fc0.x\n"+"kil "+c+".w\n"+"sub "+o+", "+o+", "+i+"\n";h+="dp3 "+u+".w, "+u+".xyz, "+p+".xyz\n"+"sub "+u+".w, "+n+".w, "+u+".w\n"+"pow "+u+".w, "+u+".w, "+n+".z\n"+"sub "+p+".w, "+n+".w, "+u+".w\n"+"mul "+p+".w, "+n+".y, "+p+".w\n"+"add "+u+".w, "+u+".w, "+p+".w\n"+"mul "+u+".w, "+n+".x, "+u+".w\n";if(this._mask){var d=r.getFreeTextureReg();h+=s.getTex2DSampleCode(c,a,d,this._mask,t.useSmoothTextures,t.repeatTextures,t.useMipmapping)+"mul "+u+".w, "+c+".x, "+u+".w\n"}h+="mul "+o+", "+o+", "+u+".w\n"+"add "+i+", "+i+", "+o+"\n";r.removeFragmentTempUsage(o);return h};return e}(a);e.exports=n},{"awayjs-stagegl/lib/materials/methods/EffectMethodBase":undefined,"awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper":undefined}],"awayjs-renderergl/lib/materials/methods/EffectLightMapMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/methods/EffectMethodBase");var s=t("awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper");var n=function(t){r(e,t);function e(e,i,r){if(i===void 0){i="multiply"}if(r===void 0){r=false}t.call(this);this._useSecondaryUV=r;this._texture=e;this.blendMode=i}e.prototype.iInitVO=function(t,e){e.needsUV=!this._useSecondaryUV;e.needsSecondaryUV=this._useSecondaryUV};Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._blendMode},set:function(t){if(t!=e.ADD&&t!=e.MULTIPLY)throw new Error("Unknown blendmode!");if(this._blendMode==t)return;this._blendMode=t;this.iInvalidateShaderProgram()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){if(t.hasMipmaps!=this._texture.hasMipmaps||t.format!=this._texture.format)this.iInvalidateShaderProgram();this._texture=t},enumerable:true,configurable:true});e.prototype.iActivate=function(e,i,r){r.context.activateTexture(i.texturesIndex,this._texture);t.prototype.iActivate.call(this,e,i,r)};e.prototype.iGetFragmentCode=function(t,i,r,a,n){var o;var h=a.getFreeTextureReg();var l=a.getFreeFragmentVectorTemp();i.texturesIndex=h.index;o=s.getTex2DSampleCode(l,n,h,this._texture,t.useSmoothTextures,t.repeatTextures,t.useMipmapping,this._useSecondaryUV?n.secondaryUVVarying:n.uvVarying);switch(this._blendMode){case e.MULTIPLY:o+="mul "+r+", "+r+", "+l+"\n";break;case e.ADD:o+="add "+r+", "+r+", "+l+"\n";break}return o};e.MULTIPLY="multiply";e.ADD="add";return e}(a);e.exports=n},{"awayjs-stagegl/lib/materials/methods/EffectMethodBase":undefined,"awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper":undefined}],"awayjs-renderergl/lib/materials/methods/EffectRefractionEnvMapMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/methods/EffectMethodBase");var s=t("awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper");var n=function(t){r(e,t);function e(e,i,r,a,s){if(i===void 0){i=.1}if(r===void 0){r=0}if(a===void 0){a=0}if(s===void 0){s=0}t.call(this);this._dispersionR=0;this._dispersionG=0;this._dispersionB=0;this._alpha=1;this._envMap=e;this._dispersionR=r;this._dispersionG=a;this._dispersionB=s;this._useDispersion=!(this._dispersionR==this._dispersionB&&this._dispersionR==this._dispersionG);this._refractionIndex=i}e.prototype.iInitConstants=function(t,e){var i=e.fragmentConstantsIndex;var r=t.fragmentConstantData;r[i+4]=1;r[i+5]=0;r[i+7]=1};e.prototype.iInitVO=function(t,e){e.needsNormals=true;e.needsView=true};Object.defineProperty(e.prototype,"envMap",{get:function(){return this._envMap},set:function(t){this._envMap=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"refractionIndex",{get:function(){return this._refractionIndex},set:function(t){this._refractionIndex=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"dispersionR",{get:function(){return this._dispersionR},set:function(t){this._dispersionR=t;var e=!(this._dispersionR==this._dispersionB&&this._dispersionR==this._dispersionG);if(this._useDispersion!=e){this.iInvalidateShaderProgram();this._useDispersion=e}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"dispersionG",{get:function(){return this._dispersionG},set:function(t){this._dispersionG=t;var e=!(this._dispersionR==this._dispersionB&&this._dispersionR==this._dispersionG);if(this._useDispersion!=e){this.iInvalidateShaderProgram();this._useDispersion=e}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"dispersionB",{get:function(){return this._dispersionB},set:function(t){this._dispersionB=t;var e=!(this._dispersionR==this._dispersionB&&this._dispersionR==this._dispersionG);if(this._useDispersion!=e){this.iInvalidateShaderProgram();this._useDispersion=e}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha=t},enumerable:true,configurable:true});e.prototype.iActivate=function(t,e,i){var r=e.fragmentConstantsIndex;var a=t.fragmentConstantData;a[r]=this._dispersionR+this._refractionIndex;if(this._useDispersion){a[r+1]=this._dispersionG+this._refractionIndex;a[r+2]=this._dispersionB+this._refractionIndex}a[r+3]=this._alpha;i.context.activateCubeTexture(e.texturesIndex,this._envMap)};e.prototype.iGetFragmentCode=function(t,e,i,r,a){var n=r.getFreeFragmentConstant();var o=r.getFreeFragmentConstant();var h="";var l=r.getFreeTextureReg();var u;var p;var c;e.texturesIndex=l.index;e.fragmentConstantsIndex=n.index*4;u=r.getFreeFragmentVectorTemp();r.addFragmentTempUsages(u,1);p=r.getFreeFragmentVectorTemp();r.addFragmentTempUsages(p,1);c=r.getFreeFragmentVectorTemp();var d=a.viewDirFragment;var f=a.normalFragment;h+="neg "+d+".xyz, "+d+".xyz\n";h+="dp3 "+c+".x, "+d+".xyz, "+f+".xyz\n"+"mul "+c+".w, "+c+".x, "+c+".x\n"+"sub "+c+".w, "+o+".x, "+c+".w\n"+"mul "+c+".w, "+n+".x, "+c+".w\n"+"mul "+c+".w, "+n+".x, "+c+".w\n"+"sub "+c+".w, "+o+".x, "+c+".w\n"+"sqt "+c+".y, "+c+".w\n"+"mul "+c+".x, "+n+".x, "+c+".x\n"+"add "+c+".x, "+c+".x, "+c+".y\n"+"mul "+c+".xyz, "+c+".x, "+f+".xyz\n"+"mul "+u+", "+n+".x, "+d+"\n"+"sub "+u+".xyz, "+u+".xyz, "+c+".xyz\n"+"nrm "+u+".xyz, "+u+".xyz\n";h+=s.getTexCubeSampleCode(p,l,this._envMap,t.useSmoothTextures,t.useMipmapping,u)+"sub "+p+".w, "+p+".w, fc0.x	\n"+"kil "+p+".w\n";if(this._useDispersion){h+="dp3 "+c+".x, "+d+".xyz, "+f+".xyz\n"+"mul "+c+".w, "+c+".x, "+c+".x\n"+"sub "+c+".w, "+o+".x, "+c+".w\n"+"mul "+c+".w, "+n+".y, "+c+".w\n"+"mul "+c+".w, "+n+".y, "+c+".w\n"+"sub "+c+".w, "+o+".x, "+c+".w\n"+"sqt "+c+".y, "+c+".w\n"+"mul "+c+".x, "+n+".y, "+c+".x\n"+"add "+c+".x, "+c+".x, "+c+".y\n"+"mul "+c+".xyz, "+c+".x, "+f+".xyz\n"+"mul "+u+", "+n+".y, "+d+"\n"+"sub "+u+".xyz, "+u+".xyz, "+c+".xyz\n"+"nrm "+u+".xyz, "+u+".xyz\n";h+=s.getTexCubeSampleCode(c,l,this._envMap,t.useSmoothTextures,t.useMipmapping,u)+"mov "+p+".y, "+c+".y\n";h+="dp3 "+c+".x, "+d+".xyz, "+f+".xyz\n"+"mul "+c+".w, "+c+".x, "+c+".x\n"+"sub "+c+".w, "+o+".x, "+c+".w\n"+"mul "+c+".w, "+n+".z, "+c+".w\n"+"mul "+c+".w, "+n+".z, "+c+".w\n"+"sub "+c+".w, "+o+".x, "+c+".w\n"+"sqt "+c+".y, "+c+".w\n"+"mul "+c+".x, "+n+".z, "+c+".x\n"+"add "+c+".x, "+c+".x, "+c+".y\n"+"mul "+c+".xyz, "+c+".x, "+f+".xyz\n"+"mul "+u+", "+n+".z, "+d+"\n"+"sub "+u+".xyz, "+u+".xyz, "+c+".xyz\n"+"nrm "+u+".xyz, "+u+".xyz\n";h+=s.getTexCubeSampleCode(c,l,this._envMap,t.useSmoothTextures,t.useMipmapping,u)+"mov "+p+".z, "+c+".z\n"}r.removeFragmentTempUsage(u);h+="sub "+p+".xyz, "+p+".xyz, "+i+".xyz\n"+"mul "+p+".xyz, "+p+".xyz, "+n+".w\n"+"add "+i+".xyz, "+i+".xyz, "+p+".xyz\n";r.removeFragmentTempUsage(p);h+="neg "+d+".xyz, "+d+".xyz\n";return h};return e}(a);e.exports=n},{"awayjs-stagegl/lib/materials/methods/EffectMethodBase":undefined,"awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper":undefined}],"awayjs-renderergl/lib/materials/methods/EffectRimLightMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/methods/EffectMethodBase");var s=function(t){r(e,t);function e(e,i,r,a){if(e===void 0){e=16777215}if(i===void 0){i=.4}if(r===void 0){r=2}if(a===void 0){a="mix"}t.call(this);this._blendMode=a;this._strength=i;this._power=r;this.color=e}e.prototype.iInitConstants=function(t,e){t.fragmentConstantData[e.fragmentConstantsIndex+3]=1};e.prototype.iInitVO=function(t,e){e.needsNormals=true;e.needsView=true};Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._blendMode},set:function(t){if(this._blendMode==t)return;this._blendMode=t;this.iInvalidateShaderProgram()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){this._color=t;this._colorR=(t>>16&255)/255;this._colorG=(t>>8&255)/255;this._colorB=(t&255)/255},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"strength",{get:function(){return this._strength},set:function(t){this._strength=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"power",{get:function(){return this._power},set:function(t){this._power=t},enumerable:true,configurable:true});e.prototype.iActivate=function(t,e,i){var r=e.fragmentConstantsIndex;var a=t.fragmentConstantData;a[r]=this._colorR;a[r+1]=this._colorG;a[r+2]=this._colorB;a[r+4]=this._strength;a[r+5]=this._power};e.prototype.iGetFragmentCode=function(t,i,r,a,s){var n=a.getFreeFragmentConstant();var o=a.getFreeFragmentConstant();var h=a.getFreeFragmentVectorTemp();var l="";i.fragmentConstantsIndex=n.index*4;l+="dp3 "+h+".x, "+s.viewDirFragment+".xyz, "+s.normalFragment+".xyz\n"+"sat "+h+".x, "+h+".x\n"+"sub "+h+".x, "+n+".w, "+h+".x\n"+"pow "+h+".x, "+h+".x, "+o+".y\n"+"mul "+h+".x, "+h+".x, "+o+".x\n"+"sub "+h+".x, "+n+".w, "+h+".x\n"+"mul "+r+".xyz, "+r+".xyz, "+h+".x\n"+"sub "+h+".w, "+n+".w, "+h+".x\n";if(this._blendMode==e.ADD){l+="mul "+h+".xyz, "+h+".w, "+n+".xyz\n"+"add "+r+".xyz, "+r+".xyz, "+h+".xyz\n"}else if(this._blendMode==e.MULTIPLY){l+="mul "+h+".xyz, "+h+".w, "+n+".xyz\n"+"mul "+r+".xyz, "+r+".xyz, "+h+".xyz\n"}else{l+="sub "+h+".xyz, "+n+".xyz, "+r+".xyz\n"+"mul "+h+".xyz, "+h+".xyz, "+h+".w\n"+"add "+r+".xyz, "+r+".xyz, "+h+".xyz\n"}return l};e.ADD="add";e.MULTIPLY="multiply";e.MIX="mix";return e}(a);e.exports=s},{"awayjs-stagegl/lib/materials/methods/EffectMethodBase":undefined}],"awayjs-renderergl/lib/materials/methods/NormalHeightMapMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/methods/NormalBasicMethod");var s=t("awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper");var n=function(t){r(e,t);function e(e,i,r,a){t.call(this);this.normalMap=e;this._worldXYRatio=i/r;this._worldXZRatio=a/r}e.prototype.iInitConstants=function(t,e){var i=e.fragmentConstantsIndex;var r=t.fragmentConstantData;r[i]=1/this.normalMap.width;r[i+1]=1/this.normalMap.height;r[i+2]=0;r[i+3]=1;r[i+4]=this._worldXYRatio;r[i+5]=this._worldXZRatio};Object.defineProperty(e.prototype,"tangentSpace",{get:function(){return false},enumerable:true,configurable:true});e.prototype.copyFrom=function(e){t.prototype.copyFrom.call(this,e);this._worldXYRatio=e._worldXYRatio;this._worldXZRatio=e._worldXZRatio};e.prototype.iGetFragmentCode=function(t,e,i,r,a){var n=r.getFreeFragmentVectorTemp();var o=r.getFreeFragmentConstant();var h=r.getFreeFragmentConstant();this._pNormalTextureRegister=r.getFreeTextureReg();e.texturesIndex=this._pNormalTextureRegister.index;e.fragmentConstantsIndex=o.index*4;return s.getTex2DSampleCode(i,a,this._pNormalTextureRegister,this.normalMap,t.useSmoothTextures,t.repeatTextures,t.useMipmapping,a.uvVarying,"clamp")+"add "+n+", "+a.uvVarying+", "+o+".xzzz\n"+s.getTex2DSampleCode(n,a,this._pNormalTextureRegister,this.normalMap,t.useSmoothTextures,t.repeatTextures,t.useMipmapping,n,"clamp")+"sub "+i+".x, "+i+".x, "+n+".x\n"+"add "+n+", "+a.uvVarying+", "+o+".zyzz\n"+s.getTex2DSampleCode(n,a,this._pNormalTextureRegister,this.normalMap,t.useSmoothTextures,t.repeatTextures,t.useMipmapping,n,"clamp")+"sub "+i+".z, "+i+".z, "+n+".x\n"+"mov "+i+".y, "+o+".w\n"+"mul "+i+".xz, "+i+".xz, "+h+".xy\n"+"nrm "+i+".xyz, "+i+".xyz\n"};return e}(a);e.exports=n},{"awayjs-stagegl/lib/materials/methods/NormalBasicMethod":undefined,"awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper":undefined}],"awayjs-renderergl/lib/materials/methods/NormalSimpleWaterMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/methods/NormalBasicMethod");var s=t("awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper");var n=function(t){r(e,t);function e(e,i){t.call(this);this._useSecondNormalMap=false;this._water1OffsetX=0;this._water1OffsetY=0;this._water2OffsetX=0;this._water2OffsetY=0;this.normalMap=e;this.secondaryNormalMap=i}e.prototype.iInitConstants=function(t,e){var i=e.fragmentConstantsIndex;var r=t.fragmentConstantData;r[i]=.5;r[i+1]=0;r[i+2]=0;r[i+3]=1};e.prototype.iInitVO=function(e,i){t.prototype.iInitVO.call(this,e,i);this._useSecondNormalMap=this.normalMap!=this.secondaryNormalMap};Object.defineProperty(e.prototype,"water1OffsetX",{get:function(){return this._water1OffsetX},set:function(t){this._water1OffsetX=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"water1OffsetY",{get:function(){return this._water1OffsetY},set:function(t){this._water1OffsetY=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"water2OffsetX",{get:function(){return this._water2OffsetX},set:function(t){this._water2OffsetX=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"water2OffsetY",{get:function(){return this._water2OffsetY},set:function(t){this._water2OffsetY=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"secondaryNormalMap",{get:function(){return this._texture2},set:function(t){this._texture2=t},enumerable:true,configurable:true});e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this);this._normalTextureRegister2=null};e.prototype.dispose=function(){t.prototype.dispose.call(this);this._texture2=null};e.prototype.iActivate=function(e,i,r){t.prototype.iActivate.call(this,e,i,r);var a=e.fragmentConstantData;var s=i.fragmentConstantsIndex;a[s+4]=this._water1OffsetX;a[s+5]=this._water1OffsetY;a[s+6]=this._water2OffsetX;a[s+7]=this._water2OffsetY;if(this._useSecondNormalMap)r.context.activateTexture(i.texturesIndex+1,this._texture2)};e.prototype.iGetFragmentCode=function(t,e,i,r,a){var n=r.getFreeFragmentVectorTemp();var o=r.getFreeFragmentConstant();var h=r.getFreeFragmentConstant();this._pNormalTextureRegister=r.getFreeTextureReg();this._normalTextureRegister2=this._useSecondNormalMap?r.getFreeTextureReg():this._pNormalTextureRegister;e.texturesIndex=this._pNormalTextureRegister.index;e.fragmentConstantsIndex=o.index*4;return"add "+n+", "+a.uvVarying+", "+h+".xyxy\n"+s.getTex2DSampleCode(i,a,this._pNormalTextureRegister,this.normalMap,t.useSmoothTextures,t.repeatTextures,t.useMipmapping,n)+"add "+n+", "+a.uvVarying+", "+h+".zwzw\n"+s.getTex2DSampleCode(n,a,this._normalTextureRegister2,this._texture2,t.useSmoothTextures,t.repeatTextures,t.useMipmapping,n)+"add "+i+", "+i+", "+n+"		\n"+"mul "+i+", "+i+", "+o+".x	\n"+"sub "+i+".xyz, "+i+".xyz, "+a.commons+".xxx	\n"+"nrm "+i+".xyz, "+i+".xyz							\n"
};return e}(a);e.exports=n},{"awayjs-stagegl/lib/materials/methods/NormalBasicMethod":undefined,"awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper":undefined}],"awayjs-renderergl/lib/materials/methods/ShadowCascadeMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=t("awayjs-display/lib/entities/DirectionalLight");var n=t("awayjs-stagegl/lib/events/ShadingMethodEvent");var o=t("awayjs-stagegl/lib/materials/compilation/MethodVO");var h=t("awayjs-stagegl/lib/materials/methods/ShadowMapMethodBase");var l=function(t){r(e,t);function e(e){var i=this;t.call(this,e.castingLight);this._baseMethod=e;if(!(this._pCastingLight instanceof s))throw new Error("ShadowCascadeMethod is only compatible with DirectionalLight");this._cascadeShadowMapper=this._pCastingLight.shadowMapper;if(!this._cascadeShadowMapper)throw new Error("ShadowCascadeMethod requires a light that has a CascadeShadowMapper instance assigned to shadowMapper.");this._cascadeShadowMapper.addEventListener(a.CHANGE,function(t){return i.onCascadeChange(t)});this._baseMethod.addEventListener(n.SHADER_INVALIDATED,function(t){return i.onShaderInvalidated(t)})}Object.defineProperty(e.prototype,"baseMethod",{get:function(){return this._baseMethod},set:function(t){var e=this;if(this._baseMethod==t)return;this._baseMethod.removeEventListener(n.SHADER_INVALIDATED,function(t){return e.onShaderInvalidated(t)});this._baseMethod=t;this._baseMethod.addEventListener(n.SHADER_INVALIDATED,function(t){return e.onShaderInvalidated(t)});this.iInvalidateShaderProgram()},enumerable:true,configurable:true});e.prototype.iInitVO=function(t,e){var i=new o(this._baseMethod);this._baseMethod.iInitVO(t,i);e.needsGlobalVertexPos=true;e.needsProjection=true};e.prototype.iInitConstants=function(t,e){var i=t.fragmentConstantData;var r=t.vertexConstantData;var a=e.fragmentConstantsIndex;i[a]=1;i[a+1]=1/255;i[a+2]=1/65025;i[a+3]=1/16581375;i[a+6]=.5;i[a+7]=-.5;a=e.vertexConstantsIndex;r[a]=.5;r[a+1]=-.5;r[a+2]=0};e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this);this._cascadeProjections=null;this._depthMapCoordVaryings=null};e.prototype.iGetVertexCode=function(t,e,i,r){var a="";var s=i.getFreeVertexConstant();this.initProjectionsRegs(i);e.vertexConstantsIndex=s.index*4;var n=i.getFreeVertexVectorTemp();for(var o=0;o<this._cascadeShadowMapper.numCascades;++o){a+="m44 "+n+", "+r.globalPositionVertex+", "+this._cascadeProjections[o]+"\n"+"add "+this._depthMapCoordVaryings[o]+", "+n+", "+s+".zzwz\n"}return a};e.prototype.initProjectionsRegs=function(t){this._cascadeProjections=new Array(this._cascadeShadowMapper.numCascades);this._depthMapCoordVaryings=new Array(this._cascadeShadowMapper.numCascades);for(var e=0;e<this._cascadeShadowMapper.numCascades;++e){this._depthMapCoordVaryings[e]=t.getFreeVarying();this._cascadeProjections[e]=t.getFreeVertexConstant();t.getFreeVertexConstant();t.getFreeVertexConstant();t.getFreeVertexConstant()}};e.prototype.iGetFragmentCode=function(t,e,i,r,a){var s=this._cascadeShadowMapper.numCascades;var n=r.getFreeTextureReg();var o=r.getFreeFragmentConstant();var h=r.getFreeFragmentConstant();var l=r.getFreeFragmentConstant();var u=Array(l+".x",l+".y",l+".z",l+".w");var p;e.fragmentConstantsIndex=o.index*4;e.texturesIndex=n.index;var c=r.getFreeFragmentVectorTemp();r.addFragmentTempUsages(c,1);var d=r.getFreeFragmentVectorTemp();r.addFragmentTempUsages(d,1);p="mov "+d+", "+this._depthMapCoordVaryings[s-1]+"\n";for(var f=s-2;f>=0;--f){var _=this._depthMapCoordVaryings[f];p+="slt "+c+".z, "+a.projectionFragment+".z, "+u[f]+"\n";var y=r.getFreeFragmentVectorTemp();p+="sub "+y+", "+_+", "+d+"\n"+"mul "+y+", "+y+", "+c+".z\n"+"add "+d+", "+d+", "+y+"\n"}r.removeFragmentTempUsage(c);p+="div "+d+", "+d+", "+d+".w\n"+"mul "+d+".xy, "+d+".xy, "+h+".zw\n"+"add "+d+".xy, "+d+".xy, "+h+".zz\n";p+=this._baseMethod._iGetCascadeFragmentCode(t,e,o,n,d,i,r,a)+"add "+i+".w, "+i+".w, "+h+".y\n";r.removeFragmentTempUsage(d);return p};e.prototype.iActivate=function(t,e,i){i.context.activateTexture(e.texturesIndex,this._pCastingLight.shadowMapper.depthMap);var r=t.vertexConstantData;var a=e.vertexConstantsIndex;t.vertexConstantData[e.vertexConstantsIndex+3]=-1/(this._cascadeShadowMapper.depth*this._pEpsilon);var s=this._cascadeShadowMapper.numCascades;a+=4;for(var n=0;n<s;++n){this._cascadeShadowMapper.getDepthProjections(n).copyRawDataTo(r,a,true);a+=16}var o=t.fragmentConstantData;var h=e.fragmentConstantsIndex;o[h+5]=1-this._pAlpha;var l=this._cascadeShadowMapper._iNearPlaneDistances;h+=8;for(var u=0;u<s;++u)o[h+u]=l[u];this._baseMethod.iActivateForCascade(t,e,i)};e.prototype.iSetRenderState=function(t,e,i,r,a){};e.prototype.onCascadeChange=function(t){this.iInvalidateShaderProgram()};e.prototype.onShaderInvalidated=function(t){this.iInvalidateShaderProgram()};return e}(h);e.exports=l},{"awayjs-core/lib/events/Event":undefined,"awayjs-display/lib/entities/DirectionalLight":undefined,"awayjs-stagegl/lib/events/ShadingMethodEvent":undefined,"awayjs-stagegl/lib/materials/compilation/MethodVO":undefined,"awayjs-stagegl/lib/materials/methods/ShadowMapMethodBase":undefined}],"awayjs-renderergl/lib/materials/methods/ShadowDitheredMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/base/BitmapData");var s=t("awayjs-core/lib/textures/BitmapTexture");var n=t("awayjs-stagegl/lib/materials/methods/ShadowMethodBase");var o=function(t){r(e,t);function e(i,r,a){if(r===void 0){r=4}if(a===void 0){a=1}t.call(this,i);this._depthMapSize=this._pCastingLight.shadowMapper.depthMapSize;this.numSamples=r;this.range=a;++e._grainUsages;if(!e._grainTexture)this.initGrainTexture()}Object.defineProperty(e.prototype,"numSamples",{get:function(){return this._numSamples},set:function(t){this._numSamples=t;if(this._numSamples<1)this._numSamples=1;else if(this._numSamples>24)this._numSamples=24;this.iInvalidateShaderProgram()},enumerable:true,configurable:true});e.prototype.iInitVO=function(e,i){t.prototype.iInitVO.call(this,e,i);i.needsProjection=true};e.prototype.iInitConstants=function(e,i){t.prototype.iInitConstants.call(this,e,i);var r=e.fragmentConstantData;var a=i.fragmentConstantsIndex;r[a+8]=1/this._numSamples};Object.defineProperty(e.prototype,"range",{get:function(){return this._range*2},set:function(t){this._range=t/2},enumerable:true,configurable:true});e.prototype.initGrainTexture=function(){e._grainBitmapData=new a(64,64,false);var t=new Array;var i=4096;var r=1/(this._depthMapSize*this._range);var n,o;for(var h=0;h<i;++h){n=2*(Math.random()-.5);o=2*(Math.random()-.5);if(n<0)n-=r;else n+=r;if(o<0)o-=r;else o+=r;if(n>1)n=1;else if(n<-1)n=-1;if(o>1)o=1;else if(o<-1)o=-1;t[h]=Math.floor((n*.5+.5)*255)<<16|Math.floor((o*.5+.5)*255)<<8}e._grainBitmapData.setVector(e._grainBitmapData.rect,t);e._grainTexture=new s(e._grainBitmapData)};e.prototype.dispose=function(){if(--e._grainUsages==0){e._grainTexture.dispose();e._grainBitmapData.dispose();e._grainTexture=null}};e.prototype.iActivate=function(i,r,a){t.prototype.iActivate.call(this,i,r,a);var s=i.fragmentConstantData;var n=r.fragmentConstantsIndex;s[n+9]=(a.width-1)/63;s[n+10]=(a.height-1)/63;s[n+11]=2*this._range/this._depthMapSize;a.context.activateTexture(r.texturesIndex+1,e._grainTexture)};e.prototype._pGetPlanarFragmentCode=function(t,e,i,r){var a=i.getFreeTextureReg();var s=i.getFreeFragmentConstant();var n=i.getFreeFragmentConstant();var o=i.getFreeFragmentConstant();t.fragmentConstantsIndex=s.index*4;t.texturesIndex=a.index;return this.getSampleCode(o,a,s,e,i,r)};e.prototype.getSampleCode=function(t,e,i,r,a,s){var n="";var o=a.getFreeTextureReg();var h=a.getFreeFragmentVectorTemp();var l=this._numSamples;a.addFragmentTempUsages(h,1);var u=a.getFreeFragmentVectorTemp();var p=s.projectionFragment;n+="div "+h+", "+p+", "+p+".w\n"+"mul "+h+".xy, "+h+".xy, "+t+".yz\n";while(l>0){if(l==this._numSamples)n+="tex "+h+", "+h+", "+o+" <2d,nearest,repeat,mipnone>\n";else n+="tex "+h+", "+h+".zwxy, "+o+" <2d,nearest,repeat,mipnone>\n";n+="sub "+h+".zw, "+h+".xy, fc0.xx\n"+"mul "+h+".zw, "+h+".zw, "+t+".w\n";if(l==this._numSamples){n+="add "+h+".xy, "+h+".zw, "+this._pDepthMapCoordReg+".xy\n"+"tex "+u+", "+h+", "+e+" <2d,nearest,clamp,mipnone>\n"+"dp4 "+u+".z, "+u+", "+i+"\n"+"slt "+r+".w, "+this._pDepthMapCoordReg+".z, "+u+".z\n"}else{n+=this.addSample(h,e,i,r,a)}if(l>4)n+="add "+h+".xy, "+h+".xy, "+h+".zw\n"+this.addSample(h,e,i,r,a);if(l>1)n+="sub "+h+".xy, "+this._pDepthMapCoordReg+".xy, "+h+".zw\n"+this.addSample(h,e,i,r,a);if(l>5)n+="sub "+h+".xy, "+h+".xy, "+h+".zw\n"+this.addSample(h,e,i,r,a);if(l>2){n+="neg "+h+".w, "+h+".w\n";n+="add "+h+".xy, "+h+".wz, "+this._pDepthMapCoordReg+".xy\n"+this.addSample(h,e,i,r,a)}if(l>6)n+="add "+h+".xy, "+h+".xy, "+h+".wz\n"+this.addSample(h,e,i,r,a);if(l>3)n+="sub "+h+".xy, "+this._pDepthMapCoordReg+".xy, "+h+".wz\n"+this.addSample(h,e,i,r,a);if(l>7)n+="sub "+h+".xy, "+h+".xy, "+h+".wz\n"+this.addSample(h,e,i,r,a);l-=8}a.removeFragmentTempUsage(h);n+="mul "+r+".w, "+r+".w, "+t+".x\n";return n};e.prototype.addSample=function(t,e,i,r,a){var s=a.getFreeFragmentVectorTemp();return"tex "+s+", "+t+", "+e+" <2d,nearest,clamp,mipnone>\n"+"dp4 "+s+".z, "+s+", "+i+"\n"+"slt "+s+".z, "+this._pDepthMapCoordReg+".z, "+s+".z\n"+"add "+r+".w, "+r+".w, "+s+".z\n"};e.prototype.iActivateForCascade=function(t,i,r){var a=t.fragmentConstantData;var s=i.secondaryFragmentConstantsIndex;a[s]=1/this._numSamples;a[s+1]=(r.width-1)/63;a[s+2]=(r.height-1)/63;a[s+3]=2*this._range/this._depthMapSize;r.context.activateTexture(i.texturesIndex+1,e._grainTexture)};e.prototype._iGetCascadeFragmentCode=function(t,e,i,r,a,s,n,o){this._pDepthMapCoordReg=a;var h=n.getFreeFragmentConstant();e.secondaryFragmentConstantsIndex=h.index*4;return this.getSampleCode(h,r,i,s,n,o)};return e}(n);e.exports=o},{"awayjs-core/lib/base/BitmapData":undefined,"awayjs-core/lib/textures/BitmapTexture":undefined,"awayjs-stagegl/lib/materials/methods/ShadowMethodBase":undefined}],"awayjs-renderergl/lib/materials/methods/ShadowFilteredMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/methods/ShadowMethodBase");var s=function(t){r(e,t);function e(e){t.call(this,e)}e.prototype.iInitConstants=function(e,i){t.prototype.iInitConstants.call(this,e,i);var r=e.fragmentConstantData;var a=i.fragmentConstantsIndex;r[a+8]=.5;var s=this.castingLight.shadowMapper.depthMapSize;r[a+9]=s;r[a+10]=1/s};e.prototype._pGetPlanarFragmentCode=function(t,e,i,r){var a=i.getFreeTextureReg();var s=i.getFreeFragmentConstant();var n=i.getFreeFragmentConstant();n=n;var o=i.getFreeFragmentConstant();var h=i.getFreeFragmentVectorTemp();var l;var u="";t.fragmentConstantsIndex=s.index*4;i.addFragmentTempUsages(h,1);l=i.getFreeFragmentVectorTemp();i.addFragmentTempUsages(l,1);u+="mov "+l+", "+this._pDepthMapCoordReg+"\n"+"tex "+h+", "+this._pDepthMapCoordReg+", "+a+" <2d, nearest, clamp>\n"+"dp4 "+h+".z, "+h+", "+s+"\n"+"slt "+l+".z, "+this._pDepthMapCoordReg+".z, "+h+".z\n"+"add "+l+".x, "+this._pDepthMapCoordReg+".x, "+o+".z\n"+"tex "+h+", "+l+", "+a+" <2d, nearest, clamp>\n"+"dp4 "+h+".z, "+h+", "+s+"\n"+"slt "+l+".w, "+this._pDepthMapCoordReg+".z, "+h+".z\n"+"mul "+h+".x, "+this._pDepthMapCoordReg+".x, "+o+".y\n"+"frc "+h+".x, "+h+".x\n"+"sub "+l+".w, "+l+".w, "+l+".z\n"+"mul "+l+".w, "+l+".w, "+h+".x\n"+"add "+e+".w, "+l+".z, "+l+".w\n"+"mov "+l+".x, "+this._pDepthMapCoordReg+".x\n"+"add "+l+".y, "+this._pDepthMapCoordReg+".y, "+o+".z\n"+"tex "+h+", "+l+", "+a+" <2d, nearest, clamp>\n"+"dp4 "+h+".z, "+h+", "+s+"\n"+"slt "+l+".z, "+this._pDepthMapCoordReg+".z, "+h+".z\n"+"add "+l+".x, "+this._pDepthMapCoordReg+".x, "+o+".z\n"+"tex "+h+", "+l+", "+a+" <2d, nearest, clamp>\n"+"dp4 "+h+".z, "+h+", "+s+"\n"+"slt "+l+".w, "+this._pDepthMapCoordReg+".z, "+h+".z\n"+"mul "+h+".x, "+this._pDepthMapCoordReg+".x, "+o+".y\n"+"frc "+h+".x, "+h+".x\n"+"sub "+l+".w, "+l+".w, "+l+".z\n"+"mul "+l+".w, "+l+".w, "+h+".x\n"+"add "+l+".w, "+l+".z, "+l+".w\n"+"mul "+h+".x, "+this._pDepthMapCoordReg+".y, "+o+".y\n"+"frc "+h+".x, "+h+".x\n"+"sub "+l+".w, "+l+".w, "+e+".w\n"+"mul "+l+".w, "+l+".w, "+h+".x\n"+"add "+e+".w, "+e+".w, "+l+".w\n";i.removeFragmentTempUsage(h);i.removeFragmentTempUsage(l);t.texturesIndex=a.index;return u};e.prototype.iActivateForCascade=function(t,e,i){var r=this.castingLight.shadowMapper.depthMapSize;var a=e.secondaryFragmentConstantsIndex;var s=t.fragmentConstantData;s[a]=r;s[a+1]=1/r};e.prototype._iGetCascadeFragmentCode=function(t,e,i,r,a,s,n,o){var h;var l=n.getFreeFragmentConstant();e.secondaryFragmentConstantsIndex=l.index*4;var u=n.getFreeFragmentVectorTemp();n.addFragmentTempUsages(u,1);var p=n.getFreeFragmentVectorTemp();n.addFragmentTempUsages(p,1);h="tex "+u+", "+a+", "+r+" <2d, nearest, clamp>\n"+"dp4 "+u+".z, "+u+", "+i+"\n"+"slt "+p+".x, "+a+".z, "+u+".z\n"+"add "+a+".x, "+a+".x, "+l+".y\n"+"tex "+u+", "+a+", "+r+" <2d, nearest, clamp>\n"+"dp4 "+u+".z, "+u+", "+i+"\n"+"slt "+p+".z, "+a+".z, "+u+".z\n"+"add "+a+".y, "+a+".y, "+l+".y\n"+"tex "+u+", "+a+", "+r+" <2d, nearest, clamp>\n"+"dp4 "+u+".z, "+u+", "+i+"\n"+"slt "+p+".w, "+a+".z, "+u+".z\n"+"sub "+a+".x, "+a+".x, "+l+".y\n"+"tex "+u+", "+a+", "+r+" <2d, nearest, clamp>\n"+"dp4 "+u+".z, "+u+", "+i+"\n"+"slt "+p+".y, "+a+".z, "+u+".z\n"+"mul "+u+".xy, "+a+".xy, "+l+".x\n"+"frc "+u+".xy, "+u+".xy\n"+"sub "+a+", "+p+".xyzw, "+p+".zwxy\n"+"mul "+a+", "+a+", "+u+".x\n"+"add "+p+".xy, "+p+".xy, "+a+".zw\n"+"sub "+p+".y, "+p+".y, "+p+".x\n"+"mul "+p+".y, "+p+".y, "+u+".y\n"+"add "+s+".w, "+p+".x, "+p+".y\n";n.removeFragmentTempUsage(u);n.removeFragmentTempUsage(p);return h};return e}(a);e.exports=s},{"awayjs-stagegl/lib/materials/methods/ShadowMethodBase":undefined}],"awayjs-renderergl/lib/materials/methods/ShadowNearMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/events/ShadingMethodEvent");var s=t("awayjs-stagegl/lib/materials/methods/ShadowMethodBase");var n=function(t){r(e,t);function e(e,i){var r=this;if(i===void 0){i=.1}t.call(this,e.castingLight);this._onShaderInvalidatedDelegate=function(t){return r.onShaderInvalidated(t)};this._baseMethod=e;this._fadeRatio=i;this._nearShadowMapper=this._pCastingLight.shadowMapper;if(!this._nearShadowMapper)throw new Error("ShadowNearMethod requires a light that has a NearDirectionalShadowMapper instance assigned to shadowMapper.");this._baseMethod.addEventListener(a.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate)}Object.defineProperty(e.prototype,"baseMethod",{get:function(){return this._baseMethod},set:function(t){if(this._baseMethod==t)return;this._baseMethod.removeEventListener(a.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate);this._baseMethod=t;this._baseMethod.addEventListener(a.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate);this.iInvalidateShaderProgram()},enumerable:true,configurable:true});e.prototype.iInitConstants=function(e,i){t.prototype.iInitConstants.call(this,e,i);this._baseMethod.iInitConstants(e,i);var r=e.fragmentConstantData;var a=i.secondaryFragmentConstantsIndex;r[a+2]=0;r[a+3]=1};e.prototype.iInitVO=function(t,e){this._baseMethod.iInitVO(t,e);e.needsProjection=true};e.prototype.dispose=function(){this._baseMethod.removeEventListener(a.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate)};Object.defineProperty(e.prototype,"alpha",{get:function(){return this._baseMethod.alpha},set:function(t){this._baseMethod.alpha=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"epsilon",{get:function(){return this._baseMethod.epsilon},set:function(t){this._baseMethod.epsilon=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"fadeRatio",{get:function(){return this._fadeRatio},set:function(t){this._fadeRatio=t},enumerable:true,configurable:true});e.prototype.iGetFragmentCode=function(t,e,i,r,a){var s=this._baseMethod.iGetFragmentCode(t,e,i,r,a);var n=r.getFreeFragmentConstant();var o=r.getFreeFragmentSingleTemp();e.secondaryFragmentConstantsIndex=n.index*4;s+="abs "+o+", "+a.projectionFragment+".w\n"+"sub "+o+", "+o+", "+n+".x\n"+"mul "+o+", "+o+", "+n+".y\n"+"sat "+o+", "+o+"\n"+"sub "+o+", "+n+".w,"+o+"\n"+"sub "+i+".w, "+n+".w,"+i+".w\n"+"mul "+i+".w, "+i+".w, "+o+"\n"+"sub "+i+".w, "+n+".w,"+i+".w\n";return s};e.prototype.iActivate=function(t,e,i){this._baseMethod.iActivate(t,e,i)};e.prototype.iDeactivate=function(t,e,i){this._baseMethod.iDeactivate(t,e,i)};e.prototype.iSetRenderState=function(t,e,i,r,a){var s=a.projection.near;var n=a.projection.far-s;var o=this._nearShadowMapper.coverageRatio;var h=o*(1-this._fadeRatio);o=s+o*n;h=s+h*n;var l=t.fragmentConstantData;var u=e.secondaryFragmentConstantsIndex;l[u]=h;l[u+1]=1/(o-h);this._baseMethod.iSetRenderState(t,e,i,r,a)};e.prototype.iGetVertexCode=function(t,e,i,r){return this._baseMethod.iGetVertexCode(t,e,i,r)};e.prototype.iReset=function(){this._baseMethod.iReset()};e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this);this._baseMethod.iCleanCompilationData()};e.prototype.onShaderInvalidated=function(t){this.iInvalidateShaderProgram()};return e}(s);e.exports=n},{"awayjs-stagegl/lib/events/ShadingMethodEvent":undefined,"awayjs-stagegl/lib/materials/methods/ShadowMethodBase":undefined}],"awayjs-renderergl/lib/materials/methods/ShadowSoftMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/PoissonLookup");var s=t("awayjs-stagegl/lib/materials/methods/ShadowMethodBase");var n=function(t){r(e,t);function e(e,i,r){if(i===void 0){i=5}if(r===void 0){r=1}t.call(this,e);this._range=1;this.numSamples=i;this.range=r}Object.defineProperty(e.prototype,"numSamples",{get:function(){return this._numSamples},set:function(t){this._numSamples=t;if(this._numSamples<1)this._numSamples=1;else if(this._numSamples>32)this._numSamples=32;this._offsets=a.getDistribution(this._numSamples);this.iInvalidateShaderProgram()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"range",{get:function(){return this._range},set:function(t){this._range=t},enumerable:true,configurable:true});e.prototype.iInitConstants=function(e,i){t.prototype.iInitConstants.call(this,e,i);e.fragmentConstantData[i.fragmentConstantsIndex+8]=1/this._numSamples;e.fragmentConstantData[i.fragmentConstantsIndex+9]=0};e.prototype.iActivate=function(e,i,r){t.prototype.iActivate.call(this,e,i,r);var a=.5*this._range/this._pCastingLight.shadowMapper.depthMapSize;var s=e.fragmentConstantData;var n=i.fragmentConstantsIndex+10;var o=this._numSamples<<1;for(var h=0;h<o;++h)s[n+h]=this._offsets[h]*a};e.prototype._pGetPlanarFragmentCode=function(t,e,i,r){var a=i.getFreeTextureReg();var s=i.getFreeFragmentConstant();var n=i.getFreeFragmentConstant();var o=i.getFreeFragmentConstant();t.fragmentConstantsIndex=s.index*4;t.texturesIndex=a.index;return this.getSampleCode(i,a,s,e,o)};e.prototype.addSample=function(t,e,i,r,a){var s=a.getFreeFragmentVectorTemp();return"tex "+s+", "+t+", "+e+" <2d,nearest,clamp>\n"+"dp4 "+s+".z, "+s+", "+i+"\n"+"slt "+t+".w, "+this._pDepthMapCoordReg+".z, "+s+".z\n"+"add "+r+".w, "+r+".w, "+t+".w\n"};e.prototype.iActivateForCascade=function(e,i,r){t.prototype.iActivate.call(this,e,i,r);var a=this._range/this._pCastingLight.shadowMapper.depthMapSize;var s=e.fragmentConstantData;var n=i.secondaryFragmentConstantsIndex;var o=this._numSamples<<1;s[n]=1/this._numSamples;s[n+1]=0;n+=2;for(var h=0;h<o;++h)s[n+h]=this._offsets[h]*a;if(o%4==0){s[n+o]=0;s[n+o+1]=0}};e.prototype._iGetCascadeFragmentCode=function(t,e,i,r,a,s,n,o){this._pDepthMapCoordReg=a;var h=n.getFreeFragmentConstant();e.secondaryFragmentConstantsIndex=h.index*4;return this.getSampleCode(n,r,i,s,h)};e.prototype.getSampleCode=function(t,e,i,r,a){var s;var n;var o=new Array(a+".zw");s=t.getFreeFragmentVectorTemp();t.addFragmentTempUsages(s,1);var h=t.getFreeFragmentVectorTemp();var l=this._numSamples>>1;for(var u=0;u<l;++u){var p=t.getFreeFragmentConstant();o.push(p+".xy");o.push(p+".zw")}for(u=0;u<this._numSamples;++u){if(u==0){n="add "+s+", "+this._pDepthMapCoordReg+", "+a+".zwyy\n"+"tex "+h+", "+s+", "+e+" <2d,nearest,clamp>\n"+"dp4 "+h+".z, "+h+", "+i+"\n"+"slt "+r+".w, "+this._pDepthMapCoordReg+".z, "+h+".z\n"}else{n+="add "+s+".xy, "+this._pDepthMapCoordReg+".xy, "+o[u]+"\n"+this.addSample(s,e,i,r,t)}}t.removeFragmentTempUsage(s);n+="mul "+r+".w, "+r+".w, "+a+".x\n";return n};return e}(s);e.exports=n},{"awayjs-core/lib/geom/PoissonLookup":undefined,"awayjs-stagegl/lib/materials/methods/ShadowMethodBase":undefined}],"awayjs-renderergl/lib/materials/methods/SpecularAnisotropicMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/methods/SpecularBasicMethod");var s=function(t){r(e,t);function e(){t.call(this)}e.prototype.iInitVO=function(t,e){e.needsTangents=true;e.needsView=true};e.prototype.iGetFragmentCodePerLight=function(t,e,i,r,a,s){var n="";var o;if(this._pIsFirstLight)o=this._pTotalLightColorReg;else{o=a.getFreeFragmentVectorTemp();a.addFragmentTempUsages(o,1)}n+="nrm "+o+".xyz, "+s.tangentVarying+".xyz\n"+"dp3 "+o+".w, "+o+".xyz, "+i+".xyz\n"+"dp3 "+o+".z, "+o+".xyz, "+s.viewDirFragment+".xyz\n";n+="sin "+o+".x, "+o+".w\n"+"sin "+o+".y, "+o+".z\n"+"mul "+o+".x, "+o+".x, "+o+".y\n"+"cos "+o+".z, "+o+".z\n"+"cos "+o+".w, "+o+".w\n"+"mul "+o+".w, "+o+".w, "+o+".z\n"+"sub "+o+".w, "+o+".x, "+o+".w\n";if(this._pUseTexture){n+="mul "+this._pSpecularTexData+".w, "+this._pSpecularTexData+".y, "+this._pSpecularDataRegister+".w\n"+"pow "+o+".w, "+o+".w, "+this._pSpecularTexData+".w\n"}else n+="pow "+o+".w, "+o+".w, "+this._pSpecularDataRegister+".w\n";n+="mul "+o+".w, "+o+".w, "+i+".w\n";if(this._iModulateMethod!=null)n+=this._iModulateMethod(t,e,o,a,s);n+="mul "+o+".xyz, "+r+".xyz, "+o+".w\n";if(!this._pIsFirstLight){n+="add "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+".xyz, "+o+".xyz\n";a.removeFragmentTempUsage(o)}this._pIsFirstLight=false;return n};return e}(a);e.exports=s},{"awayjs-stagegl/lib/materials/methods/SpecularBasicMethod":undefined}],"awayjs-renderergl/lib/materials/methods/SpecularCelMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-renderergl/lib/materials/methods/SpecularCompositeMethod");var s=function(t){r(e,t);function e(e,i){var r=this;if(e===void 0){e=.5}if(i===void 0){i=null}t.call(this,null,i);this._smoothness=.1;this._specularCutOff=.1;this.baseMethod._iModulateMethod=function(t,e,i,a,s){return r.clampSpecular(t,e,i,a,s)};this._specularCutOff=e}Object.defineProperty(e.prototype,"smoothness",{get:function(){return this._smoothness},set:function(t){this._smoothness=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"specularCutOff",{get:function(){return this._specularCutOff},set:function(t){this._specularCutOff=t},enumerable:true,configurable:true});e.prototype.iActivate=function(e,i,r){t.prototype.iActivate.call(this,e,i,r);var a=i.secondaryFragmentConstantsIndex;var s=e.fragmentConstantData;s[a]=this._smoothness;s[a+1]=this._specularCutOff};e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this);this._dataReg=null};e.prototype.clampSpecular=function(t,e,i,r,a){return"sub "+i+".y, "+i+".w, "+this._dataReg+".y\n"+"div "+i+".y, "+i+".y, "+this._dataReg+".x\n"+"sat "+i+".y, "+i+".y\n"+"sge "+i+".w, "+i+".w, "+this._dataReg+".y\n"+"mul "+i+".w, "+i+".w, "+i+".y\n"};e.prototype.iGetFragmentPreLightingCode=function(e,i,r,a){this._dataReg=r.getFreeFragmentConstant();i.secondaryFragmentConstantsIndex=this._dataReg.index*4;return t.prototype.iGetFragmentPreLightingCode.call(this,e,i,r,a)};return e}(a);e.exports=s},{"awayjs-renderergl/lib/materials/methods/SpecularCompositeMethod":undefined}],"awayjs-renderergl/lib/materials/methods/SpecularCompositeMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/events/ShadingMethodEvent");var s=t("awayjs-stagegl/lib/materials/methods/SpecularBasicMethod");var n=function(t){r(e,t);function e(e,i){var r=this;if(i===void 0){i=null}t.call(this);this._onShaderInvalidatedDelegate=function(t){return r.onShaderInvalidated(t)};this._baseMethod=i||new s;this._baseMethod._iModulateMethod=e;this._baseMethod.addEventListener(a.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate)}e.prototype.iInitVO=function(t,e){this._baseMethod.iInitVO(t,e)};e.prototype.iInitConstants=function(t,e){this._baseMethod.iInitConstants(t,e)};Object.defineProperty(e.prototype,"baseMethod",{get:function(){return this._baseMethod},set:function(t){if(this._baseMethod==t)return;this._baseMethod.removeEventListener(a.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate);this._baseMethod=t;this._baseMethod.addEventListener(a.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate);this.iInvalidateShaderProgram()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"gloss",{get:function(){return this._baseMethod.gloss},set:function(t){this._baseMethod.gloss=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"specular",{get:function(){return this._baseMethod.specular},set:function(t){this._baseMethod.specular=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"passes",{get:function(){return this._baseMethod.passes},enumerable:true,configurable:true});e.prototype.dispose=function(){this._baseMethod.removeEventListener(a.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate);this._baseMethod.dispose()};Object.defineProperty(e.prototype,"texture",{get:function(){return this._baseMethod.texture},set:function(t){this._baseMethod.texture=t},enumerable:true,configurable:true});e.prototype.iActivate=function(t,e,i){this._baseMethod.iActivate(t,e,i)};e.prototype.iSetRenderState=function(t,e,i,r,a){this._baseMethod.iSetRenderState(t,e,i,r,a)};e.prototype.iDeactivate=function(t,e,i){this._baseMethod.iDeactivate(t,e,i)};e.prototype.iGetVertexCode=function(t,e,i,r){return this._baseMethod.iGetVertexCode(t,e,i,r)};e.prototype.iGetFragmentPreLightingCode=function(t,e,i,r){return this._baseMethod.iGetFragmentPreLightingCode(t,e,i,r)};e.prototype.iGetFragmentCodePerLight=function(t,e,i,r,a,s){return this._baseMethod.iGetFragmentCodePerLight(t,e,i,r,a,s)};e.prototype.iGetFragmentCodePerProbe=function(t,e,i,r,a,s){return this._baseMethod.iGetFragmentCodePerProbe(t,e,i,r,a,s)};e.prototype.iGetFragmentPostLightingCode=function(t,e,i,r,a){return this._baseMethod.iGetFragmentPostLightingCode(t,e,i,r,a)};e.prototype.iReset=function(){this._baseMethod.iReset()};e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this);this._baseMethod.iCleanCompilationData()};e.prototype.onShaderInvalidated=function(t){this.iInvalidateShaderProgram()};return e}(s);e.exports=n},{"awayjs-stagegl/lib/events/ShadingMethodEvent":undefined,"awayjs-stagegl/lib/materials/methods/SpecularBasicMethod":undefined}],"awayjs-renderergl/lib/materials/methods/SpecularFresnelMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-renderergl/lib/materials/methods/SpecularCompositeMethod");var s=function(t){r(e,t);function e(e,i){var r=this;if(e===void 0){e=true}if(i===void 0){i=null}t.call(this,null,i);this._fresnelPower=5;this._normalReflectance=.028;this.baseMethod._iModulateMethod=function(t,e,i,a,s){return r.modulateSpecular(t,e,i,a,s)};this._incidentLight=!e}e.prototype.iInitConstants=function(t,e){var i=e.secondaryFragmentConstantsIndex;t.fragmentConstantData[i+2]=1;t.fragmentConstantData[i+3]=0};Object.defineProperty(e.prototype,"basedOnSurface",{get:function(){return!this._incidentLight},set:function(t){if(this._incidentLight!=t)return;this._incidentLight=!t;this.iInvalidateShaderProgram()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"fresnelPower",{get:function(){return this._fresnelPower},set:function(t){this._fresnelPower=t},enumerable:true,configurable:true});e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this);this._dataReg=null};Object.defineProperty(e.prototype,"normalReflectance",{get:function(){return this._normalReflectance},set:function(t){this._normalReflectance=t},enumerable:true,configurable:true});e.prototype.iActivate=function(e,i,r){t.prototype.iActivate.call(this,e,i,r);var a=e.fragmentConstantData;var s=i.secondaryFragmentConstantsIndex;a[s]=this._normalReflectance;a[s+1]=this._fresnelPower};e.prototype.iGetFragmentPreLightingCode=function(e,i,r,a){this._dataReg=r.getFreeFragmentConstant();console.log("SpecularFresnelMethod","iGetFragmentPreLightingCode",this._dataReg);i.secondaryFragmentConstantsIndex=this._dataReg.index*4;return t.prototype.iGetFragmentPreLightingCode.call(this,e,i,r,a)};e.prototype.modulateSpecular=function(t,e,i,r,a){var s;s="dp3 "+i+".y, "+a.viewDirFragment+".xyz, "+(this._incidentLight?i:a.normalFragment)+".xyz\n"+"sub "+i+".y, "+this._dataReg+".z, "+i+".y\n"+"pow "+i+".x, "+i+".y, "+this._dataReg+".y\n"+"sub "+i+".y, "+this._dataReg+".z, "+i+".y\n"+"mul "+i+".y, "+this._dataReg+".x, "+i+".y\n"+"add "+i+".y, "+i+".x, "+i+".y\n"+"mul "+i+".w, "+i+".w, "+i+".y\n";console.log("SpecularFresnelMethod","modulateSpecular",s);return s};return e}(a);e.exports=s},{"awayjs-renderergl/lib/materials/methods/SpecularCompositeMethod":undefined}],"awayjs-renderergl/lib/materials/methods/SpecularPhongMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/methods/SpecularBasicMethod");var s=function(t){r(e,t);function e(){t.call(this)}e.prototype.iGetFragmentCodePerLight=function(t,e,i,r,a,s){var n="";var o;if(this._pIsFirstLight){o=this._pTotalLightColorReg}else{o=a.getFreeFragmentVectorTemp();a.addFragmentTempUsages(o,1)}var h=s.viewDirFragment;var l=s.normalFragment;n+="dp3 "+o+".w, "+i+", "+l+"\n"+"add "+o+".w, "+o+".w, "+o+".w\n"+"mul "+o+".xyz, "+l+", "+o+".w\n"+"sub "+o+".xyz, "+o+", "+i+"\n"+"add "+o+".w, "+o+".w, "+s.commons+".w\n"+"sat "+o+".w, "+o+".w\n"+"mul "+o+".xyz, "+o+", "+o+".w\n"+"dp3 "+o+".w, "+o+", "+h+"\n"+"sat "+o+".w, "+o+".w\n";if(this._pUseTexture){n+="mul "+this._pSpecularTexData+".w, "+this._pSpecularTexData+".y, "+this._pSpecularDataRegister+".w\n"+"pow "+o+".w, "+o+".w, "+this._pSpecularTexData+".w\n"}else n+="pow "+o+".w, "+o+".w, "+this._pSpecularDataRegister+".w\n";if(t.usesLightFallOff)n+="mul "+o+".w, "+o+".w, "+i+".w\n";if(this._iModulateMethod!=null)n+=this._iModulateMethod(t,e,o,a,s);n+="mul "+o+".xyz, "+r+".xyz, "+o+".w\n";if(!this._pIsFirstLight){n+="add "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+".xyz, "+o+".xyz\n";a.removeFragmentTempUsage(o)}this._pIsFirstLight=false;return n};return e}(a);e.exports=s},{"awayjs-stagegl/lib/materials/methods/SpecularBasicMethod":undefined}],"awayjs-renderergl/lib/materials/passes/SingleObjectDepthPass":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];
function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Matrix3D");var s=t("awayjs-core/lib/textures/RenderTexture");var n=t("awayjs-display/lib/base/TriangleSubGeometry");var o=t("awayjs-stagegl/lib/base/ContextGLProgramType");var h=t("awayjs-stagegl/lib/materials/passes/MaterialPassBase");var l=function(t){r(e,t);function e(){t.call(this);this._textureSize=512;this._polyOffset=Array(15,0,0,0);this._projectionTexturesInvalid=true}Object.defineProperty(e.prototype,"textureSize",{get:function(){return this._textureSize},set:function(t){this._textureSize=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"polyOffset",{get:function(){return this._polyOffset[0]},set:function(t){this._polyOffset[0]=t},enumerable:true,configurable:true});e.prototype.dispose=function(){if(this._textures){for(var t in this._textures){var e=this._textures[t];e.dispose()}this._textures=null}};e.prototype.updateProjectionTextures=function(){if(this._textures){for(var t in this._textures){var e=this._textures[t];e.dispose()}}this._textures=new Object;this._projections=new Object;this._projectionTexturesInvalid=false};e.prototype._iGetVertexCode=function(){var t;t="mul vt7, vt1, vc4.x	\n"+"add vt7, vt7, vt0\n"+"mov vt7.w, vt0.w\n";t+="m44 vt2, vt7, vc0\n"+"mov op, vt2\n";t+="div v0, vt2, vt2.w\n";return t};e.prototype._iGetFragmentCode=function(t,e,i){var r="";r+="mul ft0, fc0, v0.z\n"+"frc ft0, ft0\n"+"mul ft1, ft0.yzww, fc1\n"+"sub ft0, ft0, ft1\n"+"mov oc, ft0\n";return r};e.prototype._iGetDepthMap=function(t){return this._textures[t.materialOwner.id]};e.prototype._iGetProjection=function(t){return this._projections[t.materialOwner.id]};e.prototype._iRender=function(t,e,i,r,h){var l;var u=i.context;var p;var c;var d=this._pLightPicker.allPickedLights;var f=e.materialOwner.id;if(!this._textures[f])this._textures[f]=new s(this._textureSize,this._textureSize);if(!this._projections[f])this._projections[f]=new a;p=d.length;c=d[0];l=c.iGetObjectProjectionMatrix(e.sourceEntity,r,this._projections[f]);u.setRenderTarget(this._textures[f],true);u.clear(1,1,1);u.setProgramConstantsFromMatrix(o.VERTEX,0,l,true);u.setProgramConstantsFromArray(o.FRAGMENT,0,this._enc,2);u.activateBuffer(0,e.getVertexData(n.POSITION_DATA),e.getVertexOffset(n.POSITION_DATA),n.POSITION_FORMAT);u.activateBuffer(1,e.getVertexData(n.NORMAL_DATA),e.getVertexOffset(n.NORMAL_DATA),n.NORMAL_FORMAT);u.drawTriangles(u.getIndexBuffer(e.getIndexData()),0,e.numTriangles)};e.prototype._iActivate=function(e,i,r){if(this._projectionTexturesInvalid)this.updateProjectionTextures();t.prototype._iActivate.call(this,e,i,r);i.context.setProgramConstantsFromArray(o.VERTEX,4,this._polyOffset,1)};return e}(h);e.exports=l},{"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/textures/RenderTexture":undefined,"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-stagegl/lib/base/ContextGLProgramType":undefined,"awayjs-stagegl/lib/materials/passes/MaterialPassBase":undefined}],"awayjs-renderergl/lib/parsers/AWDParser":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/ColorTransform");var s=t("awayjs-core/lib/geom/Matrix3D");var n=t("awayjs-core/lib/geom/Vector3D");var o=t("awayjs-core/lib/net/URLLoaderDataFormat");var h=t("awayjs-core/lib/net/URLRequest");var l=t("awayjs-core/lib/library/AssetType");var u=t("awayjs-core/lib/parsers/ParserBase");var p=t("awayjs-core/lib/parsers/ParserUtils");var c=t("awayjs-core/lib/projections/PerspectiveProjection");var d=t("awayjs-core/lib/projections/OrthographicProjection");var f=t("awayjs-core/lib/projections/OrthographicOffCenterProjection");var _=t("awayjs-core/lib/textures/BitmapCubeTexture");var y=t("awayjs-core/lib/textures/ImageCubeTexture");var g=t("awayjs-core/lib/textures/ImageTexture");var m=t("awayjs-core/lib/utils/ByteArray");var b=t("awayjs-display/lib/containers/DisplayObjectContainer");var v=t("awayjs-display/lib/base/BlendMode");var w=t("awayjs-display/lib/base/Geometry");var x=t("awayjs-display/lib/base/TriangleSubGeometry");var P=t("awayjs-display/lib/entities/DirectionalLight");var D=t("awayjs-display/lib/entities/PointLight");var C=t("awayjs-display/lib/entities/Camera");var T=t("awayjs-display/lib/entities/Mesh");var A=t("awayjs-display/lib/entities/Skybox");var S=t("awayjs-display/lib/materials/lightpickers/StaticLightPicker");var j=t("awayjs-display/lib/materials/shadowmappers/CubeMapShadowMapper");var O=t("awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper");var E=t("awayjs-display/lib/prefabs/PrefabBase");var M=t("awayjs-display/lib/prefabs/PrimitiveCapsulePrefab");var R=t("awayjs-display/lib/prefabs/PrimitiveConePrefab");var I=t("awayjs-display/lib/prefabs/PrimitiveCubePrefab");var N=t("awayjs-display/lib/prefabs/PrimitiveCylinderPrefab");var L=t("awayjs-display/lib/prefabs/PrimitivePlanePrefab");var F=t("awayjs-display/lib/prefabs/PrimitiveSpherePrefab");var V=t("awayjs-display/lib/prefabs/PrimitiveTorusPrefab");var B=t("awayjs-stagegl/lib/materials/SkyboxMaterial");var U=t("awayjs-stagegl/lib/materials/TriangleMaterialMode");var k=t("awayjs-stagegl/lib/materials/TriangleMethodMaterial");var z=t("awayjs-stagegl/lib/materials/utils/DefaultMaterialManager");var G=t("awayjs-renderergl/lib/animators/VertexAnimationSet");var H=t("awayjs-renderergl/lib/animators/VertexAnimator");var X=t("awayjs-renderergl/lib/animators/SkeletonAnimationSet");var W=t("awayjs-renderergl/lib/animators/SkeletonAnimator");var Y=t("awayjs-renderergl/lib/animators/data/JointPose");var Z=t("awayjs-renderergl/lib/animators/data/Skeleton");var q=t("awayjs-renderergl/lib/animators/data/SkeletonPose");var K=t("awayjs-renderergl/lib/animators/data/SkeletonJoint");var J=t("awayjs-renderergl/lib/animators/nodes/SkeletonClipNode");var Q=t("awayjs-renderergl/lib/animators/nodes/VertexClipNode");var $=t("awayjs-renderergl/lib/materials/methods/AmbientEnvMapMethod");var te=t("awayjs-renderergl/lib/materials/methods/DiffuseDepthMethod");var ee=t("awayjs-renderergl/lib/materials/methods/DiffuseCelMethod");var ie=t("awayjs-renderergl/lib/materials/methods/DiffuseGradientMethod");var re=t("awayjs-renderergl/lib/materials/methods/DiffuseLightMapMethod");var ae=t("awayjs-renderergl/lib/materials/methods/DiffuseWrapMethod");var se=t("awayjs-renderergl/lib/materials/methods/EffectAlphaMaskMethod");var ne=t("awayjs-renderergl/lib/materials/methods/EffectColorMatrixMethod");var oe=t("awayjs-stagegl/lib/materials/methods/EffectColorTransformMethod");var he=t("awayjs-renderergl/lib/materials/methods/EffectEnvMapMethod");var le=t("awayjs-renderergl/lib/materials/methods/EffectFogMethod");var ue=t("awayjs-renderergl/lib/materials/methods/EffectFresnelEnvMapMethod");var pe=t("awayjs-renderergl/lib/materials/methods/EffectLightMapMethod");var ce=t("awayjs-renderergl/lib/materials/methods/EffectRimLightMethod");var de=t("awayjs-renderergl/lib/materials/methods/NormalSimpleWaterMethod");var fe=t("awayjs-renderergl/lib/materials/methods/ShadowDitheredMethod");var _e=t("awayjs-renderergl/lib/materials/methods/ShadowFilteredMethod");var ye=t("awayjs-renderergl/lib/materials/methods/SpecularFresnelMethod");var ge=t("awayjs-stagegl/lib/materials/methods/ShadowHardMethod");var me=t("awayjs-renderergl/lib/materials/methods/SpecularAnisotropicMethod");var be=t("awayjs-renderergl/lib/materials/methods/SpecularCelMethod");var ve=t("awayjs-renderergl/lib/materials/methods/SpecularPhongMethod");var we=t("awayjs-renderergl/lib/materials/methods/ShadowNearMethod");var xe=t("awayjs-renderergl/lib/materials/methods/ShadowSoftMethod");var Pe=t("awayjs-renderergl/lib/parsers/data/AWDBlock");var De=t("awayjs-renderergl/lib/parsers/data/AWDProperties");var Ce=t("awayjs-renderergl/lib/parsers/data/BitFlags");var Te=function(t){r(e,t);function e(){t.call(this,o.ARRAY_BUFFER);this._debug=false;this._startedParsing=false;this._texture_users={};this._parsed_header=false;this._blocks=new Array;this._blocks[0]=new Pe;this._blocks[0].data=null;this.blendModeDic=new Array;this.blendModeDic.push(v.NORMAL);this.blendModeDic.push(v.ADD);this.blendModeDic.push(v.ALPHA);this.blendModeDic.push(v.DARKEN);this.blendModeDic.push(v.DIFFERENCE);this.blendModeDic.push(v.ERASE);this.blendModeDic.push(v.HARDLIGHT);this.blendModeDic.push(v.INVERT);this.blendModeDic.push(v.LAYER);this.blendModeDic.push(v.LIGHTEN);this.blendModeDic.push(v.MULTIPLY);this.blendModeDic.push(v.NORMAL);this.blendModeDic.push(v.OVERLAY);this.blendModeDic.push(v.SCREEN);this.blendModeDic.push(v.SHADER);this.blendModeDic.push(v.OVERLAY);this._depthSizeDic=new Array;this._depthSizeDic.push(256);this._depthSizeDic.push(512);this._depthSizeDic.push(2048);this._depthSizeDic.push(1024);this._version=Array()}e.supportsType=function(t){t=t.toLowerCase();return t=="awd"};e.supportsData=function(t){return p.toString(t,3)=="AWD"};e.prototype._iResolveDependency=function(t){if(t.assets.length==1){var e=t.id.split("#");var i=e[0];var r;var a;var s;if(e.length==1){r=t.assets[0];if(r){var n;var o;s=this._blocks[t.id];s.data=r;r.resetAssetPath(s.name,null,true);s.name=r.name;this._pFinalizeAsset(r);if(this._debug){console.log("Successfully loaded Bitmap for texture");console.log("Parsed texture: Name = "+s.name)}}}if(e.length>1){a=t.assets[0];var h=a;this._cubeTextures[e[1]]=h.htmlImageElement;this._texture_users[i].push(1);if(this._debug){console.log("Successfully loaded Bitmap "+this._texture_users[i].length+" / 6 for Cubetexture")}if(this._texture_users[i].length==this._cubeTextures.length){var l=this._cubeTextures[0];var u=this._cubeTextures[1];var p=this._cubeTextures[2];var c=this._cubeTextures[3];var d=this._cubeTextures[4];var f=this._cubeTextures[5];r=new y(l,u,p,c,d,f);s=this._blocks[i];s.data=r;r.resetAssetPath(s.name,null,true);s.name=r.name;this._pFinalizeAsset(r);if(this._debug){console.log("Parsed CubeTexture: Name = "+s.name)}}}}};e.prototype._iResolveDependencyFailure=function(t){};e.prototype._iResolveDependencyName=function(t,e){var i=e.name;if(e){var r=this._blocks[parseInt(t.id)];e.resetAssetPath(r.name,null,true)}var a=e.name;e.name=i;return a};e.prototype._pProceedParsing=function(){if(!this._startedParsing){this._byteData=this._pGetByteData();this._startedParsing=true}if(!this._parsed_header){this.parseHeader();switch(this._compression){case e.DEFLATE:case e.LZMA:this._pDieWithError("Compressed AWD formats not yet supported");break;case e.UNCOMPRESSED:this._body=this._byteData;break}this._parsed_header=true}if(this._body){while(this._body.getBytesAvailable()>0&&!this.parsingPaused){this.parseNextBlock()}if(this._body.getBytesAvailable()==0){this.dispose();return u.PARSING_DONE}else{return u.MORE_TO_PARSE}}else{switch(this._compression){case e.DEFLATE:case e.LZMA:if(this._debug){console.log("(!) AWDParser Error: Compressed AWD formats not yet supported (!)")}break}return u.PARSING_DONE}};e.prototype._pStartParsing=function(e){t.prototype._pStartParsing.call(this,e);this._pContent=new b};e.prototype.dispose=function(){for(var t in this._blocks){var e=this._blocks[t];e.dispose()}};e.prototype.parseNextBlock=function(){var t;var i;var r=false;var a;var s;var n;var o;this._cur_block_id=this._body.readUnsignedInt();a=this._body.readUnsignedByte();s=this._body.readUnsignedByte();n=this._body.readUnsignedByte();o=this._body.readUnsignedInt();var h=Ce.test(n,Ce.FLAG4);var l=Ce.test(n,Ce.FLAG5);if(this._accuracyOnBlocks){this._accuracyMatrix=Ce.test(n,Ce.FLAG1);this._accuracyGeo=Ce.test(n,Ce.FLAG2);this._accuracyProps=Ce.test(n,Ce.FLAG3);this._geoNrType=e.FLOAT32;if(this._accuracyGeo){this._geoNrType=e.FLOAT64}this._matrixNrType=e.FLOAT32;if(this._accuracyMatrix){this._matrixNrType=e.FLOAT64}this._propsNrType=e.FLOAT32;if(this._accuracyProps){this._propsNrType=e.FLOAT64}}var u=this._body.position+o;if(o>this._body.getBytesAvailable()){this._pDieWithError("AWD2 block length is bigger than the bytes that are available!");this._body.position+=this._body.getBytesAvailable();return}this._newBlockBytes=new m;this._body.readBytes(this._newBlockBytes,0,o);if(h){this._pDieWithError("Compressed AWD formats not yet supported")}this._newBlockBytes.position=0;t=new Pe;t.len=this._newBlockBytes.position+o;t.id=this._cur_block_id;var p=this._newBlockBytes.position+o;if(h){this._pDieWithError("Compressed AWD formats not yet supported")}if(this._debug){console.log("AWDBlock:  ID = "+this._cur_block_id+" | TypeID = "+s+" | Compression = "+h+" | Matrix-Precision = "+this._accuracyMatrix+" | Geometry-Precision = "+this._accuracyGeo+" | Properties-Precision = "+this._accuracyProps)}this._blocks[this._cur_block_id]=t;if(this._version[0]==2&&this._version[1]==1){switch(s){case 11:this.parsePrimitves(this._cur_block_id);r=true;break;case 31:this.parseSkyboxInstance(this._cur_block_id);r=true;break;case 41:this.parseLight(this._cur_block_id);r=true;break;case 42:this.parseCamera(this._cur_block_id);r=true;break;case 51:this.parseLightPicker(this._cur_block_id);r=true;break;case 81:this.parseMaterial_v1(this._cur_block_id);r=true;break;case 83:this.parseCubeTexture(this._cur_block_id);r=true;break;case 91:this.parseSharedMethodBlock(this._cur_block_id);r=true;break;case 92:this.parseShadowMethodBlock(this._cur_block_id);r=true;break;case 111:this.parseMeshPoseAnimation(this._cur_block_id,true);r=true;break;case 112:this.parseMeshPoseAnimation(this._cur_block_id);r=true;break;case 113:this.parseVertexAnimationSet(this._cur_block_id);r=true;break;case 122:this.parseAnimatorSet(this._cur_block_id);r=true;break;case 253:this.parseCommand(this._cur_block_id);r=true;break}}if(r==false){switch(s){case 1:this.parseTriangleGeometrieBlock(this._cur_block_id);break;case 22:this.parseContainer(this._cur_block_id);break;case 23:this.parseMeshInstance(this._cur_block_id);break;case 81:this.parseMaterial(this._cur_block_id);break;case 82:this.parseTexture(this._cur_block_id);break;case 101:this.parseSkeleton(this._cur_block_id);break;case 102:this.parseSkeletonPose(this._cur_block_id);break;case 103:this.parseSkeletonAnimation(this._cur_block_id);break;case 121:case 254:this.parseNameSpace(this._cur_block_id);break;case 255:this.parseMetaData(this._cur_block_id);break;default:if(this._debug){console.log("AWDBlock:   Unknown BlockType  (BlockID = "+this._cur_block_id+") - Skip "+o+" bytes")}this._newBlockBytes.position+=o;break}}var c=0;if(this._newBlockBytes.position==p){if(this._debug){if(t.errorMessages){while(c<t.errorMessages.length){console.log("        (!) Error: "+t.errorMessages[c]+" (!)");c++}}}if(this._debug){console.log("\n")}}else{if(this._debug){console.log("  (!)(!)(!) Error while reading AWDBlock ID "+this._cur_block_id+" = skip to next block");if(t.errorMessages){while(c<t.errorMessages.length){console.log("        (!) Error: "+t.errorMessages[c]+" (!)");c++}}}}this._body.position=u;this._newBlockBytes=null};e.prototype.parseTriangleGeometrieBlock=function(t){var e=new w;var i=this.parseVarStr();var r=this._newBlockBytes.readUnsignedShort();var a=this.parseProperties({1:this._geoNrType,2:this._geoNrType});var s=a.get(1,1);var n=a.get(2,1);var o=0;while(o<r){var h;var l,u;var p;var c;var d;l=this._newBlockBytes.readUnsignedInt();u=this._newBlockBytes.position+l;var f=this.parseProperties({1:this._geoNrType,2:this._geoNrType});while(this._newBlockBytes.position<u){var _=0;var y,g,m,b;g=this._newBlockBytes.readUnsignedByte();y=this._newBlockBytes.readUnsignedByte();m=this._newBlockBytes.readUnsignedInt();b=this._newBlockBytes.position+m;var v,P,D;if(g==1){var C=new Array;while(this._newBlockBytes.position<b){v=this.readNumber(this._accuracyGeo);P=this.readNumber(this._accuracyGeo);D=this.readNumber(this._accuracyGeo);C[_++]=v;C[_++]=P;C[_++]=D}}else if(g==2){var T=new Array;while(this._newBlockBytes.position<b){T[_++]=this._newBlockBytes.readUnsignedShort()}}else if(g==3){var A=new Array;while(this._newBlockBytes.position<b){A[_++]=this.readNumber(this._accuracyGeo)}}else if(g==4){var S=new Array;while(this._newBlockBytes.position<b){S[_++]=this.readNumber(this._accuracyGeo)}}else if(g==6){c=Array();while(this._newBlockBytes.position<b){c[_++]=this._newBlockBytes.readUnsignedShort()*3}}else if(g==7){d=new Array;while(this._newBlockBytes.position<b){d[_++]=this.readNumber(this._accuracyGeo)}}else{this._newBlockBytes.position=b}}this.parseUserAttributes();p=new x(true);if(d)p.jointsPerVertex=d.length/(C.length/3);if(S)p.autoDeriveNormals=false;if(A)p.autoDeriveUVs=false;p.updateIndices(T);p.updatePositions(C);p.updateVertexNormals(S);p.updateUVs(A);p.updateVertexTangents(null);p.updateJointWeights(d);p.updateJointIndices(c);var j=f.get(1,1);var O=f.get(2,1);var E=false;if(s!=j||n!=O){E=true;j=s/j;O=n/O}if(E)p.scaleUV(j,O);e.addSubGeometry(p);o++}if(s!=1||n!=1)e.scaleUV(s,n);this.parseUserAttributes();this._pFinalizeAsset(e,i);this._blocks[t].data=e;if(this._debug){console.log("Parsed a TriangleGeometry: Name = "+i+"| Id = "+p.id)}};e.prototype.parsePrimitves=function(t){var i;var r;var a;var s;var n;var o;i=this.parseVarStr();a=this._newBlockBytes.readUnsignedByte();n=this.parseProperties({101:this._geoNrType,102:this._geoNrType,103:this._geoNrType,110:this._geoNrType,111:this._geoNrType,301:e.UINT16,302:e.UINT16,303:e.UINT16,701:e.BOOL,702:e.BOOL,703:e.BOOL,704:e.BOOL});var h=["Unsupported Type-ID","PrimitivePlanePrefab","PrimitiveCubePrefab","PrimitiveSpherePrefab","PrimitiveCylinderPrefab","PrimitivesConePrefab","PrimitivesCapsulePrefab","PrimitivesTorusPrefab"];switch(a){case 1:r=new L(n.get(101,100),n.get(102,100),n.get(301,1),n.get(302,1),n.get(701,true),n.get(702,false));break;case 2:r=new I(n.get(101,100),n.get(102,100),n.get(103,100),n.get(301,1),n.get(302,1),n.get(303,1),n.get(701,true));break;case 3:r=new F(n.get(101,50),n.get(301,16),n.get(302,12),n.get(701,true));break;case 4:r=new N(n.get(101,50),n.get(102,50),n.get(103,100),n.get(301,16),n.get(302,1),true,true,true);if(!n.get(701,true))r.topClosed=false;if(!n.get(702,true))r.bottomClosed=false;if(!n.get(703,true))r.yUp=false;break;case 5:r=new R(n.get(101,50),n.get(102,100),n.get(301,16),n.get(302,1),n.get(701,true),n.get(702,true));break;case 6:r=new M(n.get(101,50),n.get(102,100),n.get(301,16),n.get(302,15),n.get(701,true));break;case 7:r=new V(n.get(101,50),n.get(102,50),n.get(301,16),n.get(302,8),n.get(701,true));break;default:r=new E;console.log("ERROR: UNSUPPORTED PREFAB_TYPE");break}if(n.get(110,1)!=1||n.get(111,1)!=1){}this.parseUserAttributes();r.name=i;this._pFinalizeAsset(r,i);this._blocks[t].data=r;if(this._debug){if(a<0||a>7){a=0}console.log("Parsed a Primivite: Name = "+i+"| type = "+h[a])}};e.prototype.parseContainer=function(t){var i;var r;var a;var s;var o;r=this._newBlockBytes.readUnsignedInt();a=this.parseMatrix3D();i=this.parseVarStr();var h="Root (TopLevel)";s=new b;s.transform.matrix3D=a;var u=this.getAssetByID(r,[l.CONTAINER,l.LIGHT,l.MESH]);if(u[0]){var p=u[1].addChild(s);h=u[1].name}else if(r>0){this._blocks[t].addError("Could not find a parent for this ObjectContainer3D")}else{this._pContent.addChild(s)}if(this._version[0]==2&&this._version[1]==1){var c=this.parseProperties({1:this._matrixNrType,2:this._matrixNrType,3:this._matrixNrType,4:e.UINT8});s.pivot=new n(c.get(1,0),c.get(2,0),c.get(3,0))}else{this.parseProperties(null)}s.extra=this.parseUserAttributes();this._pFinalizeAsset(s,i);this._blocks[t].data=s;if(this._debug){console.log("Parsed a Container: Name = '"+i+"' | Parent-Name = "+h)}};e.prototype.parseMeshInstance=function(t){var i;var r;var a;var s=this._newBlockBytes.readUnsignedInt();var o=this.parseMatrix3D();var h=this.parseVarStr();var u="Root (TopLevel)";var p=this._newBlockBytes.readUnsignedInt();var c;var d=this.getAssetByID(p,[l.GEOMETRY]);if(d[0]){c=d[1]}else{this._blocks[t].addError("Could not find a Geometry for this Mesh. A empty Geometry is created!");c=new w}this._blocks[t].geoID=p;var f=new Array;i=this._newBlockBytes.readUnsignedShort();var _=new Array;r=0;var y;while(r<i){var g;g=this._newBlockBytes.readUnsignedInt();y=this.getAssetByID(g,[l.MATERIAL]);if(!y[0]&&g>0){this._blocks[t].addError("Could not find Material Nr "+r+" (ID = "+g+" ) for this Mesh")}var m=y[1];f.push(m);_.push(m.name);r++}var b=new T(c,null);b.transform.matrix3D=o;var v=this.getAssetByID(s,[l.CONTAINER,l.LIGHT,l.MESH]);if(v[0]){var x=v[1];x.addChild(b);u=x.name}else if(s>0){this._blocks[t].addError("Could not find a parent for this Mesh")}else{this._pContent.addChild(b)}if(f.length>=1&&b.subMeshes.length==1){b.material=f[0]}else if(f.length>1){var P;for(P=0;P<b.subMeshes.length;P++){b.subMeshes[P].material=f[Math.min(f.length-1,P)]}}if(this._version[0]==2&&this._version[1]==1){var D=this.parseProperties({1:this._matrixNrType,2:this._matrixNrType,3:this._matrixNrType,4:e.UINT8,5:e.BOOL});b.pivot=new n(D.get(1,0),D.get(2,0),D.get(3,0));b.castsShadows=D.get(5,true)}else{this.parseProperties(null)}b.extra=this.parseUserAttributes();this._pFinalizeAsset(b,h);this._blocks[t].data=b;if(this._debug){console.log("Parsed a Mesh: Name = '"+h+"' | Parent-Name = "+u+"| Geometry-Name = "+c.name+" | SubMeshes = "+b.subMeshes.length+" | Mat-Names = "+_.toString())}};e.prototype.parseSkyboxInstance=function(t){var e=this.parseVarStr();var i=this._newBlockBytes.readUnsignedInt();var r=this.getAssetByID(i,[l.TEXTURE],"CubeTexture");if(!r[0]&&i!=0)this._blocks[t].addError("Could not find the Cubetexture (ID = "+i+" ) for this Skybox");var a=new A(new B(r[1]));this.parseProperties(null);a.extra=this.parseUserAttributes();this._pFinalizeAsset(a,e);this._blocks[t].data=a;if(this._debug)console.log("Parsed a Skybox: Name = '"+e+"' | CubeTexture-Name = "+r[1].name)};e.prototype.parseLight=function(t){var i;var r;var a=this._newBlockBytes.readUnsignedInt();var s=this.parseMatrix3D();var n=this.parseVarStr();var o=this._newBlockBytes.readUnsignedByte();var h=this.parseProperties({1:this._propsNrType,2:this._propsNrType,3:e.COLOR,4:this._propsNrType,5:this._propsNrType,6:e.BOOL,7:e.COLOR,8:this._propsNrType,9:e.UINT8,10:e.UINT8,11:this._propsNrType,12:e.UINT16,21:this._matrixNrType,22:this._matrixNrType,23:this._matrixNrType});var u=h.get(9,0);var p="Root (TopLevel)";var c=["Unsupported LightType","PointLight","DirectionalLight"];var d=["No ShadowMapper","DirectionalShadowMapper","NearDirectionalShadowMapper","CascadeShadowMapper","CubeMapShadowMapper"];if(o==1){i=new D;i.radius=h.get(1,9e4);i.fallOff=h.get(2,1e5);if(u>0){if(u==4){r=new j}}i.transform.matrix3D=s}if(o==2){i=new P(h.get(21,0),h.get(22,-1),h.get(23,1));if(u>0){if(u==1){r=new O}}}i.color=h.get(3,16777215);i.specular=h.get(4,1);i.diffuse=h.get(5,1);i.ambientColor=h.get(7,16777215);i.ambient=h.get(8,0);if(r){if(r instanceof j){if(h.get(10,1)!=1){r.depthMapSize=this._depthSizeDic[h.get(10,1)]}}else{if(h.get(10,2)!=2){r.depthMapSize=this._depthSizeDic[h.get(10,2)]}}i.shadowMapper=r;i.castsShadows=true}if(a!=0){var f=this.getAssetByID(a,[l.CONTAINER,l.LIGHT,l.MESH]);if(f[0]){f[1].addChild(i);p=f[1].name}else{this._blocks[t].addError("Could not find a parent for this Light")}}else{this._pContent.addChild(i)}this.parseUserAttributes();this._pFinalizeAsset(i,n);this._blocks[t].data=i;if(this._debug)console.log("Parsed a Light: Name = '"+n+"' | Type = "+c[o]+" | Parent-Name = "+p+" | ShadowMapper-Type = "+d[u])};e.prototype.parseCamera=function(t){var i=this._newBlockBytes.readUnsignedInt();var r=this.parseMatrix3D();var a=this.parseVarStr();var s="Root (TopLevel)";var o;this._newBlockBytes.readUnsignedByte();this._newBlockBytes.readShort();var h=this._newBlockBytes.readShort();var u=this.parseProperties({101:this._propsNrType,102:this._propsNrType,103:this._propsNrType,104:this._propsNrType});switch(h){case 5001:o=new c(u.get(101,60));break;case 5002:o=new d(u.get(101,500));break;case 5003:o=new f(u.get(101,-400),u.get(102,400),u.get(103,-300),u.get(104,300));break;default:console.log("unsupportedLenstype");return}var p=new C(o);p.transform.matrix3D=r;var _=this.getAssetByID(i,[l.CONTAINER,l.LIGHT,l.MESH]);if(_[0]){var y=_[1];y.addChild(p);s=y.name}else if(i>0){this._blocks[t].addError("Could not find a parent for this Camera")}else{this._pContent.addChild(p)}p.name=a;u=this.parseProperties({1:this._matrixNrType,2:this._matrixNrType,3:this._matrixNrType,4:e.UINT8});p.pivot=new n(u.get(1,0),u.get(2,0),u.get(3,0));p.extra=this.parseUserAttributes();this._pFinalizeAsset(p,a);this._blocks[t].data=p;if(this._debug){console.log("Parsed a Camera: Name = '"+a+"' | Projectiontype = "+o+" | Parent-Name = "+s)}};e.prototype.parseLightPicker=function(t){var e=this.parseVarStr();var i=this._newBlockBytes.readUnsignedShort();var r=new Array;var a=0;var s=0;var n;var o=new Array;for(a=0;a<i;a++){s=this._newBlockBytes.readUnsignedInt();n=this.getAssetByID(s,[l.LIGHT]);if(n[0]){r.push(n[1]);o.push(n[1].name)}else{this._blocks[t].addError("Could not find a Light Nr "+a+" (ID = "+s+" ) for this LightPicker")}}if(r.length==0){this._blocks[t].addError("Could not create this LightPicker, cause no Light was found.");this.parseUserAttributes();return}var h=new S(r);h.name=e;this.parseUserAttributes();this._pFinalizeAsset(h,e);this._blocks[t].data=h;if(this._debug){console.log("Parsed a StaticLightPicker: Name = '"+e+"' | Texture-Name = "+o.toString())}};e.prototype.parseMaterial=function(t){var i;var r;var a;var s;var n;var o;var h;var u;var p;i=this.parseVarStr();r=this._newBlockBytes.readUnsignedByte();h=this._newBlockBytes.readUnsignedByte();a=this.parseProperties({1:e.INT32,2:e.BADDR,10:this._propsNrType,11:e.BOOL,12:this._propsNrType,13:e.BOOL});u=0;while(u<h){var c;c=this._newBlockBytes.readUnsignedShort();this.parseProperties(null);this.parseUserAttributes();u+=1}var d="";n=this.parseUserAttributes();if(r===1){d+="Parsed a ColorMaterial(SinglePass): Name = '"+i+"' | ";var f;f=a.get(1,16777215);if(this.materialMode<2){s=new k(f,a.get(10,1))}else{s=new k(f);s.materialMode=U.MULTI_PASS}}else if(r===2){var _=a.get(2,0);p=this.getAssetByID(_,[l.TEXTURE]);if(!p[0]&&_>0)this._blocks[t].addError("Could not find the DiffsueTexture (ID = "+_+" ) for this Material");s=new k(p[1]);if(this.materialMode<2){s.alphaBlending=a.get(11,false);s.alpha=a.get(10,1);d+="Parsed a TriangleMethodMaterial(SinglePass): Name = '"+i+"' | Texture-Name = "+s.name}else{s.materialMode=U.MULTI_PASS;d+="Parsed a TriangleMethodMaterial(MultiPass): Name = '"+i+"' | Texture-Name = "+s.name}}s.extra=n;s.alphaThreshold=a.get(12,0);s.repeat=a.get(13,false);this._pFinalizeAsset(s,i);this._blocks[t].data=s;if(this._debug){console.log(d)}};e.prototype.parseMaterial_v1=function(t){var i;var r;var a;var s;var n=this.parseVarStr();var o=this._newBlockBytes.readUnsignedByte();var h=this._newBlockBytes.readUnsignedByte();var u=this.parseProperties({1:e.UINT32,2:e.BADDR,3:e.BADDR,4:e.UINT8,5:e.BOOL,6:e.BOOL,7:e.BOOL,8:e.BOOL,9:e.UINT8,10:this._propsNrType,11:e.BOOL,12:this._propsNrType,13:e.BOOL,15:this._propsNrType,16:e.UINT32,17:e.BADDR,18:this._propsNrType,19:this._propsNrType,20:e.UINT32,21:e.BADDR,22:e.BADDR});var p=u.get(4,0);var c="";if(p>=2){this._blocks[t].addError("Material-spezialType '"+p+"' is not supported, can only be 0:singlePass, 1:MultiPass !");return}if(this.materialMode==1)p=0;else if(this.materialMode==2)p=1;if(p<2){if(o==1){var d=u.get(1,13421772);if(p==1){i=new k(d);i.materialMode=U.MULTI_PASS;c+="Parsed a ColorMaterial(MultiPass): Name = '"+n+"' | "}else{i=new k(d,u.get(10,1));i.alphaBlending=u.get(11,false);c+="Parsed a ColorMaterial(SinglePass): Name = '"+n+"' | "}}else if(o==2){var f=u.get(2,0);s=this.getAssetByID(f,[l.TEXTURE]);if(!s[0]&&f>0)this._blocks[t].addError("Could not find the AmbientTexture (ID = "+f+" ) for this TriangleMethodMaterial");var _=s[1];i=new k(_);if(p==1){i.materialMode=U.MULTI_PASS;c+="Parsed a TriangleMethodMaterial(MultiPass): Name = '"+n+"' | Texture-Name = "+_.name}else{i.alpha=u.get(10,1);i.alphaBlending=u.get(11,false);c+="Parsed a TriangleMethodMaterial(SinglePass): Name = '"+n+"' | Texture-Name = "+_.name}}var y;var g=u.get(17,0);s=this.getAssetByID(g,[l.TEXTURE]);if(!s[0]&&g!=0){this._blocks[t].addError("Could not find the DiffuseTexture (ID = "+g+" ) for this TriangleMethodMaterial")}if(s[0])y=s[1];if(y){i.diffuseTexture=y;c+=" | DiffuseTexture-Name = "+y.name}var m=u.get(3,0);s=this.getAssetByID(m,[l.TEXTURE]);if(!s[0]&&m!=0){this._blocks[t].addError("Could not find the NormalTexture (ID = "+m+" ) for this TriangleMethodMaterial")}if(s[0]){r=s[1];c+=" | NormalTexture-Name = "+r.name}var b=u.get(21,0);s=this.getAssetByID(b,[l.TEXTURE]);if(!s[0]&&b!=0){this._blocks[t].addError("Could not find the SpecularTexture (ID = "+b+" ) for this TriangleMethodMaterial")}if(s[0]){a=s[1];c+=" | SpecularTexture-Name = "+a.name}var v=u.get(22,0);s=this.getAssetByID(v,[l.LIGHT_PICKER]);if(!s[0]&&v){this._blocks[t].addError("Could not find the LightPicker (ID = "+v+" ) for this TriangleMethodMaterial")}else{i.lightPicker=s[1]}i.smooth=u.get(5,true);i.mipmap=u.get(6,true);i.bothSides=u.get(7,false);i.alphaPremultiplied=u.get(8,false);i.blendMode=this.blendModeDic[u.get(9,0)];i.repeat=u.get(13,false);if(r)i.normalMap=r;if(a)i.specularMap=a;i.alphaThreshold=u.get(12,0);i.ambient=u.get(15,1);i.diffuseColor=u.get(16,16777215);i.specular=u.get(18,1);i.gloss=u.get(19,50);i.specularColor=u.get(20,16777215);var w=0;var x;while(w<h){var P;P=this._newBlockBytes.readUnsignedShort();u=this.parseProperties({1:e.BADDR,2:e.BADDR,3:e.BADDR,101:this._propsNrType,102:this._propsNrType,103:this._propsNrType,201:e.UINT32,202:e.UINT32,301:e.UINT16,302:e.UINT16,401:e.UINT8,402:e.UINT8,601:e.COLOR,602:e.COLOR,701:e.BOOL,702:e.BOOL,801:e.MTX4x4});switch(P){case 999:x=u.get(1,0);s=this.getAssetByID(x,[l.EFFECTS_METHOD]);if(!s[0]){this._blocks[t].addError("Could not find the EffectMethod (ID = "+x+" ) for this Material")}else{i.addEffectMethod(s[1]);c+=" | EffectMethod-Name = "+s[1].name}break;case 998:x=u.get(1,0);s=this.getAssetByID(x,[l.SHADOW_MAP_METHOD]);if(!s[0]){this._blocks[t].addError("Could not find the ShadowMethod (ID = "+x+" ) for this Material")}else{i.shadowMethod=s[1];c+=" | ShadowMethod-Name = "+s[1].name}break;case 1:x=u.get(1,0);s=this.getAssetByID(x,[l.TEXTURE],"CubeTexture");if(!s[0])this._blocks[t].addError("Could not find the EnvMap (ID = "+x+" ) for this EnvMapAmbientMethodMaterial");i.ambientMethod=new $(s[1]);c+=" | AmbientEnvMapMethod | EnvMap-Name ="+s[1].name;break;case 51:i.diffuseMethod=new te;c+=" | DiffuseDepthMethod";break;case 52:x=u.get(1,0);s=this.getAssetByID(x,[l.TEXTURE]);if(!s[0])this._blocks[t].addError("Could not find the GradientDiffuseTexture (ID = "+x+" ) for this GradientDiffuseMethod");i.diffuseMethod=new ie(s[1]);c+=" | DiffuseGradientMethod | GradientDiffuseTexture-Name ="+s[1].name;break;case 53:i.diffuseMethod=new ae(u.get(101,5));c+=" | DiffuseWrapMethod";break;case 54:x=u.get(1,0);s=this.getAssetByID(x,[l.TEXTURE]);if(!s[0])this._blocks[t].addError("Could not find the LightMap (ID = "+x+" ) for this LightMapDiffuseMethod");i.diffuseMethod=new re(s[1],this.blendModeDic[u.get(401,10)],false,i.diffuseMethod);c+=" | DiffuseLightMapMethod | LightMapTexture-Name ="+s[1].name;break;case 55:i.diffuseMethod=new ee(u.get(401,3),i.diffuseMethod);i.diffuseMethod.smoothness=u.get(101,.1);c+=" | DiffuseCelMethod";break;case 56:break;case 101:i.specularMethod=new me;c+=" | SpecularAnisotropicMethod";break;case 102:i.specularMethod=new ve;c+=" | SpecularPhongMethod";break;case 103:i.specularMethod=new be(u.get(101,.5),i.specularMethod);i.specularMethod.smoothness=u.get(102,.1);c+=" | SpecularCelMethod";break;case 104:i.specularMethod=new ye(u.get(701,true),i.specularMethod);i.specularMethod.fresnelPower=u.get(101,5);i.specularMethod.normalReflectance=u.get(102,.1);c+=" | SpecularFresnelMethod";break;case 151:break;case 152:x=u.get(1,0);s=this.getAssetByID(x,[l.TEXTURE]);if(!s[0])this._blocks[t].addError("Could not find the SecoundNormalMap (ID = "+x+" ) for this SimpleWaterNormalMethod");if(!i.normalMap)this._blocks[t].addError("Could not find a normal Map on this Material to use with this SimpleWaterNormalMethod");
i.normalMap=s[1];i.normalMethod=new de(i.normalMap,s[1]);c+=" | NormalSimpleWaterMethod | Second-NormalTexture-Name = "+s[1].name;break}this.parseUserAttributes();w+=1}}i.extra=this.parseUserAttributes();this._pFinalizeAsset(i,n);this._blocks[t].data=i;if(this._debug){console.log(c)}};e.prototype.parseTexture=function(t){var e;this._blocks[t].name=this.parseVarStr();var i=this._newBlockBytes.readUnsignedByte();var r;this._texture_users[this._cur_block_id.toString()]=[];if(i==0){r=this._newBlockBytes.readUnsignedInt();var a;a=this._newBlockBytes.readUTFBytes(r);this._pAddDependency(this._cur_block_id.toString(),new h(a),false,null,true)}else{r=this._newBlockBytes.readUnsignedInt();var s;s=new m;this._newBlockBytes.readBytes(s,0,r);this._pAddDependency(this._cur_block_id.toString(),null,false,p.byteArrayToImage(s),true)}this.parseProperties(null);this._blocks[t].extras=this.parseUserAttributes();this._pPauseAndRetrieveDependencies();this._blocks[t].data=e;if(this._debug){var n=["external","embed"];console.log("Start parsing a "+n[i]+" Bitmap for Texture")}};e.prototype.parseCubeTexture=function(t){var e;var i;var r;this._cubeTextures=new Array;this._texture_users[this._cur_block_id.toString()]=[];var a=this._newBlockBytes.readUnsignedByte();this._blocks[t].name=this.parseVarStr();for(r=0;r<6;r++){this._texture_users[this._cur_block_id.toString()]=[];this._cubeTextures.push(null);if(a==0){e=this._newBlockBytes.readUnsignedInt();var s;s=this._newBlockBytes.readUTFBytes(e);this._pAddDependency(this._cur_block_id.toString()+"#"+r,new h(s),false,null,true)}else{e=this._newBlockBytes.readUnsignedInt();var n;n=new m;this._newBlockBytes.readBytes(n,0,e);this._pAddDependency(this._cur_block_id.toString()+"#"+r,null,false,p.byteArrayToImage(n),true)}}this.parseProperties(null);this._blocks[t].extras=this.parseUserAttributes();this._pPauseAndRetrieveDependencies();this._blocks[t].data=i;if(this._debug){var o=["external","embed"];console.log("Start parsing 6 "+o[a]+" Bitmaps for CubeTexture")}};e.prototype.parseSharedMethodBlock=function(t){var e;this._blocks[t].name=this.parseVarStr();e=this.parseSharedMethodList(t);this.parseUserAttributes();this._blocks[t].data=e;this._pFinalizeAsset(e,this._blocks[t].name);this._blocks[t].data=e;if(this._debug){console.log("Parsed a EffectMethod: Name = "+e.name+" Type = "+e)}};e.prototype.parseShadowMethodBlock=function(t){var e;var i;var r;var a;this._blocks[t].name=this.parseVarStr();a=this._newBlockBytes.readUnsignedInt();var s=this.getAssetByID(a,[l.LIGHT]);if(!s[0]){this._blocks[t].addError("Could not find the TargetLight (ID = "+a+" ) for this ShadowMethod - ShadowMethod not created");return}r=this.parseShadowMethodList(s[1],t);if(!r)return;this.parseUserAttributes();this._pFinalizeAsset(r,this._blocks[t].name);this._blocks[t].data=r;if(this._debug){console.log("Parsed a ShadowMapMethodMethod: Name = "+r.name+" | Type = "+r+" | Light-Name = ",s[1].name)}};e.prototype.parseCommand=function(t){var i=this._newBlockBytes.readUnsignedByte()==1;var r=this._newBlockBytes.readUnsignedInt();var a=this.parseMatrix3D();var s=this.parseVarStr();var o;var h;var u=this.getAssetByID(r,[l.CONTAINER,l.LIGHT,l.MESH]);if(u[0]){o=u[1]}var p=this._newBlockBytes.readShort();var c=this._newBlockBytes.readShort();var d=this.parseProperties({1:e.BADDR});switch(c){case 1:var f=d.get(1,0);var _=this.getAssetByID(f,[l.LIGHT,l.TEXTURE_PROJECTOR]);if(!_[0]&&f!=0){this._blocks[t].addError("Could not find the light (ID = "+f+" ( for this CommandBock!");return}h=_[1];if(o){o.addChild(h)}h.transform.matrix3D=a;break}if(h){d=this.parseProperties({1:this._matrixNrType,2:this._matrixNrType,3:this._matrixNrType,4:e.UINT8});h.pivot=new n(d.get(1,0),d.get(2,0),d.get(3,0));h.extra=this.parseUserAttributes()}this._blocks[t].data=h;if(this._debug){console.log("Parsed a CommandBlock: Name = '"+s)}};e.prototype.parseMetaData=function(t){var i=this.parseProperties({1:e.UINT32,2:e.AWDSTRING,3:e.AWDSTRING,4:e.AWDSTRING,5:e.AWDSTRING});if(this._debug){console.log("Parsed a MetaDataBlock: TimeStamp         = "+i.get(1,0));console.log("                        EncoderName       = "+i.get(2,"unknown"));console.log("                        EncoderVersion    = "+i.get(3,"unknown"));console.log("                        GeneratorName     = "+i.get(4,"unknown"));console.log("                        GeneratorVersion  = "+i.get(5,"unknown"))}};e.prototype.parseNameSpace=function(t){var e=this._newBlockBytes.readUnsignedByte();var i=this.parseVarStr();if(this._debug)console.log("Parsed a NameSpaceBlock: ID = "+e+" | String = "+i)};e.prototype.parseShadowMethodList=function(t,i){var r=this._newBlockBytes.readUnsignedShort();var a;var s=this.parseProperties({1:e.BADDR,2:e.BADDR,3:e.BADDR,101:this._propsNrType,102:this._propsNrType,103:this._propsNrType,201:e.UINT32,202:e.UINT32,301:e.UINT16,302:e.UINT16,401:e.UINT8,402:e.UINT8,601:e.COLOR,602:e.COLOR,701:e.BOOL,702:e.BOOL,801:e.MTX4x4});var n;var o;switch(r){case 1002:n=s.get(1,0);o=this.getAssetByID(n,[l.SHADOW_MAP_METHOD]);if(!o[0]){this._blocks[i].addError("Could not find the ShadowBaseMethod (ID = "+n+" ) for this ShadowNearMethod - ShadowMethod not created");return a}a=new we(o[1]);break;case 1101:a=new _e(t);a.alpha=s.get(101,1);a.epsilon=s.get(102,.002);break;case 1102:a=new fe(t,s.get(201,5));a.alpha=s.get(101,1);a.epsilon=s.get(102,.002);a.range=s.get(103,1);break;case 1103:a=new xe(t,s.get(201,5));a.alpha=s.get(101,1);a.epsilon=s.get(102,.002);a.range=s.get(103,1);break;case 1104:a=new ge(t);a.alpha=s.get(101,1);a.epsilon=s.get(102,.002);break}this.parseUserAttributes();return a};e.prototype.parseSkeleton=function(t){var e=this.parseVarStr();var i=this._newBlockBytes.readUnsignedShort();var r=new Z;this.parseProperties(null);var a=0;while(a<i){var s;var n;this._newBlockBytes.readUnsignedShort();s=new K;s.parentIndex=this._newBlockBytes.readUnsignedShort()-1;s.name=this.parseVarStr();n=this.parseMatrix3D();s.inverseBindPose=n.rawData;this.parseProperties(null);this.parseUserAttributes();r.joints.push(s);a++}this.parseUserAttributes();this._pFinalizeAsset(r,e);this._blocks[t].data=r;if(this._debug)console.log("Parsed a Skeleton: Name = "+r.name+" | Number of Joints = "+a)};e.prototype.parseSkeletonPose=function(t){var e=this.parseVarStr();var i=this._newBlockBytes.readUnsignedShort();this.parseProperties(null);var r=new q;var a=0;while(a<i){var n;var o;n=new Y;o=this._newBlockBytes.readUnsignedByte();if(o==1){var h=this.parseMatrix43RawData();var l=new s(h);n.orientation.fromMatrix(l);n.translation.copyFrom(l.position);r.jointPoses[a]=n}a++}this.parseUserAttributes();this._pFinalizeAsset(r,e);this._blocks[t].data=r;if(this._debug)console.log("Parsed a SkeletonPose: Name = "+r.name+" | Number of Joints = "+a)};e.prototype.parseSkeletonAnimation=function(t){var e;var i;var r=this.parseVarStr();var a=new J;var s=this._newBlockBytes.readUnsignedShort();this.parseProperties(null);var n=0;var o;while(n<s){i=this._newBlockBytes.readUnsignedInt();e=this._newBlockBytes.readUnsignedShort();o=this.getAssetByID(i,[l.SKELETON_POSE]);if(!o[0])this._blocks[t].addError("Could not find the SkeletonPose Frame # "+n+" (ID = "+i+" ) for this SkeletonClipNode");else a.addFrame(this._blocks[i].data,e);n++}if(a.frames.length==0){this._blocks[t].addError("Could not this SkeletonClipNode, because no Frames where set.");return}this.parseUserAttributes();this._pFinalizeAsset(a,r);this._blocks[t].data=a;if(this._debug)console.log("Parsed a SkeletonClipNode: Name = "+a.name+" | Number of Frames = "+a.frames.length)};e.prototype.parseMeshPoseAnimation=function(t,i){if(i===void 0){i=false}var r=1;var a;var s;var n;var o;var h;var u;var p;var c;var d;var f;var _;var y=0;var g=new Q;var m;var b;var v=0;var P=0;var D=new Array;var C;var T;var A=this.parseVarStr();var S=this._newBlockBytes.readUnsignedInt();var j=this.getAssetByID(S,[l.GEOMETRY]);if(!j[0]){this._blocks[t].addError("Could not find the target-Geometry-Object "+S+" ) for this VertexClipNode");return}var O=this.getUVForVertexAnimation(S);if(!i)r=this._newBlockBytes.readUnsignedShort();a=this._newBlockBytes.readUnsignedShort();v=this._newBlockBytes.readUnsignedShort();P=0;while(P<v){D.push(this._newBlockBytes.readUnsignedShort());P++}C=this.parseProperties({1:e.BOOL,2:e.BOOL});g.looping=C.get(1,true);g.stitchFinalFrame=C.get(2,false);s=0;while(s<r){o=this._newBlockBytes.readUnsignedShort();f=new w;n=0;while(n<a){P=0;c=this._newBlockBytes.readUnsignedInt();d=this._newBlockBytes.position+c;while(P<v){if(D[P]==1){m=j[1].subGeometries[n].indices;b=new Array;y=0;while(this._newBlockBytes.position<d){h=this.readNumber(this._accuracyGeo);u=this.readNumber(this._accuracyGeo);p=this.readNumber(this._accuracyGeo);b[y++]=h;b[y++]=u;b[y++]=p}_=new x(true);_.updateIndices(m);_.updatePositions(b);_.updateUVs(O[n]);_.updateVertexNormals(null);_.updateVertexTangents(null);_.autoDeriveNormals=false;_.autoDeriveTangents=false;n++;f.addSubGeometry(_)}else this._newBlockBytes.position=d;P++}}g.addFrame(f,o);s++}this.parseUserAttributes();this._pFinalizeAsset(g,A);this._blocks[t].data=g;if(this._debug)console.log("Parsed a VertexClipNode: Name = "+g.name+" | Target-Geometry-Name = "+j[1].name+" | Number of Frames = "+g.frames.length)};e.prototype.parseVertexAnimationSet=function(t){var i;var r="";var a=this.parseVarStr();var s=this._newBlockBytes.readUnsignedShort();var n=this.parseProperties({1:e.UINT16});var o=0;var h=new Array;var u=new Array;while(o<s){i=this._newBlockBytes.readUnsignedInt();var p=this.getAssetByID(i,[l.ANIMATION_NODE]);if(!p[0])this._blocks[t].addError("Could not find the AnimationClipNode Nr "+o+" ( "+i+" ) for this AnimationSet");else{if(p[1]instanceof Q)u.push(p[1]);if(p[1]instanceof J)h.push(p[1])}o++}if(u.length==0&&h.length==0){this._blocks[t].addError("Could not create this AnimationSet, because it contains no animations");return}this.parseUserAttributes();if(u.length>0){var c=new G;for(var d=0;d<u.length;d++)c.addAnimation(u[d]);this._pFinalizeAsset(c,a);this._blocks[t].data=c;if(this._debug)console.log("Parsed a VertexAnimationSet: Name = "+a+" | Animations = "+c.animations.length+" | Animation-Names = "+c.animationNames.toString())}else if(h.length>0){p=this.getAssetByID(i,[l.ANIMATION_NODE]);var f=new X(n.get(1,4));for(var d=0;d<h.length;d++)f.addAnimation(h[d]);this._pFinalizeAsset(f,a);this._blocks[t].data=f;if(this._debug)console.log("Parsed a SkeletonAnimationSet: Name = "+a+" | Animations = "+f.animations.length+" | Animation-Names = "+f.animationNames.toString())}};e.prototype.parseAnimatorSet=function(t){var i;var r;var a;var s="";var n=this.parseVarStr();var o=this._newBlockBytes.readUnsignedShort();var h=this.parseProperties({1:e.BADDR});r=this._newBlockBytes.readUnsignedInt();var u=this._newBlockBytes.readUnsignedShort();var p=new Array;for(var c=0;c<u;c++)p.push(this._newBlockBytes.readUnsignedInt());var d=this._newBlockBytes.readUnsignedShort();var f=this._newBlockBytes.readUnsignedByte()==1;this.parseUserAttributes();this.parseUserAttributes();var _;var y=new Array;for(c=0;c<p.length;c++){_=this.getAssetByID(p[c],[l.MESH]);if(_[0])y.push(_[1])}_=this.getAssetByID(r,[l.ANIMATION_SET]);if(!_[0]){this._blocks[t].addError("Could not find the AnimationSet ( "+r+" ) for this Animator");return}a=_[1];var g;if(o==1){_=this.getAssetByID(h.get(1,0),[l.SKELETON]);if(!_[0]){this._blocks[t].addError("Could not find the Skeleton ( "+h.get(1,0)+" ) for this Animator");return}g=new W(a,_[1])}else if(o==2)g=new H(a);this._pFinalizeAsset(g,n);this._blocks[t].data=g;for(c=0;c<y.length;c++){if(o==1)y[c].animator=g;if(o==2)y[c].animator=g}if(this._debug)console.log("Parsed a Animator: Name = "+n)};e.prototype.parseSharedMethodList=function(t){var i=this._newBlockBytes.readUnsignedShort();var r;var s=this.parseProperties({1:e.BADDR,2:e.BADDR,3:e.BADDR,101:this._propsNrType,102:this._propsNrType,103:this._propsNrType,104:this._propsNrType,105:this._propsNrType,106:this._propsNrType,107:this._propsNrType,201:e.UINT32,202:e.UINT32,301:e.UINT16,302:e.UINT16,401:e.UINT8,402:e.UINT8,601:e.COLOR,602:e.COLOR,701:e.BOOL,702:e.BOOL});var n;var o;switch(i){case 401:r=new ne(s.get(101,new Array(0,0,0,1,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)));break;case 402:r=new oe;var h=s.get(601,0);r.colorTransform=new a(s.get(102,1),s.get(103,1),s.get(104,1),s.get(101,1),h>>16&255,h>>8&255,h&255,h>>24&255);break;case 403:n=s.get(1,0);console.log("ENV MAP",n);o=this.getAssetByID(n,[l.TEXTURE],"CubeTexture");if(!o[0])this._blocks[t].addError("Could not find the EnvMap (ID = "+n+" ) for this EnvMapMethod");r=new he(o[1],s.get(101,1));n=s.get(2,0);if(n>0){o=this.getAssetByID(n,[l.TEXTURE]);if(!o[0])this._blocks[t].addError("Could not find the Mask-texture (ID = "+n+" ) for this EnvMapMethod")}break;case 404:n=s.get(1,0);o=this.getAssetByID(n,[l.TEXTURE]);if(!o[0])this._blocks[t].addError("Could not find the LightMap (ID = "+n+" ) for this LightMapMethod");r=new pe(o[1],this.blendModeDic[s.get(401,10)]);break;case 406:r=new ce(s.get(601,16777215),s.get(101,.4),s.get(101,2));break;case 407:n=s.get(1,0);o=this.getAssetByID(n,[l.TEXTURE]);if(!o[0])this._blocks[t].addError("Could not find the Alpha-texture (ID = "+n+" ) for this AlphaMaskMethod");r=new se(o[1],s.get(701,false));break;case 410:n=s.get(1,0);o=this.getAssetByID(n,[l.TEXTURE],"CubeTexture");if(!o[0])this._blocks[t].addError("Could not find the EnvMap (ID = "+n+" ) for this FresnelEnvMapMethod");r=new ue(o[1],s.get(101,1));break;case 411:r=new le(s.get(101,0),s.get(102,1e3),s.get(601,8421504));break}this.parseUserAttributes();return r};e.prototype.parseUserAttributes=function(){var t;var i;var r;i=this._newBlockBytes.readUnsignedInt();if(i>0){var a;t={};a=this._newBlockBytes.position+i;while(this._newBlockBytes.position<a){var s;var n;var o;var h;var l;s=this._newBlockBytes.readUnsignedByte();n=this.parseVarStr();o=this._newBlockBytes.readUnsignedByte();h=this._newBlockBytes.readUnsignedInt();if(this._newBlockBytes.position+h>a){console.log("           Error in reading attribute # "+r+" = skipped to end of attribute-list");this._newBlockBytes.position=a;return t}switch(o){case e.AWDSTRING:l=this._newBlockBytes.readUTFBytes(h);break;case e.INT8:l=this._newBlockBytes.readByte();break;case e.INT16:l=this._newBlockBytes.readShort();break;case e.INT32:l=this._newBlockBytes.readInt();break;case e.BOOL:case e.UINT8:l=this._newBlockBytes.readUnsignedByte();break;case e.UINT16:l=this._newBlockBytes.readUnsignedShort();break;case e.UINT32:case e.BADDR:l=this._newBlockBytes.readUnsignedInt();break;case e.FLOAT32:l=this._newBlockBytes.readFloat();break;case e.FLOAT64:l=this._newBlockBytes.readDouble();break;default:l="unimplemented attribute type "+o;this._newBlockBytes.position+=h;break}if(this._debug){console.log("attribute = name: "+n+"  / value = "+l)}t[n]=l;r+=1}}return t};e.prototype.parseProperties=function(t){var e;var i;var r=0;var a=new De;i=this._newBlockBytes.readUnsignedInt();e=this._newBlockBytes.position+i;if(t){while(this._newBlockBytes.position<e){var s;var n;var o;n=this._newBlockBytes.readUnsignedShort();s=this._newBlockBytes.readUnsignedInt();if(this._newBlockBytes.position+s>e){console.log("           Error in reading property # "+r+" = skipped to end of propertie-list");this._newBlockBytes.position=e;return a}if(t.hasOwnProperty(n.toString())){o=t[n];a.set(n,this.parseAttrValue(o,s))}else{this._newBlockBytes.position+=s}r+=1}}else{this._newBlockBytes.position=e}return a};e.prototype.parseAttrValue=function(t,i){var r;var a;switch(t){case e.BOOL:case e.INT8:r=1;a=this._newBlockBytes.readByte;break;case e.INT16:r=2;a=this._newBlockBytes.readShort;break;case e.INT32:r=4;a=this._newBlockBytes.readInt;break;case e.UINT8:r=1;a=this._newBlockBytes.readUnsignedByte;break;case e.UINT16:r=2;a=this._newBlockBytes.readUnsignedShort;break;case e.UINT32:case e.COLOR:case e.BADDR:r=4;a=this._newBlockBytes.readUnsignedInt;break;case e.FLOAT32:r=4;a=this._newBlockBytes.readFloat;break;case e.FLOAT64:r=8;a=this._newBlockBytes.readDouble;break;case e.AWDSTRING:return this._newBlockBytes.readUTFBytes(i);case e.VECTOR2x1:case e.VECTOR3x1:case e.VECTOR4x1:case e.MTX3x2:case e.MTX3x3:case e.MTX4x3:case e.MTX4x4:r=8;a=this._newBlockBytes.readDouble;break}if(r<i){var s=[];var n=0;var o=i/r;while(n<o){s.push(a.apply(this._newBlockBytes));n++}return s}else{var h=a.apply(this._newBlockBytes);return h}};e.prototype.parseHeader=function(){var t;var i;this._byteData.position=3;this._version[0]=this._byteData.readUnsignedByte();this._version[1]=this._byteData.readUnsignedByte();t=this._byteData.readUnsignedShort();this._streaming=Ce.test(t,Ce.FLAG1);if(this._version[0]==2&&this._version[1]==1){this._accuracyMatrix=Ce.test(t,Ce.FLAG2);this._accuracyGeo=Ce.test(t,Ce.FLAG3);this._accuracyProps=Ce.test(t,Ce.FLAG4)}this._geoNrType=e.FLOAT32;if(this._accuracyGeo){this._geoNrType=e.FLOAT64}this._matrixNrType=e.FLOAT32;if(this._accuracyMatrix){this._matrixNrType=e.FLOAT64}this._propsNrType=e.FLOAT32;if(this._accuracyProps){this._propsNrType=e.FLOAT64}this._compression=this._byteData.readUnsignedByte();if(this._debug){console.log("Import AWDFile of version = "+this._version[0]+" - "+this._version[1]);console.log("Global Settings = Compression = "+this._compression+" | Streaming = "+this._streaming+" | Matrix-Precision = "+this._accuracyMatrix+" | Geometry-Precision = "+this._accuracyGeo+" | Properties-Precision = "+this._accuracyProps)}i=this._byteData.readUnsignedInt();if(!this._streaming&&i!=this._byteData.getBytesAvailable()){this._pDieWithError("AWD2 body length does not match header integrity field")}};e.prototype.getUVForVertexAnimation=function(t){if(this._blocks[t].data instanceof T)t=this._blocks[t].geoID;if(this._blocks[t].uvsForVertexAnimation)return this._blocks[t].uvsForVertexAnimation;var e=this._blocks[t].data;var i=0;var r;var a;var s;var n;var o;var h;var l;this._blocks[t].uvsForVertexAnimation=new Array;while(i<e.subGeometries.length){h=new Array;l=e.subGeometries[i];n=l.numVertices;r=l.uvs;a=l.getStride(x.UV_DATA);s=l.getOffset(x.UV_DATA);for(o=0;o<n;o++){h.push(r[s+o*a+0]);h.push(r[s+o*a+1])}this._blocks[t].uvsForVertexAnimation.push(h);i++}return this._blocks[t].uvsForVertexAnimation};e.prototype.parseVarStr=function(){var t=this._newBlockBytes.readUnsignedShort();return this._newBlockBytes.readUTFBytes(t)};e.prototype.getAssetByID=function(t,e,i){if(i===void 0){i="SingleTexture"}var r=new Array;var a=0;if(t>0){if(this._blocks[t]){if(this._blocks[t].data){while(a<e.length){var s=this._blocks[t].data;if(s.assetType==e[a]){if(e[a]==l.TEXTURE&&i=="CubeTexture"){if(this._blocks[t].data instanceof y){r.push(true);r.push(this._blocks[t].data);return r}}if(e[a]==l.TEXTURE&&i=="SingleTexture"){if(this._blocks[t].data instanceof g){r.push(true);r.push(this._blocks[t].data);return r}}else{r.push(true);r.push(this._blocks[t].data);return r}}if(e[a]==l.GEOMETRY&&s.assetType==l.MESH){var n=this._blocks[t].data;r.push(true);r.push(n.geometry);return r}a++}}}}r.push(false);r.push(this.getDefaultAsset(e[0],i));return r};e.prototype.getDefaultAsset=function(t,e){switch(true){case t==l.TEXTURE:if(e=="CubeTexture")return this.getDefaultCubeTexture();if(e=="SingleTexture")return this.getDefaultTexture();break;case t==l.MATERIAL:return this.getDefaultMaterial();break;default:break}return null};e.prototype.getDefaultMaterial=function(){if(!this._defaultBitmapMaterial)this._defaultBitmapMaterial=z.getDefaultMaterial();return this._defaultBitmapMaterial};e.prototype.getDefaultTexture=function(){if(!this._defaultTexture)this._defaultTexture=z.getDefaultTexture();return this._defaultTexture};e.prototype.getDefaultCubeTexture=function(){if(!this._defaultCubeTexture){var t=z.createCheckeredBitmapData();this._defaultCubeTexture=new _(t,t,t,t,t,t);this._defaultCubeTexture.name="defaultCubeTexture"}return this._defaultCubeTexture};e.prototype.readNumber=function(t){if(t===void 0){t=false}if(t)return this._newBlockBytes.readDouble();return this._newBlockBytes.readFloat()};e.prototype.parseMatrix3D=function(){return new s(this.parseMatrix43RawData())};e.prototype.parseMatrix32RawData=function(){var t;var e=new Array(6);for(t=0;t<6;t++){e[t]=this._newBlockBytes.readFloat()}return e};e.prototype.parseMatrix43RawData=function(){var t=new Array(16);t[0]=this.readNumber(this._accuracyMatrix);t[1]=this.readNumber(this._accuracyMatrix);t[2]=this.readNumber(this._accuracyMatrix);t[3]=0;t[4]=this.readNumber(this._accuracyMatrix);t[5]=this.readNumber(this._accuracyMatrix);t[6]=this.readNumber(this._accuracyMatrix);t[7]=0;t[8]=this.readNumber(this._accuracyMatrix);t[9]=this.readNumber(this._accuracyMatrix);t[10]=this.readNumber(this._accuracyMatrix);t[11]=0;t[12]=this.readNumber(this._accuracyMatrix);t[13]=this.readNumber(this._accuracyMatrix);t[14]=this.readNumber(this._accuracyMatrix);t[15]=1;if(isNaN(t[0])){t[0]=1;t[1]=0;t[2]=0;t[4]=0;t[5]=1;t[6]=0;t[8]=0;t[9]=0;t[10]=1;t[12]=0;t[13]=0;t[14]=0}return t};e.COMPRESSIONMODE_LZMA="lzma";e.UNCOMPRESSED=0;e.DEFLATE=1;e.LZMA=2;e.INT8=1;e.INT16=2;e.INT32=3;e.UINT8=4;e.UINT16=5;e.UINT32=6;e.FLOAT32=7;e.FLOAT64=8;e.BOOL=21;e.COLOR=22;e.BADDR=23;e.AWDSTRING=31;e.AWDBYTEARRAY=32;e.VECTOR2x1=41;e.VECTOR3x1=42;e.VECTOR4x1=43;e.MTX3x2=44;e.MTX3x3=45;e.MTX4x3=46;e.MTX4x4=47;return e}(u);e.exports=Te},{"awayjs-core/lib/geom/ColorTransform":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/library/AssetType":undefined,"awayjs-core/lib/net/URLLoaderDataFormat":undefined,"awayjs-core/lib/net/URLRequest":undefined,"awayjs-core/lib/parsers/ParserBase":undefined,"awayjs-core/lib/parsers/ParserUtils":undefined,"awayjs-core/lib/projections/OrthographicOffCenterProjection":undefined,"awayjs-core/lib/projections/OrthographicProjection":undefined,"awayjs-core/lib/projections/PerspectiveProjection":undefined,"awayjs-core/lib/textures/BitmapCubeTexture":undefined,"awayjs-core/lib/textures/ImageCubeTexture":undefined,"awayjs-core/lib/textures/ImageTexture":undefined,"awayjs-core/lib/utils/ByteArray":undefined,"awayjs-display/lib/base/BlendMode":undefined,"awayjs-display/lib/base/Geometry":undefined,"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-display/lib/containers/DisplayObjectContainer":undefined,"awayjs-display/lib/entities/Camera":undefined,"awayjs-display/lib/entities/DirectionalLight":undefined,"awayjs-display/lib/entities/Mesh":undefined,"awayjs-display/lib/entities/PointLight":undefined,"awayjs-display/lib/entities/Skybox":undefined,"awayjs-display/lib/materials/lightpickers/StaticLightPicker":undefined,"awayjs-display/lib/materials/shadowmappers/CubeMapShadowMapper":undefined,"awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper":undefined,"awayjs-display/lib/prefabs/PrefabBase":undefined,"awayjs-display/lib/prefabs/PrimitiveCapsulePrefab":undefined,"awayjs-display/lib/prefabs/PrimitiveConePrefab":undefined,"awayjs-display/lib/prefabs/PrimitiveCubePrefab":undefined,"awayjs-display/lib/prefabs/PrimitiveCylinderPrefab":undefined,"awayjs-display/lib/prefabs/PrimitivePlanePrefab":undefined,"awayjs-display/lib/prefabs/PrimitiveSpherePrefab":undefined,"awayjs-display/lib/prefabs/PrimitiveTorusPrefab":undefined,"awayjs-renderergl/lib/animators/SkeletonAnimationSet":undefined,"awayjs-renderergl/lib/animators/SkeletonAnimator":undefined,"awayjs-renderergl/lib/animators/VertexAnimationSet":undefined,"awayjs-renderergl/lib/animators/VertexAnimator":undefined,"awayjs-renderergl/lib/animators/data/JointPose":undefined,"awayjs-renderergl/lib/animators/data/Skeleton":undefined,"awayjs-renderergl/lib/animators/data/SkeletonJoint":undefined,"awayjs-renderergl/lib/animators/data/SkeletonPose":undefined,"awayjs-renderergl/lib/animators/nodes/SkeletonClipNode":undefined,"awayjs-renderergl/lib/animators/nodes/VertexClipNode":undefined,"awayjs-renderergl/lib/materials/methods/AmbientEnvMapMethod":undefined,"awayjs-renderergl/lib/materials/methods/DiffuseCelMethod":undefined,"awayjs-renderergl/lib/materials/methods/DiffuseDepthMethod":undefined,"awayjs-renderergl/lib/materials/methods/DiffuseGradientMethod":undefined,"awayjs-renderergl/lib/materials/methods/DiffuseLightMapMethod":undefined,"awayjs-renderergl/lib/materials/methods/DiffuseWrapMethod":undefined,"awayjs-renderergl/lib/materials/methods/EffectAlphaMaskMethod":undefined,"awayjs-renderergl/lib/materials/methods/EffectColorMatrixMethod":undefined,"awayjs-renderergl/lib/materials/methods/EffectEnvMapMethod":undefined,"awayjs-renderergl/lib/materials/methods/EffectFogMethod":undefined,"awayjs-renderergl/lib/materials/methods/EffectFresnelEnvMapMethod":undefined,"awayjs-renderergl/lib/materials/methods/EffectLightMapMethod":undefined,"awayjs-renderergl/lib/materials/methods/EffectRimLightMethod":undefined,"awayjs-renderergl/lib/materials/methods/NormalSimpleWaterMethod":undefined,"awayjs-renderergl/lib/materials/methods/ShadowDitheredMethod":undefined,"awayjs-renderergl/lib/materials/methods/ShadowFilteredMethod":undefined,"awayjs-renderergl/lib/materials/methods/ShadowNearMethod":undefined,"awayjs-renderergl/lib/materials/methods/ShadowSoftMethod":undefined,"awayjs-renderergl/lib/materials/methods/SpecularAnisotropicMethod":undefined,"awayjs-renderergl/lib/materials/methods/SpecularCelMethod":undefined,"awayjs-renderergl/lib/materials/methods/SpecularFresnelMethod":undefined,"awayjs-renderergl/lib/materials/methods/SpecularPhongMethod":undefined,"awayjs-renderergl/lib/parsers/data/AWDBlock":undefined,"awayjs-renderergl/lib/parsers/data/AWDProperties":undefined,"awayjs-renderergl/lib/parsers/data/BitFlags":undefined,"awayjs-stagegl/lib/materials/SkyboxMaterial":undefined,"awayjs-stagegl/lib/materials/TriangleMaterialMode":undefined,"awayjs-stagegl/lib/materials/TriangleMethodMaterial":undefined,"awayjs-stagegl/lib/materials/methods/EffectColorTransformMethod":undefined,"awayjs-stagegl/lib/materials/methods/ShadowHardMethod":undefined,"awayjs-stagegl/lib/materials/utils/DefaultMaterialManager":undefined}],"awayjs-renderergl/lib/parsers/MD2Parser":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/net/URLLoaderDataFormat");var s=t("awayjs-core/lib/net/URLRequest");var n=t("awayjs-core/lib/parsers/ParserBase");var o=t("awayjs-core/lib/parsers/ParserUtils");var h=t("awayjs-display/lib/containers/DisplayObjectContainer");var l=t("awayjs-display/lib/base/Geometry");var u=t("awayjs-display/lib/base/TriangleSubGeometry");var p=t("awayjs-display/lib/entities/Mesh");var c=t("awayjs-stagegl/lib/materials/utils/DefaultMaterialManager");var d=t("awayjs-stagegl/lib/materials/TriangleMethodMaterial");var f=t("awayjs-stagegl/lib/materials/TriangleMaterialMode");var _=t("awayjs-renderergl/lib/animators/nodes/VertexClipNode");var y=t("awayjs-renderergl/lib/animators/VertexAnimationSet");var g=function(t){r(e,t);function e(e,i){if(e===void 0){e="jpg"}if(i===void 0){i=true}t.call(this,a.ARRAY_BUFFER);this._clipNodes=new Object;this._animationSet=new y;this.materialFinal=false;this.geoCreated=false;this._textureType=e;this._ignoreTexturePath=i}e.supportsType=function(t){t=t.toLowerCase();return t=="md2"};e.supportsData=function(t){return o.toString(t,4)=="IDP2"};e.prototype._iResolveDependency=function(t){if(t.assets.length!=1)return;var e=t.assets[0];if(e){var i=new d(e);if(this.materialMode>=2)i.materialMode=f.MULTI_PASS;this._pContent.addChild(this._mesh);i.name=this._mesh.material.name;this._mesh.material=i;this._pFinalizeAsset(i);this._pFinalizeAsset(this._mesh.geometry);this._pFinalizeAsset(this._mesh)}this.materialFinal=true};e.prototype._iResolveDependencyFailure=function(t){if(this.materialMode<2){this._mesh.material=c.getDefaultMaterial()}else{this._mesh.material=new d(c.getDefaultTexture());this._mesh.material.materialMode=f.MULTI_PASS}this._pContent.addChild(this._mesh);this._pFinalizeAsset(this._mesh.geometry);this._pFinalizeAsset(this._mesh);this.materialFinal=true};e.prototype._pProceedParsing=function(){if(!this._startedParsing){this._byteData=this._pGetByteData();this._startedParsing=true;this._byteData.position=0}while(this._pHasTime()){if(!this._parsedHeader){this._geometry=new l;this._mesh=new p(this._geometry,null);if(this.materialMode<2){this._mesh.material=c.getDefaultMaterial()}else{this._mesh.material=new d(c.getDefaultTexture());this._mesh.material.materialMode=f.MULTI_PASS}this.parseHeader();this.parseMaterialNames()}else if(!this._parsedUV){this.parseUV()}else if(!this._parsedFaces){this.parseFaces()}else if(!this._parsedFrames){this.parseFrames()}else if(this.geoCreated&&this.materialFinal){return n.PARSING_DONE}else if(!this.geoCreated){this.geoCreated=true;this._geometry.addSubGeometry(this._firstSubGeom.clone());this._mesh.name="";if(this.materialFinal){this._pContent.addChild(this._mesh);this._pFinalizeAsset(this._mesh.geometry);this._pFinalizeAsset(this._mesh)}this._pPauseAndRetrieveDependencies()}}return n.MORE_TO_PARSE};e.prototype._pStartParsing=function(e){t.prototype._pStartParsing.call(this,e);this._pContent=new h};e.prototype.parseHeader=function(){this._ident=this._byteData.readInt();this._version=this._byteData.readInt();this._skinWidth=this._byteData.readInt();this._skinHeight=this._byteData.readInt();this._byteData.readInt();this._numSkins=this._byteData.readInt();this._numVertices=this._byteData.readInt();this._numST=this._byteData.readInt();this._numTris=this._byteData.readInt();this._byteData.readInt();this._numFrames=this._byteData.readInt();this._offsetSkins=this._byteData.readInt();this._offsetST=this._byteData.readInt();this._offsetTris=this._byteData.readInt();this._offsetFrames=this._byteData.readInt();this._byteData.readInt();this._offsetEnd=this._byteData.readInt();this._parsedHeader=true};e.prototype.parseMaterialNames=function(){var t;var e;var i;var r;this._materialNames=new Array;this._byteData.position=this._offsetSkins;var a=new RegExp("[^a-zA-Z0-9\\_/.]","g");for(var n=0;n<this._numSkins;++n){e=this._byteData.readUTFBytes(64);e=e.replace(a,"");i=e.lastIndexOf(".");if(this._ignoreTexturePath)r=e.lastIndexOf("/");if(e.toLowerCase().indexOf(".jpg")==-1&&e.toLowerCase().indexOf(".png")==-1){e=e.substring(r+1,i);t=e+"."+this._textureType}else{t=e}this._materialNames[n]=e;if(this.dependencies.length==0)this._pAddDependency(e,new s(t))}if(this._materialNames.length>0)this._mesh.material.name=this._materialNames[0];else this.materialFinal=true};e.prototype.parseUV=function(){var t=0;this._uvs=new Array(this._numST*2);this._byteData.position=this._offsetST;for(var e=0;e<this._numST;e++){this._uvs[t++]=this._byteData.readShort()/this._skinWidth;this._uvs[t++]=this._byteData.readShort()/this._skinHeight}this._parsedUV=true};e.prototype.parseFaces=function(){var t,e,i,r,a,s;var n;this._vertIndices=new Array;this._uvIndices=new Array;this._indices=new Array;this._byteData.position=this._offsetTris;for(n=0;n<this._numTris;n++){t=this._byteData.readUnsignedShort();e=this._byteData.readUnsignedShort();i=this._byteData.readUnsignedShort();r=this._byteData.readUnsignedShort();a=this._byteData.readUnsignedShort();s=this._byteData.readUnsignedShort();this.addIndex(t,r);this.addIndex(e,a);this.addIndex(i,s)}var o=this._uvIndices.length;this._finalUV=new Array(o*2);for(n=0;n<o;++n){this._finalUV[n<<1]=this._uvs[this._uvIndices[n]<<1];this._finalUV[(n<<1)+1]=this._uvs[(this._uvIndices[n]<<1)+1]}this._parsedFaces=true};e.prototype.addIndex=function(t,e){var i=this.findIndex(t,e);if(i==-1){this._indices.push(this._vertIndices.length);this._vertIndices.push(t);this._uvIndices.push(e)}else this._indices.push(i)};e.prototype.findIndex=function(t,e){var i=this._vertIndices.length;for(var r=0;r<i;++r){if(this._vertIndices[r]==t&&this._uvIndices[r]==e)return r}return-1};e.prototype.parseFrames=function(){var t,i,r;var a,s,n;var o;var h;var p=this._vertIndices.length;var c;var d;var f,y,g;var m="";var b=null;this._byteData.position=this._offsetFrames;
for(f=0;f<this._numFrames;f++){d=new Array;c=new Array(p*3);t=this._byteData.readFloat();i=this._byteData.readFloat();r=this._byteData.readFloat();a=this._byteData.readFloat();s=this._byteData.readFloat();n=this._byteData.readFloat();m=this.readFrameName();for(y=0;y<this._numVertices;y++,this._byteData.position++)d.push(t*this._byteData.readUnsignedByte()+a,i*this._byteData.readUnsignedByte()+s,r*this._byteData.readUnsignedByte()+n);g=0;for(y=0;y<p;y++){c[g++]=d[this._vertIndices[y]*3];c[g++]=d[this._vertIndices[y]*3+2];c[g++]=d[this._vertIndices[y]*3+1]}h=new u(true);if(this._firstSubGeom==null)this._firstSubGeom=h;o=new l;o.addSubGeometry(h);h.updateIndices(this._indices);h.updatePositions(c);h.updateUVs(this._finalUV);h.vertexNormals;h.vertexTangents;h.autoDeriveNormals=false;h.autoDeriveTangents=false;var v=this._clipNodes[m];if(!v){if(b){this._pFinalizeAsset(b);this._animationSet.addAnimation(b)}v=new _;v.name=m;v.stitchFinalFrame=true;this._clipNodes[m]=v;b=v}v.addFrame(o,1e3/e.FPS)}if(b){this._pFinalizeAsset(b);this._animationSet.addAnimation(b)}this._pFinalizeAsset(this._animationSet);this._parsedFrames=true};e.prototype.readFrameName=function(){var t="";var e=0;for(var i=0;i<16;i++){var r=this._byteData.readUnsignedByte();if(Math.floor(r)>57&&Math.floor(r)<=122&&e==0)t+=String.fromCharCode(r);if(Math.floor(r)>=48&&Math.floor(r)<=57)e++}return t};e.FPS=6;return e}(n);e.exports=g},{"awayjs-core/lib/net/URLLoaderDataFormat":undefined,"awayjs-core/lib/net/URLRequest":undefined,"awayjs-core/lib/parsers/ParserBase":undefined,"awayjs-core/lib/parsers/ParserUtils":undefined,"awayjs-display/lib/base/Geometry":undefined,"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-display/lib/containers/DisplayObjectContainer":undefined,"awayjs-display/lib/entities/Mesh":undefined,"awayjs-renderergl/lib/animators/VertexAnimationSet":undefined,"awayjs-renderergl/lib/animators/nodes/VertexClipNode":undefined,"awayjs-stagegl/lib/materials/TriangleMaterialMode":undefined,"awayjs-stagegl/lib/materials/TriangleMethodMaterial":undefined,"awayjs-stagegl/lib/materials/utils/DefaultMaterialManager":undefined}],"awayjs-renderergl/lib/parsers/MD5AnimParser":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Quaternion");var s=t("awayjs-core/lib/geom/Vector3D");var n=t("awayjs-core/lib/net/URLLoaderDataFormat");var o=t("awayjs-core/lib/parsers/ParserBase");var h=t("awayjs-renderergl/lib/animators/data/JointPose");var l=t("awayjs-renderergl/lib/animators/data/SkeletonPose");var u=t("awayjs-renderergl/lib/animators/nodes/SkeletonClipNode");var p=t("awayjs-renderergl/lib/parsers/data/BaseFrameData");var c=t("awayjs-renderergl/lib/parsers/data/BoundsData");var d=t("awayjs-renderergl/lib/parsers/data/FrameData");var f=t("awayjs-renderergl/lib/parsers/data/HierarchyData");var _=function(t){r(e,t);function e(e,i){if(e===void 0){e=null}if(i===void 0){i=0}t.call(this,n.TEXT);this._parseIndex=0;this._line=0;this._charLineIndex=0;this._rotationQuat=new a;var r=new a;var o=new a;r.fromAxisAngle(s.X_AXIS,-Math.PI*.5);o.fromAxisAngle(s.Y_AXIS,-Math.PI*.5);this._rotationQuat.multiply(o,r);if(e){this._rotationQuat.multiply(o,r);r.fromAxisAngle(e,i);this._rotationQuat.multiply(r,this._rotationQuat)}}e.supportsType=function(t){t=t.toLowerCase();return t=="md5anim"};e.supportsData=function(t){return false};e.prototype._pProceedParsing=function(){var t;if(!this._startedParsing){this._textData=this._pGetTextData();this._startedParsing=true}while(this._pHasTime()){t=this.getNextToken();switch(t){case e.COMMENT_TOKEN:this.ignoreLine();break;case"":break;case e.VERSION_TOKEN:this._version=this.getNextInt();if(this._version!=10)throw new Error("Unknown version number encountered!");break;case e.COMMAND_LINE_TOKEN:this.parseCMD();break;case e.NUM_FRAMES_TOKEN:this._numFrames=this.getNextInt();this._bounds=new Array;this._frameData=new Array;break;case e.NUM_JOINTS_TOKEN:this._numJoints=this.getNextInt();this._hierarchy=new Array(this._numJoints);this._baseFrameData=new Array(this._numJoints);break;case e.FRAME_RATE_TOKEN:this._frameRate=this.getNextInt();break;case e.NUM_ANIMATED_COMPONENTS_TOKEN:this._numAnimatedComponents=this.getNextInt();break;case e.HIERARCHY_TOKEN:this.parseHierarchy();break;case e.BOUNDS_TOKEN:this.parseBounds();break;case e.BASE_FRAME_TOKEN:this.parseBaseFrame();break;case e.FRAME_TOKEN:this.parseFrame();break;default:if(!this._reachedEOF)this.sendUnknownKeywordError()}if(this._reachedEOF){this._clip=new u;this.translateClip();this._pFinalizeAsset(this._clip);return o.PARSING_DONE}}return o.MORE_TO_PARSE};e.prototype.translateClip=function(){for(var t=0;t<this._numFrames;++t)this._clip.addFrame(this.translatePose(this._frameData[t]),1e3/this._frameRate)};e.prototype.translatePose=function(t){var e;var i;var r;var n;var o;var u=new s;var p=new a;var c=t.components;var d=new l;var f=d.jointPoses;for(var _=0;_<this._numJoints;++_){o=0;i=new h;e=this._hierarchy[_];r=this._baseFrameData[_];n=e.flags;u.x=r.position.x;u.y=r.position.y;u.z=r.position.z;p.x=r.orientation.x;p.y=r.orientation.y;p.z=r.orientation.z;if(n&1)u.x=c[e.startIndex+o++];if(n&2)u.y=c[e.startIndex+o++];if(n&4)u.z=c[e.startIndex+o++];if(n&8)p.x=c[e.startIndex+o++];if(n&16)p.y=c[e.startIndex+o++];if(n&32)p.z=c[e.startIndex+o++];var y=1-p.x*p.x-p.y*p.y-p.z*p.z;p.w=y<0?0:-Math.sqrt(y);if(e.parentIndex<0){i.orientation.multiply(this._rotationQuat,p);i.translation=this._rotationQuat.rotatePoint(u)}else{i.orientation.copyFrom(p);i.translation.x=u.x;i.translation.y=u.y;i.translation.z=u.z}i.orientation.y=-i.orientation.y;i.orientation.z=-i.orientation.z;i.translation.x=-i.translation.x;f[_]=i}return d};e.prototype.parseHierarchy=function(){var t;var i;var r=this.getNextToken();var a=0;if(r!="{")this.sendUnknownKeywordError();do{if(this._reachedEOF)this.sendEOFError();i=new f;i.name=this.parseLiteralstring();i.parentIndex=this.getNextInt();i.flags=this.getNextInt();i.startIndex=this.getNextInt();this._hierarchy[a++]=i;t=this.getNextChar();if(t=="/"){this.putBack();t=this.getNextToken();if(t==e.COMMENT_TOKEN)this.ignoreLine();t=this.getNextChar()}if(t!="}")this.putBack()}while(t!="}")};e.prototype.parseBounds=function(){var t;var i;var r=this.getNextToken();var a=0;if(r!="{")this.sendUnknownKeywordError();do{if(this._reachedEOF)this.sendEOFError();i=new c;i.min=this.parseVector3D();i.max=this.parseVector3D();this._bounds[a++]=i;t=this.getNextChar();if(t=="/"){this.putBack();t=this.getNextToken();if(t==e.COMMENT_TOKEN)this.ignoreLine();t=this.getNextChar()}if(t!="}")this.putBack()}while(t!="}")};e.prototype.parseBaseFrame=function(){var t;var i;var r=this.getNextToken();var a=0;if(r!="{")this.sendUnknownKeywordError();do{if(this._reachedEOF)this.sendEOFError();i=new p;i.position=this.parseVector3D();i.orientation=this.parseQuaternion();this._baseFrameData[a++]=i;t=this.getNextChar();if(t=="/"){this.putBack();t=this.getNextToken();if(t==e.COMMENT_TOKEN)this.ignoreLine();t=this.getNextChar()}if(t!="}")this.putBack()}while(t!="}")};e.prototype.parseFrame=function(){var t;var i;var r;var a;a=this.getNextInt();r=this.getNextToken();if(r!="{")this.sendUnknownKeywordError();do{if(this._reachedEOF)this.sendEOFError();i=new d;i.components=new Array(this._numAnimatedComponents);for(var s=0;s<this._numAnimatedComponents;++s)i.components[s]=this.getNextNumber();this._frameData[a]=i;t=this.getNextChar();if(t=="/"){this.putBack();t=this.getNextToken();if(t==e.COMMENT_TOKEN)this.ignoreLine();t=this.getNextChar()}if(t!="}")this.putBack()}while(t!="}")};e.prototype.putBack=function(){this._parseIndex--;this._charLineIndex--;this._reachedEOF=this._parseIndex>=this._textData.length};e.prototype.getNextToken=function(){var t;var i="";while(!this._reachedEOF){t=this.getNextChar();if(t==" "||t=="\r"||t=="\n"||t=="	"){if(i!=e.COMMENT_TOKEN)this.skipWhiteSpace();if(i!="")return i}else i+=t;if(i==e.COMMENT_TOKEN)return i}return i};e.prototype.skipWhiteSpace=function(){var t;do t=this.getNextChar();while(t=="\n"||t==" "||t=="\r"||t=="	");this.putBack()};e.prototype.ignoreLine=function(){var t;while(!this._reachedEOF&&t!="\n")t=this.getNextChar()};e.prototype.getNextChar=function(){var t=this._textData.charAt(this._parseIndex++);if(t=="\n"){++this._line;this._charLineIndex=0}else if(t!="\r")++this._charLineIndex;if(this._parseIndex==this._textData.length)this._reachedEOF=true;return t};e.prototype.getNextInt=function(){var t=parseInt(this.getNextToken());if(isNaN(t))this.sendParseError("int type");return t};e.prototype.getNextNumber=function(){var t=parseFloat(this.getNextToken());if(isNaN(t))this.sendParseError("float type");return t};e.prototype.parseVector3D=function(){var t=new s;var e=this.getNextToken();if(e!="(")this.sendParseError("(");t.x=this.getNextNumber();t.y=this.getNextNumber();t.z=this.getNextNumber();if(this.getNextToken()!=")")this.sendParseError(")");return t};e.prototype.parseQuaternion=function(){var t=new a;var e=this.getNextToken();if(e!="(")this.sendParseError("(");t.x=this.getNextNumber();t.y=this.getNextNumber();t.z=this.getNextNumber();var i=1-t.x*t.x-t.y*t.y-t.z*t.z;t.w=i<0?0:-Math.sqrt(i);if(this.getNextToken()!=")")this.sendParseError(")");return t};e.prototype.parseCMD=function(){this.parseLiteralstring()};e.prototype.parseLiteralstring=function(){this.skipWhiteSpace();var t=this.getNextChar();var e="";if(t!='"')this.sendParseError('"');do{if(this._reachedEOF)this.sendEOFError();t=this.getNextChar();if(t!='"')e+=t}while(t!='"');return e};e.prototype.sendEOFError=function(){throw new Error("Unexpected end of file")};e.prototype.sendParseError=function(t){throw new Error("Unexpected token at line "+(this._line+1)+", character "+this._charLineIndex+". "+t+" expected, but "+this._textData.charAt(this._parseIndex-1)+" encountered")};e.prototype.sendUnknownKeywordError=function(){throw new Error("Unknown keyword at line "+(this._line+1)+", character "+this._charLineIndex+". ")};e.VERSION_TOKEN="MD5Version";e.COMMAND_LINE_TOKEN="commandline";e.NUM_FRAMES_TOKEN="numFrames";e.NUM_JOINTS_TOKEN="numJoints";e.FRAME_RATE_TOKEN="frameRate";e.NUM_ANIMATED_COMPONENTS_TOKEN="numAnimatedComponents";e.HIERARCHY_TOKEN="hierarchy";e.BOUNDS_TOKEN="bounds";e.BASE_FRAME_TOKEN="baseframe";e.FRAME_TOKEN="frame";e.COMMENT_TOKEN="//";return e}(o);e.exports=_},{"awayjs-core/lib/geom/Quaternion":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/net/URLLoaderDataFormat":undefined,"awayjs-core/lib/parsers/ParserBase":undefined,"awayjs-renderergl/lib/animators/data/JointPose":undefined,"awayjs-renderergl/lib/animators/data/SkeletonPose":undefined,"awayjs-renderergl/lib/animators/nodes/SkeletonClipNode":undefined,"awayjs-renderergl/lib/parsers/data/BaseFrameData":undefined,"awayjs-renderergl/lib/parsers/data/BoundsData":undefined,"awayjs-renderergl/lib/parsers/data/FrameData":undefined,"awayjs-renderergl/lib/parsers/data/HierarchyData":undefined}],"awayjs-renderergl/lib/parsers/MD5MeshParser":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Quaternion");var s=t("awayjs-core/lib/geom/Vector3D");var n=t("awayjs-core/lib/net/URLLoaderDataFormat");var o=t("awayjs-core/lib/parsers/ParserBase");var h=t("awayjs-display/lib/containers/DisplayObjectContainer");var l=t("awayjs-display/lib/base/Geometry");var u=t("awayjs-display/lib/base/TriangleSubGeometry");var p=t("awayjs-display/lib/entities/Mesh");var c=t("awayjs-renderergl/lib/animators/SkeletonAnimationSet");var d=t("awayjs-renderergl/lib/animators/data/Skeleton");var f=t("awayjs-renderergl/lib/animators/data/SkeletonJoint");var _=function(t){r(e,t);function e(e,i){if(e===void 0){e=null}if(i===void 0){i=0}t.call(this,n.TEXT);this._parseIndex=0;this._line=0;this._charLineIndex=0;this._rotationQuat=new a;this._rotationQuat.fromAxisAngle(s.X_AXIS,-Math.PI*.5);if(e){var r=new a;r.fromAxisAngle(e,i);this._rotationQuat.multiply(this._rotationQuat,r)}}e.supportsType=function(t){t=t.toLowerCase();return t=="md5mesh"};e.supportsData=function(t){return false};e.prototype._pProceedParsing=function(){var t;if(!this._startedParsing){this._textData=this._pGetTextData();this._startedParsing=true}while(this._pHasTime()){t=this.getNextToken();switch(t){case e.COMMENT_TOKEN:this.ignoreLine();break;case e.VERSION_TOKEN:this._version=this.getNextInt();if(this._version!=10)throw new Error("Unknown version number encountered!");break;case e.COMMAND_LINE_TOKEN:this.parseCMD();break;case e.NUM_JOINTS_TOKEN:this._numJoints=this.getNextInt();this._bindPoses=new Array(this._numJoints);break;case e.NUM_MESHES_TOKEN:this._numMeshes=this.getNextInt();break;case e.JOINTS_TOKEN:this.parseJoints();break;case e.MESH_TOKEN:this.parseMesh();break;default:if(!this._reachedEOF)this.sendUnknownKeywordError()}if(this._reachedEOF){this.calculateMaxJointCount();this._animationSet=new c(this._maxJointCount);this._mesh=new p(new l,null);this._geometry=this._mesh.geometry;for(var i=0;i<this._meshData.length;++i)this._geometry.addSubGeometry(this.translateGeom(this._meshData[i].vertexData,this._meshData[i].weightData,this._meshData[i].indices));this._pContent.addChild(this._mesh);this._pFinalizeAsset(this._geometry);this._pFinalizeAsset(this._mesh);this._pFinalizeAsset(this._skeleton);this._pFinalizeAsset(this._animationSet);return o.PARSING_DONE}}return o.MORE_TO_PARSE};e.prototype._pStartParsing=function(e){t.prototype._pStartParsing.call(this,e);this._pContent=new h};e.prototype.calculateMaxJointCount=function(){this._maxJointCount=0;var t=this._meshData.length;for(var e=0;e<t;++e){var i=this._meshData[e];var r=i.vertexData;var a=r.length;for(var s=0;s<a;++s){var n=this.countZeroWeightJoints(r[s],i.weightData);var o=r[s].countWeight-n;if(o>this._maxJointCount)this._maxJointCount=o}}};e.prototype.countZeroWeightJoints=function(t,e){var i=t.startWeight;var r=t.startWeight+t.countWeight;var a=0;var s;for(var n=i;n<r;++n){s=e[n].bias;if(s==0)++a}return a};e.prototype.parseJoints=function(){var t;var i;var r;var a;var s=0;var n=this.getNextToken();if(n!="{")this.sendUnknownKeywordError();this._skeleton=new d;do{if(this._reachedEOF)this.sendEOFError();i=new f;i.name=this.parseLiteralstring();i.parentIndex=this.getNextInt();r=this.parseVector3D();r=this._rotationQuat.rotatePoint(r);a=this.parseQuaternion();this._bindPoses[s]=a.toMatrix3D();this._bindPoses[s].appendTranslation(r.x,r.y,r.z);var o=this._bindPoses[s].clone();o.invert();i.inverseBindPose=o.rawData;this._skeleton.joints[s++]=i;t=this.getNextChar();if(t=="/"){this.putBack();t=this.getNextToken();if(t==e.COMMENT_TOKEN)this.ignoreLine();t=this.getNextChar()}if(t!="}")this.putBack()}while(t!="}")};e.prototype.putBack=function(){this._parseIndex--;this._charLineIndex--;this._reachedEOF=this._parseIndex>=this._textData.length};e.prototype.parseMesh=function(){var t=this.getNextToken();var i;var r;var a;var s;if(t!="{")this.sendUnknownKeywordError();if(this._shaders==null)this._shaders=new Array;while(i!="}"){i=this.getNextToken();switch(i){case e.COMMENT_TOKEN:this.ignoreLine();break;case e.MESH_SHADER_TOKEN:this._shaders.push(this.parseLiteralstring());break;case e.MESH_NUM_VERTS_TOKEN:r=new Array(this.getNextInt());break;case e.MESH_NUM_TRIS_TOKEN:s=new Array(this.getNextInt()*3);break;case e.MESH_NUM_WEIGHTS_TOKEN:a=new Array(this.getNextInt());break;case e.MESH_VERT_TOKEN:this.parseVertex(r);break;case e.MESH_TRI_TOKEN:this.parseTri(s);break;case e.MESH_WEIGHT_TOKEN:this.parseJoint(a);break}}if(this._meshData==null)this._meshData=new Array;var n=this._meshData.length;this._meshData[n]=new m;this._meshData[n].vertexData=r;this._meshData[n].weightData=a;this._meshData[n].indices=s};e.prototype.translateGeom=function(t,e,i){var r=t.length;var a,s,n;var o;var h;var l;var p;var c=new u(true);var d=new Array(r*2);var f=new Array(r*3);var _=new Array(r*this._maxJointCount);var y=new Array(r*this._maxJointCount);var g=0;var m;for(var b=0;b<r;++b){o=t[b];a=o.index*3;s=a+1;n=a+2;f[a]=f[s]=f[n]=0;m=0;for(var v=0;v<o.countWeight;++v){h=e[o.startWeight+v];if(h.bias>0){l=this._bindPoses[h.joint];p=l.transformVector(h.pos);f[a]+=p.x*h.bias;f[s]+=p.y*h.bias;f[n]+=p.z*h.bias;_[g]=h.joint*3;y[g++]=h.bias;++m}}for(v=m;v<this._maxJointCount;++v){_[g]=0;y[g++]=0}a=o.index<<1;d[a++]=o.s;d[a]=o.t}c.jointsPerVertex=this._maxJointCount;c.updateIndices(i);c.updatePositions(f);c.updateUVs(d);c.updateJointIndices(_);c.updateJointWeights(y);c.vertexNormals;c.vertexTangents;c.autoDeriveTangents=false;c.autoDeriveNormals=false;return c};e.prototype.parseTri=function(t){var e=this.getNextInt()*3;t[e]=this.getNextInt();t[e+1]=this.getNextInt();t[e+2]=this.getNextInt()};e.prototype.parseJoint=function(t){var e=new g;e.index=this.getNextInt();e.joint=this.getNextInt();e.bias=this.getNextNumber();e.pos=this.parseVector3D();t[e.index]=e};e.prototype.parseVertex=function(t){var e=new y;e.index=this.getNextInt();this.parseUV(e);e.startWeight=this.getNextInt();e.countWeight=this.getNextInt();t[e.index]=e};e.prototype.parseUV=function(t){var e=this.getNextToken();if(e!="(")this.sendParseError("(");t.s=this.getNextNumber();t.t=this.getNextNumber();if(this.getNextToken()!=")")this.sendParseError(")")};e.prototype.getNextToken=function(){var t;var i="";while(!this._reachedEOF){t=this.getNextChar();if(t==" "||t=="\r"||t=="\n"||t=="	"){if(i!=e.COMMENT_TOKEN)this.skipWhiteSpace();if(i!="")return i}else i+=t;if(i==e.COMMENT_TOKEN)return i}return i};e.prototype.skipWhiteSpace=function(){var t;do t=this.getNextChar();while(t=="\n"||t==" "||t=="\r"||t=="	");this.putBack()};e.prototype.ignoreLine=function(){var t;while(!this._reachedEOF&&t!="\n")t=this.getNextChar()};e.prototype.getNextChar=function(){var t=this._textData.charAt(this._parseIndex++);if(t=="\n"){++this._line;this._charLineIndex=0}else if(t!="\r")++this._charLineIndex;if(this._parseIndex>=this._textData.length)this._reachedEOF=true;return t};e.prototype.getNextInt=function(){var t=parseInt(this.getNextToken());if(isNaN(t))this.sendParseError("int type");return t};e.prototype.getNextNumber=function(){var t=parseFloat(this.getNextToken());if(isNaN(t))this.sendParseError("float type");return t};e.prototype.parseVector3D=function(){var t=new s;var e=this.getNextToken();if(e!="(")this.sendParseError("(");t.x=-this.getNextNumber();t.y=this.getNextNumber();t.z=this.getNextNumber();if(this.getNextToken()!=")")this.sendParseError(")");return t};e.prototype.parseQuaternion=function(){var t=new a;var e=this.getNextToken();if(e!="(")this.sendParseError("(");t.x=this.getNextNumber();t.y=-this.getNextNumber();t.z=-this.getNextNumber();var i=1-t.x*t.x-t.y*t.y-t.z*t.z;t.w=i<0?0:-Math.sqrt(i);if(this.getNextToken()!=")")this.sendParseError(")");var r=new a;r.multiply(this._rotationQuat,t);return r};e.prototype.parseCMD=function(){this.parseLiteralstring()};e.prototype.parseLiteralstring=function(){this.skipWhiteSpace();var t=this.getNextChar();var e="";if(t!='"')this.sendParseError('"');do{if(this._reachedEOF)this.sendEOFError();t=this.getNextChar();if(t!='"')e+=t}while(t!='"');return e};e.prototype.sendEOFError=function(){throw new Error("Unexpected end of file")};e.prototype.sendParseError=function(t){throw new Error("Unexpected token at line "+(this._line+1)+", character "+this._charLineIndex+". "+t+" expected, but "+this._textData.charAt(this._parseIndex-1)+" encountered")};e.prototype.sendUnknownKeywordError=function(){throw new Error("Unknown keyword at line "+(this._line+1)+", character "+this._charLineIndex+". ")};e.VERSION_TOKEN="MD5Version";e.COMMAND_LINE_TOKEN="commandline";e.NUM_JOINTS_TOKEN="numJoints";e.NUM_MESHES_TOKEN="numMeshes";e.COMMENT_TOKEN="//";e.JOINTS_TOKEN="joints";e.MESH_TOKEN="mesh";e.MESH_SHADER_TOKEN="shader";e.MESH_NUM_VERTS_TOKEN="numverts";e.MESH_VERT_TOKEN="vert";e.MESH_NUM_TRIS_TOKEN="numtris";e.MESH_TRI_TOKEN="tri";e.MESH_NUM_WEIGHTS_TOKEN="numweights";e.MESH_WEIGHT_TOKEN="weight";return e}(o);var y=function(){function t(){}return t}();var g=function(){function t(){}return t}();var m=function(){function t(){}return t}();e.exports=_},{"awayjs-core/lib/geom/Quaternion":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/net/URLLoaderDataFormat":undefined,"awayjs-core/lib/parsers/ParserBase":undefined,"awayjs-display/lib/base/Geometry":undefined,"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-display/lib/containers/DisplayObjectContainer":undefined,"awayjs-display/lib/entities/Mesh":undefined,"awayjs-renderergl/lib/animators/SkeletonAnimationSet":undefined,"awayjs-renderergl/lib/animators/data/Skeleton":undefined,"awayjs-renderergl/lib/animators/data/SkeletonJoint":undefined}],"awayjs-renderergl/lib/parsers/Max3DSParser":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Matrix3D");var s=t("awayjs-core/lib/geom/Vector3D");var n=t("awayjs-core/lib/library/AssetType");var o=t("awayjs-core/lib/net/URLLoaderDataFormat");var h=t("awayjs-core/lib/net/URLRequest");var l=t("awayjs-core/lib/parsers/ParserBase");var u=t("awayjs-core/lib/parsers/ParserUtils");var p=t("awayjs-display/lib/containers/DisplayObjectContainer");var c=t("awayjs-display/lib/base/Geometry");var d=t("awayjs-display/lib/base/TriangleSubGeometry");var f=t("awayjs-display/lib/entities/Mesh");var _=t("awayjs-stagegl/lib/materials/utils/DefaultMaterialManager");var y=t("awayjs-stagegl/lib/materials/TriangleMethodMaterial");var g=t("awayjs-stagegl/lib/materials/TriangleMaterialMode");var m=t("awayjs-renderergl/lib/parsers/data/FaceVO");var b=t("awayjs-renderergl/lib/parsers/data/MaterialVO");var v=t("awayjs-renderergl/lib/parsers/data/ObjectVO");var w=t("awayjs-renderergl/lib/parsers/data/TextureVO");var x=t("awayjs-renderergl/lib/parsers/data/VertexVO");var P=function(t){r(e,t);function e(e){if(e===void 0){e=true}t.call(this,o.ARRAY_BUFFER);this._useSmoothingGroups=e}e.supportsType=function(t){t=t.toLowerCase();return t=="3ds"};e.supportsData=function(t){var e;e=u.toByteArray(t);if(e){e.position=0;if(e.readShort()==19789)return true}return false};e.prototype._iResolveDependency=function(t){if(t.assets.length==1){var e;e=t.assets[0];if(e.assetType==n.TEXTURE){var i;i=this._textures[t.id];i.texture=e}}};e.prototype._iResolveDependencyFailure=function(t){};e.prototype._pProceedParsing=function(){if(!this._byteData){this._byteData=this._pGetByteData();this._byteData.position=0;this._textures={};this._materials={};this._unfinalized_objects={}}while(this._pHasTime()){if(this._cur_mat&&this._byteData.position>=this._cur_mat_end)this.finalizeCurrentMaterial();else if(this._cur_obj&&this._byteData.position>=this._cur_obj_end){this._unfinalized_objects[this._cur_obj.name]=this._cur_obj;this._cur_obj_end=Number.MAX_VALUE;this._cur_obj=null}if(this._byteData.getBytesAvailable()>0){var t;var e;var i;t=this._byteData.readUnsignedShort();e=this._byteData.readUnsignedInt();i=this._byteData.position+(e-6);switch(t){case 19789:case 15677:case 45056:continue;break;case 45055:this._cur_mat_end=i;this._cur_mat=this.parseMaterial();break;case 16384:this._cur_obj_end=i;this._cur_obj=new v;this._cur_obj.name=this.readNulTermstring();this._cur_obj.materials=new Array;this._cur_obj.materialFaces={};break;case 16640:this._cur_obj.type=n.MESH;break;case 16656:this.parseVertexList();break;case 16672:this.parseFaceList();break;case 16704:this.parseUVList();break;case 16688:this.parseFaceMaterialList();break;case 16736:this._cur_obj.transform=this.readTransform();break;case 45058:this.parseObjectAnimation(i);break;case 16720:this.parseSmoothingGroups();break;default:this._byteData.position+=e-6;break}if(this.dependencies.length){this._pPauseAndRetrieveDependencies();break}}}if(this._byteData.getBytesAvailable()||this._cur_obj||this._cur_mat){return l.MORE_TO_PARSE}else{var r;for(r in this._unfinalized_objects){var a;a=this.constructObject(this._unfinalized_objects[r]);if(a){this._pContent.addChild(a);this._pFinalizeAsset(a,r)}}return l.PARSING_DONE}};e.prototype._pStartParsing=function(e){t.prototype._pStartParsing.call(this,e);this._pContent=new p};e.prototype.parseMaterial=function(){var t;t=new b;while(this._byteData.position<this._cur_mat_end){var e;var i;var r;e=this._byteData.readUnsignedShort();i=this._byteData.readUnsignedInt();r=this._byteData.position+(i-6);switch(e){case 40960:t.name=this.readNulTermstring();break;case 40976:t.ambientColor=this.readColor();break;case 40992:t.diffuseColor=this.readColor();break;case 41008:t.specularColor=this.readColor();break;case 41089:t.twoSided=true;break;case 41472:t.colorMap=this.parseTexture(r);break;case 41476:t.specularMap=this.parseTexture(r);break;default:this._byteData.position=r;break}}return t};e.prototype.parseTexture=function(t){var e;e=new w;while(this._byteData.position<t){var i;var r;i=this._byteData.readUnsignedShort();r=this._byteData.readUnsignedInt();switch(i){case 41728:e.url=this.readNulTermstring();break;default:this._byteData.position+=r-6;break}}this._textures[e.url]=e;this._pAddDependency(e.url,new h(e.url));return e};e.prototype.parseVertexList=function(){var t;var e;var i;i=this._byteData.readUnsignedShort();this._cur_obj.verts=new Array(i*3);t=0;e=this._cur_obj.verts.length;while(t<e){var r,a,s;r=this._byteData.readFloat();a=this._byteData.readFloat();s=this._byteData.readFloat();this._cur_obj.verts[t++]=r;this._cur_obj.verts[t++]=s;this._cur_obj.verts[t++]=a}};e.prototype.parseFaceList=function(){var t;var e;var i;i=this._byteData.readUnsignedShort();this._cur_obj.indices=new Array(i*3);t=0;e=this._cur_obj.indices.length;while(t<e){var r,a,s;r=this._byteData.readUnsignedShort();a=this._byteData.readUnsignedShort();s=this._byteData.readUnsignedShort();this._cur_obj.indices[t++]=r;this._cur_obj.indices[t++]=s;this._cur_obj.indices[t++]=a;this._byteData.position+=2}this._cur_obj.smoothingGroups=new Array(i)};e.prototype.parseSmoothingGroups=function(){var t=this._cur_obj.indices.length/3;var e=0;while(e<t){this._cur_obj.smoothingGroups[e]=this._byteData.readUnsignedInt();e++}};e.prototype.parseUVList=function(){var t;var e;var i;i=this._byteData.readUnsignedShort();this._cur_obj.uvs=new Array(i*2);t=0;e=this._cur_obj.uvs.length;while(t<e){this._cur_obj.uvs[t++]=this._byteData.readFloat();this._cur_obj.uvs[t++]=1-this._byteData.readFloat()}};e.prototype.parseFaceMaterialList=function(){var t;var e;var i;var r;t=this.readNulTermstring();e=this._byteData.readUnsignedShort();r=new Array(e);i=0;while(i<r.length)r[i++]=this._byteData.readUnsignedShort();this._cur_obj.materials.push(t);this._cur_obj.materialFaces[t]=r};e.prototype.parseObjectAnimation=function(t){var e;var i;var r;var a;var n;r=new s;while(this._byteData.position<t){var o;var h;o=this._byteData.readUnsignedShort();h=this._byteData.readUnsignedInt();switch(o){case 45072:a=this.readNulTermstring();this._byteData.position+=4;n=this._byteData.readShort();break;case 45075:r.x=this._byteData.readFloat();r.z=this._byteData.readFloat();r.y=this._byteData.readFloat();break;default:this._byteData.position+=h-6;break}}if(a!="$$$DUMMY"&&this._unfinalized_objects.hasOwnProperty(a)){e=this._unfinalized_objects[a];i=this.constructObject(e,r);if(i){this._pContent.addChild(i);this._pFinalizeAsset(i,e.name)}delete this._unfinalized_objects[a]}};e.prototype.constructObject=function(t,e){if(e===void 0){e=null}if(t.type==n.MESH){var i;var r;var s;var o;var h;var l;var u;var p;if(t.materials.length>1)console.log("The Away3D 3DS parser does not support multiple materials per mesh at this point.");if(!t.indices||t.indices.length==0)return null;u=new Array(t.verts.length/3);p=new Array(t.indices.length/3);this.prepareData(u,p,t);if(this._useSmoothingGroups)this.applySmoothGroups(u,p);t.verts=new Array(u.length*3);for(i=0;i<u.length;i++){t.verts[i*3]=u[i].x;t.verts[i*3+1]=u[i].y;t.verts[i*3+2]=u[i].z}t.indices=new Array(p.length*3);for(i=0;i<p.length;i++){t.indices[i*3]=p[i].a;t.indices[i*3+1]=p[i].b;t.indices[i*3+2]=p[i].c}if(t.uvs){t.uvs=new Array(u.length*2);for(i=0;i<u.length;i++){t.uvs[i*2]=u[i].u;t.uvs[i*2+1]=u[i].v}}s=new c;r=new d(true);r.updateIndices(t.indices);r.updatePositions(t.verts);r.updateUVs(t.uvs);s.addSubGeometry(r);if(t.materials.length>0){var _;_=t.materials[0];o=this._materials[_].material}if(e){if(t.transform){var y=t.transform.concat();y[12]=0;y[13]=0;y[14]=0;l=new a(y);e=l.transformVector(e)}e.scaleBy(-1);l=new a;l.appendTranslation(e.x,e.y,e.z);s.applyTransformation(l)}if(t.transform){l=new a(t.transform);l.invert();s.applyTransformation(l)}this._pFinalizeAsset(s,t.name.concat("_geom"));h=new f(s,o);h.transform.matrix3D=new a(t.transform);return h}return null};e.prototype.prepareData=function(t,e,i){var r;var a;var s;var n=i.verts.length;for(r=0,a=0,s=0;r<n;){var o=new x;o.x=i.verts[r++];o.y=i.verts[r++];o.z=i.verts[r++];if(i.uvs){o.u=i.uvs[a++];o.v=i.uvs[a++]}t[s++]=o}n=i.indices.length;for(r=0,s=0;r<n;){var h=new m;h.a=i.indices[r++];h.b=i.indices[r++];h.c=i.indices[r++];h.smoothGroup=i.smoothingGroups[s]||0;e[s++]=h}};e.prototype.applySmoothGroups=function(t,e){var i;var r;var a;var s;var n;var o=t.length;var h=e.length;var l=new Array(o);for(i=0;i<o;i++)l[i]=new Array;for(i=0;i<h;i++){var u=e[i];for(r=0;r<3;r++){var p=l[r==0?u.a:r==1?u.b:u.c];var c=u.smoothGroup;for(a=p.length-1;a>=0;a--){if((c&p[a])>0){c|=p[a];p.splice(a,1);a=p.length-1}}p.push(c)}}var d=new Array(o);for(i=0;i<o;i++){if((n=l[i].length)<1)continue;var f=new Array(n);d[i]=f;f[0]=i;var _=t[i];for(r=1;r<n;r++){var y=new x;y.x=_.x;y.y=_.y;y.z=_.z;y.u=_.u;y.v=_.v;f[r]=t.length;t.push(y)}}o=t.length;for(i=0;i<h;i++){u=e[i];c=u.smoothGroup;for(r=0;r<3;r++){a=r==0?u.a:r==1?u.b:u.c;p=l[a];n=p.length;f=d[a];for(s=0;s<n;s++){if(c==0&&p[s]==0||(c&p[s])>0){var g=f[s];if(c==0){p.splice(s,1);f.splice(s,1)}if(r==0)u.a=g;else if(r==1)u.b=g;else u.c=g;s=n}}}}};e.prototype.finalizeCurrentMaterial=function(){var t;if(this._cur_mat.colorMap)t=new y(this._cur_mat.colorMap.texture||_.getDefaultTexture());else t=new y(this._cur_mat.ambientColor);t.diffuseColor=this._cur_mat.diffuseColor;t.specularColor=this._cur_mat.specularColor;if(this.materialMode>=2)t.materialMode=g.MULTI_PASS;t.bothSides=this._cur_mat.twoSided;this._pFinalizeAsset(t,this._cur_mat.name);this._materials[this._cur_mat.name]=this._cur_mat;this._cur_mat.material=t;this._cur_mat=null};e.prototype.readNulTermstring=function(){var t;var e="";while((t=this._byteData.readUnsignedByte())>0)e+=String.fromCharCode(t);return e};e.prototype.readTransform=function(){var t;t=new Array(16);t[0]=this._byteData.readFloat();t[2]=this._byteData.readFloat();t[1]=this._byteData.readFloat();t[3]=0;t[8]=this._byteData.readFloat();t[10]=this._byteData.readFloat();t[9]=this._byteData.readFloat();t[11]=0;t[4]=this._byteData.readFloat();t[6]=this._byteData.readFloat();t[5]=this._byteData.readFloat();t[7]=0;t[12]=this._byteData.readFloat();t[14]=this._byteData.readFloat();t[13]=this._byteData.readFloat();t[15]=1;return t};e.prototype.readColor=function(){var t;var e;var i,r,a;t=this._byteData.readUnsignedShort();e=this._byteData.readUnsignedInt();switch(t){case 16:i=this._byteData.readFloat()*255;r=this._byteData.readFloat()*255;a=this._byteData.readFloat()*255;break;case 17:i=this._byteData.readUnsignedByte();r=this._byteData.readUnsignedByte();a=this._byteData.readUnsignedByte();break;default:this._byteData.position+=e-6;break}return i<<16|r<<8|a};return e}(l);e.exports=P},{"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/library/AssetType":undefined,"awayjs-core/lib/net/URLLoaderDataFormat":undefined,"awayjs-core/lib/net/URLRequest":undefined,"awayjs-core/lib/parsers/ParserBase":undefined,"awayjs-core/lib/parsers/ParserUtils":undefined,"awayjs-display/lib/base/Geometry":undefined,"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-display/lib/containers/DisplayObjectContainer":undefined,"awayjs-display/lib/entities/Mesh":undefined,"awayjs-renderergl/lib/parsers/data/FaceVO":undefined,"awayjs-renderergl/lib/parsers/data/MaterialVO":undefined,"awayjs-renderergl/lib/parsers/data/ObjectVO":undefined,"awayjs-renderergl/lib/parsers/data/TextureVO":undefined,"awayjs-renderergl/lib/parsers/data/VertexVO":undefined,"awayjs-stagegl/lib/materials/TriangleMaterialMode":undefined,"awayjs-stagegl/lib/materials/TriangleMethodMaterial":undefined,"awayjs-stagegl/lib/materials/utils/DefaultMaterialManager":undefined}],"awayjs-renderergl/lib/parsers/OBJParser":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];
function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetType");var s=t("awayjs-core/lib/net/URLLoaderDataFormat");var n=t("awayjs-core/lib/net/URLRequest");var o=t("awayjs-core/lib/parsers/ParserBase");var h=t("awayjs-core/lib/parsers/ParserUtils");var l=t("awayjs-display/lib/containers/DisplayObjectContainer");var u=t("awayjs-display/lib/base/TriangleSubGeometry");var p=t("awayjs-display/lib/base/Geometry");var c=t("awayjs-display/lib/entities/Mesh");var d=t("awayjs-stagegl/lib/materials/utils/DefaultMaterialManager");var f=t("awayjs-stagegl/lib/materials/methods/SpecularBasicMethod");var _=t("awayjs-stagegl/lib/materials/TriangleMethodMaterial");var y=t("awayjs-stagegl/lib/materials/TriangleMaterialMode");var g=function(t){r(e,t);function e(e){if(e===void 0){e=1}t.call(this,s.TEXT);this._mtlLibLoaded=true;this._activeMaterialID="";this._scale=e}Object.defineProperty(e.prototype,"scale",{set:function(t){this._scale=t},enumerable:true,configurable:true});e.supportsType=function(t){t=t.toLowerCase();return t=="obj"};e.supportsData=function(t){var e=h.toString(t);var i=false;var r=false;if(e){i=e.indexOf("\nv ")!=-1;r=e.indexOf("\nf ")!=-1}return i&&r};e.prototype._iResolveDependency=function(t){if(t.id=="mtl"){var e=h.toString(t.data);this.parseMtl(e)}else{var i;if(t.assets.length!=1){return}i=t.assets[0];if(i.assetType==a.TEXTURE){var r=new x;r.materialID=t.id;r.texture=i;this._materialLoaded.push(r);if(this._meshes.length>0){this.applyMaterial(r)}}}};e.prototype._iResolveDependencyFailure=function(t){if(t.id=="mtl"){this._mtlLib=false;this._mtlLibLoaded=false}else{var e=new x;e.materialID=t.id;this._materialLoaded.push(e)}if(this._meshes.length>0)this.applyMaterial(e)};e.prototype._pProceedParsing=function(){var t;var e=String.fromCharCode(10);var i;if(!this._startedParsing){this._textData=this._pGetTextData();this._textData=this._textData.replace(/\\[\r\n]+\s*/gm," ")}if(this._textData.indexOf(e)==-1)e=String.fromCharCode(13);if(!this._startedParsing){this._startedParsing=true;this._vertices=new Array;this._vertexNormals=new Array;this._materialIDs=new Array;this._materialLoaded=new Array;this._meshes=new Array;this._uvs=new Array;this._stringLength=this._textData.length;this._charIndex=this._textData.indexOf(e,0);this._oldIndex=0;this._objects=new Array;this._objectIndex=0}while(this._charIndex<this._stringLength&&this._pHasTime()){this._charIndex=this._textData.indexOf(e,this._oldIndex);if(this._charIndex==-1)this._charIndex=this._stringLength;t=this._textData.substring(this._oldIndex,this._charIndex);t=t.split("\r").join("");t=t.replace("  "," ");i=t.split(" ");this._oldIndex=this._charIndex+1;this.parseLine(i);if(this.parsingPaused){return o.MORE_TO_PARSE}}if(this._charIndex>=this._stringLength){if(this._mtlLib&&!this._mtlLibLoaded){return o.MORE_TO_PARSE}this.translate();this.applyMaterials();return o.PARSING_DONE}return o.MORE_TO_PARSE};e.prototype._pStartParsing=function(e){t.prototype._pStartParsing.call(this,e);this._pContent=new l};e.prototype.parseLine=function(t){switch(t[0]){case"mtllib":this._mtlLib=true;this._mtlLibLoaded=false;this.loadMtl(t[1]);break;case"g":this.createGroup(t);break;case"o":this.createObject(t);break;case"usemtl":if(this._mtlLib){if(!t[1])t[1]="def000";this._materialIDs.push(t[1]);this._activeMaterialID=t[1];if(this._currentGroup)this._currentGroup.materialID=this._activeMaterialID}break;case"v":this.parseVertex(t);break;case"vt":this.parseUV(t);break;case"vn":this.parseVertexNormal(t);break;case"f":this.parseFace(t)}};e.prototype.translate=function(){for(var t=0;t<this._objects.length;++t){var e=this._objects[t].groups;var i=e.length;var r;var a;var s;var n;var o;var h;var l;for(var u=0;u<i;++u){s=new p;r=e[u].materialGroups;a=r.length;for(o=0;o<a;++o)this.translateMaterialGroup(r[o],s);if(s.subGeometries.length==0)continue;this._pFinalizeAsset(s);l=new _(d.getDefaultTexture());if(this.materialMode>=2)l.materialMode=y.MULTI_PASS;n=new c(s,l);if(this._objects[t].name){n.name=this._objects[t].name}else if(e[u].name){n.name=e[u].name}else{n.name=""}this._meshes.push(n);if(e[u].materialID!="")l.name=e[u].materialID+"~"+n.name;else l.name=this._lastMtlID+"~"+n.name;if(n.subMeshes.length>1){for(h=1;h<n.subMeshes.length;++h)n.subMeshes[h].material=l}this._pContent.addChild(n);this._pFinalizeAsset(n)}}};e.prototype.translateMaterialGroup=function(t,e){var i=t.faces;var r;var a=i.length;var s;var n;var o=new Array;var h=new Array;var l=new Array;var p=new Array;this._realIndices=[];this._vertexIndex=0;var c;for(var d=0;d<a;++d){r=i[d];s=r.indexIds.length-1;for(c=1;c<s;++c){this.translateVertexData(r,c,o,h,p,l);this.translateVertexData(r,0,o,h,p,l);this.translateVertexData(r,c+1,o,h,p,l)}}if(o.length>0){n=new u(true);n.autoDeriveNormals=l.length?false:true;n.updateIndices(p);n.updatePositions(o);n.updateVertexNormals(l);n.updateUVs(h);e.addSubGeometry(n)}};e.prototype.translateVertexData=function(t,e,i,r,a,s){var n;var o;var h;var l;if(!this._realIndices[t.indexIds[e]]){n=this._vertexIndex;this._realIndices[t.indexIds[e]]=++this._vertexIndex;o=this._vertices[t.vertexIndices[e]-1];i.push(o.x*this._scale,o.y*this._scale,o.z*this._scale);if(t.normalIndices.length>0){h=this._vertexNormals[t.normalIndices[e]-1];s.push(h.x,h.y,h.z)}if(t.uvIndices.length>0){try{l=this._uvs[t.uvIndices[e]-1];r.push(l.u,l.v)}catch(u){switch(e){case 0:r.push(0,1);break;case 1:r.push(.5,0);break;case 2:r.push(1,1)}}}}else{n=this._realIndices[t.indexIds[e]]-1}a.push(n)};e.prototype.createObject=function(t){this._currentGroup=null;this._currentMaterialGroup=null;this._objects.push(this._currentObject=new m);if(t)this._currentObject.name=t[1]};e.prototype.createGroup=function(t){if(!this._currentObject)this.createObject(null);this._currentGroup=new b;this._currentGroup.materialID=this._activeMaterialID;if(t)this._currentGroup.name=t[1];this._currentObject.groups.push(this._currentGroup);this.createMaterialGroup(null)};e.prototype.createMaterialGroup=function(t){this._currentMaterialGroup=new v;if(t)this._currentMaterialGroup.url=t[1];this._currentGroup.materialGroups.push(this._currentMaterialGroup)};e.prototype.parseVertex=function(t){var e,i,r;if(t.length>4){var a=[];var s;for(var n=1;n<t.length;++n){s=parseFloat(t[n]);if(!isNaN(s))a.push(s)}e=a[0];i=a[1];r=-a[2];this._vertices.push(new C(e,i,r))}else{e=parseFloat(t[1]);i=parseFloat(t[2]);r=-parseFloat(t[3]);this._vertices.push(new C(e,i,r))}};e.prototype.parseUV=function(t){if(t.length>3){var e=[];var i;for(var r=1;r<t.length;++r){i=parseFloat(t[r]);if(!isNaN(i))e.push(i)}this._uvs.push(new D(e[0],1-e[1]))}else{this._uvs.push(new D(parseFloat(t[1]),1-parseFloat(t[2])))}};e.prototype.parseVertexNormal=function(t){if(t.length>4){var e=[];var i;for(var r=1;r<t.length;++r){i=parseFloat(t[r]);if(!isNaN(i))e.push(i)}this._vertexNormals.push(new C(e[0],e[1],-e[2]))}else{this._vertexNormals.push(new C(parseFloat(t[1]),parseFloat(t[2]),-parseFloat(t[3])))}};e.prototype.parseFace=function(t){var e=t.length;var i=new P;if(!this._currentGroup){this.createGroup(null)}var r;for(var a=1;a<e;++a){if(t[a]==""){continue}r=t[a].split("/");i.vertexIndices.push(this.parseIndex(parseInt(r[0]),this._vertices.length));if(r[1]&&String(r[1]).length>0)i.uvIndices.push(this.parseIndex(parseInt(r[1]),this._uvs.length));if(r[2]&&String(r[2]).length>0)i.normalIndices.push(this.parseIndex(parseInt(r[2]),this._vertexNormals.length));i.indexIds.push(t[a])}this._currentMaterialGroup.faces.push(i)};e.prototype.parseIndex=function(t,e){if(t<0)return t+e+1;else return t};e.prototype.parseMtl=function(t){var e=t.split("newmtl");var i;var r;var a;var s;var o;var h;var l;var u;var p;var c;var d;var g;for(var m=0;m<e.length;++m){i=e[m].split("\r").join("").split("\n");if(i.length==1)i=e[m].split(String.fromCharCode(13));l=u=p=16777215;c=0;o=false;h=false;d=1;g="";for(a=0;a<i.length;++a){i[a]=i[a].replace(/\s+$/,"");if(i[a].substring(0,1)!="#"&&(a==0||i[a]!="")){r=i[a].split(" ");if(String(r[0]).charCodeAt(0)==9||String(r[0]).charCodeAt(0)==32)r[0]=r[0].substring(1,r[0].length);if(a==0){this._lastMtlID=r.join("");this._lastMtlID=this._lastMtlID==""?"def000":this._lastMtlID}else{switch(r[0]){case"Ka":if(r[1]&&!isNaN(Number(r[1]))&&r[2]&&!isNaN(Number(r[2]))&&r[3]&&!isNaN(Number(r[3])))u=r[1]*255<<16|r[2]*255<<8|r[3]*255;break;case"Ks":if(r[1]&&!isNaN(Number(r[1]))&&r[2]&&!isNaN(Number(r[2]))&&r[3]&&!isNaN(Number(r[3]))){p=r[1]*255<<16|r[2]*255<<8|r[3]*255;o=true}break;case"Ns":if(r[1]&&!isNaN(Number(r[1])))c=Number(r[1])*.001;if(c==0)o=false;break;case"Kd":if(r[1]&&!isNaN(Number(r[1]))&&r[2]&&!isNaN(Number(r[2]))&&r[3]&&!isNaN(Number(r[3]))){l=r[1]*255<<16|r[2]*255<<8|r[3]*255;h=true}break;case"tr":case"d":if(r[1]&&!isNaN(Number(r[1])))d=Number(r[1]);break;case"map_Kd":g=this.parseMapKdString(r);g=g.replace(/\\/g,"/")}}}}if(g!=""){if(o){s=new f;s.specularColor=p;s.specular=c;var b=new w;b.alpha=d;b.basicSpecularMethod=s;b.materialID=this._lastMtlID;if(!this._materialSpecularData)this._materialSpecularData=new Array;this._materialSpecularData.push(b)}this._pAddDependency(this._lastMtlID,new n(g))}else if(h&&!isNaN(u)){var v=new x;v.materialID=this._lastMtlID;if(d==0)console.log("Warning: an alpha value of 0 was found in mtl color tag (Tr or d) ref:"+this._lastMtlID+", mesh(es) using it will be invisible!");var P;if(this.materialMode<2){P=new _(u);var D=P;D.alpha=d;D.diffuseColor=l;D.repeat=true;if(o){D.specularColor=p;D.specular=c}}else{P=new _(u);P.materialMode=y.MULTI_PASS;var C=P;C.diffuseColor=l;C.repeat=true;if(o){C.specularColor=p;C.specular=c}}v.cm=P;this._materialLoaded.push(v);if(this._meshes.length>0)this.applyMaterial(v)}}this._mtlLibLoaded=true};e.prototype.parseMapKdString=function(t){var e="";var i;var r;for(i=1;i<t.length;){switch(t[i]){case"-blendu":case"-blendv":case"-cc":case"-clamp":case"-texres":i+=2;break;case"-mm":i+=3;break;case"-o":case"-s":case"-t":i+=4;continue;default:r=true;break}if(r)break}for(i;i<t.length;i++){e+=t[i];e+=" "}e=e.replace(/\s+$/,"");return e};e.prototype.loadMtl=function(t){this._pAddDependency("mtl",new n(t),true);this._pPauseAndRetrieveDependencies()};e.prototype.applyMaterial=function(t){var e;var i;var r;var a;var s;for(var n=0;n<this._meshes.length;++n){i=this._meshes[n];e=i.material.name.split("~");if(e[0]==t.materialID){if(t.cm){if(i.material)i.material=null;i.material=t.cm}else if(t.texture){if(this.materialMode<2){r=i.material;r.texture=t.texture;r.color=t.color;r.alpha=t.alpha;r.repeat=true;if(t.specularMethod){r.specularMethod=null;r.specularMethod=t.specularMethod}else if(this._materialSpecularData){for(a=0;a<this._materialSpecularData.length;++a){s=this._materialSpecularData[a];if(s.materialID==t.materialID){r.specularMethod=null;r.specularMethod=s.basicSpecularMethod;r.color=s.color;r.alpha=s.alpha;break}}}}else{r=i.material;r.materialMode=y.MULTI_PASS;r.texture=t.texture;r.color=t.color;r.repeat=true;if(t.specularMethod){r.specularMethod=null;r.specularMethod=t.specularMethod}else if(this._materialSpecularData){for(a=0;a<this._materialSpecularData.length;++a){s=this._materialSpecularData[a];if(s.materialID==t.materialID){r.specularMethod=null;r.specularMethod=s.basicSpecularMethod;r.color=s.color;break}}}}}i.material.name=e[1]?e[1]:e[0];this._meshes.splice(n,1);--n}}if(t.cm||r)this._pFinalizeAsset(t.cm||r)};e.prototype.applyMaterials=function(){if(this._materialLoaded.length==0)return;for(var t=0;t<this._materialLoaded.length;++t)this.applyMaterial(this._materialLoaded[t])};return e}(o);var m=function(){function t(){this.groups=new Array}return t}();var b=function(){function t(){this.materialGroups=new Array}return t}();var v=function(){function t(){this.faces=new Array}return t}();var w=function(){function t(){this.color=16777215;this.alpha=1}return t}();var x=function(){function t(){this.color=16777215;this.alpha=1}return t}();var P=function(){function t(){this.vertexIndices=new Array;this.uvIndices=new Array;this.normalIndices=new Array;this.indexIds=new Array}return t}();var D=function(){function t(t,e){if(t===void 0){t=0}if(e===void 0){e=0}this._u=t;this._v=e}Object.defineProperty(t.prototype,"v",{get:function(){return this._v},set:function(t){this._v=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"u",{get:function(){return this._u},set:function(t){this._u=t},enumerable:true,configurable:true});t.prototype.clone=function(){return new t(this._u,this._v)};t.prototype.toString=function(){return this._u+","+this._v};return t}();var C=function(){function t(t,e,i,r){if(t===void 0){t=0}if(e===void 0){e=0}if(i===void 0){i=0}if(r===void 0){r=0}this._x=t;this._y=e;this._z=i;this._index=r}Object.defineProperty(t.prototype,"index",{get:function(){return this._index},set:function(t){this._index=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"z",{get:function(){return this._z},set:function(t){this._z=t},enumerable:true,configurable:true});t.prototype.clone=function(){return new t(this._x,this._y,this._z)};return t}();e.exports=g},{"awayjs-core/lib/library/AssetType":undefined,"awayjs-core/lib/net/URLLoaderDataFormat":undefined,"awayjs-core/lib/net/URLRequest":undefined,"awayjs-core/lib/parsers/ParserBase":undefined,"awayjs-core/lib/parsers/ParserUtils":undefined,"awayjs-display/lib/base/Geometry":undefined,"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-display/lib/containers/DisplayObjectContainer":undefined,"awayjs-display/lib/entities/Mesh":undefined,"awayjs-stagegl/lib/materials/TriangleMaterialMode":undefined,"awayjs-stagegl/lib/materials/TriangleMethodMaterial":undefined,"awayjs-stagegl/lib/materials/methods/SpecularBasicMethod":undefined,"awayjs-stagegl/lib/materials/utils/DefaultMaterialManager":undefined}],"awayjs-renderergl/lib/parsers/Parsers":[function(t,e,i){var r=t("awayjs-core/lib/library/AssetLoader");var a=t("awayjs-renderergl/lib/parsers/AWDParser");var s=t("awayjs-renderergl/lib/parsers/Max3DSParser");var n=t("awayjs-renderergl/lib/parsers/MD2Parser");var o=t("awayjs-renderergl/lib/parsers/OBJParser");var h=function(){function t(){}t.enableAllBundled=function(){r.enableParsers(t.ALL_BUNDLED)};t.ALL_BUNDLED=Array(a,s,n,o);return t}();e.exports=h},{"awayjs-core/lib/library/AssetLoader":undefined,"awayjs-renderergl/lib/parsers/AWDParser":undefined,"awayjs-renderergl/lib/parsers/MD2Parser":undefined,"awayjs-renderergl/lib/parsers/Max3DSParser":undefined,"awayjs-renderergl/lib/parsers/OBJParser":undefined}],"awayjs-renderergl/lib/parsers/data/AWDBlock":[function(t,e,i){var r=function(){function t(){}t.prototype.dispose=function(){this.id=null;this.bytes=null;this.errorMessages=null;this.uvsForVertexAnimation=null};t.prototype.addError=function(t){if(!this.errorMessages)this.errorMessages=new Array;this.errorMessages.push(t)};return t}();e.exports=r},{}],"awayjs-renderergl/lib/parsers/data/AWDProperties":[function(t,e,i){var r=function(){function t(){}t.prototype.set=function(t,e){this[t.toString()]=e};t.prototype.get=function(t,e){if(this.hasOwnProperty(t.toString())){return this[t.toString()]}else{return e}};return t}();e.exports=r},{}],"awayjs-renderergl/lib/parsers/data/BaseFrameData":[function(t,e,i){var r=function(){function t(){}return t}();e.exports=r},{}],"awayjs-renderergl/lib/parsers/data/BitFlags":[function(t,e,i){var r=function(){function t(){}t.test=function(t,e){return(t&e)==e};t.FLAG1=1;t.FLAG2=2;t.FLAG3=4;t.FLAG4=8;t.FLAG5=16;t.FLAG6=32;t.FLAG7=64;t.FLAG8=128;t.FLAG9=256;t.FLAG10=512;t.FLAG11=1024;t.FLAG12=2048;t.FLAG13=4096;t.FLAG14=8192;t.FLAG15=16384;t.FLAG16=32768;return t}();e.exports=r},{}],"awayjs-renderergl/lib/parsers/data/BoundsData":[function(t,e,i){var r=function(){function t(){}return t}();e.exports=r},{}],"awayjs-renderergl/lib/parsers/data/FaceVO":[function(t,e,i){var r=function(){function t(){}return t}();e.exports=r},{}],"awayjs-renderergl/lib/parsers/data/FrameData":[function(t,e,i){var r=function(){function t(){}return t}();e.exports=r},{}],"awayjs-renderergl/lib/parsers/data/HierarchyData":[function(t,e,i){var r=function(){function t(){}return t}();e.exports=r},{}],"awayjs-renderergl/lib/parsers/data/MaterialVO":[function(t,e,i){var r=function(){function t(){}return t}();e.exports=r},{}],"awayjs-renderergl/lib/parsers/data/ObjectVO":[function(t,e,i){var r=function(){function t(){}return t}();e.exports=r},{}],"awayjs-renderergl/lib/parsers/data/TextureVO":[function(t,e,i){var r=function(){function t(){}return t}();e.exports=r},{}],"awayjs-renderergl/lib/parsers/data/VertexVO":[function(t,e,i){var r=function(){function t(){}return t}();e.exports=r},{}],"awayjs-renderergl/lib/pick/JSPickingCollider":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-display/lib/base/TriangleSubGeometry");var n=t("awayjs-renderergl/lib/pick/PickingColliderBase");var o=function(t){r(e,t);function e(e){if(e===void 0){e=false}t.call(this);this._findClosestCollision=e}e.prototype._pTestRenderableCollision=function(t,e,i){var r;var n,o,h;var l,u,p;var c,d,f;var _,y,g;var m,b,v,w;var x,P,D;var C,T,A;var S,j,O;var E,M,R;var I,N,L;var F,V,B,U;var k,z,G,H,X;var W=t.getIndexData().data;var Y=-1;var Z=t.materialOwner.material.bothSides;var q=t.getVertexData(s.POSITION_DATA).data;var K=t.getVertexData(s.POSITION_DATA).dataPerVertex;var J=t.getVertexOffset(s.POSITION_DATA);var Q=t.getVertexData(s.UV_DATA).data;var $=t.getVertexData(s.UV_DATA).dataPerVertex;var te=t.getVertexOffset(s.UV_DATA);var ee=W.length;for(var ie=0;ie<ee;ie+=3){n=J+W[ie]*K;o=J+W[ie+1]*K;h=J+W[ie+2]*K;x=q[n];P=q[n+1];D=q[n+2];C=q[o];T=q[o+1];A=q[o+2];S=q[h];j=q[h+1];O=q[h+2];E=C-x;M=T-P;R=A-D;I=S-x;N=j-P;L=O-D;c=M*L-R*N;d=R*I-E*L;f=E*N-M*I;F=1/Math.sqrt(c*c+d*d+f*f);c*=F;d*=F;f*=F;V=c*this.rayDirection.x+d*+this.rayDirection.y+f*this.rayDirection.z;if(!Z&&V<0||Z&&V!=0){B=-(c*x+d*P+f*D);U=-(c*this.rayPosition.x+d*this.rayPosition.y+f*this.rayPosition.z+B);r=U/V;_=this.rayPosition.x+r*this.rayDirection.x;y=this.rayPosition.y+r*this.rayDirection.y;g=this.rayPosition.z+r*this.rayDirection.z;k=E*I+M*N+R*L;z=E*E+M*M+R*R;G=I*I+N*N+L*L;l=_-x;u=y-P;p=g-D;H=l*E+u*M+p*R;X=l*I+u*N+p*L;m=1/(z*G-k*k);v=m*(G*H-k*X);w=m*(-k*H+z*X);if(v<0)continue;if(w<0)continue;b=1-v-w;if(!(b<0)&&r>0&&r<i){i=r;Y=ie/3;e.rayEntryDistance=r;e.localPosition=new a(_,y,g);e.localNormal=new a(c,d,f);e.uv=this._pGetCollisionUV(W,Q,ie,v,w,b,te,$);e.index=ie;if(!this._findClosestCollision)return true}}}if(Y>=0)return true;return false};return e}(n);e.exports=o},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-renderergl/lib/pick/PickingColliderBase":undefined}],"awayjs-renderergl/lib/pick/PickingColliderBase":[function(t,e,i){var r=t("awayjs-core/lib/geom/Point");var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-core/lib/errors/AbstractMethodError");var n=t("awayjs-display/lib/pool/RenderablePool");var o=t("awayjs-stagegl/lib/pool/BillboardRenderable");var h=t("awayjs-stagegl/lib/pool/TriangleSubMeshRenderable");var l=function(){function t(){this._billboardRenderablePool=n.getPool(o);this._subMeshRenderablePool=n.getPool(h)}t.prototype._pPetCollisionNormal=function(t,e,i){var r=new a;var s=t[i]*3;var n=t[i+1]*3;var o=t[i+2]*3;var h=new a(e[s],e[s+1],e[s+2]);var l=new a(e[n],e[n+1],e[n+2]);var u=new a(e[o],e[o+1],e[o+2]);var p=l.subtract(h);var c=u.subtract(h);r=p.crossProduct(c);r.normalize();return r};t.prototype._pGetCollisionUV=function(t,e,i,s,n,o,h,l){var u=new r;var p=t[i]*l+h;var c=new a(e[p],e[p+1]);p=t[i+1]*l+h;var d=new a(e[p],e[p+1]);p=t[i+2]*l+h;var f=new a(e[p],e[p+1]);u.x=o*c.x+s*d.x+n*f.x;u.y=o*c.y+s*d.y+n*f.y;return u};t.prototype._pTestRenderableCollision=function(t,e,i){throw new s};t.prototype.setLocalRay=function(t,e){this.rayPosition=t;this.rayDirection=e};t.prototype.testBillboardCollision=function(t,e,i){this.setLocalRay(e.localRayPosition,e.localRayDirection);e.materialOwner=null;if(this._pTestRenderableCollision(this._billboardRenderablePool.getItem(t),e,i)){i=e.rayEntryDistance;e.materialOwner=t;return true}return false};t.prototype.testMeshCollision=function(t,e,i,r){this.setLocalRay(e.localRayPosition,e.localRayDirection);e.materialOwner=null;var a;var s=t.subMeshes.length;for(var n=0;n<s;++n){a=t.subMeshes[n];if(this._pTestRenderableCollision(this._subMeshRenderablePool.getItem(a),e,i)){i=e.rayEntryDistance;e.materialOwner=a;if(!r)return true}}return e.materialOwner!=null};return t}();e.exports=l},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/geom/Point":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/pool/RenderablePool":undefined,"awayjs-stagegl/lib/pool/BillboardRenderable":undefined,"awayjs-stagegl/lib/pool/TriangleSubMeshRenderable":undefined}],"awayjs-renderergl/lib/pick/ShaderPicker":[function(t,e,i){var r=t("awayjs-core/lib/utils/Debug");var a=t("awayjs-core/lib/base/BitmapData");var s=t("awayjs-core/lib/geom/Matrix3DUtils");var n=t("awayjs-core/lib/geom/Point");var o=t("awayjs-core/lib/geom/Rectangle");var h=t("awayjs-core/lib/geom/Vector3D");var l=t("awayjs-display/lib/base/TriangleSubGeometry");var u=t("awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler");var p=t("awayjs-stagegl/lib/base/ContextGLBlendFactor");var c=t("awayjs-stagegl/lib/base/ContextGLClearMask");var d=t("awayjs-stagegl/lib/base/ContextGLCompareMode");var f=t("awayjs-stagegl/lib/base/ContextGLProgramType");var _=t("awayjs-stagegl/lib/base/ContextGLTriangleFace");var y=function(){function t(t){if(t===void 0){t=false}this._onlyMouseEnabled=true;this._interactives=new Array;this._localHitPosition=new h;this._hitUV=new n;this._localHitNormal=new h;this._rayPos=new h;this._rayDir=new h;this._shaderPickingDetails=t;this._id=new Array(4);this._viewportData=new Array(4);this._boundOffsetScale=new Array(8);this._boundOffsetScale[3]=0;this._boundOffsetScale[7]=1}Object.defineProperty(t.prototype,"onlyMouseEnabled",{get:function(){return this._onlyMouseEnabled},set:function(t){this._onlyMouseEnabled=t},enumerable:true,configurable:true});t.prototype.getViewCollision=function(t,e,i){var r=i.iEntityCollector;this._stage=i.renderer.stage;if(!this._stage)return null;this._context=this._stage.context;this._viewportData[0]=i.width;this._viewportData[1]=i.height;this._viewportData[2]=-(this._projX=2*t/i.width-1);this._viewportData[3]=this._projY=2*e/i.height-1;this._potentialFound=false;this._blendedRenderableHead=null;this._opaqueRenderableHead=null;this.pDraw(r,null);this._context.setVertexBufferAt(0,null);if(!this._context||!this._potentialFound)return null;if(!this._bitmapData)this._bitmapData=new a(1,1,false,0);this._context.drawToBitmapData(this._bitmapData);this._hitColor=this._bitmapData.getPixel(0,0);if(!this._hitColor){this._context.present();return null}this._hitRenderable=this._interactives[this._hitColor-1];this._hitEntity=this._hitRenderable.sourceEntity;if(this._onlyMouseEnabled&&!this._hitEntity._iIsMouseEnabled())return null;var s=this._hitEntity._iPickingCollisionVO;if(this._shaderPickingDetails){this.getHitDetails(i.camera);s.localPosition=this._localHitPosition;s.localNormal=this._localHitNormal;s.uv=this._hitUV;s.index=this._faceIndex}else{s.localPosition=null;s.localNormal=null;s.uv=null;s.index=0}return s};t.prototype.getSceneCollision=function(t,e,i){return null};t.prototype.pDraw=function(e,i){var r=e.camera;this._context.clear(0,0,0,1);this._stage.scissorRect=t.MOUSE_SCISSOR_RECT;this._interactives.length=this._interactiveId=0;if(!this._objectProgram)this.initObjectProgram();this._context.setBlendFactors(p.ONE,p.ZERO);this._context.setDepthTest(true,d.LESS);this._context.setProgram(this._objectProgram);this._context.setProgramConstantsFromArray(f.VERTEX,4,this._viewportData,1)};t.prototype.drawRenderables=function(t,e){var i=s.CALCULATION_MATRIX;var r=e.viewProjection;while(t){if(!t.sourceEntity.scene||!t.sourceEntity._iIsMouseEnabled()){t=t.next;continue}this._potentialFound=true;this._context.setCulling(t.materialOwner.material.bothSides?_.NONE:_.BACK,e.projection.coordinateSystem);this._interactives[this._interactiveId++]=t;this._id[1]=(this._interactiveId>>8)/255;this._id[2]=(this._interactiveId&255)/255;i.copyFrom(t.sourceEntity.getRenderSceneTransform(e));i.append(r);this._context.setProgramConstantsFromMatrix(f.VERTEX,0,i,true);this._context.setProgramConstantsFromArray(f.FRAGMENT,0,this._id,1);this._context.activateBuffer(0,t.getVertexData(l.POSITION_DATA),t.getVertexOffset(l.POSITION_DATA),l.POSITION_FORMAT);this._context.drawTriangles(this._context.getIndexBuffer(t.getIndexData()),0,t.numTriangles);t=t.next}};t.prototype.updateRay=function(t){this._rayPos=t.scenePosition;this._rayDir=t.getRay(this._projX,this._projY,1);this._rayDir.normalize()};t.prototype.initObjectProgram=function(){var t;var e;this._objectProgram=this._context.createProgram();t="m44 vt0, va0, vc0			\n"+"mul vt1.xy, vt0.w, vc4.zw	\n"+"add vt0.xy, vt0.xy, vt1.xy	\n"+"mul vt0.xy, vt0.xy, vc4.xy	\n"+"mov op, vt0	\n";e="mov oc, fc0";r.throwPIR("ShaderPicker","initTriangleProgram","Dependency: initObjectProgram")};t.prototype.initTriangleProgram=function(){var t;var e;this._triangleProgram=this._context.createProgram();t="add vt0, va0, vc5 			\n"+"mul vt0, vt0, vc6 			\n"+"mov v0, vt0				\n"+"m44 vt0, va0, vc0			\n"+"mul vt1.xy, vt0.w, vc4.zw	\n"+"add vt0.xy, vt0.xy, vt1.xy	\n"+"mul vt0.xy, vt0.xy, vc4.xy	\n"+"mov op, vt0	\n";e="mov oc, v0";var i=(new u).assemble("part vertex 1\n"+t+"endpart")["vertex"].data;var r=(new u).assemble("part fragment 1\n"+e+"endpart")["fragment"].data;this._triangleProgram.upload(i,r)};t.prototype.getHitDetails=function(t){this.getApproximatePosition(t);this.getPreciseDetails(t)};t.prototype.getApproximatePosition=function(e){var i=this._hitRenderable.sourceEntity.bounds.aabb;var r;var a,n,o;var h,u,p;var d=s.CALCULATION_MATRIX;d.copyFrom(this._hitRenderable.sourceEntity.getRenderSceneTransform(e));d.append(e.viewProjection);if(!this._triangleProgram){this.initTriangleProgram()}this._boundOffsetScale[4]=1/(a=i.width);this._boundOffsetScale[5]=1/(n=i.height);this._boundOffsetScale[6]=1/(o=i.depth);this._boundOffsetScale[0]=h=-i.x;this._boundOffsetScale[1]=u=-i.y;this._boundOffsetScale[2]=p=-i.z;this._context.setProgram(this._triangleProgram);this._context.clear(0,0,0,0,1,0,c.DEPTH);this._context.setScissorRectangle(t.MOUSE_SCISSOR_RECT);this._context.setProgramConstantsFromMatrix(f.VERTEX,0,d,true);this._context.setProgramConstantsFromArray(f.VERTEX,5,this._boundOffsetScale,2);this._context.activateBuffer(0,this._hitRenderable.getVertexData(l.POSITION_DATA),this._hitRenderable.getVertexOffset(l.POSITION_DATA),l.POSITION_FORMAT);this._context.drawTriangles(this._context.getIndexBuffer(this._hitRenderable.getIndexData()),0,this._hitRenderable.numTriangles);this._context.drawToBitmapData(this._bitmapData);r=this._bitmapData.getPixel(0,0);this._localHitPosition.x=(r>>16&255)*a/255-h;this._localHitPosition.y=(r>>8&255)*n/255-u;this._localHitPosition.z=(r&255)*o/255-p};t.prototype.getPreciseDetails=function(t){var e=re.length;var i,r,a;var s,n,o;var h,u,p;var c=0,d=1,f=2;var _,y,g;var m,b,v;var w,x,P;var D,C,T;var A,S,j;var O,E,M,R;var I,N,L,F,V;var B,U,k;var z=this._localHitPosition.x,G=this._localHitPosition.y,H=this._localHitPosition.z;var X,W;var Y,Z,q;var K,J,Q;var $,te,ee;var ie;var re=this._hitRenderable.getIndexData().data;var ae=this._hitRenderable.getVertexData(l.POSITION_DATA).data;var se=this._hitRenderable.getVertexData(l.POSITION_DATA).dataPerVertex;var ne=this._hitRenderable.getVertexOffset(l.POSITION_DATA);var oe=this._hitRenderable.getVertexData(l.UV_DATA).data;var he=this._hitRenderable.getVertexData(l.UV_DATA).dataPerVertex;var le=this._hitRenderable.getVertexOffset(l.UV_DATA);var ue=this._hitRenderable.getVertexData(l.NORMAL_DATA).data;var pe=this._hitRenderable.getVertexData(l.NORMAL_DATA).dataPerVertex;var ce=this._hitRenderable.getVertexOffset(l.NORMAL_DATA);this.updateRay(t);while(c<e){_=ne+re[c]*se;y=ne+re[d]*se;g=ne+re[f]*se;i=ae[_];r=ae[_+1];a=ae[_+2];s=ae[y];n=ae[y+1];o=ae[y+2];h=ae[g];u=ae[g+1];p=ae[g+2];if(!(z<i&&z<s&&z<h||G<r&&G<n&&G<u||H<a&&H<o&&H<p||z>i&&z>s&&z>h||G>r&&G>n&&G>u||H>a&&H>o&&H>p)){m=h-i;b=u-r;v=p-a;w=s-i;x=n-r;P=o-a;D=z-i;C=G-r;T=H-a;I=m*m+b*b+v*v;N=m*w+b*x+v*P;L=m*D+b*C+v*T;F=w*w+x*x+P*P;V=w*D+x*C+P*T;k=1/(I*F-N*N);B=(F*L-N*V)*k;U=(I*V-N*L)*k;if(B>=0&&U>=0&&B+U<=1){A=ce+re[c]*pe;S=ce+re[d]*pe;j=ce+re[f]*pe;O=re[A]+re[S]+re[j];E=re[A+1]+re[S+1]+re[j+1];M=re[A+2]+re[S+2]+re[j+2];R=Math.sqrt(O*O+E*E+M*M);O/=R;E/=R;M/=R;this.getPrecisePosition(this._hitRenderable.sourceEntity.inverseSceneTransform,O,E,M,i,r,a);D=this._localHitPosition.x-i;C=this._localHitPosition.y-r;T=this._localHitPosition.z-a;K=s-i;J=n-r;Q=o-a;$=h-i;te=u-r;ee=p-a;this._localHitNormal.x=J*ee-Q*te;this._localHitNormal.y=Q*$-K*ee;this._localHitNormal.z=K*te-J*$;ie=1/Math.sqrt(this._localHitNormal.x*this._localHitNormal.x+this._localHitNormal.y*this._localHitNormal.y+this._localHitNormal.z*this._localHitNormal.z);this._localHitNormal.x*=ie;this._localHitNormal.y*=ie;this._localHitNormal.z*=ie;L=m*D+b*C+v*T;V=w*D+x*C+P*T;B=(F*L-N*V)*k;U=(I*V-N*L)*k;Y=le+re[c]*he;Z=le+re[d]*he;q=le+re[f]*he;X=oe[Y];W=oe[Y+1];this._hitUV.x=X+U*(oe[Z]-X)+B*(oe[q]-X);this._hitUV.y=W+U*(oe[Z+1]-W)+B*(oe[q+1]-W);this._faceIndex=c;return}}c+=3;d+=3;f+=3}};t.prototype.getPrecisePosition=function(t,e,i,r,a,n,o){var h,l,u;var p,c,d;var f;var _=s.RAW_DATA_CONTAINER;var y=this._rayPos.x,g=this._rayPos.y,m=this._rayPos.z;p=this._rayDir.x;c=this._rayDir.y;d=this._rayDir.z;t.copyRawDataTo(_);h=_[0]*p+_[4]*c+_[8]*d;l=_[1]*p+_[5]*c+_[9]*d;u=_[2]*p+_[6]*c+_[10]*d;p=_[0]*y+_[4]*g+_[8]*m+_[12];c=_[1]*y+_[5]*g+_[9]*m+_[13];d=_[2]*y+_[6]*g+_[10]*m+_[14];f=((a-p)*e+(n-c)*i+(o-d)*r)/(h*e+l*i+u*r);this._localHitPosition.x=p+h*f;this._localHitPosition.y=c+l*f;this._localHitPosition.z=d+u*f};t.prototype.dispose=function(){this._bitmapData.dispose();if(this._triangleProgram)this._triangleProgram.dispose();if(this._objectProgram)this._objectProgram.dispose();this._triangleProgram=null;this._objectProgram=null;this._bitmapData=null;this._hitRenderable=null;this._hitEntity=null};t.MOUSE_SCISSOR_RECT=new o(0,0,1,1);return t}();e.exports=y},{"awayjs-core/lib/base/BitmapData":undefined,"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-core/lib/geom/Point":undefined,"awayjs-core/lib/geom/Rectangle":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/utils/Debug":undefined,"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler":undefined,"awayjs-stagegl/lib/base/ContextGLBlendFactor":undefined,"awayjs-stagegl/lib/base/ContextGLClearMask":undefined,"awayjs-stagegl/lib/base/ContextGLCompareMode":undefined,"awayjs-stagegl/lib/base/ContextGLProgramType":undefined,"awayjs-stagegl/lib/base/ContextGLTriangleFace":undefined}],"awayjs-renderergl/lib/tools/commands/Merge":[function(t,e,i){var r=t("awayjs-core/lib/geom/Matrix3DUtils");var a=t("awayjs-display/lib/base/Geometry");var s=t("awayjs-display/lib/base/TriangleSubGeometry");var n=t("awayjs-display/lib/entities/Mesh");var o=function(){function t(t,e,i){if(t===void 0){t=false}if(e===void 0){e=false}if(i===void 0){i=false}this._keepMaterial=t;this._disposeSources=e;this._objectSpace=i}Object.defineProperty(t.prototype,"disposeSources",{get:function(){return this._disposeSources},set:function(t){this._disposeSources=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"keepMaterial",{get:function(){return this._keepMaterial},set:function(t){this._keepMaterial=t},enumerable:true,configurable:true});
Object.defineProperty(t.prototype,"objectSpace",{get:function(){return this._objectSpace},set:function(t){this._objectSpace=t},enumerable:true,configurable:true});t.prototype.applyToContainer=function(t,e){this.reset();this.parseContainer(t,e);this.collect(t,false);this.merge(t,this._disposeSources)};t.prototype.applyToMeshes=function(t,e){this.reset();if(!e.length)return;for(var i=0;i<e.length;i++)if(e[i]!=t)this.collect(e[i],this._disposeSources);this.collect(t,false);this.merge(t,this._disposeSources)};t.prototype.apply=function(t,e){this.reset();this.collect(e,this._disposeSources);this.collect(t,false);this.merge(t,this._disposeSources)};t.prototype.reset=function(){this._toDispose=new Array;this._geomVOs=new Array};t.prototype.merge=function(t,e){var i;var r;var n;var o;var h;n=t.geometry;o=t.geometry=new a;r=t.subMeshes.length;h=this._geomVOs.length>1;for(i=0;i<this._geomVOs.length;i++){var l;var u;var p=new s(true);p.autoDeriveNormals=false;p.autoDeriveTangents=false;u=this._geomVOs[i];p.updateIndices(u.indices);p.updatePositions(u.vertices);p.updateVertexNormals(u.normals);p.updateVertexTangents(u.tangents);p.updateUVs(u.uvs);o.addSubGeometry(p);if(this._keepMaterial&&h)t.subMeshes[r].material=u.material}if(this._keepMaterial&&!h&&this._geomVOs.length)t.material=this._geomVOs[0].material;if(e){var c;var d=this._toDispose.length;for(var i;i<d;i++){c=this._toDispose[i];c.geometry.dispose();c.dispose()}n.dispose()}this._toDispose=null};t.prototype.collect=function(t,e){if(t.geometry){var i;var a=t.geometry.subGeometries;var s;for(i=0;i<a.length;i++){var n;var o;var h,l,u,p,c;var d;var f;var _;var y;var g;var m;var b,v,w,x;f=a[i];b=f.positions;v=f.vertexNormals;w=f.vertexTangents;x=f.uvs;_=this.getSubGeomData(t.subMeshes[i].material||t.material);y=this._objectSpace?_.vertices:new Array;g=this._objectSpace?_.normals:new Array;m=this._objectSpace?_.tangents:new Array;l=y.length;u=g.length;p=m.length;c=_.uvs.length;o=f.numVertices;for(n=0;n<o;n++){s=n*3;y[l++]=b[s];y[l++]=b[s+1];y[l++]=b[s+2];g[u++]=v[s];g[u++]=v[s+1];g[u++]=v[s+2];m[p++]=w[s];m[p++]=w[s+1];m[p++]=w[s+2];_.uvs[c++]=x[n*2];_.uvs[c++]=x[n*2+1]}d=!this._objectSpace?_.vertices.length/3:0;h=_.indices.length;o=f.numTriangles;for(n=0;n<o;n++){s=n*3;_.indices[h++]=f.indices[s]+d;_.indices[h++]=f.indices[s+1]+d;_.indices[h++]=f.indices[s+2]+d}if(!this._objectSpace){t.sceneTransform.transformVectors(y,y);r.deltaTransformVectors(t.sceneTransform,g,g);r.deltaTransformVectors(t.sceneTransform,m,m);l=_.vertices.length;u=_.normals.length;p=_.tangents.length;o=y.length;for(n=0;n<o;n++){_.vertices[l++]=y[n];_.normals[u++]=g[n];_.tangents[p++]=m[n]}}}if(e)this._toDispose.push(t)}};t.prototype.getSubGeomData=function(t){var e;if(this._keepMaterial){var i;var r;r=this._geomVOs.length;for(i=0;i<r;i++){if(this._geomVOs[i].material==t){e=this._geomVOs[i];break}}}else if(this._geomVOs.length){e=this._geomVOs[0]}if(!e){e=new h;e.vertices=new Array;e.normals=new Array;e.tangents=new Array;e.uvs=new Array;e.indices=new Array;e.material=t;this._geomVOs.push(e)}return e};t.prototype.parseContainer=function(t,e){var i;var r;if(e instanceof n&&e!=t)this.collect(e,this._disposeSources);for(r=0;r<e.numChildren;++r){i=e.getChildAt(r);this.parseContainer(t,i)}};return t}();var h=function(){function t(){}return t}();e.exports=o},{"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-display/lib/base/Geometry":undefined,"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-display/lib/entities/Mesh":undefined}],"awayjs-renderergl/lib/tools/data/ParticleGeometryTransform":[function(t,e,i){var r=function(){function t(){}Object.defineProperty(t.prototype,"vertexTransform",{get:function(){return this._defaultVertexTransform},set:function(t){this._defaultVertexTransform=t;this._defaultInvVertexTransform=t.clone();this._defaultInvVertexTransform.invert();this._defaultInvVertexTransform.transpose()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"UVTransform",{get:function(){return this._defaultUVTransform},set:function(t){this._defaultUVTransform=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"invVertexTransform",{get:function(){return this._defaultInvVertexTransform},enumerable:true,configurable:true});return t}();e.exports=r},{}],"awayjs-renderergl/lib/tools/helpers/ParticleGeometryHelper":[function(t,e,i){var r=t("awayjs-core/lib/geom/Point");var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-display/lib/base/TriangleSubGeometry");var n=t("awayjs-renderergl/lib/animators/data/ParticleData");var o=t("awayjs-renderergl/lib/base/ParticleGeometry");var h=function(){function t(){}t.generateGeometry=function(e,i){if(i===void 0){i=null}var h=new Array;var l=new Array;var u=new Array;var p=new Array;var c=new Array;var d=new Array;var f=new Array;var _=new Array;var y=e.length;var g;var m;var b;var v;var w;var x;var P;var D;var C;var T;var A;var S;var j=new Array;var O=new a;var E=new a;var M=new a;var R=new r;for(A=0;A<y;A++){g=e[A].subGeometries;b=g.length;for(var I=0;I<b;I++){if(j.length<=I){j.push(_.length);h.push(new Array);l.push(new Array);u.push(new Array);p.push(new Array);c.push(new Array);_.push(new s(true));d.push(0)}m=g[I];if(m.numVertices+d[j[I]]>t.MAX_VERTEX){j[I]=_.length;h.push(new Array);l.push(new Array);u.push(new Array);p.push(new Array);c.push(new Array);_.push(new s(true));d.push(0)}S=j[I];v=h[S];w=l[S];x=u[S];P=p[S];D=c[S];C=d[S];T=_[S];var N=new n;N.numVertices=m.numVertices;N.startVertexIndex=C;N.particleIndex=A;N.subGeometry=T;f.push(N);d[S]+=m.numVertices;var L;var F;var V=m;var B;var U;var k;var z;var G;if(V){F=V.numVertices;V.numTriangles;U=V.positions;k=V.vertexNormals;z=V.vertexTangents;G=V.uvs;if(i){var H=i[A];var X=H.vertexTransform;var W=H.invVertexTransform;var Y=H.UVTransform;for(L=0;L<F;L++){B=L*3;O.x=U[B];O.y=U[B+1];O.z=U[B+2];E.x=k[B];E.y=k[B+1];E.z=k[B+2];M.x=z[B];M.y=z[B+1];M.z=z[B+2];R.x=G[L*2];R.y=G[L*2+1];if(X){O=X.transformVector(O);E=W.deltaTransformVector(E);M=W.deltaTransformVector(E)}if(Y)R=Y.transformPoint(R);U.push(O.x,O.y,O.z);k.push(E.x,E.y,E.z);z.push(M.x,M.y,M.z);G.push(R.x,R.y)}}else{for(L=0;L<F;L++){B=L*3;w.push(U[B],U[B+1],U[B+2]);x.push(k[B],k[B+1],k[B+2]);P.push(z[B],z[B+1],z[B+2]);D.push(G[L*2],G[L*2+1])}}}else{}var Z=m.indices;F=m.numTriangles;for(L=0;L<F;L++){B=L*3;v.push(Z[B]+C,Z[B+1]+C,Z[B+2]+C)}}}var q=new o;q.particles=f;q.numParticles=y;y=_.length;for(A=0;A<y;A++){T=_[A];T.autoDeriveNormals=false;T.autoDeriveTangents=false;T.updateIndices(h[A]);T.updatePositions(l[A]);T.updateVertexNormals(u[A]);T.updateVertexTangents(p[A]);T.updateUVs(c[A]);q.addSubGeometry(T)}return q};t.MAX_VERTEX=65535;return t}();e.exports=h},{"awayjs-core/lib/geom/Point":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-renderergl/lib/animators/data/ParticleData":undefined,"awayjs-renderergl/lib/base/ParticleGeometry":undefined}],"awayjs-renderergl/lib/utils/PerspectiveMatrix3D":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Matrix3D");var s=function(t){r(e,t);function e(e){if(e===void 0){e=null}t.call(this,e)}e.prototype.perspectiveFieldOfViewLH=function(t,e,i,r){var a=1/Math.tan(t/2);var s=a/e;this.copyRawDataFrom([s,0,0,0,0,a,0,0,0,0,r/(r-i),1,0,0,i*r/(i-r),0])};return e}(a);e.exports=s},{"awayjs-core/lib/geom/Matrix3D":undefined}],"awayjs-stagegl/lib/aglsl/AGALTokenizer":[function(t,e,i){var r=t("awayjs-stagegl/lib/aglsl/Description");var a=t("awayjs-stagegl/lib/aglsl/Header");var s=t("awayjs-stagegl/lib/aglsl/Mapping");var n=t("awayjs-stagegl/lib/aglsl/Token");var o=function(){function t(){}t.prototype.decribeAGALByteArray=function(t){var e=new a;if(t.readUnsignedByte()!=160){throw"Bad AGAL: Missing 0xa0 magic byte."}e.version=t.readUnsignedInt();if(e.version>=16){t.readUnsignedByte();e.version>>=1}if(t.readUnsignedByte()!=161){throw"Bad AGAL: Missing 0xa1 magic byte."}e.progid=t.readUnsignedByte();switch(e.progid){case 1:e.type="fragment";break;case 0:e.type="vertex";break;case 2:e.type="cpu";break;default:e.type="";break}var i=new r;var o=[];while(t.position<t.length){var h=new n;h.opcode=t.readUnsignedInt();var l=s.agal2glsllut[h.opcode];if(!l){throw"Opcode not valid or not implemented yet: "+h.opcode}if(l.matrixheight){i.hasmatrix=true}if(l.dest){h.dest.regnum=t.readUnsignedShort();h.dest.mask=t.readUnsignedByte();h.dest.regtype=t.readUnsignedByte();i.regwrite[h.dest.regtype][h.dest.regnum]|=h.dest.mask}else{h.dest=null;t.readUnsignedInt()}if(l.a){this.readReg(h.a,1,i,t)}else{h.a=null;t.readUnsignedInt();t.readUnsignedInt()}if(l.b){this.readReg(h.b,l.matrixheight|0,i,t)}else{h.b=null;t.readUnsignedInt();t.readUnsignedInt()}o.push(h)}i.header=e;i.tokens=o;return i};t.prototype.readReg=function(t,e,i,r){t.regnum=r.readUnsignedShort();t.indexoffset=r.readByte();t.swizzle=r.readUnsignedByte();t.regtype=r.readUnsignedByte();i.regread[t.regtype][t.regnum]=15;if(t.regtype==5){t.lodbiad=t.indexoffset;t.indexoffset=undefined;t.swizzle=undefined;t.readmode=r.readUnsignedByte();t.dim=t.readmode>>4;t.readmode&=15;t.special=r.readUnsignedByte();t.wrap=t.special>>4;t.special&=15;t.mipmap=r.readUnsignedByte();t.filter=t.mipmap>>4;t.mipmap&=15;i.samplers[t.regnum]=t}else{t.indexregtype=r.readUnsignedByte();t.indexselect=r.readUnsignedByte();t.indirectflag=r.readUnsignedByte()}if(t.indirectflag){i.hasindirect=true}if(!t.indirectflag&&e){for(var a=0;a<e;a++){i.regread[t.regtype][t.regnum+a]=i.regread[t.regtype][t.regnum]}}};return t}();e.exports=o},{"awayjs-stagegl/lib/aglsl/Description":undefined,"awayjs-stagegl/lib/aglsl/Header":undefined,"awayjs-stagegl/lib/aglsl/Mapping":undefined,"awayjs-stagegl/lib/aglsl/Token":undefined}],"awayjs-stagegl/lib/aglsl/AGLSLParser":[function(t,e,i){var r=t("awayjs-stagegl/lib/aglsl/Mapping");var a=t("awayjs-stagegl/lib/base/ContextStage3D");var s=function(){function t(){}t.prototype.parse=function(t){var e="";var i="";e+="precision highp float;\n";var s=t.header.type[0];if(t.header.type=="vertex"){e+="uniform float yflip;\n"}if(!t.hasindirect){for(var n=0;n<t.regread[1].length;n++){if(t.regread[1][n]){e+="uniform vec4 "+s+"c"+n+";\n"}}}else{e+="uniform vec4 "+s+"carrr["+a.maxvertexconstants+"];\n"}for(var n=0;n<t.regread[2].length||n<t.regwrite[2].length;n++){if(t.regread[2][n]||t.regwrite[2][n]){e+="vec4 "+s+"t"+n+";\n"}}for(var n=0;n<t.regread[0].length;n++){if(t.regread[0][n]){e+="attribute vec4 va"+n+";\n"}}for(var n=0;n<t.regread[4].length||n<t.regwrite[4].length;n++){if(t.regread[4][n]||t.regwrite[4][n]){e+="varying vec4 vi"+n+";\n"}}var o=["2D","Cube","3D",""];for(var n=0;n<t.samplers.length;n++){if(t.samplers[n]){e+="uniform sampler"+o[t.samplers[n].dim&3]+" fs"+n+";\n"}}if(t.header.type=="vertex"){e+="vec4 outpos;\n"}if(t.writedepth){e+="vec4 tmp_FragDepth;\n"}i+="void main() {\n";for(var n=0;n<t.tokens.length;n++){var h=r.agal2glsllut[t.tokens[n].opcode];if(!h){throw"Opcode not valid or not implemented yet: "}var l=h.matrixheight||1;for(var u=0;u<l;u++){var p="  "+h.s;if(t.tokens[n].dest){if(h.matrixheight){if((t.tokens[n].dest.mask>>u&1)!=1){continue}var c=this.regtostring(t.tokens[n].dest.regtype,t.tokens[n].dest.regnum,t,s);var d="float";var f=["x","y","z","w"][u];c+="."+f}else{var c=this.regtostring(t.tokens[n].dest.regtype,t.tokens[n].dest.regnum,t,s);var d;var f;if(t.tokens[n].dest.mask!=15){var _=0;f="";if(t.tokens[n].dest.mask&1){_++;f+="x"}if(t.tokens[n].dest.mask&2){_++;f+="y"}if(t.tokens[n].dest.mask&4){_++;f+="z"}if(t.tokens[n].dest.mask&8){_++;f+="w"}c+="."+f;switch(_){case 1:d="float";break;case 2:d="vec2";break;case 3:d="vec3";break;default:throw"Unexpected destination mask"}}else{d="vec4";f="xyzw"}}p=p.replace("%dest",c);p=p.replace("%cast",d);p=p.replace("%dm",f)}var y=15;if(!h.ndwm&&h.dest&&t.tokens[n].dest){y=t.tokens[n].dest.mask}if(t.tokens[n].a){p=p.replace("%a",this.sourcetostring(t.tokens[n].a,0,y,h.scalar,t,s))}if(t.tokens[n].b){p=p.replace("%b",this.sourcetostring(t.tokens[n].b,u,y,h.scalar,t,s));if(t.tokens[n].b.regtype==5){var g=["2D","Cube","3D"][t.tokens[n].b.dim];var m=["vec2","vec3","vec3"][t.tokens[n].b.dim];p=p.replace("%texdim",g);p=p.replace("%texsize",m);var b="";p=p.replace("%lod",b)}}i+=p}}if(t.header.type=="vertex"){i+="  gl_Position = vec4(outpos.x, outpos.y, outpos.z*2.0 - outpos.w, outpos.w);\n"}if(t.writedepth){i+="  gl_FragDepth = clamp(tmp_FragDepth,0.0,1.0);\n"}i+="}\n";return e+i};t.prototype.regtostring=function(t,e,i,r){switch(t){case 0:return"va"+e;case 1:if(i.hasindirect&&i.header.type=="vertex"){return"vcarrr["+e+"]"}else{return r+"c"+e}case 2:return r+"t"+e;case 3:return i.header.type=="vertex"?"outpos":"gl_FragColor";case 4:return"vi"+e;case 5:return"fs"+e;case 6:return"tmp_FragDepth";default:throw"Unknown register type"}};t.prototype.sourcetostring=function(t,e,i,r,a,s){var n=["x","y","z","w"];var o;if(t.indirectflag){o="vcarrr[int("+this.regtostring(t.indexregtype,t.regnum,a,s)+"."+n[t.indexselect]+")";var h=e+t.indexoffset;if(h<0)o+=h.toString();if(h>0)o+="+"+h.toString();o+="]"}else{o=this.regtostring(t.regtype,t.regnum+e,a,s)}if(t.regtype==5){return o}if(r){return o+"."+n[t.swizzle>>0&3]}if(t.swizzle==228&&i==15){return o}o+=".";if(i&1)o+=n[t.swizzle>>0&3];if(i&2)o+=n[t.swizzle>>2&3];if(i&4)o+=n[t.swizzle>>4&3];if(i&8)o+=n[t.swizzle>>6&3];return o};return t}();e.exports=s},{"awayjs-stagegl/lib/aglsl/Mapping":undefined,"awayjs-stagegl/lib/base/ContextStage3D":undefined}],"awayjs-stagegl/lib/aglsl/Description":[function(t,e,i){var r=t("awayjs-stagegl/lib/aglsl/Header");var a=function(){function t(){this.regread=[[],[],[],[],[],[],[]];this.regwrite=[[],[],[],[],[],[],[]];this.hasindirect=false;this.writedepth=false;this.hasmatrix=false;this.samplers=[];this.tokens=[];this.header=new r}return t}();e.exports=a},{"awayjs-stagegl/lib/aglsl/Header":undefined}],"awayjs-stagegl/lib/aglsl/Destination":[function(t,e,i){var r=function(){function t(){this.mask=0;this.regnum=0;this.regtype=0;this.dim=0}return t}();e.exports=r},{}],"awayjs-stagegl/lib/aglsl/Header":[function(t,e,i){var r=function(){function t(){this.progid=0;this.version=0;this.type=""}return t}();e.exports=r},{}],"awayjs-stagegl/lib/aglsl/Mapping":[function(t,e,i){var r=t("awayjs-stagegl/lib/aglsl/OpLUT");var a=function(){function t(t){}t.agal2glsllut=[new r("%dest = %cast(%a);\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(%a + %b);\n",0,true,true,true,null,null,null,null,null,null),new r("%dest = %cast(%a - %b);\n",0,true,true,true,null,null,null,null,null,null),new r("%dest = %cast(%a * %b);\n",0,true,true,true,null,null,null,null,null,null),new r("%dest = %cast(%a / %b);\n",0,true,true,true,null,null,null,null,null,null),new r("%dest = %cast(1.0) / %a;\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(min(%a,%b));\n",0,true,true,true,null,null,null,null,null,null),new r("%dest = %cast(max(%a,%b));\n",0,true,true,true,null,null,null,null,null,null),new r("%dest = %cast(fract(%a));\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(sqrt(abs(%a)));\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(inversesqrt(abs(%a)));\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(pow(abs(%a),%b));\n",0,true,true,true,null,null,null,null,null,null),new r("%dest = %cast(log2(abs(%a)));\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(exp2(%a));\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(normalize(vec3( %a ) ));\n",0,true,true,false,null,null,true,null,null,null),new r("%dest = %cast(sin(%a));\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(cos(%a));\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(cross(vec3(%a),vec3(%b)));\n",0,true,true,true,null,null,true,null,null,null),new r("%dest = %cast(dot(vec3(%a),vec3(%b)));\n",0,true,true,true,null,null,true,null,null,null),new r("%dest = %cast(dot(vec4(%a),vec4(%b)));\n",0,true,true,true,null,null,true,null,null,null),new r("%dest = %cast(abs(%a));\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(%a * -1.0);\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(clamp(%a,0.0,1.0));\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(dot(vec3(%a),vec3(%b)));\n",null,true,true,true,3,3,true,null,null,null),new r("%dest = %cast(dot(vec4(%a),vec4(%b)));\n",null,true,true,true,4,4,true,null,null,null),new r("%dest = %cast(dot(vec4(%a),vec4(%b)));\n",null,true,true,true,4,3,true,null,null,null),new r("%dest = %cast(dFdx(%a));\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(dFdx(%a));\n",0,true,true,false,null,null,null,null,null,null),new r("if (float(%a)==float(%b)) {;\n",0,false,true,true,null,null,null,true,null,null),new r("if (float(%a)!=float(%b)) {;\n",0,false,true,true,null,null,null,true,null,null),new r("if (float(%a)>=float(%b)) {;\n",0,false,true,true,null,null,null,true,null,null),new r("if (float(%a)<float(%b)) {;\n",0,false,true,true,null,null,null,true,null,null),new r("} else {;\n",0,false,false,false,null,null,null,null,null,null),new r("};\n",0,false,false,false,null,null,null,null,null,null),new r(null,null,null,null,false,null,null,null,null,null,null),new r(null,null,null,null,false,null,null,null,null,null,null),new r(null,null,null,null,false,null,null,null,null,null,null),new r(null,null,null,null,false,null,null,null,null,null,null),new r("%dest = %cast(texture%texdimLod(%b,%texsize(%a)).%dm);\n",null,true,true,true,null,null,null,null,true,null),new r("if ( float(%a)<0.0 ) discard;\n",null,false,true,false,null,null,null,true,null,null),new r("%dest = %cast(texture%texdim(%b,%texsize(%a)%lod).%dm);\n",null,true,true,true,null,null,true,null,true,true),new r("%dest = %cast(greaterThanEqual(%a,%b).%dm);\n",0,true,true,true,null,null,true,null,true,null),new r("%dest = %cast(lessThan(%a,%b).%dm);\n",0,true,true,true,null,null,true,null,true,null),new r("%dest = %cast(sign(%a));\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(equal(%a,%b).%dm);\n",0,true,true,true,null,null,true,null,true,null),new r("%dest = %cast(notEqual(%a,%b).%dm);\n",0,true,true,true,null,null,true,null,true,null)];return t}();e.exports=a},{"awayjs-stagegl/lib/aglsl/OpLUT":undefined}],"awayjs-stagegl/lib/aglsl/OpLUT":[function(t,e,i){var r=function(){function t(t,e,i,r,a,s,n,o,h,l,u){this.s=t;this.flags=e;this.dest=i;this.a=r;this.b=a;this.matrixwidth=s;this.matrixheight=n;this.ndwm=o;this.scalar=h;this.dm=l;this.lod=u}return t}();e.exports=r},{}],"awayjs-stagegl/lib/aglsl/Sampler":[function(t,e,i){var r=function(){function t(){this.lodbias=0;this.dim=0;this.readmode=0;this.special=0;this.wrap=0;this.mipmap=0;this.filter=0}return t}();e.exports=r},{}],"awayjs-stagegl/lib/aglsl/Token":[function(t,e,i){var r=t("awayjs-stagegl/lib/aglsl/Destination");var a=function(){function t(){this.dest=new r;this.opcode=0;this.a=new r;this.b=new r}return t}();e.exports=a},{"awayjs-stagegl/lib/aglsl/Destination":undefined}],"awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler":[function(t,e,i){var r=t("awayjs-stagegl/lib/aglsl/assembler/OpcodeMap");var a=t("awayjs-stagegl/lib/aglsl/assembler/Part");var s=t("awayjs-stagegl/lib/aglsl/assembler/RegMap");var n=t("awayjs-stagegl/lib/aglsl/assembler/SamplerMap");var o=function(){function t(){this.r={};this.cur=new a}t.prototype.assemble=function(t,e,i){if(e===void 0){e=null}if(i===void 0){i=null}if(!i){i=1}if(e){this.addHeader(e,i)}var r=t.replace(/[\f\n\r\v]+/g,"\n").split("\n");for(var a in r){this.processLine(r[a],a)}return this.r};t.prototype.processLine=function(t,e){var i=t.search("//");if(i!=-1){t=t.slice(0,i)}t=t.replace(/^\s+|\s+$/g,"");if(!(t.length>0)){return}var a=t.search(/<.*>/g);var s=null;if(a!=-1){s=t.slice(a).match(/([\w\.\-\+]+)/gi);t=t.slice(0,a)}var n=t.match(/([\w\.\+\[\]]+)/gi);if(!n||n.length<1){if(t.length>=3){console.log("Warning: bad line "+e+": "+t)}return}switch(n[0]){case"part":this.addHeader(n[1],Number(n[2]));break;case"endpart":if(!this.cur){throw"Unexpected endpart"}this.cur.data.position=0;this.cur=null;return;default:if(!this.cur){console.log("Warning: bad line "+e+": "+t+" (Outside of any part definition)");return}if(this.cur.name=="comment"){return}var o=r.map[n[0]];if(!o){throw"Bad opcode "+n[0]+" "+e+": "+t}this.emitOpcode(this.cur,o.opcode);var h=1;if(o.dest&&o.dest!="none"){if(!this.emitDest(this.cur,n[h++],o.dest)){throw"Bad destination register "+n[h-1]+" "+e+": "+t}}else{this.emitZeroDword(this.cur)}if(o.a&&o.a.format!="none"){if(!this.emitSource(this.cur,n[h++],o.a))throw"Bad source register "+n[h-1]+" "+e+": "+t}else{this.emitZeroQword(this.cur)}if(o.b&&o.b.format!="none"){if(o.b.format=="sampler"){if(!this.emitSampler(this.cur,n[h++],o.b,s)){throw"Bad sampler register "+n[h-1]+" "+e+": "+t}}else{if(!this.emitSource(this.cur,n[h++],o.b)){throw"Bad source register "+n[h-1]+" "+e+": "+t}}}else{this.emitZeroQword(this.cur)}break}};t.prototype.emitHeader=function(t){t.data.writeUnsignedByte(160);t.data.writeUnsignedInt(t.version);if(t.version>=16){t.data.writeUnsignedByte(0)}t.data.writeUnsignedByte(161);switch(t.name){case"fragment":t.data.writeUnsignedByte(1);break;case"vertex":t.data.writeUnsignedByte(0);break;case"cpu":t.data.writeUnsignedByte(2);break;default:t.data.writeUnsignedByte(255);break}};t.prototype.emitOpcode=function(t,e){t.data.writeUnsignedInt(e)};t.prototype.emitZeroDword=function(t){t.data.writeUnsignedInt(0)};t.prototype.emitZeroQword=function(t){t.data.writeUnsignedInt(0);t.data.writeUnsignedInt(0)};t.prototype.emitDest=function(t,e,i){var r=e.match(/([fov]?[tpocidavs])(\d*)(\.[xyzw]{1,4})?/i);if(!s.map[r[1]])return false;var a={num:r[2]?r[2]:0,code:s.map[r[1]].code,mask:this.stringToMask(r[3])};t.data.writeUnsignedShort(a.num);t.data.writeUnsignedByte(a.mask);t.data.writeUnsignedByte(a.code);return true};t.prototype.stringToMask=function(t){if(!t)return 15;var e=0;if(t.indexOf("x")!=-1)e|=1;if(t.indexOf("y")!=-1)e|=2;if(t.indexOf("z")!=-1)e|=4;if(t.indexOf("w")!=-1)e|=8;return e};t.prototype.stringToSwizzle=function(t){if(!t){return 228}var e={x:0,y:1,z:2,w:3};var i=0;if(t.charAt(0)!="."){throw"Missing . for swizzle"}if(t.length>1){i|=e[t.charAt(1)]}if(t.length>2){i|=e[t.charAt(2)]<<2}else{i|=(i&3)<<2}if(t.length>3){i|=e[t.charAt(3)]<<4}else{i|=(i&3<<2)<<2}if(t.length>4){i|=e[t.charAt(4)]<<6}else{i|=(i&3<<4)<<2}return i};t.prototype.emitSampler=function(t,e,i,r){var a=e.match(/fs(\d*)/i);if(!a||!a[1]){return false}t.data.writeUnsignedShort(parseInt(a[1]));t.data.writeUnsignedByte(0);t.data.writeUnsignedByte(0);var s=5;var o=0;for(var h=0;h<r.length;h++){var l=n.map[r[h].toLowerCase()];if(l){if((o>>l.shift&l.mask)!=0){console.log("Warning, duplicate sampler option")}o|=l.mask<<l.shift;s&=~(l.mask<<l.shift);s|=l.value<<l.shift}else{console.log("Warning, unknown sampler option: ",r[h])}}t.data.writeUnsignedInt(s);return true};t.prototype.emitSource=function(t,e,i){var r=e.match(/vc\[(v[tcai])(\d+)\.([xyzw])([\+\-]\d+)?\](\.[xyzw]{1,4})?/i);var a;if(r){if(!s.map[r[1]]){return false}var n={x:0,y:1,z:2,w:3};var o={num:r[2]|0,code:s.map[r[1]].code,swizzle:this.stringToSwizzle(r[5]),select:n[r[3]],offset:r[4]|0};t.data.writeUnsignedShort(o.num);t.data.writeByte(o.offset);t.data.writeUnsignedByte(o.swizzle);t.data.writeUnsignedByte(1);t.data.writeUnsignedByte(o.code);t.data.writeUnsignedByte(o.select);t.data.writeUnsignedByte(1<<7)}else{a=e.match(/([fov]?[tpocidavs])(\d*)(\.[xyzw]{1,4})?/i);if(!s.map[a[1]]){return false}var o={num:a[2]|0,code:s.map[a[1]].code,swizzle:this.stringToSwizzle(a[3])};t.data.writeUnsignedShort(o.num);t.data.writeUnsignedByte(0);t.data.writeUnsignedByte(o.swizzle);t.data.writeUnsignedByte(o.code);t.data.writeUnsignedByte(0);t.data.writeUnsignedByte(0);t.data.writeUnsignedByte(0)}return true};t.prototype.addHeader=function(t,e){if(!e){e=1}if(this.r[t]==undefined){this.r[t]=new a(t,e);this.emitHeader(this.r[t])}else if(this.r[t].version!=e){throw"Multiple versions for part "+t}this.cur=this.r[t]};return t}();e.exports=o},{"awayjs-stagegl/lib/aglsl/assembler/OpcodeMap":undefined,"awayjs-stagegl/lib/aglsl/assembler/Part":undefined,"awayjs-stagegl/lib/aglsl/assembler/RegMap":undefined,"awayjs-stagegl/lib/aglsl/assembler/SamplerMap":undefined}],"awayjs-stagegl/lib/aglsl/assembler/FS":[function(t,e,i){var r=function(){function t(){}return t}();e.exports=r},{}],"awayjs-stagegl/lib/aglsl/assembler/Flags":[function(t,e,i){var r=function(){function t(){}return t}();e.exports=r},{}],"awayjs-stagegl/lib/aglsl/assembler/OpcodeMap":[function(t,e,i){var r=t("awayjs-stagegl/lib/aglsl/assembler/Opcode");var a=function(){function t(){}Object.defineProperty(t,"map",{get:function(){if(!t._map){t._map=new Array;t._map["mov"]=new r("vector","vector",4,"none",0,0,true,null,null,null);t._map["add"]=new r("vector","vector",4,"vector",4,1,true,null,null,null);t._map["sub"]=new r("vector","vector",4,"vector",4,2,true,null,null,null);t._map["mul"]=new r("vector","vector",4,"vector",4,3,true,null,null,null);t._map["div"]=new r("vector","vector",4,"vector",4,4,true,null,null,null);t._map["rcp"]=new r("vector","vector",4,"none",0,5,true,null,null,null);t._map["min"]=new r("vector","vector",4,"vector",4,6,true,null,null,null);t._map["max"]=new r("vector","vector",4,"vector",4,7,true,null,null,null);t._map["frc"]=new r("vector","vector",4,"none",0,8,true,null,null,null);t._map["sqt"]=new r("vector","vector",4,"none",0,9,true,null,null,null);t._map["rsq"]=new r("vector","vector",4,"none",0,10,true,null,null,null);t._map["pow"]=new r("vector","vector",4,"vector",4,11,true,null,null,null);t._map["log"]=new r("vector","vector",4,"none",0,12,true,null,null,null);t._map["exp"]=new r("vector","vector",4,"none",0,13,true,null,null,null);t._map["nrm"]=new r("vector","vector",4,"none",0,14,true,null,null,null);t._map["sin"]=new r("vector","vector",4,"none",0,15,true,null,null,null);t._map["cos"]=new r("vector","vector",4,"none",0,16,true,null,null,null);t._map["crs"]=new r("vector","vector",4,"vector",4,17,true,true,null,null);t._map["dp3"]=new r("vector","vector",4,"vector",4,18,true,true,null,null);t._map["dp4"]=new r("vector","vector",4,"vector",4,19,true,true,null,null);t._map["abs"]=new r("vector","vector",4,"none",0,20,true,null,null,null);t._map["neg"]=new r("vector","vector",4,"none",0,21,true,null,null,null);t._map["sat"]=new r("vector","vector",4,"none",0,22,true,null,null,null);t._map["ted"]=new r("vector","vector",4,"sampler",1,38,true,null,true,null);t._map["kil"]=new r("none","scalar",1,"none",0,39,true,null,true,null);t._map["tex"]=new r("vector","vector",4,"sampler",1,40,true,null,true,null);t._map["m33"]=new r("vector","matrix",3,"vector",3,23,true,null,null,true);t._map["m44"]=new r("vector","matrix",4,"vector",4,24,true,null,null,true);t._map["m43"]=new r("vector","matrix",3,"vector",4,25,true,null,null,true);t._map["sge"]=new r("vector","vector",4,"vector",4,41,true,null,null,null);t._map["slt"]=new r("vector","vector",4,"vector",4,42,true,null,null,null);t._map["sgn"]=new r("vector","vector",4,"vector",4,43,true,null,null,null);t._map["seq"]=new r("vector","vector",4,"vector",4,44,true,null,null,null);t._map["sne"]=new r("vector","vector",4,"vector",4,45,true,null,null,null)}return t._map},enumerable:true,configurable:true});return t}();e.exports=a},{"awayjs-stagegl/lib/aglsl/assembler/Opcode":undefined}],"awayjs-stagegl/lib/aglsl/assembler/Opcode":[function(t,e,i){var r=t("awayjs-stagegl/lib/aglsl/assembler/Flags");var a=t("awayjs-stagegl/lib/aglsl/assembler/FS");var s=function(){function t(t,e,i,s,n,o,h,l,u,p){this.a=new a;this.b=new a;this.flags=new r;this.dest=t;this.a.format=e;this.a.size=i;this.b.format=s;this.b.size=n;this.opcode=o;this.flags.simple=h;this.flags.horizontal=l;this.flags.fragonly=u;this.flags.matrix=p}return t}();e.exports=s},{"awayjs-stagegl/lib/aglsl/assembler/FS":undefined,"awayjs-stagegl/lib/aglsl/assembler/Flags":undefined}],"awayjs-stagegl/lib/aglsl/assembler/Part":[function(t,e,i){var r=t("awayjs-core/lib/utils/ByteArray");var a=function(){function t(t,e){if(t===void 0){t=null}if(e===void 0){e=null}this.name="";this.version=0;this.name=t;this.version=e;this.data=new r}return t}();e.exports=a},{"awayjs-core/lib/utils/ByteArray":undefined}],"awayjs-stagegl/lib/aglsl/assembler/RegMap":[function(t,e,i){var r=function(){function t(t,e){this.code=t;this.desc=e}return t}();var a=function(){function t(){}Object.defineProperty(t,"map",{get:function(){if(!t._map){t._map=new Array;t._map["va"]=new r(0,"vertex attribute");t._map["fc"]=new r(1,"fragment constant");t._map["vc"]=new r(1,"vertex constant");t._map["ft"]=new r(2,"fragment temporary");t._map["vt"]=new r(2,"vertex temporary");t._map["vo"]=new r(3,"vertex output");t._map["op"]=new r(3,"vertex output");t._map["fd"]=new r(3,"fragment depth output");t._map["fo"]=new r(3,"fragment output");t._map["oc"]=new r(3,"fragment output");t._map["v"]=new r(4,"varying");t._map["vi"]=new r(4,"varying output");t._map["fi"]=new r(4,"varying input");t._map["fs"]=new r(5,"sampler")}return t._map},enumerable:true,configurable:true});return t}();e.exports=a},{}],"awayjs-stagegl/lib/aglsl/assembler/SamplerMap":[function(t,e,i){var r=t("awayjs-stagegl/lib/aglsl/assembler/Sampler");var a=function(){function t(){}Object.defineProperty(t,"map",{get:function(){if(!t._map){t._map=new Array;t._map["rgba"]=new r(8,15,0);t._map["rg"]=new r(8,15,5);t._map["r"]=new r(8,15,4);t._map["compressed"]=new r(8,15,1);t._map["compressed_alpha"]=new r(8,15,2);t._map["dxt1"]=new r(8,15,1);t._map["dxt5"]=new r(8,15,2);t._map["2d"]=new r(12,15,0);t._map["cube"]=new r(12,15,1);t._map["3d"]=new r(12,15,2);t._map["centroid"]=new r(16,1,1);t._map["ignoresampler"]=new r(16,4,4);t._map["clamp"]=new r(20,15,0);t._map["repeat"]=new r(20,15,1);t._map["wrap"]=new r(20,15,1);t._map["nomip"]=new r(24,15,0);t._map["mipnone"]=new r(24,15,0);t._map["mipnearest"]=new r(24,15,1);t._map["miplinear"]=new r(24,15,2);t._map["nearest"]=new r(28,15,0);t._map["linear"]=new r(28,15,1)}return t._map},enumerable:true,configurable:true});return t}();e.exports=a},{"awayjs-stagegl/lib/aglsl/assembler/Sampler":undefined}],"awayjs-stagegl/lib/aglsl/assembler/Sampler":[function(t,e,i){var r=function(){function t(t,e,i){this.shift=t;this.mask=e;this.value=i}return t}();e.exports=r},{}],"awayjs-stagegl/lib/animators/AnimationSetBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetType");var s=t("awayjs-core/lib/library/NamedAssetBase");var n=t("awayjs-core/lib/errors/AbstractMethodError");var o=t("awayjs-stagegl/lib/errors/AnimationSetError");var h=function(t){r(e,t);function e(){t.call(this);this._animations=new Array;this._animationNames=new Array;this._animationDictionary=new Object}e.prototype._pFindTempReg=function(t,e){if(e===void 0){e=null}var i=0;var r;while(true){r="vt"+i;if(t.indexOf(r)==-1&&e!=r)return r;++i}return null};Object.defineProperty(e.prototype,"usesCPU",{get:function(){return this._usesCPU},enumerable:true,configurable:true});e.prototype.resetGPUCompatibility=function(){this._usesCPU=false};e.prototype.cancelGPUCompatibility=function(){this._usesCPU=true};e.prototype.getAGALVertexCode=function(t){throw new n};e.prototype.activate=function(t,e){throw new n};e.prototype.deactivate=function(t,e){throw new n};e.prototype.getAGALFragmentCode=function(t,e){throw new n};e.prototype.getAGALUVCode=function(t){throw new n};e.prototype.doneAGALCode=function(t){throw new n};Object.defineProperty(e.prototype,"assetType",{get:function(){return a.ANIMATION_SET},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"animations",{get:function(){return this._animations},enumerable:true,configurable:true});
Object.defineProperty(e.prototype,"animationNames",{get:function(){return this._animationNames},enumerable:true,configurable:true});e.prototype.hasAnimation=function(t){return this._animationDictionary[t]!=null};e.prototype.getAnimation=function(t){return this._animationDictionary[t]};e.prototype.addAnimation=function(t){if(this._animationDictionary[t.name])throw new o("root node name '"+t.name+"' already exists in the set");this._animationDictionary[t.name]=t;this._animations.push(t);this._animationNames.push(t.name)};e.prototype.dispose=function(){};return e}(s);e.exports=h},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/library/AssetType":undefined,"awayjs-core/lib/library/NamedAssetBase":undefined,"awayjs-stagegl/lib/errors/AnimationSetError":undefined}],"awayjs-stagegl/lib/animators/AnimatorBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetType");var s=t("awayjs-core/lib/library/NamedAssetBase");var n=t("awayjs-core/lib/errors/AbstractMethodError");var o=t("awayjs-core/lib/utils/RequestAnimationFrame");var h=t("awayjs-core/lib/utils/getTimer");var l=t("awayjs-stagegl/lib/events/AnimatorEvent");var u=function(t){r(e,t);function e(e){t.call(this);this._autoUpdate=true;this._time=0;this._playbackSpeed=1;this._pOwners=new Array;this._pAbsoluteTime=0;this._animationStates=new Object;this.updatePosition=true;this._pAnimationSet=e;this._broadcaster=new o(this.onEnterFrame,this)}e.prototype.getAnimationState=function(t){var e=t.stateClass;var i=t.id;if(this._animationStates[i]==null)this._animationStates[i]=new e(this,t);return this._animationStates[i]};e.prototype.getAnimationStateByName=function(t){return this.getAnimationState(this._pAnimationSet.getAnimation(t))};Object.defineProperty(e.prototype,"absoluteTime",{get:function(){return this._pAbsoluteTime},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"animationSet",{get:function(){return this._pAnimationSet},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"activeState",{get:function(){return this._pActiveState},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"activeAnimation",{get:function(){return this._pAnimationSet.getAnimation(this._pActiveAnimationName)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"activeAnimationName",{get:function(){return this._pActiveAnimationName},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){if(this._autoUpdate==t)return;this._autoUpdate=t;if(this._autoUpdate)this.start();else this.stop()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"time",{get:function(){return this._time},set:function(t){if(this._time==t)return;this.update(t)},enumerable:true,configurable:true});e.prototype.phase=function(t){this._pActiveState.phase(t)};Object.defineProperty(e.prototype,"playbackSpeed",{get:function(){return this._playbackSpeed},set:function(t){this._playbackSpeed=t},enumerable:true,configurable:true});e.prototype.setRenderState=function(t,e,i,r,a,s){throw new n};e.prototype.start=function(){if(this._isPlaying||!this._autoUpdate)return;this._time=this._pAbsoluteTime=h();this._isPlaying=true;this._broadcaster.start();if(!this.hasEventListener(l.START))return;if(this._startEvent==null)this._startEvent=new l(l.START,this);this.dispatchEvent(this._startEvent)};e.prototype.stop=function(){if(!this._isPlaying)return;this._isPlaying=false;this._broadcaster.stop();if(!this.hasEventListener(l.STOP))return;if(this._stopEvent==null)this._stopEvent=new l(l.STOP,this);this.dispatchEvent(this._stopEvent)};e.prototype.update=function(t){var e=(t-this._time)*this.playbackSpeed;this._pUpdateDeltaTime(e);this._time=t};e.prototype.reset=function(t,e){if(e===void 0){e=0}this.getAnimationState(this._pAnimationSet.getAnimation(t)).offset(e+this._pAbsoluteTime)};e.prototype.addOwner=function(t){this._pOwners.push(t)};e.prototype.removeOwner=function(t){this._pOwners.splice(this._pOwners.indexOf(t),1)};e.prototype._pUpdateDeltaTime=function(t){this._pAbsoluteTime+=t;this._pActiveState.update(this._pAbsoluteTime);if(this.updatePosition)this.applyPositionDelta()};e.prototype.onEnterFrame=function(t){if(t===void 0){t=null}this.update(h())};e.prototype.applyPositionDelta=function(){var t=this._pActiveState.positionDelta;var e=t.length;var i;if(e>0){i=this._pOwners.length;for(var r=0;r<i;++r)this._pOwners[r].translateLocal(t,e)}};e.prototype.dispatchCycleEvent=function(){if(this.hasEventListener(l.CYCLE_COMPLETE)){if(this._cycleEvent==null)this._cycleEvent=new l(l.CYCLE_COMPLETE,this);this.dispatchEvent(this._cycleEvent)}};e.prototype.clone=function(){throw new n};e.prototype.dispose=function(){};e.prototype.testGPUCompatibility=function(t){throw new n};Object.defineProperty(e.prototype,"assetType",{get:function(){return a.ANIMATOR},enumerable:true,configurable:true});e.prototype.getRenderableSubGeometry=function(t,e){return e};return e}(s);e.exports=u},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/library/AssetType":undefined,"awayjs-core/lib/library/NamedAssetBase":undefined,"awayjs-core/lib/utils/RequestAnimationFrame":undefined,"awayjs-core/lib/utils/getTimer":undefined,"awayjs-stagegl/lib/events/AnimatorEvent":undefined}],"awayjs-stagegl/lib/animators/data/AnimationRegisterCache":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/compilation/ShaderRegisterCache");var s=t("awayjs-stagegl/lib/materials/compilation/ShaderRegisterElement");var n=function(t){r(e,t);function e(e){t.call(this,e);this.indexDictionary=new Object;this.vertexConstantData=new Array;this.fragmentConstantData=new Array}e.prototype.reset=function(){t.prototype.reset.call(this);this.rotationRegisters=new Array;this.positionAttribute=this.getRegisterFromString(this.sourceRegisters[0]);this.scaleAndRotateTarget=this.getRegisterFromString(this.targetRegisters[0]);this.addVertexTempUsages(this.scaleAndRotateTarget,1);for(var e=1;e<this.targetRegisters.length;e++){this.rotationRegisters.push(this.getRegisterFromString(this.targetRegisters[e]));this.addVertexTempUsages(this.rotationRegisters[e-1],1)}this.scaleAndRotateTarget=new s(this.scaleAndRotateTarget.regName,this.scaleAndRotateTarget.index);this.vertexZeroConst=this.getFreeVertexConstant();this.vertexZeroConst=new s(this.vertexZeroConst.regName,this.vertexZeroConst.index,0);this.vertexOneConst=new s(this.vertexZeroConst.regName,this.vertexZeroConst.index,1);this.vertexTwoConst=new s(this.vertexZeroConst.regName,this.vertexZeroConst.index,2);this.positionTarget=this.getFreeVertexVectorTemp();this.addVertexTempUsages(this.positionTarget,1);this.positionTarget=new s(this.positionTarget.regName,this.positionTarget.index);if(this.needVelocity){this.velocityTarget=this.getFreeVertexVectorTemp();this.addVertexTempUsages(this.velocityTarget,1);this.velocityTarget=new s(this.velocityTarget.regName,this.velocityTarget.index);this.vertexTime=new s(this.velocityTarget.regName,this.velocityTarget.index,3);this.vertexLife=new s(this.positionTarget.regName,this.positionTarget.index,3)}else{var i=this.getFreeVertexVectorTemp();this.addVertexTempUsages(i,1);this.vertexTime=new s(i.regName,i.index,0);this.vertexLife=new s(i.regName,i.index,1)}};e.prototype.setUVSourceAndTarget=function(t,e){this.uvVar=this.getRegisterFromString(e);this.uvAttribute=this.getRegisterFromString(t);this.uvTarget=new s(this.positionTarget.regName,this.positionTarget.index)};e.prototype.setRegisterIndex=function(t,e,i){var r=this.indexDictionary[t.id];if(r==null)r=this.indexDictionary[t.id]=new Array(8);r[e]=i};e.prototype.getRegisterIndex=function(t,e){return this.indexDictionary[t.id][e]};e.prototype.getInitCode=function(){var t=this.sourceRegisters.length;var e="";for(var i=0;i<t;i++)e+="mov "+this.targetRegisters[i]+","+this.sourceRegisters[i]+"\n";e+="mov "+this.positionTarget+".xyz,"+this.vertexZeroConst.toString()+"\n";if(this.needVelocity)e+="mov "+this.velocityTarget+".xyz,"+this.vertexZeroConst.toString()+"\n";return e};e.prototype.getCombinationCode=function(){return"add "+this.scaleAndRotateTarget+".xyz,"+this.scaleAndRotateTarget+".xyz,"+this.positionTarget+".xyz\n"};e.prototype.initColorRegisters=function(){var t="";if(this.hasColorMulNode){this.colorMulTarget=this.getFreeVertexVectorTemp();this.addVertexTempUsages(this.colorMulTarget,1);this.colorMulVary=this.getFreeVarying();t+="mov "+this.colorMulTarget+","+this.vertexOneConst+"\n"}if(this.hasColorAddNode){this.colorAddTarget=this.getFreeVertexVectorTemp();this.addVertexTempUsages(this.colorAddTarget,1);this.colorAddVary=this.getFreeVarying();t+="mov "+this.colorAddTarget+","+this.vertexZeroConst+"\n"}return t};e.prototype.getColorPassCode=function(){var t="";if(this.needFragmentAnimation&&(this.hasColorAddNode||this.hasColorMulNode)){if(this.hasColorMulNode)t+="mov "+this.colorMulVary+","+this.colorMulTarget+"\n";if(this.hasColorAddNode)t+="mov "+this.colorAddVary+","+this.colorAddTarget+"\n"}return t};e.prototype.getColorCombinationCode=function(t){var e="";if(this.needFragmentAnimation&&(this.hasColorAddNode||this.hasColorMulNode)){var i=this.getRegisterFromString(t);this.addFragmentTempUsages(i,1);if(this.hasColorMulNode)e+="mul "+i+","+i+","+this.colorMulVary+"\n";if(this.hasColorAddNode)e+="add "+i+","+i+","+this.colorAddVary+"\n"}return e};e.prototype.getRegisterFromString=function(t){var e=t.split(/(\d+)/);return new s(e[0],parseInt(e[1]))};Object.defineProperty(e.prototype,"numVertexConstant",{get:function(){return this._numVertexConstant},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numFragmentConstant",{get:function(){return this._numFragmentConstant},enumerable:true,configurable:true});e.prototype.setDataLength=function(){this._numVertexConstant=this.numUsedVertexConstants-this.vertexConstantOffset;this._numFragmentConstant=this.numUsedFragmentConstants-this.fragmentConstantOffset;this.vertexConstantData.length=this._numVertexConstant*4;this.fragmentConstantData.length=this._numFragmentConstant*4};e.prototype.setVertexConst=function(t,e,i,r,a){if(e===void 0){e=0}if(i===void 0){i=0}if(r===void 0){r=0}if(a===void 0){a=0}var s=(t-this.vertexConstantOffset)*4;this.vertexConstantData[s++]=e;this.vertexConstantData[s++]=i;this.vertexConstantData[s++]=r;this.vertexConstantData[s]=a};e.prototype.setVertexConstFromArray=function(t,e){var i=(t-this.vertexConstantOffset)*4;for(var r=0;r<e.length;r++)this.vertexConstantData[i++]=e[r]};e.prototype.setVertexConstFromMatrix=function(t,e){var i=e.rawData;var r=(t-this.vertexConstantOffset)*4;this.vertexConstantData[r++]=i[0];this.vertexConstantData[r++]=i[4];this.vertexConstantData[r++]=i[8];this.vertexConstantData[r++]=i[12];this.vertexConstantData[r++]=i[1];this.vertexConstantData[r++]=i[5];this.vertexConstantData[r++]=i[9];this.vertexConstantData[r++]=i[13];this.vertexConstantData[r++]=i[2];this.vertexConstantData[r++]=i[6];this.vertexConstantData[r++]=i[10];this.vertexConstantData[r++]=i[14];this.vertexConstantData[r++]=i[3];this.vertexConstantData[r++]=i[7];this.vertexConstantData[r++]=i[11];this.vertexConstantData[r]=i[15]};e.prototype.setFragmentConst=function(t,e,i,r,a){if(e===void 0){e=0}if(i===void 0){i=0}if(r===void 0){r=0}if(a===void 0){a=0}var s=(t-this.fragmentConstantOffset)*4;this.fragmentConstantData[s++]=e;this.fragmentConstantData[s++]=i;this.fragmentConstantData[s++]=r;this.fragmentConstantData[s]=a};return e}(a);e.exports=n},{"awayjs-stagegl/lib/materials/compilation/ShaderRegisterCache":undefined,"awayjs-stagegl/lib/materials/compilation/ShaderRegisterElement":undefined}],"awayjs-stagegl/lib/animators/states/IAnimationState":[function(t,e,i){},{}],"awayjs-stagegl/lib/base/ContextGLBase":[function(t,e,i){var r=t("awayjs-core/lib/errors/AbstractMethodError");var a=t("awayjs-core/lib/textures/RenderTexture");var s=t("awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler");var n=t("awayjs-stagegl/lib/pool/TextureDataPool");var o=t("awayjs-stagegl/lib/pool/ProgramDataPool");var h=t("awayjs-stagegl/lib/pool/MaterialDataPool");var l=t("awayjs-stagegl/lib/base/ContextGLClearMask");var u=t("awayjs-stagegl/lib/base/ContextGLTextureFormat");var p=function(){function t(t){this._programData=new Array;this._numUsedStreams=0;this._numUsedTextures=0;this._stageIndex=-1;this._antiAlias=0;this._renderTarget=null;this._renderSurfaceSelector=0;this._stageIndex=t;this._texturePool=new n(this);this._materialDataPool=new h(this);this._programDataPool=new o(this)}Object.defineProperty(t.prototype,"container",{get:function(){return this._pContainer},enumerable:true,configurable:true});t.prototype.setRenderTarget=function(t,e,i){if(e===void 0){e=false}if(i===void 0){i=0}if(this._renderTarget===t&&i==this._renderSurfaceSelector&&this._enableDepthAndStencil==e)return;this._renderTarget=t;this._renderSurfaceSelector=i;this._enableDepthAndStencil=e;if(t instanceof a){this.setRenderToTexture(this.getRenderTexture(t),e,this._antiAlias,i)}else{this.setRenderToBackBuffer();this.configureBackBuffer(this._width,this._height,this._antiAlias,this._enableDepthAndStencil)}};t.prototype.getRenderTexture=function(t){var e=this._texturePool.getItem(t);if(!e.texture)e.texture=this.createTexture(t.width,t.height,u.BGRA,true);return e.texture};t.prototype.getProgram=function(t){if(!t.key.length){t.key=t.animationVertexCode+t.vertexCode+"---"+t.fragmentCode+t.animationFragmentCode+t.postAnimationFragmentCode}else{return t.programData}var e=this._programDataPool.getItem(t.key);if(t.programData!=e){if(t.programData)t.programData.dispose();t.programData=e;e.usages++}return e};t.prototype.getMaterial=function(t,e){var i=this._materialDataPool.getItem(t);if(i.invalidAnimation){i.invalidAnimation=false;var r=i.getMaterialPasses(e);var a=this.getEnabledGPUAnimation(t,r);var s=0;var n=1;var o;var h=r.length;for(var l=0;l<h;l++){o=r[l];if(o.usesAnimation!=a){o.usesAnimation=a;o.key==""}if(o.key=="")this.calcAnimationCode(t,o);s+=this.getProgram(o).id*n;n*=1e3}i.renderOrderId=s}return i};t.prototype.activateBuffer=function(t,e,i,r){if(!e.contexts[this._stageIndex])e.contexts[this._stageIndex]=this;if(!e.buffers[this._stageIndex]){e.buffers[this._stageIndex]=this.createVertexBuffer(e.data.length/e.dataPerVertex,e.dataPerVertex);e.invalid[this._stageIndex]=true}if(e.invalid[this._stageIndex]){e.buffers[this._stageIndex].uploadFromArray(e.data,0,e.data.length/e.dataPerVertex);e.invalid[this._stageIndex]=false}this.setVertexBufferAt(t,e.buffers[this._stageIndex],i,r)};t.prototype.disposeVertexData=function(t){t.buffers[this._stageIndex].dispose();t.buffers[this._stageIndex]=null};t.prototype.activateRenderTexture=function(t,e){this.setTextureAt(t,this.getRenderTexture(e))};t.prototype.activateMaterialPass=function(t,e,i){var r=t.shaderObject;for(var a=r.numUsedStreams;a<this._numUsedStreams;a++)this.setVertexBufferAt(a,null);for(var a=r.numUsedTextures;a<this._numUsedTextures;a++)this.setTextureAt(a,null);if(t.usesAnimation)t.material.animationSet.activate(r,e);r.iActivate(e,i);var n=this.getProgram(t);if(!n.program){n.program=this.createProgram();var o=(new s).assemble("part vertex 1\n"+t.animationVertexCode+t.vertexCode+"endpart")["vertex"].data;var h=(new s).assemble("part fragment 1\n"+t.fragmentCode+t.animationFragmentCode+t.postAnimationFragmentCode+"endpart")["fragment"].data;n.program.upload(o,h)}this.setProgram(n.program)};t.prototype.deactivateMaterialPass=function(t,e){var i=t.shaderObject;if(t.usesAnimation)t.material.animationSet.deactivate(i,e);t.shaderObject.iDeactivate(e);this._numUsedStreams=i.numUsedStreams;this._numUsedTextures=i.numUsedTextures};t.prototype.activateTexture=function(t,e){var i=this._texturePool.getItem(e);if(!i.texture){i.texture=this.createTexture(e.width,e.height,u.BGRA,true);i.invalid=true}if(i.invalid){i.invalid=false;if(e.generateMipmaps){var r=e._iGetMipmapData();var a=r.length;for(var s=0;s<a;s++)i.texture.uploadFromData(r[s],s)}else{i.texture.uploadFromData(e._iGetTextureData(),0)}}this.setTextureAt(t,i.texture)};t.prototype.activateCubeTexture=function(t,e){var i=this._texturePool.getItem(e);if(!i.texture){i.texture=this.createCubeTexture(e.size,u.BGRA,false);i.invalid=true}if(i.invalid){i.invalid=false;for(var r=0;r<6;++r){if(e.generateMipmaps){var a=e._iGetMipmapData(r);var s=a.length;for(var n=0;n<s;n++)i.texture.uploadFromData(a[n],r,n)}else{i.texture.uploadFromData(e._iGetTextureData(r),r,0)}}}this.setTextureAt(t,i.texture)};t.prototype.getIndexBuffer=function(t){if(!t.contexts[this._stageIndex])t.contexts[this._stageIndex]=this;if(!t.buffers[this._stageIndex]){t.buffers[this._stageIndex]=this.createIndexBuffer(t.data.length);t.invalid[this._stageIndex]=true}if(t.invalid[this._stageIndex]){t.buffers[this._stageIndex].uploadFromArray(t.data,0,t.data.length);t.invalid[this._stageIndex]=false}return t.buffers[this._stageIndex]};t.prototype.disposeIndexData=function(t){t.buffers[this._stageIndex].dispose();t.buffers[this._stageIndex]=null};t.prototype.clear=function(t,e,i,r,a,s,n){if(t===void 0){t=0}if(e===void 0){e=0}if(i===void 0){i=0}if(r===void 0){r=1}if(a===void 0){a=1}if(s===void 0){s=0}if(n===void 0){n=l.ALL}};t.prototype.configureBackBuffer=function(t,e,i,r){if(r===void 0){r=true}this._width=t;this._height=e};t.prototype.createIndexBuffer=function(t){throw new r};t.prototype.createVertexBuffer=function(t,e){throw new r};t.prototype.createTexture=function(t,e,i,a,s){if(s===void 0){s=0}throw new r};t.prototype.createCubeTexture=function(t,e,i,a){if(a===void 0){a=0}throw new r};t.prototype.createProgram=function(){throw new r};t.prototype.dispose=function(){};t.prototype.present=function(){};t.prototype.setRenderToTexture=function(t,e,i,r){if(e===void 0){e=false}if(i===void 0){i=0}if(r===void 0){r=0}};t.prototype.setRenderToBackBuffer=function(){};t.prototype.setScissorRectangle=function(t){};t.prototype.setTextureAt=function(t,e){};t.prototype.setVertexBufferAt=function(t,e,i,r){if(i===void 0){i=0}if(r===void 0){r=null}};t.prototype.setProgram=function(t){};t.prototype.registerProgram=function(t){var e=0;while(this._programData[e]!=null)e++;this._programData[e]=t;t.id=e};t.prototype.unRegisterProgram=function(t){this._programData[t.id]=null;t.id=-1};t.prototype.getEnabledGPUAnimation=function(t,e){if(t.animationSet){t.animationSet.resetGPUCompatibility();var i=t.iOwners;var r=i.length;var a=e.length;for(var s=0;s<a;s++)for(var n=0;n<r;n++)if(i[n].animator)i[n].animator.testGPUCompatibility(e[s].shaderObject);return!t.animationSet.usesCPU}return false};t.prototype.calcAnimationCode=function(t,e){e.key="";e.animationVertexCode="";e.animationFragmentCode="";var i=e.shaderObject;if(e.usesAnimation){var r=t.animationSet;e.animationVertexCode+=r.getAGALVertexCode(i);if(i.uvDependencies>0&&!i.usesUVTransform)e.animationVertexCode+=r.getAGALUVCode(i);if(i.usesFragmentAnimation)e.animationFragmentCode+=r.getAGALFragmentCode(i,e.shadedTarget);r.doneAGALCode(i)}else{var a=i.animatableAttributes.length;for(var s=0;s<a;++s)e.animationVertexCode+="mov "+i.animationTargetRegisters[s]+", "+i.animatableAttributes[s]+"\n";if(i.uvDependencies>0&&!i.usesUVTransform)e.animationVertexCode+="mov "+i.uvTarget+","+i.uvSource+"\n"}};return t}();e.exports=p},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/textures/RenderTexture":undefined,"awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler":undefined,"awayjs-stagegl/lib/base/ContextGLClearMask":undefined,"awayjs-stagegl/lib/base/ContextGLTextureFormat":undefined,"awayjs-stagegl/lib/pool/MaterialDataPool":undefined,"awayjs-stagegl/lib/pool/ProgramDataPool":undefined,"awayjs-stagegl/lib/pool/TextureDataPool":undefined}],"awayjs-stagegl/lib/base/ContextGLBlendFactor":[function(t,e,i){var r=function(){function t(){}t.DESTINATION_ALPHA="destinationAlpha";t.DESTINATION_COLOR="destinationColor";t.ONE="one";t.ONE_MINUS_DESTINATION_ALPHA="oneMinusDestinationAlpha";t.ONE_MINUS_DESTINATION_COLOR="oneMinusDestinationColor";t.ONE_MINUS_SOURCE_ALPHA="oneMinusSourceAlpha";t.ONE_MINUS_SOURCE_COLOR="oneMinusSourceColor";t.SOURCE_ALPHA="sourceAlpha";t.SOURCE_COLOR="sourceColor";t.ZERO="zero";return t}();e.exports=r},{}],"awayjs-stagegl/lib/base/ContextGLClearMask":[function(t,e,i){var r=function(){function t(){}t.COLOR=1;t.DEPTH=2;t.STENCIL=4;t.ALL=t.COLOR|t.DEPTH|t.STENCIL;return t}();e.exports=r},{}],"awayjs-stagegl/lib/base/ContextGLCompareMode":[function(t,e,i){var r=function(){function t(){}t.ALWAYS="always";t.EQUAL="equal";t.GREATER="greater";t.GREATER_EQUAL="greaterEqual";t.LESS="less";t.LESS_EQUAL="lessEqual";t.NEVER="never";t.NOT_EQUAL="notEqual";return t}();e.exports=r},{}],"awayjs-stagegl/lib/base/ContextGLMipFilter":[function(t,e,i){var r=function(){function t(){}t.MIPLINEAR="miplinear";t.MIPNEAREST="mipnearest";t.MIPNONE="mipnone";return t}();e.exports=r},{}],"awayjs-stagegl/lib/base/ContextGLProfile":[function(t,e,i){var r=function(){function t(){}t.BASELINE="baseline";t.BASELINE_CONSTRAINED="baselineConstrained";t.BASELINE_EXTENDED="baselineExtended";return t}();e.exports=r},{}],"awayjs-stagegl/lib/base/ContextGLProgramType":[function(t,e,i){var r=function(){function t(){}t.FRAGMENT="fragment";t.VERTEX="vertex";return t}();e.exports=r},{}],"awayjs-stagegl/lib/base/ContextGLStencilAction":[function(t,e,i){var r=function(){function t(){}t.DECREMENT_SATURATE="decrementSaturate";t.DECREMENT_WRAP="decrementWrap";t.INCREMENT_SATURATE="incrementSaturate";t.INCREMENT_WRAP="incrementWrap";t.INVERT="invert";t.KEEP="keep";t.SET="set";t.ZERO="zero";return t}();e.exports=r},{}],"awayjs-stagegl/lib/base/ContextGLTextureFilter":[function(t,e,i){var r=function(){function t(){}t.LINEAR="linear";t.NEAREST="nearest";return t}();e.exports=r},{}],"awayjs-stagegl/lib/base/ContextGLTextureFormat":[function(t,e,i){var r=function(){function t(){}t.BGRA="bgra";t.BGRA_PACKED="bgraPacked4444";t.BGR_PACKED="bgrPacked565";t.COMPRESSED="compressed";t.COMPRESSED_ALPHA="compressedAlpha";return t}();e.exports=r},{}],"awayjs-stagegl/lib/base/ContextGLTriangleFace":[function(t,e,i){var r=function(){function t(){}t.BACK="back";t.FRONT="front";t.FRONT_AND_BACK="frontAndBack";t.NONE="none";return t}();e.exports=r},{}],"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":[function(t,e,i){var r=function(){function t(){}t.BYTES_4="bytes4";t.FLOAT_1="float1";t.FLOAT_2="float2";t.FLOAT_3="float3";t.FLOAT_4="float4";return t}();e.exports=r},{}],"awayjs-stagegl/lib/base/ContextGLWrapMode":[function(t,e,i){var r=function(){function t(){}t.CLAMP="clamp";t.REPEAT="repeat";return t}();e.exports=r},{}],"awayjs-stagegl/lib/base/ContextStage3D":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/swfobject");var s=t("awayjs-stagegl/lib/aglsl/Sampler");var n=t("awayjs-stagegl/lib/base/ContextGLBase");var o=t("awayjs-stagegl/lib/base/ContextGLClearMask");var h=t("awayjs-stagegl/lib/base/ContextGLProgramType");var l=t("awayjs-stagegl/lib/base/CubeTextureFlash");var u=t("awayjs-stagegl/lib/base/IndexBufferFlash");var p=t("awayjs-stagegl/lib/base/OpCodes");var c=t("awayjs-stagegl/lib/base/ProgramFlash");var d=t("awayjs-stagegl/lib/base/TextureFlash");var f=t("awayjs-stagegl/lib/base/VertexBufferFlash");var _=function(t){r(e,t);function e(i,r,s,n){t.call(this,r);this._cmdStream="";this._resources=new Array;var o="11.0.0";var h={id:i.id};var l={quality:"high",bgcolor:"#ffffff",allowscriptaccess:"sameDomain",allowfullscreen:"true",wmode:"direct"};this._errorCheckingEnabled=false;this._iDriverInfo="Unknown";var u={salign:"tl",id:i.id,name:i["name"]};this._oldCanvas=i.cloneNode();this._oldParent=i.parentNode;var p=this;e.contexts[i.id]=this;function c(t){if(!t.success)return;p._pContainer=t.ref;p._iCallback=s}a.embedSWF("libs/molehill_js_flashbridge.swf",i.id,String(i.width),String(i.height),o,"",h,l,u,c)}Object.defineProperty(e.prototype,"container",{get:function(){return this._pContainer},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"driverInfo",{get:function(){return this._iDriverInfo},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"errorCheckingEnabled",{get:function(){return this._errorCheckingEnabled},set:function(t){if(this._errorCheckingEnabled==t)return;this._errorCheckingEnabled=t;this.addStream(String.fromCharCode(p.enableErrorChecking,t?p.trueValue:p.falseValue));this.execute()},enumerable:true,configurable:true});e.prototype._iAddResource=function(t){this._resources.push(t)};e.prototype._iRemoveResource=function(t){this._resources.splice(this._resources.indexOf(t))};e.prototype.createTexture=function(t,e,i,r,a){if(a===void 0){a=0}return new d(this,t,e,i,r)};e.prototype.createCubeTexture=function(t,e,i,r){if(r===void 0){r=0}return new l(this,t,e,i)};e.prototype.setTextureAt=function(t,i){if(i){this.addStream(String.fromCharCode(p.setTextureAt)+t+","+i.id+",")}else{this.addStream(String.fromCharCode(p.clearTextureAt)+t.toString()+",")}if(e.debug)this.execute()};e.prototype.setSamplerStateAt=function(t,e,i,r){};e.prototype.setStencilActions=function(t,i,r,a,s){if(t===void 0){t="frontAndBack"}if(i===void 0){i="always"}if(r===void 0){r="keep"}if(a===void 0){a="keep"}if(s===void 0){s="keep"}this.addStream(String.fromCharCode(p.setStencilActions)+t+"$"+i+"$"+r+"$"+a+"$"+s+"$");if(e.debug)this.execute()};e.prototype.setStencilReferenceValue=function(t,i,r){if(i===void 0){i=255}if(r===void 0){r=255}this.addStream(String.fromCharCode(p.setStencilReferenceValue,t+p.intMask,i+p.intMask,r+p.intMask));if(e.debug)this.execute()};e.prototype.setCulling=function(t,i){if(i===void 0){i="leftHanded"}this.addStream(String.fromCharCode(p.setCulling)+t+"$");if(e.debug)this.execute()};e.prototype.drawTriangles=function(t,i,r){if(i===void 0){i=0}if(r===void 0){r=-1}i=i||0;if(!r||r<0)r=t.numIndices/3;this.addStream(String.fromCharCode(p.drawTriangles,t.id+p.intMask)+i+","+r+",");if(e.debug)this.execute()};e.prototype.setProgramConstantsFromMatrix=function(t,e,i,r){if(r===void 0){r=false}var a=i.rawData;if(r){this.setProgramConstantsFromArray(t,e,[a[0],a[4],a[8],a[12]],1);this.setProgramConstantsFromArray(t,e+1,[a[1],a[5],a[9],a[13]],1);this.setProgramConstantsFromArray(t,e+2,[a[2],a[6],a[10],a[14]],1);this.setProgramConstantsFromArray(t,e+3,[a[3],a[7],a[11],a[15]],1)}else{this.setProgramConstantsFromArray(t,e,[a[0],a[1],a[2],a[3]],1);this.setProgramConstantsFromArray(t,e+1,[a[4],a[5],a[6],a[7]],1);this.setProgramConstantsFromArray(t,e+2,[a[8],a[9],a[10],a[11]],1);this.setProgramConstantsFromArray(t,e+3,[a[12],a[13],a[14],a[15]],1)}};e.prototype.setProgramConstantsFromArray=function(t,i,r,a){if(a===void 0){a=-1}var s;var n=t==h.VERTEX?p.trueValue:p.falseValue;for(var o=0;o<a;o++){s=o*4;this.addStream(String.fromCharCode(p.setProgramConstant,n,i+o+p.intMask)+r[s]+","+r[s+1]+","+r[s+2]+","+r[s+3]+",");if(e.debug)this.execute()}};e.prototype.setProgram=function(t){this.addStream(String.fromCharCode(p.setProgram,t.id+p.intMask));if(e.debug)this.execute()};e.prototype.present=function(){this.addStream(String.fromCharCode(p.present));this.execute()};e.prototype.clear=function(t,i,r,a,s,n,h){if(t===void 0){t=0}if(i===void 0){i=0}if(r===void 0){r=0}if(a===void 0){a=1}if(s===void 0){s=1}if(n===void 0){n=0}if(h===void 0){h=o.ALL}this.addStream(String.fromCharCode(p.clear)+t+","+i+","+r+","+a+","+s+","+n+","+h+",");if(e.debug)this.execute()};e.prototype.createProgram=function(){return new c(this)};e.prototype.createVertexBuffer=function(t,e){return new f(this,t,e)};e.prototype.createIndexBuffer=function(t){return new u(this,t)};e.prototype.configureBackBuffer=function(e,i,r,a){if(a===void 0){a=true}t.prototype.configureBackBuffer.call(this,e,i,r,a);this.addStream(String.fromCharCode(p.configureBackBuffer)+e+","+i+",")};e.prototype.drawToBitmapData=function(t){};e.prototype.setVertexBufferAt=function(t,i,r,a){if(r===void 0){r=0}if(a===void 0){a=null}if(i){this.addStream(String.fromCharCode(p.setVertexBufferAt,t+p.intMask)+i.id+","+r+","+a+"$")}else{this.addStream(String.fromCharCode(p.clearVertexBufferAt,t+p.intMask))}if(e.debug)this.execute()};e.prototype.setColorMask=function(t,i,r,a){this.addStream(String.fromCharCode(p.setColorMask,t?p.trueValue:p.falseValue,i?p.trueValue:p.falseValue,r?p.trueValue:p.falseValue,a?p.trueValue:p.falseValue));if(e.debug)this.execute()};e.prototype.setBlendFactors=function(t,i){this.addStream(String.fromCharCode(p.setBlendFactors)+t+"$"+i+"$");if(e.debug)this.execute()};e.prototype.setRenderToTexture=function(t,i,r,a){if(i===void 0){i=false}if(r===void 0){r=0}if(a===void 0){a=0}if(t===null||t===undefined){this.addStream(String.fromCharCode(p.clearRenderToTexture))}else{this.addStream(String.fromCharCode(p.setRenderToTexture,i?p.trueValue:p.falseValue)+t.id+","+(r||0)+",")}if(e.debug)this.execute()};e.prototype.setRenderToBackBuffer=function(){this.addStream(String.fromCharCode(p.clearRenderToTexture));if(e.debug)this.execute()};e.prototype.setScissorRectangle=function(t){if(t){this.addStream(String.fromCharCode(p.setScissorRect)+t.x+","+t.y+","+t.width+","+t.height+",")}else{this.addStream(String.fromCharCode(p.clearScissorRect))}if(e.debug)this.execute()};e.prototype.setDepthTest=function(t,i){this.addStream(String.fromCharCode(p.setDepthTest,t?p.trueValue:p.falseValue)+i+"$");if(e.debug)this.execute()};e.prototype.dispose=function(){if(this._pContainer==null)return;console.log("Context3D dispose, releasing "+this._resources.length+" resources.");while(this._resources.length)this._resources[0].dispose();if(this._pContainer){this.addStream(String.fromCharCode(p.disposeContext));this.execute();a.removeSWF(this._oldCanvas.id);if(this._oldCanvas&&this._oldParent){this._oldParent.appendChild(this._oldCanvas);this._oldParent=null}this._pContainer=null}this._oldCanvas=null};e.prototype.addStream=function(t){this._cmdStream+=t};e.prototype.execute=function(){if(e.logStream)console.log(this._cmdStream);var t=this._pContainer["CallFunction"]('<invoke name="execStage3dOpStream" returntype="javascript"><arguments><string>'+this._cmdStream+"</string></arguments></invoke>");if(Number(t)<=-3)throw"Exec stream failed";this._cmdStream="";return Number(t)};e.contexts=new Object;e.maxvertexconstants=128;e.maxfragconstants=28;e.maxtemp=8;e.maxstreams=8;e.maxtextures=8;e.defaultsampler=new s;e.debug=false;e.logStream=false;return e}(n);function y(t,e){var i=_.contexts[t];if(i._iCallback){i._iDriverInfo=e;var r=window.setTimeout(function(){window.clearTimeout(r);try{i._iCallback(i)}catch(t){console.log("Callback failed during flash initialization with '"+t.toString()+"'")}},1)}}e.exports=_},{"awayjs-stagegl/lib/aglsl/Sampler":undefined,"awayjs-stagegl/lib/base/ContextGLBase":undefined,"awayjs-stagegl/lib/base/ContextGLClearMask":undefined,"awayjs-stagegl/lib/base/ContextGLProgramType":undefined,"awayjs-stagegl/lib/base/CubeTextureFlash":undefined,"awayjs-stagegl/lib/base/IndexBufferFlash":undefined,"awayjs-stagegl/lib/base/OpCodes":undefined,"awayjs-stagegl/lib/base/ProgramFlash":undefined,"awayjs-stagegl/lib/base/TextureFlash":undefined,"awayjs-stagegl/lib/base/VertexBufferFlash":undefined,"awayjs-stagegl/lib/swfobject":undefined}],"awayjs-stagegl/lib/base/ContextWebGL":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Rectangle");var s=t("awayjs-core/lib/utils/ByteArray");var n=t("awayjs-stagegl/lib/base/ContextGLBase");var o=t("awayjs-stagegl/lib/base/ContextGLBlendFactor");var h=t("awayjs-stagegl/lib/base/ContextGLClearMask");
var l=t("awayjs-stagegl/lib/base/ContextGLCompareMode");var u=t("awayjs-stagegl/lib/base/ContextGLMipFilter");var p=t("awayjs-stagegl/lib/base/ContextGLProgramType");var c=t("awayjs-stagegl/lib/base/ContextGLTextureFilter");var d=t("awayjs-stagegl/lib/base/ContextGLTriangleFace");var f=t("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var _=t("awayjs-stagegl/lib/base/ContextGLWrapMode");var y=t("awayjs-stagegl/lib/base/CubeTextureWebGL");var g=t("awayjs-stagegl/lib/base/IndexBufferWebGL");var m=t("awayjs-stagegl/lib/base/ProgramWebGL");var b=t("awayjs-stagegl/lib/base/TextureWebGL");var v=t("awayjs-stagegl/lib/base/SamplerState");var w=t("awayjs-stagegl/lib/base/VertexBufferWebGL");var x=function(t){r(e,t);function e(i,r){t.call(this,r);this._blendFactorDictionary=new Object;this._depthTestDictionary=new Object;this._textureIndexDictionary=new Array(8);this._textureTypeDictionary=new Object;this._wrapDictionary=new Object;this._filterDictionary=new Object;this._mipmapFilterDictionary=new Object;this._uniformLocationNameDictionary=new Object;this._vertexBufferDimensionDictionary=new Object;this._indexBufferList=new Array;this._vertexBufferList=new Array;this._textureList=new Array;this._programList=new Array;this._samplerStates=new Array(8);this._pContainer=i;try{this._gl=i.getContext("experimental-webgl",{premultipliedAlpha:false,alpha:false});if(!this._gl)this._gl=i.getContext("webgl",{premultipliedAlpha:false,alpha:false})}catch(a){}if(this._gl){this._blendFactorDictionary[o.ONE]=this._gl.ONE;this._blendFactorDictionary[o.DESTINATION_ALPHA]=this._gl.DST_ALPHA;this._blendFactorDictionary[o.DESTINATION_COLOR]=this._gl.DST_COLOR;this._blendFactorDictionary[o.ONE]=this._gl.ONE;this._blendFactorDictionary[o.ONE_MINUS_DESTINATION_ALPHA]=this._gl.ONE_MINUS_DST_ALPHA;this._blendFactorDictionary[o.ONE_MINUS_DESTINATION_COLOR]=this._gl.ONE_MINUS_DST_COLOR;this._blendFactorDictionary[o.ONE_MINUS_SOURCE_ALPHA]=this._gl.ONE_MINUS_SRC_ALPHA;this._blendFactorDictionary[o.ONE_MINUS_SOURCE_COLOR]=this._gl.ONE_MINUS_SRC_COLOR;this._blendFactorDictionary[o.SOURCE_ALPHA]=this._gl.SRC_ALPHA;this._blendFactorDictionary[o.SOURCE_COLOR]=this._gl.SRC_COLOR;this._blendFactorDictionary[o.ZERO]=this._gl.ZERO;this._depthTestDictionary[l.ALWAYS]=this._gl.ALWAYS;this._depthTestDictionary[l.EQUAL]=this._gl.EQUAL;this._depthTestDictionary[l.GREATER]=this._gl.GREATER;this._depthTestDictionary[l.GREATER_EQUAL]=this._gl.GEQUAL;this._depthTestDictionary[l.LESS]=this._gl.LESS;this._depthTestDictionary[l.LESS_EQUAL]=this._gl.LEQUAL;this._depthTestDictionary[l.NEVER]=this._gl.NEVER;this._depthTestDictionary[l.NOT_EQUAL]=this._gl.NOTEQUAL;this._textureIndexDictionary[0]=this._gl.TEXTURE0;this._textureIndexDictionary[1]=this._gl.TEXTURE1;this._textureIndexDictionary[2]=this._gl.TEXTURE2;this._textureIndexDictionary[3]=this._gl.TEXTURE3;this._textureIndexDictionary[4]=this._gl.TEXTURE4;this._textureIndexDictionary[5]=this._gl.TEXTURE5;this._textureIndexDictionary[6]=this._gl.TEXTURE6;this._textureIndexDictionary[7]=this._gl.TEXTURE7;this._textureTypeDictionary["texture2d"]=this._gl.TEXTURE_2D;this._textureTypeDictionary["textureCube"]=this._gl.TEXTURE_CUBE_MAP;this._wrapDictionary[_.REPEAT]=this._gl.REPEAT;this._wrapDictionary[_.CLAMP]=this._gl.CLAMP_TO_EDGE;this._filterDictionary[c.LINEAR]=this._gl.LINEAR;this._filterDictionary[c.NEAREST]=this._gl.NEAREST;this._mipmapFilterDictionary[c.LINEAR]=new Object;this._mipmapFilterDictionary[c.LINEAR][u.MIPNEAREST]=this._gl.LINEAR_MIPMAP_NEAREST;this._mipmapFilterDictionary[c.LINEAR][u.MIPLINEAR]=this._gl.LINEAR_MIPMAP_LINEAR;this._mipmapFilterDictionary[c.LINEAR][u.MIPNONE]=this._gl.LINEAR;this._mipmapFilterDictionary[c.NEAREST]=new Object;this._mipmapFilterDictionary[c.NEAREST][u.MIPNEAREST]=this._gl.NEAREST_MIPMAP_NEAREST;this._mipmapFilterDictionary[c.NEAREST][u.MIPLINEAR]=this._gl.NEAREST_MIPMAP_LINEAR;this._mipmapFilterDictionary[c.NEAREST][u.MIPNONE]=this._gl.NEAREST;this._uniformLocationNameDictionary[p.VERTEX]="vc";this._uniformLocationNameDictionary[p.FRAGMENT]="fc";this._vertexBufferDimensionDictionary[f.FLOAT_1]=1;this._vertexBufferDimensionDictionary[f.FLOAT_2]=2;this._vertexBufferDimensionDictionary[f.FLOAT_3]=3;this._vertexBufferDimensionDictionary[f.FLOAT_4]=4;this._vertexBufferDimensionDictionary[f.BYTES_4]=4}else{alert("WebGL is not available.")}for(var s=0;s<e.MAX_SAMPLERS;++s){this._samplerStates[s]=new v;this._samplerStates[s].wrap=this._gl.REPEAT;this._samplerStates[s].filter=this._gl.LINEAR;this._samplerStates[s].mipfilter=this._gl.LINEAR}}Object.defineProperty(e.prototype,"container",{get:function(){return this._pContainer},enumerable:true,configurable:true});e.prototype.gl=function(){return this._gl};e.prototype.clear=function(t,e,i,r,a,s,n){if(t===void 0){t=0}if(e===void 0){e=0}if(i===void 0){i=0}if(r===void 0){r=1}if(a===void 0){a=1}if(s===void 0){s=0}if(n===void 0){n=h.ALL}if(!this._drawing){this.updateBlendStatus();this._drawing=true}var o=0;if(n&h.COLOR)o|=this._gl.COLOR_BUFFER_BIT;if(n&h.STENCIL)o|=this._gl.STENCIL_BUFFER_BIT;if(n&h.DEPTH)o|=this._gl.DEPTH_BUFFER_BIT;this._gl.clearColor(t,e,i,r);this._gl.clearDepth(a);this._gl.clearStencil(s);this._gl.clear(o)};e.prototype.configureBackBuffer=function(e,i,r,a){if(a===void 0){a=true}t.prototype.configureBackBuffer.call(this,e,i,r,a);if(a){this._gl.enable(this._gl.STENCIL_TEST);this._gl.enable(this._gl.DEPTH_TEST)}this._gl.viewport["width"]=e;this._gl.viewport["height"]=i;this._gl.viewport(0,0,e,i)};e.prototype.createCubeTexture=function(t,e,i,r){if(r===void 0){r=0}var a=new y(this._gl,t);this._textureList.push(a);return a};e.prototype.createIndexBuffer=function(t){var e=new g(this._gl,t);this._indexBufferList.push(e);return e};e.prototype.createProgram=function(){var t=new m(this._gl);this._programList.push(t);return t};e.prototype.createTexture=function(t,e,i,r,a){if(a===void 0){a=0}var s=new b(this._gl,t,e);this._textureList.push(s);return s};e.prototype.createVertexBuffer=function(t,e){var i=new w(this._gl,t,e);this._vertexBufferList.push(i);return i};e.prototype.dispose=function(){var t;for(t=0;t<this._indexBufferList.length;++t)this._indexBufferList[t].dispose();this._indexBufferList=null;for(t=0;t<this._vertexBufferList.length;++t)this._vertexBufferList[t].dispose();this._vertexBufferList=null;for(t=0;t<this._textureList.length;++t)this._textureList[t].dispose();this._textureList=null;for(t=0;t<this._programList.length;++t)this._programList[t].dispose();for(t=0;t<this._samplerStates.length;++t)this._samplerStates[t]=null;this._programList=null};e.prototype.drawToBitmapData=function(t){var e=new ArrayBuffer(t.width*t.height*4);this._gl.readPixels(0,0,t.width,t.height,this._gl.RGBA,this._gl.UNSIGNED_BYTE,new Uint8Array(e));var i=new s;i.setArrayBuffer(e);t.setPixels(new a(0,0,t.width,t.height),i)};e.prototype.drawTriangles=function(t,e,i){if(e===void 0){e=0}if(i===void 0){i=-1}if(!this._drawing)throw"Need to clear before drawing if the buffer has not been cleared since the last present() call.";this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,t.glBuffer);this._gl.drawElements(this._gl.TRIANGLES,i==-1?t.numIndices:i*3,this._gl.UNSIGNED_SHORT,e)};e.prototype.present=function(){this._drawing=false};e.prototype.setBlendFactors=function(t,e){this._blendEnabled=true;this._blendSourceFactor=this._blendFactorDictionary[t];this._blendDestinationFactor=this._blendFactorDictionary[e];this.updateBlendStatus()};e.prototype.setColorMask=function(t,e,i,r){this._gl.colorMask(t,e,i,r)};e.prototype.setCulling=function(t,e){if(e===void 0){e="leftHanded"}if(t==d.NONE){this._gl.disable(this._gl.CULL_FACE)}else{this._gl.enable(this._gl.CULL_FACE);switch(t){case d.BACK:this._gl.cullFace(e=="leftHanded"?this._gl.FRONT:this._gl.BACK);break;case d.FRONT:this._gl.cullFace(e=="leftHanded"?this._gl.BACK:this._gl.FRONT);break;case d.FRONT_AND_BACK:this._gl.cullFace(this._gl.FRONT_AND_BACK);break;default:throw"Unknown ContextGLTriangleFace type."}}};e.prototype.setDepthTest=function(t,e){this._gl.depthFunc(this._depthTestDictionary[e]);this._gl.depthMask(t)};e.prototype.setProgram=function(t){this._currentProgram=t;t.focusProgram()};e.prototype.setProgramConstantsFromMatrix=function(t,e,i,r){if(r===void 0){r=false}var a=i.rawData;if(r){this.setProgramConstantsFromArray(t,e,[a[0],a[4],a[8],a[12]],1);this.setProgramConstantsFromArray(t,e+1,[a[1],a[5],a[9],a[13]],1);this.setProgramConstantsFromArray(t,e+2,[a[2],a[6],a[10],a[14]],1);this.setProgramConstantsFromArray(t,e+3,[a[3],a[7],a[11],a[15]],1)}else{this.setProgramConstantsFromArray(t,e,[a[0],a[1],a[2],a[3]],1);this.setProgramConstantsFromArray(t,e+1,[a[4],a[5],a[6],a[7]],1);this.setProgramConstantsFromArray(t,e+2,[a[8],a[9],a[10],a[11]],1);this.setProgramConstantsFromArray(t,e+3,[a[12],a[13],a[14],a[15]],1)}};e.prototype.setProgramConstantsFromArray=function(t,e,i,r){if(r===void 0){r=-1}var a=this._uniformLocationNameDictionary[t];var s;for(var n=0;n<r;n++){s=n*4;this._gl.uniform4f(this._gl.getUniformLocation(this._currentProgram.glProgram,a+(e+n)),i[s],i[s+1],i[s+2],i[s+3])}};e.prototype.setScissorRectangle=function(t){if(!t){this._gl.disable(this._gl.SCISSOR_TEST);return}this._gl.enable(this._gl.SCISSOR_TEST);this._gl.scissor(t.x,t.y,t.width,t.height)};e.prototype.setTextureAt=function(t,e){var i=this._samplerStates[t];if(this._activeTexture!=t&&(e||i.type)){this._activeTexture=t;this._gl.activeTexture(this._textureIndexDictionary[t])}if(!e){if(i.type){this._gl.bindTexture(i.type,null);i.type=null}return}var r=this._textureTypeDictionary[e.textureType];i.type=r;this._gl.bindTexture(r,e.glTexture);this._gl.uniform1i(this._gl.getUniformLocation(this._currentProgram.glProgram,"fs"+t),t);this._gl.texParameteri(r,this._gl.TEXTURE_WRAP_S,i.wrap);this._gl.texParameteri(r,this._gl.TEXTURE_WRAP_T,i.wrap);this._gl.texParameteri(r,this._gl.TEXTURE_MAG_FILTER,i.filter);this._gl.texParameteri(r,this._gl.TEXTURE_MIN_FILTER,i.mipfilter)};e.prototype.setSamplerStateAt=function(t,i,r,a){if(0<=t&&t<e.MAX_SAMPLERS){this._samplerStates[t].wrap=this._wrapDictionary[i];this._samplerStates[t].filter=this._filterDictionary[r];this._samplerStates[t].mipfilter=this._mipmapFilterDictionary[r][a]}else{throw"Sampler is out of bounds."}};e.prototype.setVertexBufferAt=function(t,e,i,r){if(i===void 0){i=0}if(r===void 0){r=null}var a=this._currentProgram?this._gl.getAttribLocation(this._currentProgram.glProgram,"va"+t):-1;if(!e){if(a>-1)this._gl.disableVertexAttribArray(a);return}this._gl.bindBuffer(this._gl.ARRAY_BUFFER,e.glBuffer);this._gl.enableVertexAttribArray(a);this._gl.vertexAttribPointer(a,this._vertexBufferDimensionDictionary[r],this._gl.FLOAT,false,e.data32PerVertex*4,i*4)};e.prototype.setRenderToTexture=function(t,e,i,r){if(e===void 0){e=false}if(i===void 0){i=0}if(r===void 0){r=0}var a=t;var s=a.frameBuffer;this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,s);if(e){this._gl.enable(this._gl.STENCIL_TEST);this._gl.enable(this._gl.DEPTH_TEST)}this._gl.viewport(0,0,a.width,a.height)};e.prototype.setRenderToBackBuffer=function(){this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null)};e.prototype.updateBlendStatus=function(){if(this._blendEnabled){this._gl.enable(this._gl.BLEND);this._gl.blendEquation(this._gl.FUNC_ADD);this._gl.blendFunc(this._blendSourceFactor,this._blendDestinationFactor)}else{this._gl.disable(this._gl.BLEND)}};e.MAX_SAMPLERS=8;e.modulo=0;return e}(n);e.exports=x},{"awayjs-core/lib/geom/Rectangle":undefined,"awayjs-core/lib/utils/ByteArray":undefined,"awayjs-stagegl/lib/base/ContextGLBase":undefined,"awayjs-stagegl/lib/base/ContextGLBlendFactor":undefined,"awayjs-stagegl/lib/base/ContextGLClearMask":undefined,"awayjs-stagegl/lib/base/ContextGLCompareMode":undefined,"awayjs-stagegl/lib/base/ContextGLMipFilter":undefined,"awayjs-stagegl/lib/base/ContextGLProgramType":undefined,"awayjs-stagegl/lib/base/ContextGLTextureFilter":undefined,"awayjs-stagegl/lib/base/ContextGLTriangleFace":undefined,"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined,"awayjs-stagegl/lib/base/ContextGLWrapMode":undefined,"awayjs-stagegl/lib/base/CubeTextureWebGL":undefined,"awayjs-stagegl/lib/base/IndexBufferWebGL":undefined,"awayjs-stagegl/lib/base/ProgramWebGL":undefined,"awayjs-stagegl/lib/base/SamplerState":undefined,"awayjs-stagegl/lib/base/TextureWebGL":undefined,"awayjs-stagegl/lib/base/VertexBufferWebGL":undefined}],"awayjs-stagegl/lib/base/CubeTextureFlash":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/base/BitmapData");var s=t("awayjs-core/lib/utils/ByteArrayBase");var n=t("awayjs-stagegl/lib/base/OpCodes");var o=t("awayjs-stagegl/lib/base/ResourceBaseFlash");var h=function(t){r(e,t);function e(e,i,r,a,s){if(s===void 0){s=false}t.call(this);this._context=e;this._size=i;this._context.addStream(String.fromCharCode(n.initCubeTexture,a?n.trueValue:n.falseValue)+i+","+s+","+r+"$");this._pId=this._context.execute();this._context._iAddResource(this)}Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:true,configurable:true});e.prototype.dispose=function(){this._context.addStream(String.fromCharCode(n.disposeCubeTexture)+this._pId.toString()+",");this._context.execute();this._context._iRemoveResource(this);this._context=null};e.prototype.uploadFromData=function(t,e,i){if(i===void 0){i=0}if(t instanceof a){t=t.imageData.data}else if(t instanceof HTMLImageElement){var r=document.createElement("canvas");var o=t.width;var h=t.height;r.width=o;r.height=h;var l=r.getContext("2d");l.drawImage(t,0,0);t=l.getImageData(0,0,o,h).data}var u=0;var p=s.internalGetBase64String(t.length,function(){return t[u++]},null);this._context.addStream(String.fromCharCode(n.uploadBytesCubeTexture)+this._pId+","+i+","+e+","+(this.size>>i)+","+p+"%");this._context.execute()};e.prototype.uploadCompressedTextureFromByteArray=function(t,e,i){if(i===void 0){i=false}};return e}(o);e.exports=h},{"awayjs-core/lib/base/BitmapData":undefined,"awayjs-core/lib/utils/ByteArrayBase":undefined,"awayjs-stagegl/lib/base/OpCodes":undefined,"awayjs-stagegl/lib/base/ResourceBaseFlash":undefined}],"awayjs-stagegl/lib/base/CubeTextureWebGL":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/base/BitmapData");var s=t("awayjs-stagegl/lib/base/TextureBaseWebGL");var n=function(t){r(e,t);function e(e,i){t.call(this,e);this._textureSelectorDictionary=new Array(6);this.textureType="textureCube";this._size=i;this._texture=this._gl.createTexture();this._textureSelectorDictionary[0]=e.TEXTURE_CUBE_MAP_POSITIVE_X;this._textureSelectorDictionary[1]=e.TEXTURE_CUBE_MAP_NEGATIVE_X;this._textureSelectorDictionary[2]=e.TEXTURE_CUBE_MAP_POSITIVE_Y;this._textureSelectorDictionary[3]=e.TEXTURE_CUBE_MAP_NEGATIVE_Y;this._textureSelectorDictionary[4]=e.TEXTURE_CUBE_MAP_POSITIVE_Z;this._textureSelectorDictionary[5]=e.TEXTURE_CUBE_MAP_NEGATIVE_Z}e.prototype.dispose=function(){this._gl.deleteTexture(this._texture)};e.prototype.uploadFromData=function(t,e,i){if(i===void 0){i=0}if(t instanceof a)t=t.imageData;this._gl.bindTexture(this._gl.TEXTURE_CUBE_MAP,this._texture);this._gl.texImage2D(this._textureSelectorDictionary[e],i,this._gl.RGBA,this._gl.RGBA,this._gl.UNSIGNED_BYTE,t);this._gl.bindTexture(this._gl.TEXTURE_CUBE_MAP,null)};e.prototype.uploadCompressedTextureFromByteArray=function(t,e,i){if(i===void 0){i=false}};Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"glTexture",{get:function(){return this._texture},enumerable:true,configurable:true});return e}(s);e.exports=n},{"awayjs-core/lib/base/BitmapData":undefined,"awayjs-stagegl/lib/base/TextureBaseWebGL":undefined}],"awayjs-stagegl/lib/base/IContextStageGL":[function(t,e,i){},{}],"awayjs-stagegl/lib/base/ICubeTexture":[function(t,e,i){},{}],"awayjs-stagegl/lib/base/IIndexBuffer":[function(t,e,i){},{}],"awayjs-stagegl/lib/base/IProgram":[function(t,e,i){},{}],"awayjs-stagegl/lib/base/ITextureBase":[function(t,e,i){},{}],"awayjs-stagegl/lib/base/ITexture":[function(t,e,i){},{}],"awayjs-stagegl/lib/base/IVertexBuffer":[function(t,e,i){},{}],"awayjs-stagegl/lib/base/IndexBufferFlash":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/base/OpCodes");var s=t("awayjs-stagegl/lib/base/ResourceBaseFlash");var n=function(t){r(e,t);function e(e,i){t.call(this);this._context=e;this._numIndices=i;this._context.addStream(String.fromCharCode(a.initIndexBuffer,i+a.intMask));this._pId=this._context.execute();this._context._iAddResource(this)}e.prototype.uploadFromArray=function(t,e,i){this._context.addStream(String.fromCharCode(a.uploadArrayIndexBuffer,this._pId+a.intMask)+t.join()+"#"+e+","+i+",");this._context.execute()};e.prototype.dispose=function(){this._context.addStream(String.fromCharCode(a.disposeIndexBuffer,this._pId+a.intMask));this._context.execute();this._context._iRemoveResource(this);this._context=null};Object.defineProperty(e.prototype,"numIndices",{get:function(){return this._numIndices},enumerable:true,configurable:true});return e}(s);e.exports=n},{"awayjs-stagegl/lib/base/OpCodes":undefined,"awayjs-stagegl/lib/base/ResourceBaseFlash":undefined}],"awayjs-stagegl/lib/base/IndexBufferWebGL":[function(t,e,i){var r=function(){function t(t,e){this._gl=t;this._buffer=this._gl.createBuffer();this._numIndices=e}t.prototype.uploadFromArray=function(t,e,i){this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,this._buffer);this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(t),this._gl.STATIC_DRAW)};t.prototype.dispose=function(){this._gl.deleteBuffer(this._buffer)};Object.defineProperty(t.prototype,"numIndices",{get:function(){return this._numIndices},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"glBuffer",{get:function(){return this._buffer},enumerable:true,configurable:true});return t}();e.exports=r},{}],"awayjs-stagegl/lib/base/OpCodes":[function(t,e,i){var r=function(){function t(){}t.trueValue=32;t.falseValue=33;t.intMask=63;t.drawTriangles=41;t.setProgramConstant=42;t.setProgram=43;t.present=44;t.clear=45;t.initProgram=46;t.initVertexBuffer=47;t.initIndexBuffer=48;t.configureBackBuffer=49;t.uploadArrayIndexBuffer=50;t.uploadArrayVertexBuffer=51;t.uploadAGALBytesProgram=52;t.setVertexBufferAt=53;t.uploadBytesIndexBuffer=54;t.uploadBytesVertexBuffer=55;t.setColorMask=56;t.setDepthTest=57;t.disposeProgram=58;t.disposeContext=59;t.disposeVertexBuffer=61;t.disposeIndexBuffer=63;t.initTexture=64;t.setTextureAt=65;t.uploadBytesTexture=66;t.disposeTexture=67;t.setCulling=68;t.setScissorRect=69;t.clearScissorRect=70;t.setBlendFactors=71;t.setRenderToTexture=72;t.clearTextureAt=73;t.clearVertexBufferAt=74;t.setStencilActions=75;t.setStencilReferenceValue=76;t.initCubeTexture=77;t.disposeCubeTexture=78;t.uploadBytesCubeTexture=79;t.clearRenderToTexture=80;t.enableErrorChecking=81;return t}();e.exports=r},{}],"awayjs-stagegl/lib/base/ProgramFlash":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/base/ContextStage3D");var s=t("awayjs-stagegl/lib/base/OpCodes");var n=t("awayjs-stagegl/lib/base/ResourceBaseFlash");var o=function(t){r(e,t);function e(e){t.call(this);this._context=e;this._context.addStream(String.fromCharCode(s.initProgram));this._pId=this._context.execute();this._context._iAddResource(this)}e.prototype.upload=function(t,e){this._context.addStream(String.fromCharCode(s.uploadAGALBytesProgram,this._pId+s.intMask)+t.readBase64String(t.length)+"%"+e.readBase64String(e.length)+"%");if(a.debug)this._context.execute()};e.prototype.dispose=function(){this._context.addStream(String.fromCharCode(s.disposeProgram,this._pId+s.intMask));this._context.execute();this._context._iRemoveResource(this);this._context=null};return e}(n);e.exports=o},{"awayjs-stagegl/lib/base/ContextStage3D":undefined,"awayjs-stagegl/lib/base/OpCodes":undefined,"awayjs-stagegl/lib/base/ResourceBaseFlash":undefined}],"awayjs-stagegl/lib/base/ProgramWebGL":[function(t,e,i){var r=t("awayjs-stagegl/lib/aglsl/AGALTokenizer");var a=t("awayjs-stagegl/lib/aglsl/AGLSLParser");var s=function(){function t(t){this._gl=t;this._program=this._gl.createProgram()}t.prototype.upload=function(e,i){var r=t._aglslParser.parse(t._tokenizer.decribeAGALByteArray(e));var a=t._aglslParser.parse(t._tokenizer.decribeAGALByteArray(i));this._vertexShader=this._gl.createShader(this._gl.VERTEX_SHADER);this._fragmentShader=this._gl.createShader(this._gl.FRAGMENT_SHADER);this._gl.shaderSource(this._vertexShader,r);this._gl.compileShader(this._vertexShader);if(!this._gl.getShaderParameter(this._vertexShader,this._gl.COMPILE_STATUS)){throw new Error(this._gl.getShaderInfoLog(this._vertexShader));return}this._gl.shaderSource(this._fragmentShader,a);this._gl.compileShader(this._fragmentShader);if(!this._gl.getShaderParameter(this._fragmentShader,this._gl.COMPILE_STATUS)){throw new Error(this._gl.getShaderInfoLog(this._fragmentShader));return}this._gl.attachShader(this._program,this._vertexShader);this._gl.attachShader(this._program,this._fragmentShader);this._gl.linkProgram(this._program);if(!this._gl.getProgramParameter(this._program,this._gl.LINK_STATUS)){throw new Error(this._gl.getProgramInfoLog(this._program))}};t.prototype.dispose=function(){this._gl.deleteProgram(this._program)};t.prototype.focusProgram=function(){this._gl.useProgram(this._program)};Object.defineProperty(t.prototype,"glProgram",{get:function(){return this._program},enumerable:true,configurable:true});t._tokenizer=new r;t._aglslParser=new a;return t}();e.exports=s},{"awayjs-stagegl/lib/aglsl/AGALTokenizer":undefined,"awayjs-stagegl/lib/aglsl/AGLSLParser":undefined}],"awayjs-stagegl/lib/base/ResourceBaseFlash":[function(t,e,i){var r=function(){function t(){}Object.defineProperty(t.prototype,"id",{get:function(){return this._pId},enumerable:true,configurable:true});t.prototype.dispose=function(){};return t}();e.exports=r},{}],"awayjs-stagegl/lib/base/SamplerState":[function(t,e,i){var r=function(){function t(){}return t}();e.exports=r},{}],"awayjs-stagegl/lib/base/Stage":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Rectangle");var s=t("awayjs-core/lib/events/Event");var n=t("awayjs-core/lib/events/EventDispatcher");var o=t("awayjs-core/lib/utils/CSS");var h=t("awayjs-display/lib/display/ContextMode");var l=t("awayjs-display/lib/events/StageEvent");var u=t("awayjs-stagegl/lib/base/ContextStage3D");var p=t("awayjs-stagegl/lib/base/ContextWebGL");var c=function(t){r(e,t);function e(e,i,r,s,n){if(s===void 0){s=false}if(n===void 0){n="baseline"}t.call(this);this._x=0;this._y=0;this._stageIndex=-1;this._antiAlias=0;this._renderTarget=null;this._renderSurfaceSelector=0;this._initialised=false;this._container=e;this._stageIndex=i;this._stageManager=r;this._viewPort=new a;this._enableDepthAndStencil=true;o.setElementX(this._container,0);o.setElementY(this._container,0);this.visible=true}e.prototype.requestContext=function(t,e,i){var r=this;if(t===void 0){t=false}if(e===void 0){e="baseline"}if(i===void 0){i="auto"}if(this._usesSoftwareRendering!=null)this._usesSoftwareRendering=t;this._profile=e;try{if(i==h.FLASH)new u(this._container,this._stageIndex,function(t){return r._callback(t)});else this._context=new p(this._container,this._stageIndex)}catch(a){try{if(i==h.AUTO)new u(this._container,this._stageIndex,function(t){return r._callback(t)});else this.dispatchEvent(new s(s.ERROR))}catch(a){this.dispatchEvent(new s(s.ERROR))}}if(this._context)this._callback(this._context)};Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){if(this._width==t)return;o.setElementWidth(this._container,t);this._width=this._viewPort.width=t;this._backBufferDirty=true;this.notifyViewportUpdated()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){if(this._height==t)return;o.setElementHeight(this._container,t);this._height=this._viewPort.height=t;this._backBufferDirty=true;this.notifyViewportUpdated()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){if(this._x==t)return;o.setElementX(this._container,t);this._x=this._viewPort.x=t;this.notifyViewportUpdated()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){if(this._y==t)return;o.setElementY(this._container,t);this._y=this._viewPort.y=t;this.notifyViewportUpdated()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"visible",{get:function(){return o.getElementVisibility(this._container)},set:function(t){o.setElementVisibility(this._container,t)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"container",{get:function(){return this._container},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"context",{get:function(){return this._context},enumerable:true,configurable:true});e.prototype.notifyViewportUpdated=function(){if(this._viewportDirty)return;this._viewportDirty=true;this._viewportUpdated=new l(l.VIEWPORT_UPDATED);this.dispatchEvent(this._viewportUpdated)};e.prototype.notifyEnterFrame=function(){if(!this._enterFrame)this._enterFrame=new s(s.ENTER_FRAME);this.dispatchEvent(this._enterFrame)};e.prototype.notifyExitFrame=function(){if(!this._exitFrame)this._exitFrame=new s(s.EXIT_FRAME);this.dispatchEvent(this._exitFrame)};Object.defineProperty(e.prototype,"profile",{get:function(){return this._profile},enumerable:true,configurable:true});e.prototype.dispose=function(){this._stageManager.iRemoveStage(this);this.freeContext();this._stageManager=null;this._stageIndex=-1};e.prototype.configureBackBuffer=function(t,e,i,r){this.width=t;this.height=e;this._antiAlias=i;this._enableDepthAndStencil=r;if(this._context)this._context.configureBackBuffer(t,e,i,r)};Object.defineProperty(e.prototype,"enableDepthAndStencil",{get:function(){return this._enableDepthAndStencil},set:function(t){this._enableDepthAndStencil=t;this._backBufferDirty=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"renderTarget",{get:function(){return this._renderTarget},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"renderSurfaceSelector",{get:function(){return this._renderSurfaceSelector},enumerable:true,configurable:true});e.prototype.clear=function(){if(!this._context)return;if(this._backBufferDirty){this.configureBackBuffer(this._width,this._height,this._antiAlias,this._enableDepthAndStencil);this._backBufferDirty=false}this._context.clear((this._color&4278190080)>>>24,(this._color&16711680)>>>16,(this._color&65280)>>>8,this._color&255);this._bufferClear=true};e.prototype.addEventListener=function(e,i){t.prototype.addEventListener.call(this,e,i)};e.prototype.removeEventListener=function(e,i){t.prototype.removeEventListener.call(this,e,i)};Object.defineProperty(e.prototype,"scissorRect",{get:function(){return this._scissorRect},set:function(t){this._scissorRect=t;this._context.setScissorRectangle(this._scissorRect)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"stageIndex",{get:function(){return this._stageIndex},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"usesSoftwareRendering",{get:function(){return this._usesSoftwareRendering},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"antiAlias",{get:function(){return this._antiAlias},set:function(t){this._antiAlias=t;this._backBufferDirty=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"viewPort",{get:function(){this._viewportDirty=false;return this._viewPort},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){this._color=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"bufferClear",{get:function(){return this._bufferClear},set:function(t){this._bufferClear=t},enumerable:true,configurable:true});e.prototype.freeContext=function(){if(this._context){this._context.dispose();this.dispatchEvent(new l(l.CONTEXT_DISPOSED))}this._context=null;this._initialised=false};e.prototype.onEnterFrame=function(t){if(!this._context)return;this.clear();this.notifyEnterFrame();if(!this._context)this._context.present();this.notifyExitFrame()};e.prototype.recoverFromDisposal=function(){if(!this._context)return false;return true};e.prototype._callback=function(t){this._context=t;this._container=this._context.container;if(this._width&&this._height)this._context.configureBackBuffer(this._width,this._height,this._antiAlias,this._enableDepthAndStencil);this.dispatchEvent(new l(this._initialised?l.CONTEXT_RECREATED:l.CONTEXT_CREATED));this._initialised=true};return e}(n);e.exports=c},{"awayjs-core/lib/events/Event":undefined,"awayjs-core/lib/events/EventDispatcher":undefined,"awayjs-core/lib/geom/Rectangle":undefined,"awayjs-core/lib/utils/CSS":undefined,"awayjs-display/lib/display/ContextMode":undefined,"awayjs-display/lib/events/StageEvent":undefined,"awayjs-stagegl/lib/base/ContextStage3D":undefined,"awayjs-stagegl/lib/base/ContextWebGL":undefined}],"awayjs-stagegl/lib/base/TextureBaseWebGL":[function(t,e,i){var r=t("awayjs-core/lib/errors/AbstractMethodError");var a=function(){function t(t){this.textureType="";this._gl=t}t.prototype.dispose=function(){throw"Abstract method must be overridden."};Object.defineProperty(t.prototype,"glTexture",{get:function(){throw new r},enumerable:true,configurable:true});return t}();e.exports=a},{"awayjs-core/lib/errors/AbstractMethodError":undefined}],"awayjs-stagegl/lib/base/TextureFlash":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/base/BitmapData");var s=t("awayjs-core/lib/utils/ByteArrayBase");var n=t("awayjs-stagegl/lib/base/OpCodes");var o=t("awayjs-stagegl/lib/base/ResourceBaseFlash");var h=function(t){r(e,t);function e(e,i,r,a,s,o){if(o===void 0){o=false}t.call(this);this._context=e;this._width=i;this._height=r;this._context.addStream(String.fromCharCode(n.initTexture,s?n.trueValue:n.falseValue)+i+","+r+","+o+","+a+"$");this._pId=this._context.execute();this._context._iAddResource(this)}Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:true,configurable:true});e.prototype.dispose=function(){this._context.addStream(String.fromCharCode(n.disposeTexture)+this._pId.toString()+",");this._context.execute();this._context._iRemoveResource(this);this._context=null};e.prototype.uploadFromData=function(t,e){if(e===void 0){e=0}if(t instanceof a){t=t.imageData.data}else if(t instanceof HTMLImageElement){var i=document.createElement("canvas");var r=t.width;var o=t.height;i.width=r;i.height=o;var h=i.getContext("2d");h.drawImage(t,0,0);t=h.getImageData(0,0,r,o).data}var l=0;var u=s.internalGetBase64String(t.length,function(){return t[l++]},null);this._context.addStream(String.fromCharCode(n.uploadBytesTexture)+this._pId+","+e+","+(this._width>>e)+","+(this._height>>e)+","+u+"%");this._context.execute()};return e}(o);e.exports=h},{"awayjs-core/lib/base/BitmapData":undefined,"awayjs-core/lib/utils/ByteArrayBase":undefined,"awayjs-stagegl/lib/base/OpCodes":undefined,"awayjs-stagegl/lib/base/ResourceBaseFlash":undefined}],"awayjs-stagegl/lib/base/TextureWebGL":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];
function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/base/BitmapData");var s=t("awayjs-stagegl/lib/base/TextureBaseWebGL");var n=function(t){r(e,t);function e(e,i,r){t.call(this,e);this.textureType="texture2d";this._width=i;this._height=r;this._glTexture=this._gl.createTexture()}e.prototype.dispose=function(){this._gl.deleteTexture(this._glTexture)};Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"frameBuffer",{get:function(){if(!this._frameBuffer){this._frameBuffer=this._gl.createFramebuffer();this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._frameBuffer);this._gl.bindTexture(this._gl.TEXTURE_2D,this._glTexture);this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,this._width,this._height,0,this._gl.RGBA,this._gl.UNSIGNED_BYTE,null);var t=this._gl.createRenderbuffer();this._gl.bindRenderbuffer(this._gl.RENDERBUFFER,t);this._gl.renderbufferStorage(this._gl.RENDERBUFFER,this._gl.DEPTH_COMPONENT16,this._width,this._height);this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._glTexture,0);this._gl.framebufferRenderbuffer(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.RENDERBUFFER,t);this._gl.bindTexture(this._gl.TEXTURE_2D,null);this._gl.bindRenderbuffer(this._gl.RENDERBUFFER,null);this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null)}return this._frameBuffer},enumerable:true,configurable:true});e.prototype.uploadFromData=function(t,e){if(e===void 0){e=0}if(t instanceof a)t=t.imageData;this._gl.bindTexture(this._gl.TEXTURE_2D,this._glTexture);this._gl.texImage2D(this._gl.TEXTURE_2D,e,this._gl.RGBA,this._gl.RGBA,this._gl.UNSIGNED_BYTE,t);this._gl.bindTexture(this._gl.TEXTURE_2D,null)};e.prototype.uploadCompressedTextureFromByteArray=function(t,e,i){if(i===void 0){i=false}var r=this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc")};Object.defineProperty(e.prototype,"glTexture",{get:function(){return this._glTexture},enumerable:true,configurable:true});e.prototype.generateMipmaps=function(){};return e}(s);e.exports=n},{"awayjs-core/lib/base/BitmapData":undefined,"awayjs-stagegl/lib/base/TextureBaseWebGL":undefined}],"awayjs-stagegl/lib/base/VertexBufferFlash":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/base/OpCodes");var s=t("awayjs-stagegl/lib/base/ResourceBaseFlash");var n=function(t){r(e,t);function e(e,i,r){t.call(this);this._context=e;this._numVertices=i;this._data32PerVertex=r;this._context.addStream(String.fromCharCode(a.initVertexBuffer,r+a.intMask)+i.toString()+",");this._pId=this._context.execute();this._context._iAddResource(this)}e.prototype.uploadFromArray=function(t,e,i){this._context.addStream(String.fromCharCode(a.uploadArrayVertexBuffer,this._pId+a.intMask)+t.join()+"#"+[e,i].join()+",");this._context.execute()};Object.defineProperty(e.prototype,"numVertices",{get:function(){return this._numVertices},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"data32PerVertex",{get:function(){return this._data32PerVertex},enumerable:true,configurable:true});e.prototype.dispose=function(){this._context.addStream(String.fromCharCode(a.disposeVertexBuffer,this._pId+a.intMask));this._context.execute();this._context._iRemoveResource(this);this._context=null};return e}(s);e.exports=n},{"awayjs-stagegl/lib/base/OpCodes":undefined,"awayjs-stagegl/lib/base/ResourceBaseFlash":undefined}],"awayjs-stagegl/lib/base/VertexBufferWebGL":[function(t,e,i){var r=function(){function t(t,e,i){this._gl=t;this._buffer=this._gl.createBuffer();this._numVertices=e;this._data32PerVertex=i}t.prototype.uploadFromArray=function(t,e,i){this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._buffer);this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(t),this._gl.STATIC_DRAW)};Object.defineProperty(t.prototype,"numVertices",{get:function(){return this._numVertices},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"data32PerVertex",{get:function(){return this._data32PerVertex},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"glBuffer",{get:function(){return this._buffer},enumerable:true,configurable:true});t.prototype.dispose=function(){this._gl.deleteBuffer(this._buffer)};return t}();e.exports=r},{}],"awayjs-stagegl/lib/errors/AnimationSetError":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/Error");var s=function(t){r(e,t);function e(e){t.call(this,e)}return e}(a);e.exports=s},{"awayjs-core/lib/errors/Error":undefined}],"awayjs-stagegl/lib/events/AnimatorEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e,i){t.call(this,e);this._animator=i}Object.defineProperty(e.prototype,"animator",{get:function(){return this._animator},enumerable:true,configurable:true});e.prototype.clone=function(){return new e(this.type,this._animator)};e.START="start";e.STOP="stop";e.CYCLE_COMPLETE="cycle_complete";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":undefined}],"awayjs-stagegl/lib/events/ShadingMethodEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e){t.call(this,e)}e.SHADER_INVALIDATED="ShaderInvalidated";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":undefined}],"awayjs-stagegl/lib/filters/Filter3DBase":[function(t,e,i){var r=function(){function t(){this._tasks=new Array}Object.defineProperty(t.prototype,"requireDepthRender",{get:function(){return this._requireDepthRender},enumerable:true,configurable:true});t.prototype.pAddTask=function(t){this._tasks.push(t);if(this._requireDepthRender==null)this._requireDepthRender=t.requireDepthRender};Object.defineProperty(t.prototype,"tasks",{get:function(){return this._tasks},enumerable:true,configurable:true});t.prototype.getMainInputTexture=function(t){return this._tasks[0].getMainInputTexture(t)};Object.defineProperty(t.prototype,"textureWidth",{get:function(){return this._textureWidth},set:function(t){this._textureWidth=t;for(var e=0;e<this._tasks.length;++e)this._tasks[e].textureWidth=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"textureHeight",{get:function(){return this._textureHeight},set:function(t){this._textureHeight=t;for(var e=0;e<this._tasks.length;++e)this._tasks[e].textureHeight=t},enumerable:true,configurable:true});t.prototype.setRenderTargets=function(t,e){this._tasks[this._tasks.length-1].target=t};t.prototype.dispose=function(){for(var t=0;t<this._tasks.length;++t)this._tasks[t].dispose()};t.prototype.update=function(t,e){};return t}();e.exports=r},{}],"awayjs-stagegl/lib/filters/tasks/Filter3DTaskBase":[function(t,e,i){var r=t("awayjs-core/lib/errors/AbstractMethodError");var a=t("awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler");var s=t("awayjs-stagegl/lib/base/ContextGLTextureFormat");var n=function(){function t(t){if(t===void 0){t=false}this._scaledTextureWidth=-1;this._scaledTextureHeight=-1;this._textureWidth=-1;this._textureHeight=-1;this._textureDimensionsInvalid=true;this._program3DInvalid=true;this._textureScale=0;this._requireDepthRender=t}Object.defineProperty(t.prototype,"textureScale",{get:function(){return this._textureScale},set:function(t){if(this._textureScale==t)return;this._textureScale=t;this._scaledTextureWidth=this._textureWidth>>this._textureScale;this._scaledTextureHeight=this._textureHeight>>this._textureScale;this._textureDimensionsInvalid=true},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"target",{get:function(){return this._target},set:function(t){this._target=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"textureWidth",{get:function(){return this._textureWidth},set:function(t){if(this._textureWidth==t)return;this._textureWidth=t;this._scaledTextureWidth=this._textureWidth>>this._textureScale;this._textureDimensionsInvalid=true},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"textureHeight",{get:function(){return this._textureHeight},set:function(t){if(this._textureHeight==t)return;this._textureHeight=t;this._scaledTextureHeight=this._textureHeight>>this._textureScale;this._textureDimensionsInvalid=true},enumerable:true,configurable:true});t.prototype.getMainInputTexture=function(t){if(this._textureDimensionsInvalid)this.pUpdateTextures(t);return this._mainInputTexture};t.prototype.dispose=function(){if(this._mainInputTexture)this._mainInputTexture.dispose();if(this._program3D)this._program3D.dispose()};t.prototype.pInvalidateProgram=function(){this._program3DInvalid=true};t.prototype.pUpdateProgram=function(t){if(this._program3D)this._program3D.dispose();this._program3D=t.context.createProgram();var e=(new a).assemble("part vertex 1\n"+this.pGetVertexCode()+"endpart")["vertex"].data;var i=(new a).assemble("part fragment 1\n"+this.pGetFragmentCode()+"endpart")["fragment"].data;this._program3D.upload(e,i);this._program3DInvalid=false};t.prototype.pGetVertexCode=function(){return"mov op, va0\n"+"mov v0, va1\n"};t.prototype.pGetFragmentCode=function(){throw new r;return null};t.prototype.pUpdateTextures=function(t){if(this._mainInputTexture)this._mainInputTexture.dispose();this._mainInputTexture=t.context.createTexture(this._scaledTextureWidth,this._scaledTextureHeight,s.BGRA,true);this._textureDimensionsInvalid=false};t.prototype.getProgram=function(t){if(this._program3DInvalid)this.pUpdateProgram(t);return this._program3D};t.prototype.activate=function(t,e,i){};t.prototype.deactivate=function(t){};Object.defineProperty(t.prototype,"requireDepthRender",{get:function(){return this._requireDepthRender},enumerable:true,configurable:true});return t}();e.exports=n},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler":undefined,"awayjs-stagegl/lib/base/ContextGLTextureFormat":undefined}],"awayjs-stagegl/lib/managers/RTTBufferManager":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Rectangle");var s=t("awayjs-core/lib/events/Event");var n=t("awayjs-core/lib/events/EventDispatcher");var o=t("awayjs-core/lib/utils/TextureUtils");var h=function(t){r(e,t);function e(e){t.call(this);this._viewWidth=-1;this._viewHeight=-1;this._textureWidth=-1;this._textureHeight=-1;this._buffersInvalid=true;this._renderToTextureRect=new a;this._stage=e}e.getInstance=function(t){if(!t)throw new Error("stage key cannot be null!");if(e._instances==null)e._instances=new Array;var i=e.getRTTBufferManagerFromStage(t);if(i==null){i=new e(t);var r=new l;r.stage3d=t;r.rttbfm=i;e._instances.push(r)}return i};e.getRTTBufferManagerFromStage=function(t){var i=e._instances.length;var r;for(var a=0;a<i;a++){r=e._instances[a];if(r.stage3d===t)return r.rttbfm}return null};e.deleteRTTBufferManager=function(t){var i=e._instances.length;var r;for(var a=0;a<i;a++){r=e._instances[a];if(r.stage3d===t){e._instances.splice(a,1);return}}};Object.defineProperty(e.prototype,"textureRatioX",{get:function(){if(this._buffersInvalid)this.updateRTTBuffers();return this._textureRatioX},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"textureRatioY",{get:function(){if(this._buffersInvalid)this.updateRTTBuffers();return this._textureRatioY},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"viewWidth",{get:function(){return this._viewWidth},set:function(t){if(t==this._viewWidth)return;this._viewWidth=t;this._buffersInvalid=true;this._textureWidth=o.getBestPowerOf2(this._viewWidth);if(this._textureWidth>this._viewWidth){this._renderToTextureRect.x=Math.floor((this._textureWidth-this._viewWidth)*.5);this._renderToTextureRect.width=this._viewWidth}else{this._renderToTextureRect.x=0;this._renderToTextureRect.width=this._textureWidth}this.dispatchEvent(new s(s.RESIZE))},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"viewHeight",{get:function(){return this._viewHeight},set:function(t){if(t==this._viewHeight)return;this._viewHeight=t;this._buffersInvalid=true;this._textureHeight=o.getBestPowerOf2(this._viewHeight);if(this._textureHeight>this._viewHeight){this._renderToTextureRect.y=Math.floor((this._textureHeight-this._viewHeight)*.5);this._renderToTextureRect.height=this._viewHeight}else{this._renderToTextureRect.y=0;this._renderToTextureRect.height=this._textureHeight}this.dispatchEvent(new s(s.RESIZE))},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"renderToTextureVertexBuffer",{get:function(){if(this._buffersInvalid)this.updateRTTBuffers();return this._renderToTextureVertexBuffer},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"renderToScreenVertexBuffer",{get:function(){if(this._buffersInvalid)this.updateRTTBuffers();return this._renderToScreenVertexBuffer},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"indexBuffer",{get:function(){return this._indexBuffer},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"renderToTextureRect",{get:function(){if(this._buffersInvalid)this.updateRTTBuffers();return this._renderToTextureRect},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"textureWidth",{get:function(){return this._textureWidth},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"textureHeight",{get:function(){return this._textureHeight},enumerable:true,configurable:true});e.prototype.dispose=function(){e.deleteRTTBufferManager(this._stage);if(this._indexBuffer){this._indexBuffer.dispose();this._renderToScreenVertexBuffer.dispose();this._renderToTextureVertexBuffer.dispose();this._renderToScreenVertexBuffer=null;this._renderToTextureVertexBuffer=null;this._indexBuffer=null}};e.prototype.updateRTTBuffers=function(){var t=this._stage.context;var e;var i;var r;var a;if(this._renderToTextureVertexBuffer==null)this._renderToTextureVertexBuffer=t.createVertexBuffer(4,5);if(this._renderToScreenVertexBuffer==null)this._renderToScreenVertexBuffer=t.createVertexBuffer(4,5);if(!this._indexBuffer){this._indexBuffer=t.createIndexBuffer(6);this._indexBuffer.uploadFromArray([2,1,0,3,2,0],0,6)}this._textureRatioX=r=Math.min(this._viewWidth/this._textureWidth,1);this._textureRatioY=a=Math.min(this._viewHeight/this._textureHeight,1);var s=(1-r)*.5;var n=(r+1)*.5;var o=(a+1)*.5;var h=(1-a)*.5;e=[-r,-a,s,o,0,r,-a,n,o,1,r,a,n,h,2,-r,a,s,h,3];i=[-1,-1,s,o,0,1,-1,n,o,1,1,1,n,h,2,-1,1,s,h,3];this._renderToTextureVertexBuffer.uploadFromArray(e,0,4);this._renderToScreenVertexBuffer.uploadFromArray(i,0,4);this._buffersInvalid=false};return e}(n);var l=function(){function t(){}return t}();e.exports=h},{"awayjs-core/lib/events/Event":undefined,"awayjs-core/lib/events/EventDispatcher":undefined,"awayjs-core/lib/geom/Rectangle":undefined,"awayjs-core/lib/utils/TextureUtils":undefined}],"awayjs-stagegl/lib/managers/StageManager":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/EventDispatcher");var s=t("awayjs-core/lib/errors/ArgumentError");var n=t("awayjs-display/lib/events/StageEvent");var o=t("awayjs-stagegl/lib/base/Stage");var h=function(t){r(e,t);function e(){var i=this;t.call(this);this._stages=new Array(e.STAGE_MAX_QUANTITY);this._onContextCreatedDelegate=function(t){return i.onContextCreated(t)}}e.getInstance=function(){if(this._instance==null)this._instance=new e;return this._instance};e.prototype.getStageAt=function(t,i,r,a){if(i===void 0){i=false}if(r===void 0){r="baseline"}if(a===void 0){a="auto"}if(t<0||t>=e.STAGE_MAX_QUANTITY)throw new s("Index is out of bounds [0.."+e.STAGE_MAX_QUANTITY+"]");if(!this._stages[t]){e._numStages++;var h=document.createElement("canvas");h.id="stage"+t;document.body.appendChild(h);var l=this._stages[t]=new o(h,t,this,i,r);l.addEventListener(n.CONTEXT_CREATED,this._onContextCreatedDelegate);l.requestContext(i,r,a)}return l};e.prototype.iRemoveStage=function(t){e._numStages--;t.removeEventListener(n.CONTEXT_CREATED,this._onContextCreatedDelegate);this._stages[t.stageIndex]=null};e.prototype.getFreeStage=function(t,e,i){if(t===void 0){t=false}if(e===void 0){e="baseline"}if(i===void 0){i="auto"}var r=0;var a=this._stages.length;while(r<a){if(!this._stages[r])return this.getStageAt(r,t,e,i);++r}return null};Object.defineProperty(e.prototype,"hasFreeStage",{get:function(){return e._numStages<e.STAGE_MAX_QUANTITY?true:false},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numSlotsFree",{get:function(){return e.STAGE_MAX_QUANTITY-e._numStages},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numSlotsUsed",{get:function(){return e._numStages},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numSlotsTotal",{get:function(){return this._stages.length},enumerable:true,configurable:true});e.prototype.onContextCreated=function(t){};e.STAGE_MAX_QUANTITY=8;e._numStages=0;return e}(a);e.exports=h},{"awayjs-core/lib/errors/ArgumentError":undefined,"awayjs-core/lib/events/EventDispatcher":undefined,"awayjs-display/lib/events/StageEvent":undefined,"awayjs-stagegl/lib/base/Stage":undefined}],"awayjs-stagegl/lib/materials/LineBasicMaterial":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Matrix3D");var s=t("awayjs-display/lib/base/LineSubGeometry");var n=t("awayjs-stagegl/lib/base/ContextGLProgramType");var o=t("awayjs-stagegl/lib/materials/StageGLMaterialBase");var h=t("awayjs-stagegl/lib/materials/passes/LineBasicPass");var l=function(t){r(e,t);function e(e){if(e===void 0){e=1.25}t.call(this);this._constants=new Array(0,0,0,0);this._thickness=e;this.bothSides=true;this._pAddScreenPass(this._screenPass=new h);this._calcMatrix=new a;this._constants[1]=1/255}e.prototype._iGetVertexCode=function(t,e,i){return"m44 vt0, va0, vc8			\n"+"m44 vt1, va1, vc8			\n"+"sub vt2, vt1, vt0 			\n"+"slt vt5.x, vt0.z, vc7.z			\n"+"sub vt5.y, vc5.x, vt5.x			\n"+"add vt4.x, vt0.z, vc7.z			\n"+"sub vt4.y, vt0.z, vt1.z			\n"+"seq vt4.z, vt4.y vc6.x			\n"+"add vt4.y, vt4.y, vt4.z			\n"+"div vt4.z, vt4.x, vt4.y			\n"+"mul vt4.xyz, vt4.zzz, vt2.xyz	\n"+"add vt3.xyz, vt0.xyz, vt4.xyz	\n"+"mov vt3.w, vc5.x			\n"+"mul vt0, vt0, vt5.yyyy			\n"+"mul vt3, vt3, vt5.xxxx			\n"+"add vt0, vt0, vt3				\n"+"sub vt2, vt1, vt0 			\n"+"nrm vt2.xyz, vt2.xyz			\n"+"nrm vt5.xyz, vt0.xyz			\n"+"mov vt5.w, vc5.x				\n"+"crs vt3.xyz, vt2, vt5			\n"+"nrm vt3.xyz, vt3.xyz			\n"+"mul vt3.xyz, vt3.xyz, va2.xxx	\n"+"mov vt3.w, vc5.x			\n"+"dp3 vt4.x, vt0, vc6			\n"+"mul vt4.x, vt4.x, vc7.x			\n"+"mul vt3.xyz, vt3.xyz, vt4.xxx	\n"+"add vt0.xyz, vt0.xyz, vt3.xyz	\n"+"m44 op, vt0, vc0			\n"+"mov v0, va3				\n"};e.prototype._iActivatePass=function(i,r,a){t.prototype._iActivatePass.call(this,i,r,a);var s=r.context;this._constants[0]=this._thickness/(r.scissorRect?Math.min(r.scissorRect.width,r.scissorRect.height):Math.min(r.width,r.height));this._constants[2]=a.projection.near;s.setProgramConstantsFromArray(n.VERTEX,5,e.pONE_VECTOR,1);s.setProgramConstantsFromArray(n.VERTEX,6,e.pFRONT_VECTOR,1);s.setProgramConstantsFromArray(n.VERTEX,7,this._constants,1);s.setProgramConstantsFromMatrix(n.VERTEX,0,a.projection.matrix,true)};e.prototype._iRenderPass=function(e,i,r,a,o){t.prototype._iRenderPass.call(this,e,i,r,a,o);var h=r.context;this._calcMatrix.copyFrom(i.sourceEntity.sceneTransform);this._calcMatrix.append(a.inverseSceneTransform);h.setProgramConstantsFromMatrix(n.VERTEX,8,this._calcMatrix,true);h.activateBuffer(0,i.getVertexData(s.START_POSITION_DATA),i.getVertexOffset(s.START_POSITION_DATA),s.POSITION_FORMAT);h.activateBuffer(1,i.getVertexData(s.END_POSITION_DATA),i.getVertexOffset(s.END_POSITION_DATA),s.POSITION_FORMAT);h.activateBuffer(2,i.getVertexData(s.THICKNESS_DATA),i.getVertexOffset(s.THICKNESS_DATA),s.THICKNESS_FORMAT);h.activateBuffer(3,i.getVertexData(s.COLOR_DATA),i.getVertexOffset(s.COLOR_DATA),s.COLOR_FORMAT);h.drawTriangles(h.getIndexBuffer(i.getIndexData()),0,i.numTriangles)};e.pONE_VECTOR=Array(1,1,1,1);e.pFRONT_VECTOR=Array(0,0,-1,0);return e}(o);e.exports=l},{"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-display/lib/base/LineSubGeometry":undefined,"awayjs-stagegl/lib/base/ContextGLProgramType":undefined,"awayjs-stagegl/lib/materials/StageGLMaterialBase":undefined,"awayjs-stagegl/lib/materials/passes/LineBasicPass":undefined}],"awayjs-stagegl/lib/materials/SkyboxMaterial":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/base/TriangleSubGeometry");var s=t("awayjs-stagegl/lib/base/ContextGLCompareMode");var n=t("awayjs-stagegl/lib/base/ContextGLMipFilter");var o=t("awayjs-stagegl/lib/base/ContextGLProgramType");var h=t("awayjs-stagegl/lib/base/ContextGLTextureFilter");var l=t("awayjs-stagegl/lib/base/ContextGLWrapMode");var u=t("awayjs-stagegl/lib/materials/StageGLMaterialBase");var p=t("awayjs-stagegl/lib/materials/passes/SkyboxPass");var c=t("awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper");var d=function(t){r(e,t);function e(e,i,r,a){if(i===void 0){i=true}if(r===void 0){r=false}if(a===void 0){a=false}t.call(this);this._cubeMap=e;this._pAddScreenPass(this._skyboxPass=new p);this._vertexData=new Array(0,0,0,0,1,1,1,1)}Object.defineProperty(e.prototype,"cubeMap",{get:function(){return this._cubeMap},set:function(t){if(t&&this._cubeMap&&(t.hasMipmaps!=this._cubeMap.hasMipmaps||t.format!=this._cubeMap.format))this._pInvalidatePasses();this._cubeMap=t},enumerable:true,configurable:true});e.prototype._iGetVertexCode=function(t,e,i){return"mul vt0, va0, vc5\n"+"add vt0, vt0, vc4\n"+"m44 op, vt0, vc0\n"+"mov v0, va0\n"};e.prototype._iGetFragmentCode=function(t,e,i){var r=",mipnone";if(this._cubeMap.hasMipmaps)r=",miplinear";return"tex ft0, v0, fs0 <cube,"+c.getFormatStringForTexture(this._cubeMap)+"linear,clamp"+r+">\n"};e.prototype._iActivatePass=function(e,i,r){t.prototype._iActivatePass.call(this,e,i,r);var a=i.context;a.setSamplerStateAt(0,l.CLAMP,h.LINEAR,this._cubeMap.hasMipmaps?n.MIPLINEAR:n.MIPNONE);a.setDepthTest(false,s.LESS);a.activateCubeTexture(0,this._cubeMap)};e.prototype._iRenderPass=function(e,i,r,s,n){t.prototype._iRenderPass.call(this,e,i,r,s,n);var h=r.context;var l=s.scenePosition;this._vertexData[0]=l.x;this._vertexData[1]=l.y;this._vertexData[2]=l.z;this._vertexData[4]=this._vertexData[5]=this._vertexData[6]=s.projection.far/Math.sqrt(3);h.setProgramConstantsFromMatrix(o.VERTEX,0,n,true);h.setProgramConstantsFromArray(o.VERTEX,4,this._vertexData,2);h.activateBuffer(0,i.getVertexData(a.POSITION_DATA),i.getVertexOffset(a.POSITION_DATA),a.POSITION_FORMAT);h.drawTriangles(h.getIndexBuffer(i.getIndexData()),0,i.numTriangles)};return e}(u);e.exports=d},{"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-stagegl/lib/base/ContextGLCompareMode":undefined,"awayjs-stagegl/lib/base/ContextGLMipFilter":undefined,"awayjs-stagegl/lib/base/ContextGLProgramType":undefined,"awayjs-stagegl/lib/base/ContextGLTextureFilter":undefined,"awayjs-stagegl/lib/base/ContextGLWrapMode":undefined,"awayjs-stagegl/lib/materials/StageGLMaterialBase":undefined,"awayjs-stagegl/lib/materials/passes/SkyboxPass":undefined,"awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper":undefined}],"awayjs-stagegl/lib/materials/StageGLMaterialBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/materials/MaterialBase");var s=function(t){r(e,t);function e(){t.apply(this,arguments)}e.prototype._iGetVertexCode=function(t,e,i){return""};e.prototype._iGetFragmentCode=function(t,e,i){return""};return e}(a);e.exports=s},{"awayjs-display/lib/materials/MaterialBase":undefined}],"awayjs-stagegl/lib/materials/TriangleBasicMaterial":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/textures/Texture2DBase");var s=t("awayjs-display/lib/base/BlendMode");var n=t("awayjs-stagegl/lib/base/ContextGLCompareMode");var o=t("awayjs-stagegl/lib/materials/passes/TriangleBasicPass");var h=t("awayjs-stagegl/lib/materials/TriangleMaterialBase");var l=function(t){r(e,t);function e(e,i,r,s){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=false}if(s===void 0){s=false}t.call(this);this._alphaBlending=false;this._alpha=1;this._depthCompareMode=n.LESS_EQUAL;this._screenPass=new o;if(e instanceof a){this.texture=e;this.smooth=i==null?true:false;this.repeat=r;this.mipmap=s}else{this.color=e?Number(e):13421772;this.alpha=i==null?1:Number(i)}}Object.defineProperty(e.prototype,"depthCompareMode",{get:function(){return this._depthCompareMode},set:function(t){if(this._depthCompareMode==t)return;this._depthCompareMode=t;this._pInvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){if(t>1)t=1;else if(t<0)t=0;if(this._alpha==t)return;this._alpha=t;this._pInvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"alphaBlending",{get:function(){return this._alphaBlending},set:function(t){if(this._alphaBlending==t)return;this._alphaBlending=t;this._pInvalidatePasses()},enumerable:true,configurable:true});e.prototype.iUpdateMaterial=function(){var t;if(this._pScreenPassesInvalid){this.pUpdateScreenPasses();t=true}if(t){this._pClearScreenPasses();this._pAddScreenPass(this._screenPass)}};e.prototype.pUpdateScreenPasses=function(){this.initPasses();this.setBlendAndCompareModes();this._pScreenPassesInvalid=false};e.prototype.initPasses=function(){};e.prototype.setBlendAndCompareModes=function(){this._pRequiresBlending=this._pBlendMode!=s.NORMAL||this._alphaBlending||this._alpha<1;this._screenPass.depthCompareMode=this._depthCompareMode;this._screenPass.preserveAlpha=this._pRequiresBlending;this._screenPass.setBlendMode(this._pBlendMode==s.NORMAL&&this._pRequiresBlending?s.LAYER:this._pBlendMode);this._screenPass.forceSeparateMVP=false};return e}(h);e.exports=l},{"awayjs-core/lib/textures/Texture2DBase":undefined,"awayjs-display/lib/base/BlendMode":undefined,"awayjs-stagegl/lib/base/ContextGLCompareMode":undefined,"awayjs-stagegl/lib/materials/TriangleMaterialBase":undefined,"awayjs-stagegl/lib/materials/passes/TriangleBasicPass":undefined}],"awayjs-stagegl/lib/materials/TriangleMaterialBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Matrix3DUtils");var s=t("awayjs-display/lib/base/TriangleSubGeometry");var n=t("awayjs-stagegl/lib/base/ContextGLProgramType");var o=t("awayjs-stagegl/lib/materials/StageGLMaterialBase");var h=function(t){r(e,t);function e(){t.apply(this,arguments)}e.prototype._iGetVertexCode=function(t,e,i){var r="";var a=t.globalPosDependencies>0?i.globalPositionVertex:i.localPosition;var s=e.getFreeVertexConstant();e.getFreeVertexConstant();e.getFreeVertexConstant();e.getFreeVertexConstant();t.viewMatrixIndex=s.index*4;if(t.projectionDependencies>0){i.projectionFragment=e.getFreeVarying();var n=e.getFreeVertexVectorTemp();r+="m44 "+n+", "+a+", "+s+"\n"+"mov "+i.projectionFragment+", "+n+"\n"+"mov op, "+n+"\n"}else{r+="m44 op, "+a+", "+s+"\n"}return r};e.prototype._iRenderPass=function(e,i,r,o,h){t.prototype._iRenderPass.call(this,e,i,r,o,h);var l=e.shaderObject;if(l.sceneMatrixIndex>=0){i.sourceEntity.getRenderSceneTransform(o).copyRawDataTo(l.vertexConstantData,l.sceneMatrixIndex,true);h.copyRawDataTo(l.vertexConstantData,l.viewMatrixIndex,true)}else{var u=a.CALCULATION_MATRIX;u.copyFrom(i.sourceEntity.getRenderSceneTransform(o));u.append(h);u.copyRawDataTo(l.vertexConstantData,l.viewMatrixIndex,true)}var p=r.context;p.setProgramConstantsFromArray(n.VERTEX,0,l.vertexConstantData,l.numUsedVertexConstants);p.setProgramConstantsFromArray(n.FRAGMENT,0,l.fragmentConstantData,l.numUsedFragmentConstants);p.activateBuffer(0,i.getVertexData(s.POSITION_DATA),i.getVertexOffset(s.POSITION_DATA),s.POSITION_FORMAT);p.drawTriangles(p.getIndexBuffer(i.getIndexData()),0,i.numTriangles)};return e}(o);e.exports=h},{"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-stagegl/lib/base/ContextGLProgramType":undefined,"awayjs-stagegl/lib/materials/StageGLMaterialBase":undefined}],"awayjs-stagegl/lib/materials/TriangleMaterialMode":[function(t,e,i){var r=function(){function t(){}t.SINGLE_PASS="singlePass";t.MULTI_PASS="multiPass";return t}();e.exports=r},{}],"awayjs-stagegl/lib/materials/TriangleMethodMaterial":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/ColorTransform");var s=t("awayjs-core/lib/textures/Texture2DBase");var n=t("awayjs-display/lib/base/BlendMode");var o=t("awayjs-display/lib/materials/lightpickers/StaticLightPicker");var h=t("awayjs-stagegl/lib/base/ContextGLCompareMode");var l=t("awayjs-stagegl/lib/materials/methods/AmbientBasicMethod");var u=t("awayjs-stagegl/lib/materials/methods/DiffuseBasicMethod");var p=t("awayjs-stagegl/lib/materials/methods/NormalBasicMethod");var c=t("awayjs-stagegl/lib/materials/methods/SpecularBasicMethod");var d=t("awayjs-stagegl/lib/materials/passes/MaterialPassMode");var f=t("awayjs-stagegl/lib/materials/passes/TriangleMethodPass");var _=t("awayjs-stagegl/lib/materials/TriangleMaterialBase");var y=t("awayjs-stagegl/lib/materials/TriangleMaterialMode");var g=function(t){r(e,t);function e(e,i,r,a){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=false}if(a===void 0){a=false}t.call(this);this._alphaBlending=false;this._alpha=1;this._ambientMethod=new l;this._diffuseMethod=new u;this._normalMethod=new p;this._specularMethod=new c;this._depthCompareMode=h.LESS_EQUAL;this._materialMode=y.SINGLE_PASS;if(e instanceof s){this.texture=e;this.smooth=i==null?true:false;this.repeat=r;this.mipmap=a}else{this.color=e==null?16777215:Number(e);this.alpha=i==null?1:Number(i)}}Object.defineProperty(e.prototype,"materialMode",{get:function(){return this._materialMode},set:function(t){if(this._materialMode==t)return;this._materialMode=t;this._pInvalidateScreenPasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"depthCompareMode",{get:function(){return this._depthCompareMode},set:function(t){if(this._depthCompareMode==t)return;this._depthCompareMode=t;this._pInvalidateScreenPasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){if(t>1)t=1;else if(t<0)t=0;if(this._alpha==t)return;
this._alpha=t;if(this._colorTransform==null)this._colorTransform=new a;this._colorTransform.alphaMultiplier=t;this._pInvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"colorTransform",{get:function(){return this._screenPass.colorTransform},set:function(t){this._screenPass.colorTransform=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"diffuseTexture",{get:function(){return this._diffuseMethod.texture},set:function(t){this._diffuseMethod.texture=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"ambientMethod",{get:function(){return this._ambientMethod},set:function(t){if(this._ambientMethod==t)return;if(t&&this._ambientMethod)t.copyFrom(this._ambientMethod);this._ambientMethod=t;this._pInvalidateScreenPasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"shadowMethod",{get:function(){return this._shadowMethod},set:function(t){if(this._shadowMethod==t)return;if(t&&this._shadowMethod)t.copyFrom(this._shadowMethod);this._shadowMethod=t;this._pInvalidateScreenPasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"diffuseMethod",{get:function(){return this._diffuseMethod},set:function(t){if(this._diffuseMethod==t)return;if(t&&this._diffuseMethod)t.copyFrom(this._diffuseMethod);this._diffuseMethod=t;this._pInvalidateScreenPasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"specularMethod",{get:function(){return this._specularMethod},set:function(t){if(this._specularMethod==t)return;if(t&&this._specularMethod)t.copyFrom(this._specularMethod);this._specularMethod=t;this._pInvalidateScreenPasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"normalMethod",{get:function(){return this._normalMethod},set:function(t){if(this._normalMethod==t)return;if(t&&this._normalMethod)t.copyFrom(this._normalMethod);this._normalMethod=t;this._pInvalidateScreenPasses()},enumerable:true,configurable:true});e.prototype.addEffectMethod=function(t){if(this._screenPass==null)this._screenPass=new f;this._screenPass.addEffectMethod(t);this._pInvalidateScreenPasses()};Object.defineProperty(e.prototype,"numEffectMethods",{get:function(){return this._screenPass?this._screenPass.numEffectMethods:0},enumerable:true,configurable:true});e.prototype.hasEffectMethod=function(t){return this._screenPass?this._screenPass.hasEffectMethod(t):false};e.prototype.getEffectMethodAt=function(t){if(this._screenPass==null)return null;return this._screenPass.getEffectMethodAt(t)};e.prototype.addEffectMethodAt=function(t,e){if(this._screenPass==null)this._screenPass=new f;this._screenPass.addEffectMethodAt(t,e);this._pInvalidatePasses()};e.prototype.removeEffectMethod=function(t){if(this._screenPass==null)return;this._screenPass.removeEffectMethod(t);if(this._screenPass.numEffectMethods==0)this._pInvalidatePasses()};Object.defineProperty(e.prototype,"normalMap",{get:function(){return this._normalMethod.normalMap},set:function(t){this._normalMethod.normalMap=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"specularMap",{get:function(){return this._specularMethod.texture},set:function(t){this._specularMethod.texture=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"gloss",{get:function(){return this._specularMethod.gloss},set:function(t){this._specularMethod.gloss=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"ambient",{get:function(){return this._ambientMethod.ambient},set:function(t){this._ambientMethod.ambient=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"specular",{get:function(){return this._specularMethod.specular},set:function(t){this._specularMethod.specular=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"ambientColor",{get:function(){return this._diffuseMethod.ambientColor},set:function(t){this._diffuseMethod.ambientColor=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"diffuseColor",{get:function(){return this._diffuseMethod.diffuseColor},set:function(t){this._diffuseMethod.diffuseColor=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"specularColor",{get:function(){return this._specularMethod.specularColor},set:function(t){this._specularMethod.specularColor=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"alphaBlending",{get:function(){return this._alphaBlending},set:function(t){if(this._alphaBlending==t)return;this._alphaBlending=t;this._pInvalidatePasses()},enumerable:true,configurable:true});e.prototype._iUpdateMaterial=function(){if(this._pScreenPassesInvalid){this._pScreenPassesInvalid=false;this.initPasses();this.setBlendAndCompareModes();this._pClearScreenPasses();if(this._materialMode==y.MULTI_PASS){if(this._casterLightPass)this._pAddScreenPass(this._casterLightPass);if(this._nonCasterLightPasses)for(var t=0;t<this._nonCasterLightPasses.length;++t)this._pAddScreenPass(this._nonCasterLightPasses[t])}if(this._screenPass)this._pAddScreenPass(this._screenPass)}};e.prototype.initPasses=function(){if(this.numLights==0||this.numEffectMethods>0||this._materialMode==y.SINGLE_PASS)this.initEffectPass();else if(this._screenPass)this.removeEffectPass();if(this._shadowMethod&&this._materialMode==y.MULTI_PASS)this.initCasterLightPass();else if(this._casterLightPass)this.removeCasterLightPass();if(this.numNonCasters>0&&this._materialMode==y.MULTI_PASS)this.initNonCasterLightPasses();else if(this._nonCasterLightPasses)this.removeNonCasterLightPasses()};e.prototype.setBlendAndCompareModes=function(){var t=Boolean(this._casterLightPass||this._screenPass);if(this._casterLightPass){this._casterLightPass.forceSeparateMVP=t;this._casterLightPass.setBlendMode(n.NORMAL);this._casterLightPass.depthCompareMode=this._depthCompareMode}if(this._nonCasterLightPasses){var e=0;if(!this._casterLightPass){this._nonCasterLightPasses[0].forceSeparateMVP=t;this._nonCasterLightPasses[0].setBlendMode(n.NORMAL);this._nonCasterLightPasses[0].depthCompareMode=this._depthCompareMode;e=1}for(var i=e;i<this._nonCasterLightPasses.length;++i){this._nonCasterLightPasses[i].forceSeparateMVP=t;this._nonCasterLightPasses[i].setBlendMode(n.ADD);this._nonCasterLightPasses[i].depthCompareMode=h.LESS_EQUAL}}if(this._casterLightPass||this._nonCasterLightPasses){this._pRequiresBlending=false;if(this._screenPass){this._screenPass.passMode=d.EFFECTS;this._screenPass.depthCompareMode=h.LESS_EQUAL;this._screenPass.setBlendMode(n.LAYER);this._screenPass.forceSeparateMVP=t}}else if(this._screenPass){this._pRequiresBlending=this._pBlendMode!=n.NORMAL||this._alphaBlending||this._colorTransform&&this._colorTransform.alphaMultiplier<1;this._screenPass.passMode=d.SUPER_SHADER;this._screenPass.depthCompareMode=this._depthCompareMode;this._screenPass.preserveAlpha=this._pRequiresBlending;this._screenPass.colorTransform=this._colorTransform;this._screenPass.setBlendMode(this._pBlendMode==n.NORMAL&&this._pRequiresBlending?n.LAYER:this._pBlendMode);this._screenPass.forceSeparateMVP=false}};e.prototype.initCasterLightPass=function(){if(this._casterLightPass==null)this._casterLightPass=new f(d.LIGHTING);this._casterLightPass.lightPicker=new o([this._shadowMethod.castingLight]);this._casterLightPass.shadowMethod=this._shadowMethod;this._casterLightPass.diffuseMethod=this._diffuseMethod;this._casterLightPass.ambientMethod=this._ambientMethod;this._casterLightPass.normalMethod=this._normalMethod;this._casterLightPass.specularMethod=this._specularMethod};e.prototype.removeCasterLightPass=function(){this._casterLightPass.dispose();this._pRemoveScreenPass(this._casterLightPass);this._casterLightPass=null};e.prototype.initNonCasterLightPasses=function(){this.removeNonCasterLightPasses();var t;var e=this._pLightPicker.numDirectionalLights;var i=this._pLightPicker.numPointLights;var r=this._pLightPicker.numLightProbes;var a=0;var s=0;var n=0;if(!this._casterLightPass){e+=this._pLightPicker.numCastingDirectionalLights;i+=this._pLightPicker.numCastingPointLights}this._nonCasterLightPasses=new Array;while(a<e||s<i||n<r){t=new f(d.LIGHTING);t.includeCasters=this._shadowMethod==null;t.directionalLightsOffset=a;t.pointLightsOffset=s;t.lightProbesOffset=n;t.lightPicker=this._pLightPicker;t.diffuseMethod=this._diffuseMethod;t.ambientMethod=this._ambientMethod;t.normalMethod=this._normalMethod;t.specularMethod=this._specularMethod;this._nonCasterLightPasses.push(t);a+=t.iNumDirectionalLights;s+=t.iNumPointLights;n+=t.iNumLightProbes}};e.prototype.removeNonCasterLightPasses=function(){if(!this._nonCasterLightPasses)return;for(var t=0;t<this._nonCasterLightPasses.length;++t)this._pRemoveScreenPass(this._nonCasterLightPasses[t]);this._nonCasterLightPasses=null};e.prototype.removeEffectPass=function(){if(this._screenPass.ambientMethod!=this._ambientMethod)this._screenPass.ambientMethod.dispose();if(this._screenPass.diffuseMethod!=this._diffuseMethod)this._screenPass.diffuseMethod.dispose();if(this._screenPass.specularMethod!=this._specularMethod)this._screenPass.specularMethod.dispose();if(this._screenPass.normalMethod!=this._normalMethod)this._screenPass.normalMethod.dispose();this._pRemoveScreenPass(this._screenPass);this._screenPass=null};e.prototype.initEffectPass=function(){if(this._screenPass==null)this._screenPass=new f;if(this._materialMode==y.SINGLE_PASS){this._screenPass.ambientMethod=this._ambientMethod;this._screenPass.diffuseMethod=this._diffuseMethod;this._screenPass.specularMethod=this._specularMethod;this._screenPass.normalMethod=this._normalMethod;this._screenPass.shadowMethod=this._shadowMethod}else if(this._materialMode==y.MULTI_PASS){if(this.numLights==0){this._screenPass.ambientMethod=this._ambientMethod}else{this._screenPass.ambientMethod=null}this._screenPass.preserveAlpha=false;this._screenPass.normalMethod=this._normalMethod}};Object.defineProperty(e.prototype,"numLights",{get:function(){return this._pLightPicker?this._pLightPicker.numLightProbes+this._pLightPicker.numDirectionalLights+this._pLightPicker.numPointLights+this._pLightPicker.numCastingDirectionalLights+this._pLightPicker.numCastingPointLights:0},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numNonCasters",{get:function(){return this._pLightPicker?this._pLightPicker.numLightProbes+this._pLightPicker.numDirectionalLights+this._pLightPicker.numPointLights:0},enumerable:true,configurable:true});return e}(_);e.exports=g},{"awayjs-core/lib/geom/ColorTransform":undefined,"awayjs-core/lib/textures/Texture2DBase":undefined,"awayjs-display/lib/base/BlendMode":undefined,"awayjs-display/lib/materials/lightpickers/StaticLightPicker":undefined,"awayjs-stagegl/lib/base/ContextGLCompareMode":undefined,"awayjs-stagegl/lib/materials/TriangleMaterialBase":undefined,"awayjs-stagegl/lib/materials/TriangleMaterialMode":undefined,"awayjs-stagegl/lib/materials/methods/AmbientBasicMethod":undefined,"awayjs-stagegl/lib/materials/methods/DiffuseBasicMethod":undefined,"awayjs-stagegl/lib/materials/methods/NormalBasicMethod":undefined,"awayjs-stagegl/lib/materials/methods/SpecularBasicMethod":undefined,"awayjs-stagegl/lib/materials/passes/MaterialPassMode":undefined,"awayjs-stagegl/lib/materials/passes/TriangleMethodPass":undefined}],"awayjs-stagegl/lib/materials/compilation/MethodVO":[function(t,e,i){var r=function(){function t(t){this.useMethod=true;this.method=t}t.prototype.reset=function(){this.method.iReset();this.texturesIndex=-1;this.vertexConstantsIndex=-1;this.fragmentConstantsIndex=-1;this.needsProjection=false;this.needsView=false;this.needsNormals=false;this.needsTangents=false;this.needsUV=false;this.needsSecondaryUV=false;this.needsGlobalVertexPos=false;this.needsGlobalFragmentPos=false};return t}();e.exports=r},{}],"awayjs-stagegl/lib/materials/compilation/RegisterPool":[function(t,e,i){var r=t("awayjs-stagegl/lib/materials/compilation/ShaderRegisterElement");var a=function(){function t(t,e,i){if(i===void 0){i=true}this._regName=t;this._regCount=e;this._persistent=i;this.initRegisters(t,e)}t.prototype.requestFreeVectorReg=function(){for(var t=0;t<this._regCount;++t){if(!this.isRegisterUsed(t)){if(this._persistent)this._usedVectorCount[t]++;return this._vectorRegisters[t]}}throw new Error("Register overflow!")};t.prototype.requestFreeRegComponent=function(){for(var t=0;t<this._regCount;++t){if(this._usedVectorCount[t]>0)continue;for(var e=0;e<4;++e){if(this._usedSingleCount[e][t]==0){if(this._persistent)this._usedSingleCount[e][t]++;return this._registerComponents[e][t]}}}throw new Error("Register overflow!")};t.prototype.addUsage=function(t,e){if(t._component>-1)this._usedSingleCount[t._component][t.index]+=e;else this._usedVectorCount[t.index]+=e};t.prototype.removeUsage=function(t){if(t._component>-1){if(--this._usedSingleCount[t._component][t.index]<0)throw new Error("More usages removed than exist!")}else{if(--this._usedVectorCount[t.index]<0)throw new Error("More usages removed than exist!")}};t.prototype.dispose=function(){this._vectorRegisters=null;this._registerComponents=null;this._usedSingleCount=null;this._usedVectorCount=null};t.prototype.hasRegisteredRegs=function(){for(var t=0;t<this._regCount;++t)if(this.isRegisterUsed(t))return true;return false};t.prototype.initRegisters=function(e,i){var r=t._initPool(e,i);this._vectorRegisters=t._regPool[r];this._registerComponents=t._regCompsPool[r];this._usedVectorCount=this._initArray(Array(i),0);this._usedSingleCount=new Array(4);this._usedSingleCount[0]=this._initArray(new Array(i),0);this._usedSingleCount[1]=this._initArray(new Array(i),0);this._usedSingleCount[2]=this._initArray(new Array(i),0);this._usedSingleCount[3]=this._initArray(new Array(i),0)};t._initPool=function(e,i){var a=e+i;if(t._regPool[a]!=undefined)return a;var s=new Array(i);t._regPool[a]=s;var n=[[],[],[],[]];t._regCompsPool[a]=n;for(var o=0;o<i;++o){s[o]=new r(e,o);for(var h=0;h<4;++h)n[h][o]=new r(e,o,h)}return a};t.prototype.isRegisterUsed=function(t){if(this._usedVectorCount[t]>0)return true;for(var e=0;e<4;++e)if(this._usedSingleCount[e][t]>0)return true;return false};t.prototype._initArray=function(t,e){var i=t.length;for(var r=0;r<i;r++)t[r]=e;return t};t._regPool=new Object;t._regCompsPool=new Object;return t}();e.exports=a},{"awayjs-stagegl/lib/materials/compilation/ShaderRegisterElement":undefined}],"awayjs-stagegl/lib/materials/compilation/ShaderCompilerBase":[function(t,e,i){var r=t("awayjs-stagegl/lib/materials/compilation/ShaderRegisterCache");var a=t("awayjs-stagegl/lib/materials/compilation/ShaderRegisterData");var s=t("awayjs-stagegl/lib/materials/passes/MaterialPassMode");var n=function(){function t(t,e,i){this._pVertexCode="";this._pFragmentCode="";this._pPostAnimationFragmentCode="";this._pMaterial=t;this._pMaterialPass=e;this._pShaderObject=i;this._pProfile=i.profile;this._pSharedRegisters=new a;this._pRegisterCache=new r(this._pProfile);this._pRegisterCache.vertexAttributesOffset=1;this._pRegisterCache.reset()}t.prototype.compile=function(){this._pShaderObject.reset();this.pCalculateDependencies();this.pInitRegisterIndices();this.pCompileDependencies();this._pVertexCode+=this._pMaterialPass._iGetVertexCode(this._pShaderObject,this._pRegisterCache,this._pSharedRegisters);this._pPostAnimationFragmentCode+=this._pMaterialPass._iGetFragmentCode(this._pShaderObject,this._pRegisterCache,this._pSharedRegisters);this._pPostAnimationFragmentCode+="mov "+this._pRegisterCache.fragmentOutputRegister+", "+this._pSharedRegisters.shadedTarget+"\n";this._pRegisterCache.removeFragmentTempUsage(this._pSharedRegisters.shadedTarget);this._pShaderObject.initConstantData(this._pRegisterCache,this._pAnimatableAttributes,this._pAnimationTargetRegisters,this._uvSource,this._uvTarget);this._pMaterialPass._iInitConstantData(this._pShaderObject)};t.prototype.pCompileDependencies=function(){this._pSharedRegisters.shadedTarget=this._pRegisterCache.getFreeFragmentVectorTemp();this._pRegisterCache.addFragmentTempUsages(this._pSharedRegisters.shadedTarget,1);if(this._pShaderObject.globalPosDependencies>0)this.compileGlobalPositionCode();if(this._pShaderObject.uvDependencies>0)this.compileUVCode();if(this._pShaderObject.secondaryUVDependencies>0)this.compileSecondaryUVCode();if(this._pShaderObject.normalDependencies>0)this.compileNormalCode();if(this._pShaderObject.viewDirDependencies>0)this.compileViewDirCode();this._pVertexCode+=this._pMaterial._iGetVertexCode(this._pShaderObject,this._pRegisterCache,this._pSharedRegisters);this._pFragmentCode+=this._pMaterial._iGetFragmentCode(this._pShaderObject,this._pRegisterCache,this._pSharedRegisters);this._pVertexCode+=this._pMaterialPass._iGetPreLightingVertexCode(this._pShaderObject,this._pRegisterCache,this._pSharedRegisters);this._pFragmentCode+=this._pMaterialPass._iGetPreLightingFragmentCode(this._pShaderObject,this._pRegisterCache,this._pSharedRegisters)};t.prototype.compileGlobalPositionCode=function(){this._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.globalPositionVertex=this._pRegisterCache.getFreeVertexVectorTemp(),this._pShaderObject.globalPosDependencies);var t=this._pRegisterCache.getFreeVertexConstant();this._pRegisterCache.getFreeVertexConstant();this._pRegisterCache.getFreeVertexConstant();this._pRegisterCache.getFreeVertexConstant();this._pShaderObject.sceneMatrixIndex=t.index*4;this._pVertexCode+="m44 "+this._pSharedRegisters.globalPositionVertex+", "+this._pSharedRegisters.localPosition+", "+t+"\n";if(this._pShaderObject.usesGlobalPosFragment){this._pSharedRegisters.globalPositionVarying=this._pRegisterCache.getFreeVarying();this._pVertexCode+="mov "+this._pSharedRegisters.globalPositionVarying+", "+this._pSharedRegisters.globalPositionVertex+"\n"}};t.prototype.compileUVCode=function(){var t=this._pRegisterCache.getFreeVertexAttribute();this._pShaderObject.uvBufferIndex=t.index;var e=this._pRegisterCache.getFreeVarying();this._pSharedRegisters.uvVarying=e;if(this._pShaderObject.usesUVTransform){var i=this._pRegisterCache.getFreeVertexConstant();var r=this._pRegisterCache.getFreeVertexConstant();this._pShaderObject.uvTransformIndex=i.index*4;this._pVertexCode+="dp4 "+e+".x, "+t+", "+i+"\n"+"dp4 "+e+".y, "+t+", "+r+"\n"+"mov "+e+".zw, "+t+".zw \n"}else{this._pShaderObject.uvTransformIndex=-1;this._uvTarget=e.toString();this._uvSource=t.toString()}};t.prototype.compileSecondaryUVCode=function(){var t=this._pRegisterCache.getFreeVertexAttribute();this._pShaderObject.secondaryUVBufferIndex=t.index;this._pSharedRegisters.secondaryUVVarying=this._pRegisterCache.getFreeVarying();this._pVertexCode+="mov "+this._pSharedRegisters.secondaryUVVarying+", "+t+"\n"};t.prototype.compileViewDirCode=function(){var t=this._pRegisterCache.getFreeVertexConstant();this._pSharedRegisters.viewDirVarying=this._pRegisterCache.getFreeVarying();this._pSharedRegisters.viewDirFragment=this._pRegisterCache.getFreeFragmentVectorTemp();this._pRegisterCache.addFragmentTempUsages(this._pSharedRegisters.viewDirFragment,this._pShaderObject.viewDirDependencies);this._pShaderObject.cameraPositionIndex=t.index*4;if(this._pShaderObject.usesTangentSpace){var e=this._pRegisterCache.getFreeVertexVectorTemp();this._pVertexCode+="sub "+e+", "+t+", "+this._pSharedRegisters.localPosition+"\n"+"m33 "+this._pSharedRegisters.viewDirVarying+".xyz, "+e+", "+this._pSharedRegisters.animatedTangent+"\n"+"mov "+this._pSharedRegisters.viewDirVarying+".w, "+this._pSharedRegisters.localPosition+".w\n"}else{this._pVertexCode+="sub "+this._pSharedRegisters.viewDirVarying+", "+t+", "+this._pSharedRegisters.globalPositionVertex+"\n";this._pRegisterCache.removeVertexTempUsage(this._pSharedRegisters.globalPositionVertex)}this._pFragmentCode+="nrm "+this._pSharedRegisters.viewDirFragment+".xyz, "+this._pSharedRegisters.viewDirVarying+"\n"+"mov "+this._pSharedRegisters.viewDirFragment+".w,   "+this._pSharedRegisters.viewDirVarying+".w\n"};t.prototype.compileNormalCode=function(){this._pSharedRegisters.normalFragment=this._pRegisterCache.getFreeFragmentVectorTemp();this._pRegisterCache.addFragmentTempUsages(this._pSharedRegisters.normalFragment,this._pShaderObject.normalDependencies);if(this._pShaderObject.outputsNormals&&!this._pShaderObject.outputsTangentNormals){this._pVertexCode+=this._pMaterialPass._iGetNormalVertexCode(this._pShaderObject,this._pRegisterCache,this._pSharedRegisters);this._pFragmentCode+=this._pMaterialPass._iGetNormalFragmentCode(this._pShaderObject,this._pRegisterCache,this._pSharedRegisters);return}var t;if(!this._pShaderObject.outputsNormals||!this._pShaderObject.usesTangentSpace){t=new Array(3);t[0]=this._pRegisterCache.getFreeVertexConstant();t[1]=this._pRegisterCache.getFreeVertexConstant();t[2]=this._pRegisterCache.getFreeVertexConstant();this._pRegisterCache.getFreeVertexConstant();this._pShaderObject.sceneNormalMatrixIndex=t[0].index*4;this._pSharedRegisters.normalVarying=this._pRegisterCache.getFreeVarying()}if(this._pShaderObject.outputsNormals){if(this._pShaderObject.usesTangentSpace){this._pVertexCode+="nrm "+this._pSharedRegisters.animatedNormal+".xyz, "+this._pSharedRegisters.animatedNormal+"\n"+"nrm "+this._pSharedRegisters.animatedTangent+".xyz, "+this._pSharedRegisters.animatedTangent+"\n"+"crs "+this._pSharedRegisters.bitangent+".xyz, "+this._pSharedRegisters.animatedNormal+", "+this._pSharedRegisters.animatedTangent+"\n";this._pFragmentCode+=this._pMaterialPass._iGetNormalFragmentCode(this._pShaderObject,this._pRegisterCache,this._pSharedRegisters)}else{this._pSharedRegisters.tangentVarying=this._pRegisterCache.getFreeVarying();this._pSharedRegisters.bitangentVarying=this._pRegisterCache.getFreeVarying();var e=this._pRegisterCache.getFreeVertexVectorTemp();this._pVertexCode+="m33 "+e+".xyz, "+this._pSharedRegisters.animatedNormal+", "+t[0]+"\n"+"nrm "+this._pSharedRegisters.animatedNormal+".xyz, "+e+"\n"+"m33 "+e+".xyz, "+this._pSharedRegisters.animatedTangent+", "+t[0]+"\n"+"nrm "+this._pSharedRegisters.animatedTangent+".xyz, "+e+"\n"+"mov "+this._pSharedRegisters.tangentVarying+".x, "+this._pSharedRegisters.animatedTangent+".x  \n"+"mov "+this._pSharedRegisters.tangentVarying+".z, "+this._pSharedRegisters.animatedNormal+".x  \n"+"mov "+this._pSharedRegisters.tangentVarying+".w, "+this._pSharedRegisters.normalInput+".w  \n"+"mov "+this._pSharedRegisters.bitangentVarying+".x, "+this._pSharedRegisters.animatedTangent+".y  \n"+"mov "+this._pSharedRegisters.bitangentVarying+".z, "+this._pSharedRegisters.animatedNormal+".y  \n"+"mov "+this._pSharedRegisters.bitangentVarying+".w, "+this._pSharedRegisters.normalInput+".w  \n"+"mov "+this._pSharedRegisters.normalVarying+".x, "+this._pSharedRegisters.animatedTangent+".z  \n"+"mov "+this._pSharedRegisters.normalVarying+".z, "+this._pSharedRegisters.animatedNormal+".z  \n"+"mov "+this._pSharedRegisters.normalVarying+".w, "+this._pSharedRegisters.normalInput+".w  \n"+"crs "+e+".xyz, "+this._pSharedRegisters.animatedNormal+", "+this._pSharedRegisters.animatedTangent+"\n"+"mov "+this._pSharedRegisters.tangentVarying+".y, "+e+".x    \n"+"mov "+this._pSharedRegisters.bitangentVarying+".y, "+e+".y  \n"+"mov "+this._pSharedRegisters.normalVarying+".y, "+e+".z    \n";this._pRegisterCache.removeVertexTempUsage(this._pSharedRegisters.animatedTangent);var i;var r;var a;i=this._pRegisterCache.getFreeFragmentVectorTemp();this._pRegisterCache.addFragmentTempUsages(i,1);r=this._pRegisterCache.getFreeFragmentVectorTemp();this._pRegisterCache.addFragmentTempUsages(r,1);a=this._pRegisterCache.getFreeFragmentVectorTemp();this._pRegisterCache.addFragmentTempUsages(a,1);this._pFragmentCode+="nrm "+i+".xyz, "+this._pSharedRegisters.tangentVarying+"\n"+"mov "+i+".w, "+this._pSharedRegisters.tangentVarying+".w	\n"+"nrm "+r+".xyz, "+this._pSharedRegisters.bitangentVarying+"\n"+"nrm "+a+".xyz, "+this._pSharedRegisters.normalVarying+"\n";this._pFragmentCode+=this._pMaterialPass._iGetNormalFragmentCode(this._pShaderObject,this._pRegisterCache,this._pSharedRegisters)+"m33 "+this._pSharedRegisters.normalFragment+".xyz, "+this._pSharedRegisters.normalFragment+", "+i+"\n"+"mov "+this._pSharedRegisters.normalFragment+".w, "+this._pSharedRegisters.normalVarying+".w\n";this._pRegisterCache.removeFragmentTempUsage(r);this._pRegisterCache.removeFragmentTempUsage(i);this._pRegisterCache.removeFragmentTempUsage(a)}}else{this._pVertexCode+="m33 "+this._pSharedRegisters.normalVarying+".xyz, "+this._pSharedRegisters.animatedNormal+", "+t[0]+"\n"+"mov "+this._pSharedRegisters.normalVarying+".w, "+this._pSharedRegisters.animatedNormal+".w\n";this._pFragmentCode+="nrm "+this._pSharedRegisters.normalFragment+".xyz, "+this._pSharedRegisters.normalVarying+"\n"+"mov "+this._pSharedRegisters.normalFragment+".w, "+this._pSharedRegisters.normalVarying+".w\n";if(this._pShaderObject.tangentDependencies>0){this._pSharedRegisters.tangentVarying=this._pRegisterCache.getFreeVarying();this._pVertexCode+="m33 "+this._pSharedRegisters.tangentVarying+".xyz, "+this._pSharedRegisters.animatedTangent+", "+t[0]+"\n"+"mov "+this._pSharedRegisters.tangentVarying+".w, "+this._pSharedRegisters.animatedTangent+".w\n"}}if(!this._pShaderObject.usesTangentSpace)this._pRegisterCache.removeVertexTempUsage(this._pSharedRegisters.animatedNormal)};t.prototype.pInitRegisterIndices=function(){this._pShaderObject.pInitRegisterIndices();this._pAnimatableAttributes=new Array("va0");this._pAnimationTargetRegisters=new Array("vt0");this._pVertexCode="";this._pFragmentCode="";this._pPostAnimationFragmentCode="";this._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.localPosition=this._pRegisterCache.getFreeVertexVectorTemp(),1);this._pSharedRegisters.commons=this._pRegisterCache.getFreeFragmentConstant();this._pShaderObject.commonsDataIndex=this._pSharedRegisters.commons.index*4;if(this._pShaderObject.tangentDependencies>0||this._pShaderObject.outputsNormals){this._pSharedRegisters.tangentInput=this._pRegisterCache.getFreeVertexAttribute();this._pShaderObject.tangentBufferIndex=this._pSharedRegisters.tangentInput.index;this._pSharedRegisters.animatedTangent=this._pRegisterCache.getFreeVertexVectorTemp();this._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.animatedTangent,1);if(this._pShaderObject.usesTangentSpace){this._pSharedRegisters.bitangent=this._pRegisterCache.getFreeVertexVectorTemp();this._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.bitangent,1)}this._pAnimatableAttributes.push(this._pSharedRegisters.tangentInput.toString());this._pAnimationTargetRegisters.push(this._pSharedRegisters.animatedTangent.toString())}if(this._pShaderObject.normalDependencies>0){this._pSharedRegisters.normalInput=this._pRegisterCache.getFreeVertexAttribute();this._pShaderObject.normalBufferIndex=this._pSharedRegisters.normalInput.index;this._pSharedRegisters.animatedNormal=this._pRegisterCache.getFreeVertexVectorTemp();this._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.animatedNormal,1);this._pAnimatableAttributes.push(this._pSharedRegisters.normalInput.toString());this._pAnimationTargetRegisters.push(this._pSharedRegisters.animatedNormal.toString())}};t.prototype.pCalculateDependencies=function(){this._pShaderObject.useAlphaPremultiplied=this._pMaterial.alphaPremultiplied;this._pShaderObject.useBothSides=this._pMaterial.bothSides;this._pShaderObject.useMipmapping=this._pMaterial.mipmap;this._pShaderObject.useSmoothTextures=this._pMaterial.smooth;this._pShaderObject.repeatTextures=this._pMaterial.repeat;this._pShaderObject.usesUVTransform=this._pMaterial.animateUVs;this._pShaderObject.alphaThreshold=this._pMaterial.alphaThreshold;this._pShaderObject.texture=this._pMaterial.texture;this._pShaderObject.color=this._pMaterial.color;this._pShaderObject.usesFragmentAnimation=Boolean(this._pMaterialPass.passMode==s.SUPER_SHADER);this._pMaterialPass._iIncludeDependencies(this._pShaderObject)};t.prototype.dispose=function(){this._pRegisterCache.dispose();this._pRegisterCache=null;this._pSharedRegisters=null};Object.defineProperty(t.prototype,"vertexCode",{get:function(){return this._pVertexCode},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"fragmentCode",{get:function(){return this._pFragmentCode},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"postAnimationFragmentCode",{get:function(){return this._pPostAnimationFragmentCode},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"shadedTarget",{get:function(){return this._pSharedRegisters.shadedTarget.toString()},enumerable:true,configurable:true});return t}();e.exports=n},{"awayjs-stagegl/lib/materials/compilation/ShaderRegisterCache":undefined,"awayjs-stagegl/lib/materials/compilation/ShaderRegisterData":undefined,"awayjs-stagegl/lib/materials/passes/MaterialPassMode":undefined}],"awayjs-stagegl/lib/materials/compilation/ShaderLightingCompiler":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/materials/LightSources");var s=t("awayjs-stagegl/lib/base/ContextGLProfile");var n=t("awayjs-stagegl/lib/materials/compilation/ShaderCompilerBase");var o=function(t){r(e,t);function e(e,i,r){t.call(this,e,i,r);this._materialLightingPass=i;this._shaderLightingObject=r}e.prototype.pCompileDependencies=function(){t.prototype.pCompileDependencies.call(this);if(this._shaderLightingObject.usesShadows)this.pCompileShadowCode();if(this._shaderLightingObject.usesLights){this.initLightRegisters();this.compileLightCode()}if(this._shaderLightingObject.usesProbes)this.compileLightProbeCode();this._pVertexCode+=this._materialLightingPass._iGetPostLightingVertexCode(this._shaderLightingObject,this._pRegisterCache,this._pSharedRegisters);this._pFragmentCode+=this._materialLightingPass._iGetPostLightingFragmentCode(this._shaderLightingObject,this._pRegisterCache,this._pSharedRegisters)};e.prototype.pCompileShadowCode=function(){if(this._shaderLightingObject.normalDependencies>0){this._pSharedRegisters.shadowTarget=this._pSharedRegisters.normalFragment}else{this._pSharedRegisters.shadowTarget=this._pRegisterCache.getFreeFragmentVectorTemp();this._pRegisterCache.addFragmentTempUsages(this._pSharedRegisters.shadowTarget,1)}};e.prototype.initLightRegisters=function(){var t,e;if(this._dirLightVertexConstants){e=this._dirLightVertexConstants.length;for(t=0;t<e;++t){this._dirLightVertexConstants[t]=this._pRegisterCache.getFreeVertexConstant();if(this._shaderLightingObject.lightVertexConstantIndex==-1)this._shaderLightingObject.lightVertexConstantIndex=this._dirLightVertexConstants[t].index*4}}if(this._pointLightVertexConstants){e=this._pointLightVertexConstants.length;for(t=0;t<e;++t){this._pointLightVertexConstants[t]=this._pRegisterCache.getFreeVertexConstant();if(this._shaderLightingObject.lightVertexConstantIndex==-1)this._shaderLightingObject.lightVertexConstantIndex=this._pointLightVertexConstants[t].index*4}}e=this._dirLightFragmentConstants.length;for(t=0;t<e;++t){this._dirLightFragmentConstants[t]=this._pRegisterCache.getFreeFragmentConstant();if(this._shaderLightingObject.lightFragmentConstantIndex==-1)this._shaderLightingObject.lightFragmentConstantIndex=this._dirLightFragmentConstants[t].index*4}e=this._pointLightFragmentConstants.length;for(t=0;t<e;++t){this._pointLightFragmentConstants[t]=this._pRegisterCache.getFreeFragmentConstant();if(this._shaderLightingObject.lightFragmentConstantIndex==-1)this._shaderLightingObject.lightFragmentConstantIndex=this._pointLightFragmentConstants[t].index*4}};e.prototype.compileLightCode=function(){var t;var e;var i;var r;var a=0;var s=0;var n=this._shaderLightingObject.usesLightsForSpecular;var o=this._shaderLightingObject.usesLightsForDiffuse;for(var h=0;h<this._materialLightingPass.iNumDirectionalLights;++h){if(this._shaderLightingObject.usesTangentSpace){r=this._dirLightVertexConstants[a++];var l=this._pRegisterCache.getFreeVarying();this._pVertexCode+="m33 "+l+".xyz, "+r+", "+this._pSharedRegisters.animatedTangent+"\n"+"mov "+l+".w, "+r+".w\n";
r=this._pRegisterCache.getFreeFragmentVectorTemp();this._pRegisterCache.addVertexTempUsages(r,1);this._pFragmentCode+="nrm "+r+".xyz, "+l+"\n"+"mov "+r+".w, "+l+".w\n"}else{r=this._dirLightFragmentConstants[s++]}t=this._dirLightFragmentConstants[s++];e=this._dirLightFragmentConstants[s++];if(o)this._pFragmentCode+=this._materialLightingPass._iGetPerLightDiffuseFragmentCode(this._shaderLightingObject,r,t,this._pRegisterCache,this._pSharedRegisters);if(n)this._pFragmentCode+=this._materialLightingPass._iGetPerLightSpecularFragmentCode(this._shaderLightingObject,r,e,this._pRegisterCache,this._pSharedRegisters);if(this._shaderLightingObject.usesTangentSpace)this._pRegisterCache.removeVertexTempUsage(r)}a=0;s=0;for(var h=0;h<this._materialLightingPass.iNumPointLights;++h){if(this._shaderLightingObject.usesTangentSpace||!this._shaderLightingObject.usesGlobalPosFragment)i=this._pointLightVertexConstants[a++];else i=this._pointLightFragmentConstants[s++];t=this._pointLightFragmentConstants[s++];e=this._pointLightFragmentConstants[s++];r=this._pRegisterCache.getFreeFragmentVectorTemp();this._pRegisterCache.addFragmentTempUsages(r,1);var l;if(this._shaderLightingObject.usesTangentSpace){l=this._pRegisterCache.getFreeVarying();var u=this._pRegisterCache.getFreeVertexVectorTemp();this._pVertexCode+="sub "+u+", "+i+", "+this._pSharedRegisters.localPosition+"\n"+"m33 "+l+".xyz, "+u+", "+this._pSharedRegisters.animatedTangent+"\n"+"mov "+l+".w, "+this._pSharedRegisters.localPosition+".w\n"}else if(!this._shaderLightingObject.usesGlobalPosFragment){l=this._pRegisterCache.getFreeVarying();this._pVertexCode+="sub "+l+", "+i+", "+this._pSharedRegisters.globalPositionVertex+"\n"}else{l=r;this._pFragmentCode+="sub "+r+", "+i+", "+this._pSharedRegisters.globalPositionVarying+"\n"}if(this._shaderLightingObject.usesLightFallOff){this._pFragmentCode+="dp3 "+r+".w, "+l+", "+l+"\n"+"sub "+r+".w, "+r+".w, "+t+".w\n"+"mul "+r+".w, "+r+".w, "+e+".w\n"+"sat "+r+".w, "+r+".w\n"+"sub "+r+".w, "+this._pSharedRegisters.commons+".w, "+r+".w\n"+"nrm "+r+".xyz, "+l+"\n"}else{this._pFragmentCode+="nrm "+r+".xyz, "+l+"\n"+"mov "+r+".w, "+l+".w\n"}if(this._shaderLightingObject.lightFragmentConstantIndex==-1)this._shaderLightingObject.lightFragmentConstantIndex=i.index*4;if(o)this._pFragmentCode+=this._materialLightingPass._iGetPerLightDiffuseFragmentCode(this._shaderLightingObject,r,t,this._pRegisterCache,this._pSharedRegisters);if(n)this._pFragmentCode+=this._materialLightingPass._iGetPerLightSpecularFragmentCode(this._shaderLightingObject,r,e,this._pRegisterCache,this._pSharedRegisters);this._pRegisterCache.removeFragmentTempUsage(r)}};e.prototype.compileLightProbeCode=function(){var t;var e=[".x",".y",".z",".w"];var i=new Array;var r;var a;var s=this._shaderLightingObject.usesProbesForSpecular;var n=this._shaderLightingObject.usesProbesForDiffuse;if(n)this._shaderLightingObject.lightProbeDiffuseIndices=new Array;if(s)this._shaderLightingObject.lightProbeSpecularIndices=new Array;for(r=0;r<this._pNumProbeRegisters;++r){i[r]=this._pRegisterCache.getFreeFragmentConstant();if(r==0)this._shaderLightingObject.probeWeightsIndex=i[r].index*4}for(r=0;r<this._materialLightingPass.iNumLightProbes;++r){t=i[Math.floor(r/4)].toString()+e[r%4];if(n){a=this._pRegisterCache.getFreeTextureReg();this._shaderLightingObject.lightProbeDiffuseIndices[r]=a.index;this._pFragmentCode+=this._materialLightingPass._iGetPerProbeDiffuseFragmentCode(this._shaderLightingObject,a,t,this._pRegisterCache,this._pSharedRegisters)}if(s){a=this._pRegisterCache.getFreeTextureReg();this._shaderLightingObject.lightProbeSpecularIndices[r]=a.index;this._pFragmentCode+=this._materialLightingPass._iGetPerProbeSpecularFragmentCode(this._shaderLightingObject,a,t,this._pRegisterCache,this._pSharedRegisters)}}};e.prototype.pInitRegisterIndices=function(){t.prototype.pInitRegisterIndices.call(this);this._shaderLightingObject.lightVertexConstantIndex=-1;this._shaderLightingObject.lightFragmentConstantIndex=-1;this._shaderLightingObject.probeWeightsIndex=-1;this._pNumProbeRegisters=Math.ceil(this._materialLightingPass.iNumLightProbes/4);if(this._shaderLightingObject.usesTangentSpace||!this._shaderLightingObject.usesGlobalPosFragment){this._pointLightVertexConstants=new Array(this._materialLightingPass.iNumPointLights);this._pointLightFragmentConstants=new Array(this._materialLightingPass.iNumPointLights*2)}else{this._pointLightFragmentConstants=new Array(this._materialLightingPass.iNumPointLights*3)}if(this._shaderLightingObject.usesTangentSpace){this._dirLightVertexConstants=new Array(this._materialLightingPass.iNumDirectionalLights);this._dirLightFragmentConstants=new Array(this._materialLightingPass.iNumDirectionalLights*2)}else{this._dirLightFragmentConstants=new Array(this._materialLightingPass.iNumDirectionalLights*3)}};e.prototype.pCalculateDependencies=function(){var e=this._materialLightingPass.iNumPointLights+this._materialLightingPass.iNumDirectionalLights;var i=this._materialLightingPass.iNumLightProbes;var r=this._pMaterial.diffuseLightSources;var n=this._materialLightingPass._iUsesSpecular()?this._pMaterial.specularLightSources:0;var o=r|n;this._shaderLightingObject.usesLightFallOff=this._pMaterial.enableLightFallOff&&this._shaderLightingObject.profile!=s.BASELINE_CONSTRAINED;this._shaderLightingObject.numLights=e+i;this._shaderLightingObject.numPointLights=this._materialLightingPass.iNumPointLights;this._shaderLightingObject.numDirectionalLights=this._materialLightingPass.iNumDirectionalLights;this._shaderLightingObject.numLightProbes=i;this._shaderLightingObject.pointLightsOffset=this._materialLightingPass.pointLightsOffset;this._shaderLightingObject.directionalLightsOffset=this._materialLightingPass.directionalLightsOffset;this._shaderLightingObject.lightProbesOffset=this._materialLightingPass.lightProbesOffset;this._shaderLightingObject.lightPicker=this._materialLightingPass.lightPicker;this._shaderLightingObject.usesLights=e>0&&(o&a.LIGHTS)!=0;this._shaderLightingObject.usesProbes=i>0&&(o&a.PROBES)!=0;this._shaderLightingObject.usesLightsForSpecular=e>0&&(n&a.LIGHTS)!=0;this._shaderLightingObject.usesProbesForSpecular=i>0&&(n&a.PROBES)!=0;this._shaderLightingObject.usesLightsForDiffuse=e>0&&(r&a.LIGHTS)!=0;this._shaderLightingObject.usesProbesForDiffuse=i>0&&(r&a.PROBES)!=0;this._shaderLightingObject.usesShadows=this._materialLightingPass._iUsesShadows();t.prototype.pCalculateDependencies.call(this)};return e}(n);e.exports=o},{"awayjs-display/lib/materials/LightSources":undefined,"awayjs-stagegl/lib/base/ContextGLProfile":undefined,"awayjs-stagegl/lib/materials/compilation/ShaderCompilerBase":undefined}],"awayjs-stagegl/lib/materials/compilation/ShaderLightingObject":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/compilation/ShaderLightingCompiler");var s=t("awayjs-stagegl/lib/materials/compilation/ShaderObjectBase");var n=function(t){r(e,t);function e(e){t.call(this,e)}e.prototype.createCompiler=function(t,e){return new a(t,e,this)};e.prototype.reset=function(){t.prototype.reset.call(this);this.numLights=0;this.usesLightFallOff=true};e.prototype.addWorldSpaceDependencies=function(e){t.prototype.addWorldSpaceDependencies.call(this,e);if(this.numPointLights>0&&this.usesLights){++this.globalPosDependencies;if(e)this.usesGlobalPosFragment=true}};e.prototype.setRenderState=function(e,i,r,a){t.prototype.setRenderState.call(this,e,i,r,a);if(this.usesLights)this.updateLights();if(this.usesProbes)this.updateProbes(i)};e.prototype.updateLights=function(){var t;var e;var i=0;var r=0;var a;var s;var n=0;var o=this.usesShadows?2:1;var h;var l;this.ambientR=this.ambientG=this.ambientB=0;h=this.lightVertexConstantIndex;r=this.lightFragmentConstantIndex;var u=0;var p=this.lightPicker.directionalLights;l=this.directionalLightsOffset;a=this.lightPicker.directionalLights.length;if(l>a){u=1;l-=a}for(;u<o;++u){if(u)p=this.lightPicker.castingDirectionalLights;a=p.length;if(a>this.numDirectionalLights)a=this.numDirectionalLights;for(i=0;i<a;++i){t=p[l+i];s=t.sceneDirection;this.ambientR+=t._iAmbientR;this.ambientG+=t._iAmbientG;this.ambientB+=t._iAmbientB;if(this.usesTangentSpace){var c=-s.x;var d=-s.y;var f=-s.z;this.vertexConstantData[h++]=this._pInverseSceneMatrix[0]*c+this._pInverseSceneMatrix[4]*d+this._pInverseSceneMatrix[8]*f;this.vertexConstantData[h++]=this._pInverseSceneMatrix[1]*c+this._pInverseSceneMatrix[5]*d+this._pInverseSceneMatrix[9]*f;this.vertexConstantData[h++]=this._pInverseSceneMatrix[2]*c+this._pInverseSceneMatrix[6]*d+this._pInverseSceneMatrix[10]*f;this.vertexConstantData[h++]=1}else{this.fragmentConstantData[r++]=-s.x;this.fragmentConstantData[r++]=-s.y;this.fragmentConstantData[r++]=-s.z;this.fragmentConstantData[r++]=1}this.fragmentConstantData[r++]=t._iDiffuseR;this.fragmentConstantData[r++]=t._iDiffuseG;this.fragmentConstantData[r++]=t._iDiffuseB;this.fragmentConstantData[r++]=1;this.fragmentConstantData[r++]=t._iSpecularR;this.fragmentConstantData[r++]=t._iSpecularG;this.fragmentConstantData[r++]=t._iSpecularB;this.fragmentConstantData[r++]=1;if(++n==this.numDirectionalLights){i=a;u=o}}}if(this.numDirectionalLights>n){i=r+(this.numDirectionalLights-n)*12;while(r<i)this.fragmentConstantData[r++]=0}n=0;var _=this.lightPicker.pointLights;l=this.pointLightsOffset;a=this.lightPicker.pointLights.length;if(l>a){u=1;l-=a}else{u=0}for(;u<o;++u){if(u)_=this.lightPicker.castingPointLights;a=_.length;for(i=0;i<a;++i){e=_[l+i];s=e.scenePosition;this.ambientR+=e._iAmbientR;this.ambientG+=e._iAmbientG;this.ambientB+=e._iAmbientB;if(this.usesTangentSpace){c=s.x;d=s.y;f=s.z;this.vertexConstantData[h++]=this._pInverseSceneMatrix[0]*c+this._pInverseSceneMatrix[4]*d+this._pInverseSceneMatrix[8]*f+this._pInverseSceneMatrix[12];this.vertexConstantData[h++]=this._pInverseSceneMatrix[1]*c+this._pInverseSceneMatrix[5]*d+this._pInverseSceneMatrix[9]*f+this._pInverseSceneMatrix[13];this.vertexConstantData[h++]=this._pInverseSceneMatrix[2]*c+this._pInverseSceneMatrix[6]*d+this._pInverseSceneMatrix[10]*f+this._pInverseSceneMatrix[14];this.vertexConstantData[h++]=1}else if(!this.usesGlobalPosFragment){this.vertexConstantData[h++]=s.x;this.vertexConstantData[h++]=s.y;this.vertexConstantData[h++]=s.z;this.vertexConstantData[h++]=1}else{this.fragmentConstantData[r++]=s.x;this.fragmentConstantData[r++]=s.y;this.fragmentConstantData[r++]=s.z;this.fragmentConstantData[r++]=1}this.fragmentConstantData[r++]=e._iDiffuseR;this.fragmentConstantData[r++]=e._iDiffuseG;this.fragmentConstantData[r++]=e._iDiffuseB;var y=e._pRadius;this.fragmentConstantData[r++]=y*y;this.fragmentConstantData[r++]=e._iSpecularR;this.fragmentConstantData[r++]=e._iSpecularG;this.fragmentConstantData[r++]=e._iSpecularB;this.fragmentConstantData[r++]=e._pFallOffFactor;if(++n==this.numPointLights){i=a;u=o}}}if(this.numPointLights>n){i=r+(n-this.numPointLights)*12;for(;r<i;++r)this.fragmentConstantData[r]=0}};e.prototype.updateProbes=function(t){var e;var i=this.lightPicker.lightProbes;var r=this.lightPicker.lightProbeWeights;var a=i.length-this.lightProbesOffset;var s=this.usesProbesForDiffuse;var n=this.usesProbesForSpecular;if(!(s||n))return;if(a>this.numLightProbes)a=this.numLightProbes;for(var o=0;o<a;++o){e=i[this.lightProbesOffset+o];if(s)t.context.activateCubeTexture(this.lightProbeDiffuseIndices[o],e.diffuseMap);if(n)t.context.activateCubeTexture(this.lightProbeSpecularIndices[o],e.specularMap)}for(o=0;o<a;++o)this.fragmentConstantData[this.probeWeightsIndex+o]=r[this.lightProbesOffset+o]};return e}(s);e.exports=n},{"awayjs-stagegl/lib/materials/compilation/ShaderLightingCompiler":undefined,"awayjs-stagegl/lib/materials/compilation/ShaderObjectBase":undefined}],"awayjs-stagegl/lib/materials/compilation/ShaderObjectBase":[function(t,e,i){var r=t("awayjs-display/lib/base/TriangleSubGeometry");var a=t("awayjs-stagegl/lib/base/ContextGLTriangleFace");var s=t("awayjs-stagegl/lib/materials/compilation/ShaderCompilerBase");var n=function(){function t(t){this._defaultCulling=a.BACK;this._pInverseSceneMatrix=new Array;this.ambientR=255;this.ambientG=255;this.ambientB=255;this.usesGlobalPosFragment=false;this.vertexConstantData=new Array;this.fragmentConstantData=new Array;this.profile=t}t.prototype.createCompiler=function(t,e){return new s(t,e,this)};t.prototype.reset=function(){this.projectionDependencies=0;this.normalDependencies=0;this.viewDirDependencies=0;this.uvDependencies=0;this.secondaryUVDependencies=0;this.globalPosDependencies=0;this.tangentDependencies=0;this.usesGlobalPosFragment=false;this.usesFragmentAnimation=false;this.usesTangentSpace=false;this.outputsNormals=false;this.outputsTangentNormals=false};t.prototype.addWorldSpaceDependencies=function(t){if(this.viewDirDependencies>0)++this.globalPosDependencies};t.prototype.pInitRegisterIndices=function(){this.commonsDataIndex=-1;this.cameraPositionIndex=-1;this.uvBufferIndex=-1;this.uvTransformIndex=-1;this.secondaryUVBufferIndex=-1;this.normalBufferIndex=-1;this.tangentBufferIndex=-1;this.sceneMatrixIndex=-1;this.sceneNormalMatrixIndex=-1};t.prototype.initConstantData=function(t,e,i,r,a){this.numUsedVertexConstants=t.numUsedVertexConstants;this.numUsedFragmentConstants=t.numUsedFragmentConstants;this.numUsedStreams=t.numUsedStreams;this.numUsedTextures=t.numUsedTextures;this.numUsedVaryings=t.numUsedVaryings;this.numUsedFragmentConstants=t.numUsedFragmentConstants;this.animatableAttributes=e;this.animationTargetRegisters=i;this.uvSource=r;this.uvTarget=a;this.vertexConstantData.length=this.numUsedVertexConstants*4;this.fragmentConstantData.length=this.numUsedFragmentConstants*4;this.fragmentConstantData[this.commonsDataIndex]=.5;this.fragmentConstantData[this.commonsDataIndex+1]=0;this.fragmentConstantData[this.commonsDataIndex+2]=1/255;this.fragmentConstantData[this.commonsDataIndex+3]=1;if(this.uvTransformIndex>=0){this.vertexConstantData[this.uvTransformIndex]=1;this.vertexConstantData[this.uvTransformIndex+1]=0;this.vertexConstantData[this.uvTransformIndex+2]=0;this.vertexConstantData[this.uvTransformIndex+3]=0;this.vertexConstantData[this.uvTransformIndex+4]=0;this.vertexConstantData[this.uvTransformIndex+5]=1;this.vertexConstantData[this.uvTransformIndex+6]=0;this.vertexConstantData[this.uvTransformIndex+7]=0}if(this.cameraPositionIndex>=0)this.vertexConstantData[this.cameraPositionIndex+3]=1};t.prototype.iActivate=function(t,e){t.context.setCulling(this.useBothSides?a.NONE:this._defaultCulling,e.projection.coordinateSystem);if(!this.usesTangentSpace&&this.cameraPositionIndex>=0){var i=e.scenePosition;this.vertexConstantData[this.cameraPositionIndex]=i.x;this.vertexConstantData[this.cameraPositionIndex+1]=i.y;this.vertexConstantData[this.cameraPositionIndex+2]=i.z}};t.prototype.iDeactivate=function(t){};t.prototype.setRenderState=function(t,e,i,a){var s=e.context;if(t.materialOwner.animator)t.materialOwner.animator.setRenderState(this,t,e,i,this.numUsedVertexConstants,this.numUsedStreams);if(this.uvBufferIndex>=0)s.activateBuffer(this.uvBufferIndex,t.getVertexData(r.UV_DATA),t.getVertexOffset(r.UV_DATA),r.UV_FORMAT);if(this.secondaryUVBufferIndex>=0)s.activateBuffer(this.secondaryUVBufferIndex,t.getVertexData(r.SECONDARY_UV_DATA),t.getVertexOffset(r.SECONDARY_UV_DATA),r.SECONDARY_UV_FORMAT);if(this.normalBufferIndex>=0)s.activateBuffer(this.normalBufferIndex,t.getVertexData(r.NORMAL_DATA),t.getVertexOffset(r.NORMAL_DATA),r.NORMAL_FORMAT);if(this.tangentBufferIndex>=0)s.activateBuffer(this.tangentBufferIndex,t.getVertexData(r.TANGENT_DATA),t.getVertexOffset(r.TANGENT_DATA),r.TANGENT_FORMAT);if(this.usesUVTransform){var n=t.materialOwner.uvTransform.matrix;if(n){this.vertexConstantData[this.uvTransformIndex]=n.a;this.vertexConstantData[this.uvTransformIndex+1]=n.b;this.vertexConstantData[this.uvTransformIndex+3]=n.tx;this.vertexConstantData[this.uvTransformIndex+4]=n.c;this.vertexConstantData[this.uvTransformIndex+5]=n.d;this.vertexConstantData[this.uvTransformIndex+7]=n.ty}else{this.vertexConstantData[this.uvTransformIndex]=1;this.vertexConstantData[this.uvTransformIndex+1]=0;this.vertexConstantData[this.uvTransformIndex+3]=0;this.vertexConstantData[this.uvTransformIndex+4]=0;this.vertexConstantData[this.uvTransformIndex+5]=1;this.vertexConstantData[this.uvTransformIndex+7]=0}}if(this.sceneNormalMatrixIndex>=0)t.sourceEntity.inverseSceneTransform.copyRawDataTo(this.vertexConstantData,this.sceneNormalMatrixIndex,false);if(this.usesTangentSpace&&this.cameraPositionIndex>=0){t.sourceEntity.inverseSceneTransform.copyRawDataTo(this._pInverseSceneMatrix);var o=i.scenePosition;var h=o.x;var l=o.y;var u=o.z;this.vertexConstantData[this.cameraPositionIndex]=this._pInverseSceneMatrix[0]*h+this._pInverseSceneMatrix[4]*l+this._pInverseSceneMatrix[8]*u+this._pInverseSceneMatrix[12];this.vertexConstantData[this.cameraPositionIndex+1]=this._pInverseSceneMatrix[1]*h+this._pInverseSceneMatrix[5]*l+this._pInverseSceneMatrix[9]*u+this._pInverseSceneMatrix[13];this.vertexConstantData[this.cameraPositionIndex+2]=this._pInverseSceneMatrix[2]*h+this._pInverseSceneMatrix[6]*l+this._pInverseSceneMatrix[10]*u+this._pInverseSceneMatrix[14]}};t.prototype.dispose=function(){};return t}();e.exports=n},{"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-stagegl/lib/base/ContextGLTriangleFace":undefined,"awayjs-stagegl/lib/materials/compilation/ShaderCompilerBase":undefined}],"awayjs-stagegl/lib/materials/compilation/ShaderRegisterCache":[function(t,e,i){var r=t("awayjs-stagegl/lib/materials/compilation/RegisterPool");var a=t("awayjs-stagegl/lib/materials/compilation/ShaderRegisterElement");var s=function(){function t(t){this._numUsedVertexConstants=0;this._numUsedFragmentConstants=0;this._numUsedStreams=0;this._numUsedTextures=0;this._numUsedVaryings=0;this._profile=t}t.prototype.reset=function(){this._fragmentTempCache=new r("ft",8,false);this._vertexTempCache=new r("vt",8,false);this._varyingCache=new r("v",8);this._textureCache=new r("fs",8);this._vertexAttributesCache=new r("va",8);this._fragmentConstantsCache=new r("fc",28);this._vertexConstantsCache=new r("vc",128);this._fragmentOutputRegister=new a("oc",-1);this._vertexOutputRegister=new a("op",-1);this._numUsedVertexConstants=0;this._numUsedStreams=0;this._numUsedTextures=0;this._numUsedVaryings=0;this._numUsedFragmentConstants=0;var t;for(t=0;t<this._vertexAttributesOffset;++t)this.getFreeVertexAttribute();for(t=0;t<this._vertexConstantOffset;++t)this.getFreeVertexConstant();for(t=0;t<this._varyingsOffset;++t)this.getFreeVarying();for(t=0;t<this._fragmentConstantOffset;++t)this.getFreeFragmentConstant()};t.prototype.dispose=function(){this._fragmentTempCache.dispose();this._vertexTempCache.dispose();this._varyingCache.dispose();this._fragmentConstantsCache.dispose();this._vertexAttributesCache.dispose();this._fragmentTempCache=null;this._vertexTempCache=null;this._varyingCache=null;this._fragmentConstantsCache=null;this._vertexAttributesCache=null;this._fragmentOutputRegister=null;this._vertexOutputRegister=null};t.prototype.addFragmentTempUsages=function(t,e){this._fragmentTempCache.addUsage(t,e)};t.prototype.removeFragmentTempUsage=function(t){this._fragmentTempCache.removeUsage(t)};t.prototype.addVertexTempUsages=function(t,e){this._vertexTempCache.addUsage(t,e)};t.prototype.removeVertexTempUsage=function(t){this._vertexTempCache.removeUsage(t)};t.prototype.getFreeFragmentVectorTemp=function(){return this._fragmentTempCache.requestFreeVectorReg()};t.prototype.getFreeFragmentSingleTemp=function(){return this._fragmentTempCache.requestFreeRegComponent()};t.prototype.getFreeVarying=function(){++this._numUsedVaryings;return this._varyingCache.requestFreeVectorReg()};t.prototype.getFreeFragmentConstant=function(){++this._numUsedFragmentConstants;return this._fragmentConstantsCache.requestFreeVectorReg()};t.prototype.getFreeVertexConstant=function(){++this._numUsedVertexConstants;return this._vertexConstantsCache.requestFreeVectorReg()};t.prototype.getFreeVertexVectorTemp=function(){return this._vertexTempCache.requestFreeVectorReg()};t.prototype.getFreeVertexSingleTemp=function(){return this._vertexTempCache.requestFreeRegComponent()};t.prototype.getFreeVertexAttribute=function(){++this._numUsedStreams;return this._vertexAttributesCache.requestFreeVectorReg()};t.prototype.getFreeTextureReg=function(){++this._numUsedTextures;return this._textureCache.requestFreeVectorReg()};Object.defineProperty(t.prototype,"vertexConstantOffset",{get:function(){return this._vertexConstantOffset},set:function(t){this._vertexConstantOffset=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"vertexAttributesOffset",{get:function(){return this._vertexAttributesOffset},set:function(t){this._vertexAttributesOffset=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"varyingsOffset",{get:function(){return this._varyingsOffset},set:function(t){this._varyingsOffset=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"fragmentConstantOffset",{get:function(){return this._fragmentConstantOffset},set:function(t){this._fragmentConstantOffset=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"fragmentOutputRegister",{get:function(){return this._fragmentOutputRegister},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"numUsedVertexConstants",{get:function(){return this._numUsedVertexConstants},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"numUsedFragmentConstants",{get:function(){return this._numUsedFragmentConstants},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"numUsedStreams",{get:function(){return this._numUsedStreams},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"numUsedTextures",{get:function(){return this._numUsedTextures},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"numUsedVaryings",{get:function(){return this._numUsedVaryings},enumerable:true,configurable:true});return t}();e.exports=s},{"awayjs-stagegl/lib/materials/compilation/RegisterPool":undefined,"awayjs-stagegl/lib/materials/compilation/ShaderRegisterElement":undefined}],"awayjs-stagegl/lib/materials/compilation/ShaderRegisterData":[function(t,e,i){var r=function(){function t(){}return t}();e.exports=r},{}],"awayjs-stagegl/lib/materials/compilation/ShaderRegisterElement":[function(t,e,i){var r=function(){function t(e,i,r){if(r===void 0){r=-1}this._component=r;this._regName=e;this._index=i;this._toStr=this._regName;if(this._index>=0)this._toStr+=this._index;if(r>-1)this._toStr+="."+t.COMPONENTS[r]}t.prototype.toString=function(){return this._toStr};Object.defineProperty(t.prototype,"regName",{get:function(){return this._regName},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"index",{get:function(){return this._index},enumerable:true,configurable:true});t.COMPONENTS=["x","y","z","w"];return t}();e.exports=r},{}],"awayjs-stagegl/lib/materials/methods/AmbientBasicMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/base/ContextGLMipFilter");var s=t("awayjs-stagegl/lib/base/ContextGLTextureFilter");var n=t("awayjs-stagegl/lib/base/ContextGLWrapMode");var o=t("awayjs-stagegl/lib/materials/methods/ShadingMethodBase");var h=t("awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper");var l=function(t){r(e,t);function e(){t.call(this);this._color=16777215;this._alpha=1;this._colorR=1;this._colorG=1;this._colorB=1;this._ambient=1}e.prototype.iInitVO=function(t,e){e.needsUV=Boolean(t.texture!=null)};e.prototype.iInitConstants=function(t,e){if(!e.needsUV){this._color=t.color;this.updateColor()}};Object.defineProperty(e.prototype,"ambient",{get:function(){return this._ambient},set:function(t){if(this._ambient==t)return;this._ambient=t;this.updateColor()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){if(this._alpha==t)return;this._alpha=t;this.updateColor()},enumerable:true,configurable:true});e.prototype.copyFrom=function(t){var e=t;var i=e};e.prototype.iGetFragmentCode=function(t,e,i,r,a){var s="";var n;if(e.needsUV){n=r.getFreeTextureReg();e.texturesIndex=n.index;s+=h.getTex2DSampleCode(i,a,n,t.texture,t.useSmoothTextures,t.repeatTextures,t.useMipmapping);if(t.alphaThreshold>0){var o=r.getFreeFragmentConstant();e.fragmentConstantsIndex=o.index*4;s+="sub "+i+".w, "+i+".w, "+o+".x\n"+"kil "+i+".w\n"+"add "+i+".w, "+i+".w, "+o+".x\n"}}else{n=r.getFreeFragmentConstant();e.fragmentConstantsIndex=n.index*4;s+="mov "+i+", "+n+"\n"}return s};e.prototype.iActivate=function(t,e,i){if(e.needsUV){i.context.setSamplerStateAt(e.texturesIndex,t.repeatTextures?n.REPEAT:n.CLAMP,t.useSmoothTextures?s.LINEAR:s.NEAREST,t.useMipmapping?a.MIPLINEAR:a.MIPNONE);i.context.activateTexture(e.texturesIndex,t.texture);if(t.alphaThreshold>0)t.fragmentConstantData[e.fragmentConstantsIndex]=t.alphaThreshold}else{var r=e.fragmentConstantsIndex;var o=t.fragmentConstantData;o[r]=this._colorR;o[r+1]=this._colorG;o[r+2]=this._colorB;o[r+3]=this._alpha}};e.prototype.updateColor=function(){this._colorR=(this._color>>16&255)/255*this._ambient;this._colorG=(this._color>>8&255)/255*this._ambient;this._colorB=(this._color&255)/255*this._ambient};return e}(o);e.exports=l},{"awayjs-stagegl/lib/base/ContextGLMipFilter":undefined,"awayjs-stagegl/lib/base/ContextGLTextureFilter":undefined,"awayjs-stagegl/lib/base/ContextGLWrapMode":undefined,"awayjs-stagegl/lib/materials/methods/ShadingMethodBase":undefined,"awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper":undefined}],"awayjs-stagegl/lib/materials/methods/DiffuseBasicMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/base/ContextGLMipFilter");var s=t("awayjs-stagegl/lib/base/ContextGLTextureFilter");var n=t("awayjs-stagegl/lib/base/ContextGLWrapMode");var o=t("awayjs-stagegl/lib/materials/methods/LightingMethodBase");var h=t("awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper");var l=function(t){r(e,t);function e(){t.call(this);this._multiply=true;this._diffuseColor=16777215;this._ambientColor=16777215;this._diffuseR=1;this._diffuseG=1;this._diffuseB=1;this._ambientR=1;this._ambientG=1;this._ambientB=1}e.prototype.iIsUsed=function(t){if(!t.numLights)return false;return true};Object.defineProperty(e.prototype,"multiply",{get:function(){return this._multiply},set:function(t){if(this._multiply==t)return;this._multiply=t;this.iInvalidateShaderProgram()},enumerable:true,configurable:true});e.prototype.iInitVO=function(t,e){e.needsUV=this._pUseTexture;e.needsNormals=t.numLights>0};e.prototype.generateMip=function(t){if(this._pUseTexture)t.context.activateTexture(0,this._texture)};Object.defineProperty(e.prototype,"diffuseColor",{get:function(){return this._diffuseColor},set:function(t){if(this._diffuseColor==t)return;this._diffuseColor=t;this.updateDiffuse()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"ambientColor",{get:function(){return this._ambientColor},set:function(t){if(this._ambientColor==t)return;this._ambientColor=t;this.updateAmbient()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){var e=t!=null;if(e!=this._pUseTexture||t&&this._texture&&(t.hasMipmaps!=this._texture.hasMipmaps||t.format!=this._texture.format))this.iInvalidateShaderProgram();this._pUseTexture=e;this._texture=t},enumerable:true,configurable:true});e.prototype.dispose=function(){this._texture=null};e.prototype.copyFrom=function(t){var e=t;this.texture=e.texture;this.multiply=e.multiply;this.diffuseColor=e.diffuseColor;this.ambientColor=e.ambientColor};e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this);this._pTotalLightColorReg=null;this._pDiffuseInputRegister=null};e.prototype.iGetFragmentPreLightingCode=function(t,e,i,r){var a="";this._pIsFirstLight=true;this._pTotalLightColorReg=i.getFreeFragmentVectorTemp();i.addFragmentTempUsages(this._pTotalLightColorReg,1);return a};e.prototype.iGetFragmentCodePerLight=function(t,e,i,r,a,s){var n="";var o;if(this._pIsFirstLight){o=this._pTotalLightColorReg}else{o=a.getFreeFragmentVectorTemp();a.addFragmentTempUsages(o,1)}n+="dp3 "+o+".x, "+i+", "+s.normalFragment+"\n"+"max "+o+".w, "+o+".x, "+s.commons+".y\n";if(t.usesLightFallOff)n+="mul "+o+".w, "+o+".w, "+i+".w\n";if(this._iModulateMethod!=null)n+=this._iModulateMethod(t,e,o,a,s);n+="mul "+o+", "+o+".w, "+r+"\n";if(!this._pIsFirstLight){n+="add "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+", "+o+"\n";a.removeFragmentTempUsage(o)}this._pIsFirstLight=false;return n};e.prototype.iGetFragmentCodePerProbe=function(t,e,i,r,a,s){var n="";var o;if(this._pIsFirstLight){o=this._pTotalLightColorReg}else{o=a.getFreeFragmentVectorTemp();a.addFragmentTempUsages(o,1)}n+="tex "+o+", "+s.normalFragment+", "+i+" <cube,linear,miplinear>\n"+"mul "+o+".xyz, "+o+".xyz, "+r+"\n";if(this._iModulateMethod!=null)n+=this._iModulateMethod(t,e,o,a,s);if(!this._pIsFirstLight){n+="add "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+", "+o+"\n";a.removeFragmentTempUsage(o)}this._pIsFirstLight=false;return n};e.prototype.iGetFragmentPostLightingCode=function(t,e,i,r,a){var s="";var n;var o;if(a.shadowTarget)s+=this.pApplyShadow(t,e,r,a);n=r.getFreeFragmentVectorTemp();r.addFragmentTempUsages(n,1);var l=r.getFreeFragmentConstant();e.fragmentConstantsIndex=l.index*4;if(this._pUseTexture){this._pDiffuseInputRegister=r.getFreeTextureReg();e.texturesIndex=this._pDiffuseInputRegister.index;s+=h.getTex2DSampleCode(n,a,this._pDiffuseInputRegister,this._texture,t.useSmoothTextures,t.repeatTextures,t.useMipmapping)}else{this._pDiffuseInputRegister=r.getFreeFragmentConstant();s+="mov "+n+", "+this._pDiffuseInputRegister+"\n"}s+="sat "+this._pTotalLightColorReg+", "+this._pTotalLightColorReg+"\n"+"mul "+n+".xyz, "+n+", "+this._pTotalLightColorReg+"\n";if(this._multiply){s+="add "+n+".xyz, "+n+", "+l+"\n"+"mul "+i+".xyz, "+i+", "+n+"\n"}else{s+="mul "+i+".xyz, "+i+", "+l+"\n"+"mul "+this._pTotalLightColorReg+".xyz, "+i+", "+this._pTotalLightColorReg+"\n"+"sub "+i+".xyz, "+i+", "+this._pTotalLightColorReg+"\n"+"add "+i+".xyz, "+i+", "+n+"\n"}r.removeFragmentTempUsage(this._pTotalLightColorReg);r.removeFragmentTempUsage(n);return s};e.prototype.pApplyShadow=function(t,e,i,r){return"mul "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+", "+r.shadowTarget+".w\n"};e.prototype.iActivate=function(t,e,i){if(this._pUseTexture){i.context.setSamplerStateAt(e.texturesIndex,t.repeatTextures?n.REPEAT:n.CLAMP,t.useSmoothTextures?s.LINEAR:s.NEAREST,t.useMipmapping?a.MIPLINEAR:a.MIPNONE);i.context.activateTexture(e.texturesIndex,this._texture)}else{var r=e.fragmentConstantsIndex;var o=t.fragmentConstantData;o[r+4]=this._diffuseR;o[r+5]=this._diffuseG;o[r+6]=this._diffuseB;o[r+7]=1}};e.prototype.updateDiffuse=function(){this._diffuseR=(this._diffuseColor>>16&255)/255;this._diffuseG=(this._diffuseColor>>8&255)/255;this._diffuseB=(this._diffuseColor&255)/255};e.prototype.updateAmbient=function(){this._ambientR=(this._ambientColor>>16&255)/255;this._ambientG=(this._ambientColor>>8&255)/255;this._ambientB=(this._ambientColor&255)/255};e.prototype.iSetRenderState=function(t,e,i,r,a){if(t.numLights>0){var s=e.fragmentConstantsIndex;var n=t.fragmentConstantData;n[s]=t.ambientR*this._ambientR;n[s+1]=t.ambientG*this._ambientG;n[s+2]=t.ambientB*this._ambientB;n[s+3]=1}};return e}(o);e.exports=l},{"awayjs-stagegl/lib/base/ContextGLMipFilter":undefined,"awayjs-stagegl/lib/base/ContextGLTextureFilter":undefined,"awayjs-stagegl/lib/base/ContextGLWrapMode":undefined,"awayjs-stagegl/lib/materials/methods/LightingMethodBase":undefined,"awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper":undefined}],"awayjs-stagegl/lib/materials/methods/EffectColorTransformMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];
function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/methods/EffectMethodBase");var s=function(t){r(e,t);function e(){t.call(this)}Object.defineProperty(e.prototype,"colorTransform",{get:function(){return this._colorTransform},set:function(t){this._colorTransform=t},enumerable:true,configurable:true});e.prototype.iGetFragmentCode=function(t,e,i,r,a){var s="";var n=r.getFreeFragmentConstant();var o=r.getFreeFragmentConstant();e.fragmentConstantsIndex=n.index*4;s+="mul "+i+", "+i+", "+n+"\n"+"add "+i+", "+i+", "+o+"\n";return s};e.prototype.iActivate=function(t,e,i){var r=1/255;var a=e.fragmentConstantsIndex;var s=t.fragmentConstantData;s[a]=this._colorTransform.redMultiplier;s[a+1]=this._colorTransform.greenMultiplier;s[a+2]=this._colorTransform.blueMultiplier;s[a+3]=this._colorTransform.alphaMultiplier;s[a+4]=this._colorTransform.redOffset*r;s[a+5]=this._colorTransform.greenOffset*r;s[a+6]=this._colorTransform.blueOffset*r;s[a+7]=this._colorTransform.alphaOffset*r};return e}(a);e.exports=s},{"awayjs-stagegl/lib/materials/methods/EffectMethodBase":undefined}],"awayjs-stagegl/lib/materials/methods/EffectMethodBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetType");var s=t("awayjs-core/lib/errors/AbstractMethodError");var n=t("awayjs-stagegl/lib/materials/methods/ShadingMethodBase");var o=function(t){r(e,t);function e(){t.call(this)}Object.defineProperty(e.prototype,"assetType",{get:function(){return a.EFFECTS_METHOD},enumerable:true,configurable:true});e.prototype.iGetFragmentCode=function(t,e,i,r,a){throw new s;return""};return e}(n);e.exports=o},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/library/AssetType":undefined,"awayjs-stagegl/lib/materials/methods/ShadingMethodBase":undefined}],"awayjs-stagegl/lib/materials/methods/LightingMethodBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/methods/ShadingMethodBase");var s=function(t){r(e,t);function e(){t.call(this)}e.prototype.iGetFragmentPreLightingCode=function(t,e,i,r){return""};e.prototype.iGetFragmentCodePerLight=function(t,e,i,r,a,s){return""};e.prototype.iGetFragmentCodePerProbe=function(t,e,i,r,a,s){return""};e.prototype.iGetFragmentPostLightingCode=function(t,e,i,r,a){return""};return e}(a);e.exports=s},{"awayjs-stagegl/lib/materials/methods/ShadingMethodBase":undefined}],"awayjs-stagegl/lib/materials/methods/NormalBasicMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/base/ContextGLMipFilter");var s=t("awayjs-stagegl/lib/base/ContextGLTextureFilter");var n=t("awayjs-stagegl/lib/base/ContextGLWrapMode");var o=t("awayjs-stagegl/lib/materials/methods/ShadingMethodBase");var h=t("awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper");var l=function(t){r(e,t);function e(){t.call(this)}e.prototype.iIsUsed=function(t){if(!this._useTexture||!t.normalDependencies)return false;return true};e.prototype.iInitVO=function(t,e){e.needsUV=this._useTexture};e.prototype.iOutputsTangentNormals=function(){return true};e.prototype.copyFrom=function(t){var e=t;var i=t;if(i.normalMap!=null)this.normalMap=i.normalMap};Object.defineProperty(e.prototype,"normalMap",{get:function(){return this._texture},set:function(t){var e=t!=null;if(e!=this._useTexture||t&&this._texture&&(t.hasMipmaps!=this._texture.hasMipmaps||t.format!=this._texture.format))this.iInvalidateShaderProgram();this._useTexture=e;this._texture=t},enumerable:true,configurable:true});e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this);this._pNormalTextureRegister=null};e.prototype.dispose=function(){if(this._texture)this._texture=null};e.prototype.iActivate=function(t,e,i){if(e.texturesIndex>=0){i.context.setSamplerStateAt(e.texturesIndex,t.repeatTextures?n.REPEAT:n.CLAMP,t.useSmoothTextures?s.LINEAR:s.NEAREST,t.useMipmapping?a.MIPLINEAR:a.MIPNONE);i.context.activateTexture(e.texturesIndex,this._texture)}};e.prototype.iGetFragmentCode=function(t,e,i,r,a){this._pNormalTextureRegister=r.getFreeTextureReg();e.texturesIndex=this._pNormalTextureRegister.index;return h.getTex2DSampleCode(i,a,this._pNormalTextureRegister,this._texture,t.useSmoothTextures,t.repeatTextures,t.useMipmapping)+"sub "+i+".xyz, "+i+".xyz, "+a.commons+".xxx\n"+"nrm "+i+".xyz, "+i+"\n"};return e}(o);e.exports=l},{"awayjs-stagegl/lib/base/ContextGLMipFilter":undefined,"awayjs-stagegl/lib/base/ContextGLTextureFilter":undefined,"awayjs-stagegl/lib/base/ContextGLWrapMode":undefined,"awayjs-stagegl/lib/materials/methods/ShadingMethodBase":undefined,"awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper":undefined}],"awayjs-stagegl/lib/materials/methods/ShadingMethodBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/NamedAssetBase");var s=t("awayjs-stagegl/lib/events/ShadingMethodEvent");var n=function(t){r(e,t);function e(){t.call(this)}e.prototype.iIsUsed=function(t){return true};e.prototype.iInitVO=function(t,e){};e.prototype.iInitConstants=function(t,e){};e.prototype.iUsesTangentSpace=function(){return true};Object.defineProperty(e.prototype,"passes",{get:function(){return this._passes},enumerable:true,configurable:true});e.prototype.dispose=function(){};e.prototype.iReset=function(){this.iCleanCompilationData()};e.prototype.iCleanCompilationData=function(){};e.prototype.iGetVertexCode=function(t,e,i,r){return""};e.prototype.iGetFragmentCode=function(t,e,i,r,a){return null};e.prototype.iActivate=function(t,e,i){};e.prototype.iSetRenderState=function(t,e,i,r,a){};e.prototype.iDeactivate=function(t,e,i){};e.prototype.iInvalidateShaderProgram=function(){this.dispatchEvent(new s(s.SHADER_INVALIDATED))};e.prototype.copyFrom=function(t){};return e}(a);e.exports=n},{"awayjs-core/lib/library/NamedAssetBase":undefined,"awayjs-stagegl/lib/events/ShadingMethodEvent":undefined}],"awayjs-stagegl/lib/materials/methods/ShadowHardMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/methods/ShadowMethodBase");var s=function(t){r(e,t);function e(e){t.call(this,e)}e.prototype._pGetPlanarFragmentCode=function(t,e,i,r){var a=i.getFreeTextureReg();var s=i.getFreeFragmentConstant();var n=i.getFreeFragmentConstant();var o=i.getFreeFragmentVectorTemp();var h="";t.fragmentConstantsIndex=s.index*4;t.texturesIndex=a.index;h+="tex "+o+", "+this._pDepthMapCoordReg+", "+a+" <2d, nearest, clamp>\n"+"dp4 "+o+".z, "+o+", "+s+"\n"+"slt "+e+".w, "+this._pDepthMapCoordReg+".z, "+o+".z\n";return h};e.prototype._pGetPointFragmentCode=function(t,e,i,r){var a=i.getFreeTextureReg();var s=i.getFreeFragmentConstant();var n=i.getFreeFragmentConstant();var o=i.getFreeFragmentConstant();var h=i.getFreeFragmentVectorTemp();i.addFragmentTempUsages(h,1);var l=i.getFreeFragmentVectorTemp();var u="";t.fragmentConstantsIndex=s.index*4;t.texturesIndex=a.index;u+="sub "+l+", "+r.globalPositionVarying+", "+o+"\n"+"dp3 "+l+".w, "+l+".xyz, "+l+".xyz\n"+"mul "+l+".w, "+l+".w, "+o+".w\n"+"nrm "+l+".xyz, "+l+".xyz\n"+"tex "+h+", "+l+", "+a+" <cube, nearest, clamp>\n"+"dp4 "+h+".z, "+h+", "+s+"\n"+"add "+e+".w, "+l+".w, "+n+".x\n"+"slt "+e+".w, "+e+".w, "+h+".z\n";i.removeFragmentTempUsage(h);return u};e.prototype._iGetCascadeFragmentCode=function(t,e,i,r,a,s,n,o){var h=n.getFreeFragmentVectorTemp();return"tex "+h+", "+a+", "+r+" <2d, nearest, clamp>\n"+"dp4 "+h+".z, "+h+", "+i+"\n"+"slt "+s+".w, "+a+".z, "+h+".z\n"};e.prototype.iActivateForCascade=function(t,e,i){};return e}(a);e.exports=s},{"awayjs-stagegl/lib/materials/methods/ShadowMethodBase":undefined}],"awayjs-stagegl/lib/materials/methods/ShadowMapMethodBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetType");var s=t("awayjs-stagegl/lib/materials/methods/ShadingMethodBase");var n=function(t){r(e,t);function e(e){t.call(this);this._pEpsilon=.02;this._pAlpha=1;this._pCastingLight=e;e.castsShadows=true;this._pShadowMapper=e.shadowMapper}Object.defineProperty(e.prototype,"assetType",{get:function(){return a.SHADOW_MAP_METHOD},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"alpha",{get:function(){return this._pAlpha},set:function(t){this._pAlpha=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"castingLight",{get:function(){return this._pCastingLight},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"epsilon",{get:function(){return this._pEpsilon},set:function(t){this._pEpsilon=t},enumerable:true,configurable:true});return e}(s);e.exports=n},{"awayjs-core/lib/library/AssetType":undefined,"awayjs-stagegl/lib/materials/methods/ShadingMethodBase":undefined}],"awayjs-stagegl/lib/materials/methods/ShadowMethodBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/AbstractMethodError");var s=t("awayjs-display/lib/entities/PointLight");var n=t("awayjs-stagegl/lib/materials/methods/ShadowMapMethodBase");var o=function(t){r(e,t);function e(e){this._pUsePoint=e instanceof s;t.call(this,e)}e.prototype.iInitVO=function(t,e){e.needsView=true;e.needsGlobalVertexPos=true;e.needsGlobalFragmentPos=this._pUsePoint;e.needsNormals=t.numLights>0};e.prototype.iInitConstants=function(t,e){var i=t.fragmentConstantData;var r=t.vertexConstantData;var a=e.fragmentConstantsIndex;i[a]=1;i[a+1]=1/255;i[a+2]=1/65025;i[a+3]=1/16581375;i[a+6]=0;i[a+7]=1;if(this._pUsePoint){i[a+8]=0;i[a+9]=0;i[a+10]=0;i[a+11]=1}a=e.vertexConstantsIndex;if(a!=-1){r[a]=.5;r[a+1]=.5;r[a+2]=0;r[a+3]=1}};Object.defineProperty(e.prototype,"_iDepthMapCoordReg",{get:function(){return this._pDepthMapCoordReg},set:function(t){this._pDepthMapCoordReg=t},enumerable:true,configurable:true});e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this);this._pDepthMapCoordReg=null};e.prototype.iGetVertexCode=function(t,e,i,r){return this._pUsePoint?this._pGetPointVertexCode(e,i,r):this.pGetPlanarVertexCode(e,i,r)};e.prototype._pGetPointVertexCode=function(t,e,i){t.vertexConstantsIndex=-1;return""};e.prototype.pGetPlanarVertexCode=function(t,e,i){var r="";var a=e.getFreeVertexVectorTemp();var s=e.getFreeVertexConstant();var n=e.getFreeVertexConstant();e.getFreeVertexConstant();e.getFreeVertexConstant();e.getFreeVertexConstant();this._pDepthMapCoordReg=e.getFreeVarying();t.vertexConstantsIndex=s.index*4;r+="m44 "+a+", "+i.globalPositionVertex+", "+n+"\n"+"div "+a+", "+a+", "+a+".w\n"+"mul "+a+".xy, "+a+".xy, "+s+".xy\n"+"add "+this._pDepthMapCoordReg+", "+a+", "+s+".xxwz\n";return r};e.prototype.iGetFragmentCode=function(t,e,i,r,a){var s=this._pUsePoint?this._pGetPointFragmentCode(e,i,r,a):this._pGetPlanarFragmentCode(e,i,r,a);s+="add "+i+".w, "+i+".w, fc"+(e.fragmentConstantsIndex/4+1)+".y\n"+"sat "+i+".w, "+i+".w\n";return s};e.prototype._pGetPlanarFragmentCode=function(t,e,i,r){throw new a;return""};e.prototype._pGetPointFragmentCode=function(t,e,i,r){throw new a;return""};e.prototype.iSetRenderState=function(t,e,i,r,a){if(!this._pUsePoint)this._pShadowMapper.iDepthProjection.copyRawDataTo(t.vertexConstantData,e.vertexConstantsIndex+4,true)};e.prototype._iGetCascadeFragmentCode=function(t,e,i,r,a,s,n,o){throw new Error("This shadow method is incompatible with cascade shadows")};e.prototype.iActivate=function(t,e,i){var r=t.fragmentConstantData;var a=e.fragmentConstantsIndex;if(this._pUsePoint)r[a+4]=-Math.pow(1/(this._pCastingLight.fallOff*this._pEpsilon),2);else t.vertexConstantData[e.vertexConstantsIndex+3]=-1/(this._pShadowMapper.depth*this._pEpsilon);r[a+5]=1-this._pAlpha;if(this._pUsePoint){var s=this._pCastingLight.scenePosition;r[a+8]=s.x;r[a+9]=s.y;r[a+10]=s.z;var n=this._pCastingLight.fallOff;r[a+11]=1/(2*n*n)}if(!this._pUsePoint)i.context.activateRenderTexture(e.texturesIndex,this._pCastingLight.shadowMapper.depthMap)};e.prototype.iActivateForCascade=function(t,e,i){throw new Error("This shadow method is incompatible with cascade shadows")};return e}(n);e.exports=o},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-display/lib/entities/PointLight":undefined,"awayjs-stagegl/lib/materials/methods/ShadowMapMethodBase":undefined}],"awayjs-stagegl/lib/materials/methods/SpecularBasicMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/base/ContextGLMipFilter");var s=t("awayjs-stagegl/lib/base/ContextGLTextureFilter");var n=t("awayjs-stagegl/lib/base/ContextGLWrapMode");var o=t("awayjs-stagegl/lib/materials/methods/LightingMethodBase");var h=t("awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper");var l=function(t){r(e,t);function e(){t.call(this);this._gloss=50;this._specular=1;this._specularColor=16777215;this._iSpecularR=1;this._iSpecularG=1;this._iSpecularB=1}e.prototype.iIsUsed=function(t){if(!t.numLights)return false;return true};e.prototype.iInitVO=function(t,e){e.needsUV=this._pUseTexture;e.needsNormals=t.numLights>0;e.needsView=t.numLights>0};Object.defineProperty(e.prototype,"gloss",{get:function(){return this._gloss},set:function(t){this._gloss=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"specular",{get:function(){return this._specular},set:function(t){if(t==this._specular)return;this._specular=t;this.updateSpecular()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"specularColor",{get:function(){return this._specularColor},set:function(t){if(this._specularColor==t)return;if(this._specularColor==0||t==0)this.iInvalidateShaderProgram();this._specularColor=t;this.updateSpecular()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){var e=t!=null;if(e!=this._pUseTexture||t&&this._texture&&(t.hasMipmaps!=this._texture.hasMipmaps||t.format!=this._texture.format))this.iInvalidateShaderProgram();this._pUseTexture=e;this._texture=t},enumerable:true,configurable:true});e.prototype.copyFrom=function(t){var e=t;var i=t;var r=i;this.texture=r.texture;this.specular=r.specular;this.specularColor=r.specularColor;this.gloss=r.gloss};e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this);this._pTotalLightColorReg=null;this._pSpecularTextureRegister=null;this._pSpecularTexData=null;this._pSpecularDataRegister=null};e.prototype.iGetFragmentPreLightingCode=function(t,e,i,r){var a="";this._pIsFirstLight=true;this._pSpecularDataRegister=i.getFreeFragmentConstant();e.fragmentConstantsIndex=this._pSpecularDataRegister.index*4;if(this._pUseTexture){this._pSpecularTexData=i.getFreeFragmentVectorTemp();i.addFragmentTempUsages(this._pSpecularTexData,1);this._pSpecularTextureRegister=i.getFreeTextureReg();e.texturesIndex=this._pSpecularTextureRegister.index;a=h.getTex2DSampleCode(this._pSpecularTexData,r,this._pSpecularTextureRegister,this._texture,t.useSmoothTextures,t.repeatTextures,t.useMipmapping)}else{this._pSpecularTextureRegister=null}this._pTotalLightColorReg=i.getFreeFragmentVectorTemp();i.addFragmentTempUsages(this._pTotalLightColorReg,1);return a};e.prototype.iGetFragmentCodePerLight=function(t,e,i,r,a,s){var n="";var o;if(this._pIsFirstLight){o=this._pTotalLightColorReg}else{o=a.getFreeFragmentVectorTemp();a.addFragmentTempUsages(o,1)}var h=s.viewDirFragment;var l=s.normalFragment;n+="add "+o+", "+i+", "+h+"\n"+"nrm "+o+".xyz, "+o+"\n"+"dp3 "+o+".w, "+l+", "+o+"\n"+"sat "+o+".w, "+o+".w\n";if(this._pUseTexture){n+="mul "+this._pSpecularTexData+".w, "+this._pSpecularTexData+".y, "+this._pSpecularDataRegister+".w\n"+"pow "+o+".w, "+o+".w, "+this._pSpecularTexData+".w\n"}else{n+="pow "+o+".w, "+o+".w, "+this._pSpecularDataRegister+".w\n"}if(t.usesLightFallOff)n+="mul "+o+".w, "+o+".w, "+i+".w\n";if(this._iModulateMethod!=null)n+=this._iModulateMethod(t,e,o,a,s);n+="mul "+o+".xyz, "+r+", "+o+".w\n";if(!this._pIsFirstLight){n+="add "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+", "+o+"\n";a.removeFragmentTempUsage(o)}this._pIsFirstLight=false;return n};e.prototype.iGetFragmentCodePerProbe=function(t,e,i,r,a,s){var n="";var o;if(this._pIsFirstLight){o=this._pTotalLightColorReg}else{o=a.getFreeFragmentVectorTemp();a.addFragmentTempUsages(o,1)}var h=s.normalFragment;var l=s.viewDirFragment;n+="dp3 "+o+".w, "+h+", "+l+"\n"+"add "+o+".w, "+o+".w, "+o+".w\n"+"mul "+o+", "+o+".w, "+h+"\n"+"sub "+o+", "+o+", "+l+"\n"+"tex "+o+", "+o+", "+i+" <cube,"+(t.useSmoothTextures?"linear":"nearest")+",miplinear>\n"+"mul "+o+".xyz, "+o+", "+r+"\n";if(this._iModulateMethod!=null)n+=this._iModulateMethod(t,e,o,a,s);if(!this._pIsFirstLight){n+="add "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+", "+o+"\n";a.removeFragmentTempUsage(o)}this._pIsFirstLight=false;return n};e.prototype.iGetFragmentPostLightingCode=function(t,e,i,r,a){var s="";if(a.shadowTarget)s+="mul "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+", "+a.shadowTarget+".w\n";if(this._pUseTexture){s+="mul "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+", "+this._pSpecularTexData+".x\n";r.removeFragmentTempUsage(this._pSpecularTexData)}s+="mul "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+", "+this._pSpecularDataRegister+"\n"+"add "+i+".xyz, "+i+", "+this._pTotalLightColorReg+"\n";r.removeFragmentTempUsage(this._pTotalLightColorReg);return s};e.prototype.iActivate=function(t,e,i){if(this._pUseTexture){i.context.setSamplerStateAt(e.texturesIndex,t.repeatTextures?n.REPEAT:n.CLAMP,t.useSmoothTextures?s.LINEAR:s.NEAREST,t.useMipmapping?a.MIPLINEAR:a.MIPNONE);i.context.activateTexture(e.texturesIndex,this._texture)}var r=e.fragmentConstantsIndex;var o=t.fragmentConstantData;o[r]=this._iSpecularR;o[r+1]=this._iSpecularG;o[r+2]=this._iSpecularB;o[r+3]=this._gloss};e.prototype.updateSpecular=function(){this._iSpecularR=(this._specularColor>>16&255)/255*this._specular;this._iSpecularG=(this._specularColor>>8&255)/255*this._specular;this._iSpecularB=(this._specularColor&255)/255*this._specular};return e}(o);e.exports=l},{"awayjs-stagegl/lib/base/ContextGLMipFilter":undefined,"awayjs-stagegl/lib/base/ContextGLTextureFilter":undefined,"awayjs-stagegl/lib/base/ContextGLWrapMode":undefined,"awayjs-stagegl/lib/materials/methods/LightingMethodBase":undefined,"awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper":undefined}],"awayjs-stagegl/lib/materials/passes/DepthMapPass":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/base/ContextGLMipFilter");var s=t("awayjs-stagegl/lib/base/ContextGLTextureFilter");var n=t("awayjs-stagegl/lib/base/ContextGLWrapMode");var o=t("awayjs-stagegl/lib/materials/passes/MaterialPassBase");var h=t("awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper");var l=function(t){r(e,t);function e(){t.call(this)}e.prototype._iInitConstantData=function(e){t.prototype._iInitConstantData.call(this,e);var i=this._fragmentConstantsIndex;var r=e.fragmentConstantData;r[i]=1;r[i+1]=255;r[i+2]=65025;r[i+3]=16581375;r[i+4]=1/255;r[i+5]=1/255;r[i+6]=1/255;r[i+7]=0};e.prototype._iIncludeDependencies=function(t){t.projectionDependencies++;if(t.alphaThreshold>0)t.uvDependencies++};e.prototype._iGetFragmentCode=function(t,e,i){var r="";var a=i.shadedTarget;var s=e.getFreeTextureReg();var n=e.getFreeFragmentConstant();var o=e.getFreeFragmentConstant();this._fragmentConstantsIndex=n.index*4;var l=e.getFreeFragmentVectorTemp();e.addFragmentTempUsages(l,1);var u=e.getFreeFragmentVectorTemp();e.addFragmentTempUsages(u,1);r+="div "+l+", "+i.projectionFragment+", "+i.projectionFragment+".w\n"+"mul "+l+", "+n+", "+l+".z\n"+"frc "+l+", "+l+"\n"+"mul "+u+", "+l+".yzww, "+o+"\n";if(t.alphaThreshold>0){s=e.getFreeTextureReg();this._texturesIndex=s.index;var p=e.getFreeFragmentVectorTemp();r+=h.getTex2DSampleCode(p,i,s,t.texture,t.useSmoothTextures,t.repeatTextures,t.useMipmapping);var c=e.getFreeFragmentConstant();r+="sub "+p+".w, "+p+".w, "+c+".x\n"+"kil "+p+".w\n"}r+="sub "+a+", "+l+", "+u+"\n";e.removeFragmentTempUsage(l);e.removeFragmentTempUsage(u);return r};e.prototype._iRender=function(t,e,i,r,a){};e.prototype._iActivate=function(e,i,r){t.prototype._iActivate.call(this,e,i,r);var o=i.context;var h=e.shaderObject;if(h.alphaThreshold>0){o.setSamplerStateAt(this._texturesIndex,h.repeatTextures?n.REPEAT:n.CLAMP,h.useSmoothTextures?s.LINEAR:s.NEAREST,h.useMipmapping?a.MIPLINEAR:a.MIPNONE);o.activateTexture(this._texturesIndex,h.texture);h.fragmentConstantData[this._fragmentConstantsIndex+8]=e.shaderObject.alphaThreshold}};return e}(o);e.exports=l},{"awayjs-stagegl/lib/base/ContextGLMipFilter":undefined,"awayjs-stagegl/lib/base/ContextGLTextureFilter":undefined,"awayjs-stagegl/lib/base/ContextGLWrapMode":undefined,"awayjs-stagegl/lib/materials/passes/MaterialPassBase":undefined,"awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper":undefined}],"awayjs-stagegl/lib/materials/passes/DistanceMapPass":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/base/ContextGLMipFilter");var s=t("awayjs-stagegl/lib/base/ContextGLTextureFilter");var n=t("awayjs-stagegl/lib/base/ContextGLWrapMode");var o=t("awayjs-stagegl/lib/materials/passes/MaterialPassBase");var h=t("awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper");var l=function(t){r(e,t);function e(){t.call(this)}e.prototype._iInitConstantData=function(e){t.prototype._iInitConstantData.call(this,e);var i=this._fragmentConstantsIndex;var r=e.fragmentConstantData;r[i+4]=1/255;r[i+5]=1/255;r[i+6]=1/255;r[i+7]=0};e.prototype._iIncludeDependencies=function(t){t.projectionDependencies++;t.viewDirDependencies++;if(t.alphaThreshold>0)t.uvDependencies++;t.addWorldSpaceDependencies(false)};e.prototype._iGetFragmentCode=function(t,e,i){var r;var a=i.shadedTarget;var s=e.getFreeTextureReg();var n=e.getFreeFragmentConstant();var o=e.getFreeFragmentConstant();this._fragmentConstantsIndex=n.index*4;var l=e.getFreeFragmentVectorTemp();e.addFragmentTempUsages(l,1);var u=e.getFreeFragmentVectorTemp();e.addFragmentTempUsages(u,1);r="dp3 "+l+".z, "+i.viewDirVarying+".xyz, "+i.viewDirVarying+".xyz\n"+"mul "+l+", "+n+", "+l+".z\n"+"frc "+l+", "+l+"\n"+"mul "+u+", "+l+".yzww, "+o+"\n";if(t.alphaThreshold>0){s=e.getFreeTextureReg();this._texturesIndex=s.index;var p=e.getFreeFragmentVectorTemp();r+=h.getTex2DSampleCode(p,i,s,t.texture,t.useSmoothTextures,t.repeatTextures,t.useMipmapping);var c=e.getFreeFragmentConstant();r+="sub "+p+".w, "+p+".w, "+c+".x\n"+"kil "+p+".w\n"}r+="sub "+a+", "+l+", "+u+"\n";return r};e.prototype._iActivate=function(e,i,r){t.prototype._iActivate.call(this,e,i,r);var o=i.context;var h=e.shaderObject;var l=r.projection.far;l=1/(2*l*l);var u=this._fragmentConstantsIndex;var p=h.fragmentConstantData;p[u]=1*l;p[u+1]=255*l;p[u+2]=65025*l;p[u+3]=16581375*l;if(h.alphaThreshold>0){o.setSamplerStateAt(this._texturesIndex,h.repeatTextures?n.REPEAT:n.CLAMP,h.useSmoothTextures?s.LINEAR:s.NEAREST,h.useMipmapping?a.MIPLINEAR:a.MIPNONE);o.activateTexture(this._texturesIndex,h.texture);p[u+8]=e.shaderObject.alphaThreshold}};return e}(o);e.exports=l},{"awayjs-stagegl/lib/base/ContextGLMipFilter":undefined,"awayjs-stagegl/lib/base/ContextGLTextureFilter":undefined,"awayjs-stagegl/lib/base/ContextGLWrapMode":undefined,"awayjs-stagegl/lib/materials/passes/MaterialPassBase":undefined,"awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper":undefined}],"awayjs-stagegl/lib/materials/passes/ILightingPassStageGL":[function(t,e,i){},{}],"awayjs-stagegl/lib/materials/passes/IMaterialPassStageGL":[function(t,e,i){},{}],"awayjs-stagegl/lib/materials/passes/LineBasicPass":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/passes/MaterialPassBase");var s=function(t){r(e,t);function e(){t.call(this)}e.prototype._iGetFragmentCode=function(t,e,i){var r=i.shadedTarget;return"mov "+r+", v0\n"};return e}(a);e.exports=s},{"awayjs-stagegl/lib/materials/passes/MaterialPassBase":undefined}],"awayjs-stagegl/lib/materials/passes/MaterialPassBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/NamedAssetBase");var s=t("awayjs-core/lib/errors/ArgumentError");var n=t("awayjs-core/lib/events/Event");var o=t("awayjs-display/lib/base/BlendMode");var h=t("awayjs-stagegl/lib/base/ContextGLBlendFactor");var l=t("awayjs-stagegl/lib/base/ContextGLCompareMode");var u=t("awayjs-stagegl/lib/materials/compilation/ShaderObjectBase");var p=t("awayjs-stagegl/lib/materials/passes/MaterialPassMode");var c=function(t){r(e,t);function e(e){var i=this;if(e===void 0){e=3}t.call(this);this._materialPassData=new Array;this._maxLights=3;this._preserveAlpha=true;this._includeCasters=true;this._forceSeparateMVP=false;this._directionalLightsOffset=0;this._pointLightsOffset=0;this._lightProbesOffset=0;this._pNumPointLights=0;this._pNumDirectionalLights=0;this._pNumLightProbes=0;this._pNumLights=0;this._depthCompareMode=l.LESS_EQUAL;this._blendFactorSource=h.ONE;this._blendFactorDest=h.ZERO;this._pEnableBlending=false;this._writeDepth=true;this._passMode=e;this._onLightsChangeDelegate=function(t){return i.onLightsChange(t)}}Object.defineProperty(e.prototype,"preserveAlpha",{get:function(){return this._preserveAlpha},set:function(t){if(this._preserveAlpha==t)return;this._preserveAlpha=t;this._pInvalidatePass()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"includeCasters",{get:function(){return this._includeCasters},set:function(t){if(this._includeCasters==t)return;this._includeCasters=t;this._pInvalidatePass()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"forceSeparateMVP",{get:function(){return this._forceSeparateMVP},set:function(t){if(this._forceSeparateMVP==t)return;this._forceSeparateMVP=t;this._pInvalidatePass()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"directionalLightsOffset",{get:function(){return this._directionalLightsOffset},set:function(t){this._directionalLightsOffset=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"pointLightsOffset",{get:function(){return this._pointLightsOffset},set:function(t){this._pointLightsOffset=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lightProbesOffset",{get:function(){return this._lightProbesOffset},set:function(t){this._lightProbesOffset=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"passMode",{get:function(){return this._passMode},set:function(t){this._passMode=t;this._pInvalidatePass()},enumerable:true,configurable:true});e.prototype.createShaderObject=function(t){return new u(t)};Object.defineProperty(e.prototype,"writeDepth",{get:function(){return this._writeDepth},set:function(t){this._writeDepth=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"depthCompareMode",{get:function(){return this._depthCompareMode},set:function(t){this._depthCompareMode=t},enumerable:true,configurable:true});e.prototype.dispose=function(){if(this._pLightPicker)this._pLightPicker.removeEventListener(n.CHANGE,this._onLightsChangeDelegate);while(this._materialPassData.length)this._materialPassData[0].dispose();this._materialPassData=null};e.prototype._iRender=function(t,e,i,r,a){this.setRenderState(t,e,i,r,a)};e.prototype.setRenderState=function(t,e,i,r,a){t.shaderObject.setRenderState(e,i,r,a)};e.prototype.setBlendMode=function(t){switch(t){case o.NORMAL:this._blendFactorSource=h.ONE;this._blendFactorDest=h.ZERO;this._pEnableBlending=false;break;case o.LAYER:this._blendFactorSource=h.SOURCE_ALPHA;this._blendFactorDest=h.ONE_MINUS_SOURCE_ALPHA;this._pEnableBlending=true;break;case o.MULTIPLY:this._blendFactorSource=h.ZERO;this._blendFactorDest=h.SOURCE_COLOR;this._pEnableBlending=true;break;case o.ADD:this._blendFactorSource=h.SOURCE_ALPHA;this._blendFactorDest=h.ONE;this._pEnableBlending=true;break;case o.ALPHA:this._blendFactorSource=h.ZERO;this._blendFactorDest=h.SOURCE_ALPHA;this._pEnableBlending=true;break;default:throw new s("Unsupported blend mode!")}};e.prototype._iActivate=function(t,e,i){var r=e.context;r.setDepthTest(this._writeDepth&&!this._pEnableBlending,this._depthCompareMode);if(this._pEnableBlending)r.setBlendFactors(this._blendFactorSource,this._blendFactorDest);r.activateMaterialPass(t,e,i)};e.prototype._iDeactivate=function(t,e){e.context.deactivateMaterialPass(t,e);e.context.setDepthTest(true,l.LESS_EQUAL)};e.prototype._pInvalidatePass=function(){var t=this._materialPassData.length;for(var e=0;e<t;e++)this._materialPassData[e].invalidate();this.dispatchEvent(new n(n.CHANGE))};Object.defineProperty(e.prototype,"lightPicker",{get:function(){return this._pLightPicker},set:function(t){if(this._pLightPicker)this._pLightPicker.removeEventListener(n.CHANGE,this._onLightsChangeDelegate);this._pLightPicker=t;if(this._pLightPicker)this._pLightPicker.addEventListener(n.CHANGE,this._onLightsChangeDelegate);this.pUpdateLights()},enumerable:true,configurable:true});e.prototype.onLightsChange=function(t){this.pUpdateLights()};e.prototype.pUpdateLights=function(){var t=this._pNumDirectionalLights;var e=this._pNumPointLights;var i=this._pNumLightProbes;if(this._pLightPicker&&this._passMode&p.LIGHTING){this._pNumDirectionalLights=this.calculateNumDirectionalLights(this._pLightPicker.numDirectionalLights);this._pNumPointLights=this.calculateNumPointLights(this._pLightPicker.numPointLights);this._pNumLightProbes=this.calculateNumProbes(this._pLightPicker.numLightProbes);if(this._includeCasters){this._pNumDirectionalLights+=this._pLightPicker.numCastingDirectionalLights;this._pNumPointLights+=this._pLightPicker.numCastingPointLights}}else{this._pNumDirectionalLights=0;this._pNumPointLights=0;this._pNumLightProbes=0}this._pNumLights=this._pNumDirectionalLights+this._pNumPointLights;if(t!=this._pNumDirectionalLights||e!=this._pNumPointLights||i!=this._pNumLightProbes)this._pInvalidatePass()};e.prototype._iIncludeDependencies=function(t){if(this._forceSeparateMVP)t.globalPosDependencies++;t.outputsNormals=this._pOutputsNormals(t);t.outputsTangentNormals=t.outputsNormals&&this._pOutputsTangentNormals(t);t.usesTangentSpace=t.outputsTangentNormals&&this._pUsesTangentSpace(t);if(!t.usesTangentSpace)t.addWorldSpaceDependencies(Boolean(this._passMode&p.EFFECTS))};e.prototype._iInitConstantData=function(t){};e.prototype._iGetPreLightingVertexCode=function(t,e,i){return""};e.prototype._iGetPreLightingFragmentCode=function(t,e,i){return""};e.prototype._iGetVertexCode=function(t,e,i){return""};e.prototype._iGetFragmentCode=function(t,e,i){return""};e.prototype._iGetNormalVertexCode=function(t,e,i){return""
};e.prototype._iGetNormalFragmentCode=function(t,e,i){return""};Object.defineProperty(e.prototype,"iNumPointLights",{get:function(){return this._pNumPointLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"iNumDirectionalLights",{get:function(){return this._pNumDirectionalLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"iNumLightProbes",{get:function(){return this._pNumLightProbes},enumerable:true,configurable:true});e.prototype._pOutputsNormals=function(t){return false};e.prototype._pOutputsTangentNormals=function(t){return false};e.prototype._pUsesTangentSpace=function(t){return false};e.prototype.calculateNumDirectionalLights=function(t){return Math.min(t-this._directionalLightsOffset,this._maxLights)};e.prototype.calculateNumPointLights=function(t){var e=this._maxLights-this._pNumDirectionalLights;return Math.min(t-this._pointLightsOffset,e)};e.prototype.calculateNumProbes=function(t){var e=0;return Math.min(t-this._lightProbesOffset,4/e|0)};e.prototype._iAddMaterialPassData=function(t){this._materialPassData.push(t);return t};e.prototype._iRemoveMaterialPassData=function(t){this._materialPassData.splice(this._materialPassData.indexOf(t),1);return t};return e}(a);e.exports=c},{"awayjs-core/lib/errors/ArgumentError":undefined,"awayjs-core/lib/events/Event":undefined,"awayjs-core/lib/library/NamedAssetBase":undefined,"awayjs-display/lib/base/BlendMode":undefined,"awayjs-stagegl/lib/base/ContextGLBlendFactor":undefined,"awayjs-stagegl/lib/base/ContextGLCompareMode":undefined,"awayjs-stagegl/lib/materials/compilation/ShaderObjectBase":undefined,"awayjs-stagegl/lib/materials/passes/MaterialPassMode":undefined}],"awayjs-stagegl/lib/materials/passes/MaterialPassMode":[function(t,e,i){var r=function(){function t(){}t.EFFECTS=1;t.LIGHTING=2;t.SUPER_SHADER=3;return t}();e.exports=r},{}],"awayjs-stagegl/lib/materials/passes/SkyboxPass":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/materials/passes/MaterialPassBase");var s=function(t){r(e,t);function e(){t.call(this)}e.prototype._iIncludeDependencies=function(t){t.useMipmapping=false};return e}(a);e.exports=s},{"awayjs-stagegl/lib/materials/passes/MaterialPassBase":undefined}],"awayjs-stagegl/lib/materials/passes/TriangleBasicPass":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/base/ContextGLMipFilter");var s=t("awayjs-stagegl/lib/base/ContextGLTextureFilter");var n=t("awayjs-stagegl/lib/base/ContextGLWrapMode");var o=t("awayjs-stagegl/lib/materials/passes/MaterialPassBase");var h=t("awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper");var l=function(t){r(e,t);function e(){t.call(this);this._diffuseColor=16777215;this._diffuseR=1;this._diffuseG=1;this._diffuseB=1;this._diffuseA=1}Object.defineProperty(e.prototype,"diffuseAlpha",{get:function(){return this._diffuseA},set:function(t){this._diffuseA=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"diffuseColor",{get:function(){return this._diffuseColor},set:function(t){this._diffuseColor=t;this._diffuseR=(this._diffuseColor>>16&255)/255;this._diffuseG=(this._diffuseColor>>8&255)/255;this._diffuseB=(this._diffuseColor&255)/255},enumerable:true,configurable:true});e.prototype._iGetFragmentCode=function(t,e,i){var r="";var a=i.shadedTarget;var s;if(t.texture!=null){s=e.getFreeTextureReg();this._texturesIndex=s.index;r+=h.getTex2DSampleCode(a,i,s,t.texture,t.useSmoothTextures,t.repeatTextures,t.useMipmapping);if(t.alphaThreshold>0){var n=e.getFreeFragmentConstant();this._fragmentConstantsIndex=n.index*4;r+="sub "+a+".w, "+a+".w, "+n+".x\n"+"kil "+a+".w\n"+"add "+a+".w, "+a+".w, "+n+".x\n"}}else{s=e.getFreeFragmentConstant();this._fragmentConstantsIndex=s.index*4;r+="mov "+a+", "+s+"\n"}return r};e.prototype._iIncludeDependencies=function(t){if(t.texture!=null)t.uvDependencies++};e.prototype._iActivate=function(e,i,r){t.prototype._iActivate.call(this,e,i,r);var o=e.shaderObject;if(o.texture!=null){i.context.setSamplerStateAt(this._texturesIndex,o.repeatTextures?n.REPEAT:n.CLAMP,o.useSmoothTextures?s.LINEAR:s.NEAREST,o.useMipmapping?a.MIPLINEAR:a.MIPNONE);i.context.activateTexture(this._texturesIndex,o.texture);if(o.alphaThreshold>0)o.fragmentConstantData[this._fragmentConstantsIndex]=o.alphaThreshold}else{var h=this._fragmentConstantsIndex;var l=o.fragmentConstantData;l[h]=this._diffuseR;l[h+1]=this._diffuseG;l[h+2]=this._diffuseB;l[h+3]=this._diffuseA}};return e}(o);e.exports=l},{"awayjs-stagegl/lib/base/ContextGLMipFilter":undefined,"awayjs-stagegl/lib/base/ContextGLTextureFilter":undefined,"awayjs-stagegl/lib/base/ContextGLWrapMode":undefined,"awayjs-stagegl/lib/materials/passes/MaterialPassBase":undefined,"awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper":undefined}],"awayjs-stagegl/lib/materials/passes/TriangleMethodPass":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/events/ShadingMethodEvent");var s=t("awayjs-stagegl/lib/materials/compilation/MethodVO");var n=t("awayjs-stagegl/lib/materials/compilation/ShaderLightingObject");var o=t("awayjs-stagegl/lib/materials/compilation/ShaderObjectBase");var h=t("awayjs-stagegl/lib/materials/methods/EffectColorTransformMethod");var l=t("awayjs-stagegl/lib/materials/passes/MaterialPassBase");var u=t("awayjs-stagegl/lib/materials/passes/MaterialPassMode");var p=function(t){r(e,t);function e(e){var i=this;if(e===void 0){e=3}t.call(this,e);this._iMethodVOs=new Array;this._numEffectDependencies=0;this._onShaderInvalidatedDelegate=function(t){return i.onShaderInvalidated(t)}}e.prototype.createShaderObject=function(t){if(this._pLightPicker&&this.passMode&u.LIGHTING)return new n(t);return new o(t)};e.prototype._iInitConstantData=function(e){t.prototype._iInitConstantData.call(this,e);var i=this._iMethodVOs.length;for(var r=0;r<i;++r)this._iMethodVOs[r].method.iInitConstants(e,this._iMethodVOs[r])};Object.defineProperty(e.prototype,"colorTransform",{get:function(){return this.colorTransformMethod?this.colorTransformMethod.colorTransform:null},set:function(t){if(t){if(this.colorTransformMethod==null)this.colorTransformMethod=new h;this.colorTransformMethod.colorTransform=t}else if(!t){if(this.colorTransformMethod)this.colorTransformMethod=null}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"colorTransformMethod",{get:function(){return this._iColorTransformMethodVO?this._iColorTransformMethodVO.method:null},set:function(t){if(this._iColorTransformMethodVO&&this._iColorTransformMethodVO.method==t)return;if(this._iColorTransformMethodVO){this._removeDependency(this._iColorTransformMethodVO);this._iColorTransformMethodVO=null}if(t){this._iColorTransformMethodVO=new s(t);this._addDependency(this._iColorTransformMethodVO)}},enumerable:true,configurable:true});e.prototype._removeDependency=function(t,e){if(e===void 0){e=false}var i=this._iMethodVOs.indexOf(t);if(!e)this._numEffectDependencies--;t.method.removeEventListener(a.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate);this._iMethodVOs.splice(i,1);this._pInvalidatePass()};e.prototype._addDependency=function(t,e,i){if(e===void 0){e=false}if(i===void 0){i=-1}t.method.addEventListener(a.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate);if(e){if(i!=-1)this._iMethodVOs.splice(i+this._iMethodVOs.length-this._numEffectDependencies,0,t);else this._iMethodVOs.push(t);this._numEffectDependencies++}else{this._iMethodVOs.splice(this._iMethodVOs.length-this._numEffectDependencies,0,t)}this._pInvalidatePass()};e.prototype.addEffectMethod=function(t){this._addDependency(new s(t),true)};Object.defineProperty(e.prototype,"numEffectMethods",{get:function(){return this._numEffectDependencies},enumerable:true,configurable:true});e.prototype.hasEffectMethod=function(t){return this.getDependencyForMethod(t)!=null};e.prototype.getEffectMethodAt=function(t){if(t<0||t>this._numEffectDependencies-1)return null;return this._iMethodVOs[t+this._iMethodVOs.length-this._numEffectDependencies].method};e.prototype.addEffectMethodAt=function(t,e){this._addDependency(new s(t),true,e)};e.prototype.removeEffectMethod=function(t){var e=this.getDependencyForMethod(t);if(e!=null)this._removeDependency(e,true)};e.prototype.getDependencyForMethod=function(t){var e=this._iMethodVOs.length;for(var i=0;i<e;++i)if(this._iMethodVOs[i].method==t)return this._iMethodVOs[i];return null};Object.defineProperty(e.prototype,"normalMethod",{get:function(){return this._iNormalMethodVO?this._iNormalMethodVO.method:null},set:function(t){if(this._iNormalMethodVO&&this._iNormalMethodVO.method==t)return;if(this._iNormalMethodVO){this._removeDependency(this._iNormalMethodVO);this._iNormalMethodVO=null}if(t){this._iNormalMethodVO=new s(t);this._addDependency(this._iNormalMethodVO)}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"ambientMethod",{get:function(){return this._iAmbientMethodVO?this._iAmbientMethodVO.method:null},set:function(t){if(this._iAmbientMethodVO&&this._iAmbientMethodVO.method==t)return;if(this._iAmbientMethodVO){this._removeDependency(this._iAmbientMethodVO);this._iAmbientMethodVO=null}if(t){this._iAmbientMethodVO=new s(t);this._addDependency(this._iAmbientMethodVO)}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"shadowMethod",{get:function(){return this._iShadowMethodVO?this._iShadowMethodVO.method:null},set:function(t){if(this._iShadowMethodVO&&this._iShadowMethodVO.method==t)return;if(this._iShadowMethodVO){this._removeDependency(this._iShadowMethodVO);this._iShadowMethodVO=null}if(t){this._iShadowMethodVO=new s(t);this._addDependency(this._iShadowMethodVO)}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"diffuseMethod",{get:function(){return this._iDiffuseMethodVO?this._iDiffuseMethodVO.method:null},set:function(t){if(this._iDiffuseMethodVO&&this._iDiffuseMethodVO.method==t)return;if(this._iDiffuseMethodVO){this._removeDependency(this._iDiffuseMethodVO);this._iDiffuseMethodVO=null}if(t){this._iDiffuseMethodVO=new s(t);this._addDependency(this._iDiffuseMethodVO)}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"specularMethod",{get:function(){return this._iSpecularMethodVO?this._iSpecularMethodVO.method:null},set:function(t){if(this._iSpecularMethodVO&&this._iSpecularMethodVO.method==t)return;if(this._iSpecularMethodVO){this._removeDependency(this._iSpecularMethodVO);this._iSpecularMethodVO=null}if(t){this._iSpecularMethodVO=new s(t);this._addDependency(this._iSpecularMethodVO)}},enumerable:true,configurable:true});e.prototype.dispose=function(){t.prototype.dispose.call(this);while(this._iMethodVOs.length)this._removeDependency(this._iMethodVOs[0]);this._iMethodVOs=null};e.prototype.onShaderInvalidated=function(t){this._pInvalidatePass()};e.prototype._iActivate=function(e,i,r){t.prototype._iActivate.call(this,e,i,r);var a;var s=this._iMethodVOs.length;for(var n=0;n<s;++n){a=this._iMethodVOs[n];if(a.useMethod)a.method.iActivate(e.shaderObject,a,i)}};e.prototype.setRenderState=function(e,i,r,a,s){t.prototype.setRenderState.call(this,e,i,r,a,s);var n;var o=this._iMethodVOs.length;for(var h=0;h<o;++h){n=this._iMethodVOs[h];if(n.useMethod)n.method.iSetRenderState(e.shaderObject,n,i,r,a)}};e.prototype._iDeactivate=function(e,i){t.prototype._iDeactivate.call(this,e,i);var r;var a=this._iMethodVOs.length;for(var s=0;s<a;++s){r=this._iMethodVOs[s];if(r.useMethod)r.method.iDeactivate(e.shaderObject,r,i)}};e.prototype._iIncludeDependencies=function(e){var i;var r=this._iMethodVOs.length;for(i=0;i<r;++i)this.setupAndCountDependencies(e,this._iMethodVOs[i]);for(i=0;i<r;++i)this._iMethodVOs[i].useMethod=this._iMethodVOs[i].method.iIsUsed(e);t.prototype._iIncludeDependencies.call(this,e)};e.prototype.setupAndCountDependencies=function(t,e){e.reset();e.method.iInitVO(t,e);if(e.needsProjection)t.projectionDependencies++;if(e.needsGlobalVertexPos){t.globalPosDependencies++;if(e.needsGlobalFragmentPos)t.usesGlobalPosFragment=true}else if(e.needsGlobalFragmentPos){t.globalPosDependencies++;t.usesGlobalPosFragment=true}if(e.needsNormals)t.normalDependencies++;if(e.needsTangents)t.tangentDependencies++;if(e.needsView)t.viewDirDependencies++;if(e.needsUV)t.uvDependencies++;if(e.needsSecondaryUV)t.secondaryUVDependencies++};e.prototype._iGetPreLightingVertexCode=function(t,e,i){var r="";if(this._iAmbientMethodVO&&this._iAmbientMethodVO.useMethod)r+=this._iAmbientMethodVO.method.iGetVertexCode(t,this._iAmbientMethodVO,e,i);if(this._iDiffuseMethodVO&&this._iDiffuseMethodVO.useMethod)r+=this._iDiffuseMethodVO.method.iGetVertexCode(t,this._iDiffuseMethodVO,e,i);if(this._iSpecularMethodVO&&this._iSpecularMethodVO.useMethod)r+=this._iSpecularMethodVO.method.iGetVertexCode(t,this._iSpecularMethodVO,e,i);return r};e.prototype._iGetPreLightingFragmentCode=function(t,e,i){var r="";if(this._iAmbientMethodVO&&this._iAmbientMethodVO.useMethod){r+=this._iAmbientMethodVO.method.iGetFragmentCode(t,this._iAmbientMethodVO,i.shadedTarget,e,i);if(this._iAmbientMethodVO.needsNormals)e.removeFragmentTempUsage(i.normalFragment);if(this._iAmbientMethodVO.needsView)e.removeFragmentTempUsage(i.viewDirFragment)}if(this._iDiffuseMethodVO&&this._iDiffuseMethodVO.useMethod)r+=this._iDiffuseMethodVO.method.iGetFragmentPreLightingCode(t,this._iDiffuseMethodVO,e,i);if(this._iSpecularMethodVO&&this._iSpecularMethodVO.useMethod)r+=this._iSpecularMethodVO.method.iGetFragmentPreLightingCode(t,this._iSpecularMethodVO,e,i);return r};e.prototype._iGetPerLightDiffuseFragmentCode=function(t,e,i,r,a){return this._iDiffuseMethodVO.method.iGetFragmentCodePerLight(t,this._iDiffuseMethodVO,e,i,r,a)};e.prototype._iGetPerLightSpecularFragmentCode=function(t,e,i,r,a){return this._iSpecularMethodVO.method.iGetFragmentCodePerLight(t,this._iSpecularMethodVO,e,i,r,a)};e.prototype._iGetPerProbeDiffuseFragmentCode=function(t,e,i,r,a){return this._iDiffuseMethodVO.method.iGetFragmentCodePerProbe(t,this._iDiffuseMethodVO,e,i,r,a)};e.prototype._iGetPerProbeSpecularFragmentCode=function(t,e,i,r,a){return this._iSpecularMethodVO.method.iGetFragmentCodePerProbe(t,this._iSpecularMethodVO,e,i,r,a)};e.prototype._iGetPostLightingVertexCode=function(t,e,i){var r="";if(this._iShadowMethodVO)r+=this._iShadowMethodVO.method.iGetVertexCode(t,this._iShadowMethodVO,e,i);return r};e.prototype._iGetPostLightingFragmentCode=function(t,e,i){var r="";if(t.useAlphaPremultiplied&&this._pEnableBlending){r+="add "+i.shadedTarget+".w, "+i.shadedTarget+".w, "+i.commons+".z\n"+"div "+i.shadedTarget+".xyz, "+i.shadedTarget+", "+i.shadedTarget+".w\n"+"sub "+i.shadedTarget+".w, "+i.shadedTarget+".w, "+i.commons+".z\n"+"sat "+i.shadedTarget+".xyz, "+i.shadedTarget+"\n"}if(this._iShadowMethodVO)r+=this._iShadowMethodVO.method.iGetFragmentCode(t,this._iShadowMethodVO,i.shadowTarget,e,i);if(this._iDiffuseMethodVO&&this._iDiffuseMethodVO.useMethod){r+=this._iDiffuseMethodVO.method.iGetFragmentPostLightingCode(t,this._iDiffuseMethodVO,i.shadedTarget,e,i);if(this._iDiffuseMethodVO.needsNormals)e.removeFragmentTempUsage(i.normalFragment);if(this._iDiffuseMethodVO.needsView)e.removeFragmentTempUsage(i.viewDirFragment)}if(this._iSpecularMethodVO&&this._iSpecularMethodVO.useMethod){r+=this._iSpecularMethodVO.method.iGetFragmentPostLightingCode(t,this._iSpecularMethodVO,i.shadedTarget,e,i);if(this._iSpecularMethodVO.needsNormals)e.removeFragmentTempUsage(i.normalFragment);if(this._iSpecularMethodVO.needsView)e.removeFragmentTempUsage(i.viewDirFragment)}if(this._iShadowMethodVO)e.removeFragmentTempUsage(i.shadowTarget);return r};e.prototype._pUsesTangentSpace=function(t){if(t.usesProbes)return false;var e;var i=this._iMethodVOs.length;for(var r=0;r<i;++r){e=this._iMethodVOs[r];if(e.useMethod&&!e.method.iUsesTangentSpace())return false}return true};e.prototype._pOutputsTangentNormals=function(t){return this._iNormalMethodVO.method.iOutputsTangentNormals()};e.prototype._pOutputsNormals=function(t){return this._iNormalMethodVO&&this._iNormalMethodVO.useMethod};e.prototype._iGetNormalVertexCode=function(t,e,i){return this._iNormalMethodVO.method.iGetVertexCode(t,this._iNormalMethodVO,e,i)};e.prototype._iGetNormalFragmentCode=function(t,e,i){var r=this._iNormalMethodVO.method.iGetFragmentCode(t,this._iNormalMethodVO,i.normalFragment,e,i);if(this._iNormalMethodVO.needsView)e.removeFragmentTempUsage(i.viewDirFragment);if(this._iNormalMethodVO.needsGlobalFragmentPos||this._iNormalMethodVO.needsGlobalVertexPos)e.removeVertexTempUsage(i.globalPositionVertex);return r};e.prototype._iGetVertexCode=function(t,e,i){var r="";var a;var s=this._iMethodVOs.length;for(var n=s-this._numEffectDependencies;n<s;n++){a=this._iMethodVOs[n];if(a.useMethod){r+=a.method.iGetVertexCode(t,a,e,i);if(a.needsGlobalVertexPos||a.needsGlobalFragmentPos)e.removeVertexTempUsage(i.globalPositionVertex)}}if(this._iColorTransformMethodVO&&this._iColorTransformMethodVO.useMethod)r+=this._iColorTransformMethodVO.method.iGetVertexCode(t,this._iColorTransformMethodVO,e,i);return r};e.prototype._iGetFragmentCode=function(t,e,i){var r="";var a;if(this.preserveAlpha&&this._numEffectDependencies>0){a=e.getFreeFragmentSingleTemp();e.addFragmentTempUsages(a,1);r+="mov "+a+", "+i.shadedTarget+".w\n"}var s;var n=this._iMethodVOs.length;for(var o=n-this._numEffectDependencies;o<n;o++){s=this._iMethodVOs[o];if(s.useMethod){r+=s.method.iGetFragmentCode(t,s,i.shadedTarget,e,i);if(s.needsNormals)e.removeFragmentTempUsage(i.normalFragment);if(s.needsView)e.removeFragmentTempUsage(i.viewDirFragment)}}if(this.preserveAlpha&&this._numEffectDependencies>0){r+="mov "+i.shadedTarget+".w, "+a+"\n";e.removeFragmentTempUsage(a)}if(this._iColorTransformMethodVO&&this._iColorTransformMethodVO.useMethod)r+=this._iColorTransformMethodVO.method.iGetFragmentCode(t,this._iColorTransformMethodVO,i.shadedTarget,e,i);return r};e.prototype._iUsesShadows=function(){return Boolean(this._iShadowMethodVO||this.lightPicker.castingDirectionalLights.length>0||this.lightPicker.castingPointLights.length>0)};e.prototype._iUsesSpecular=function(){return Boolean(this._iSpecularMethodVO)};return e}(l);e.exports=p},{"awayjs-stagegl/lib/events/ShadingMethodEvent":undefined,"awayjs-stagegl/lib/materials/compilation/MethodVO":undefined,"awayjs-stagegl/lib/materials/compilation/ShaderLightingObject":undefined,"awayjs-stagegl/lib/materials/compilation/ShaderObjectBase":undefined,"awayjs-stagegl/lib/materials/methods/EffectColorTransformMethod":undefined,"awayjs-stagegl/lib/materials/passes/MaterialPassBase":undefined,"awayjs-stagegl/lib/materials/passes/MaterialPassMode":undefined}],"awayjs-stagegl/lib/materials/utils/DefaultMaterialManager":[function(t,e,i){var r=t("awayjs-core/lib/base/BitmapData");var a=t("awayjs-core/lib/library/AssetType");var s=t("awayjs-core/lib/textures/BitmapTexture");var n=t("awayjs-stagegl/lib/materials/LineBasicMaterial");var o=t("awayjs-stagegl/lib/materials/TriangleBasicMaterial");var h=function(){function t(){}t.getDefaultMaterial=function(e){if(e===void 0){e=null}if(e!=null&&e.assetType==a.LINE_SUB_MESH){if(!t._defaultLineMaterial)t.createDefaultLineMaterial();return t._defaultLineMaterial}else{if(!t._defaultTriangleMaterial)t.createDefaultTriangleMaterial();return t._defaultTriangleMaterial}};t.getDefaultTexture=function(e){if(e===void 0){e=null}if(!t._defaultTexture)t.createDefaultTexture();return t._defaultTexture};t.createDefaultTexture=function(){t._defaultBitmapData=t.createCheckeredBitmapData();t._defaultTexture=new s(t._defaultBitmapData,true);t._defaultTexture.name="defaultTexture"};t.createCheckeredBitmapData=function(){var t=new r(8,8,false,0);var e,i;for(e=0;e<8;e++){for(i=0;i<8;i++){if(i&1^e&1){t.setPixel(e,i,16777215)}}}return t};t.createDefaultTriangleMaterial=function(){if(!t._defaultTexture)t.createDefaultTexture();t._defaultTriangleMaterial=new o(t._defaultTexture);t._defaultTriangleMaterial.mipmap=false;t._defaultTriangleMaterial.smooth=false;t._defaultTriangleMaterial.name="defaultTriangleMaterial"};t.createDefaultLineMaterial=function(){t._defaultLineMaterial=new n;t._defaultLineMaterial.name="defaultSegmentMaterial"};return t}();e.exports=h},{"awayjs-core/lib/base/BitmapData":undefined,"awayjs-core/lib/library/AssetType":undefined,"awayjs-core/lib/textures/BitmapTexture":undefined,"awayjs-stagegl/lib/materials/LineBasicMaterial":undefined,"awayjs-stagegl/lib/materials/TriangleBasicMaterial":undefined}],"awayjs-stagegl/lib/materials/utils/ShaderCompilerHelper":[function(t,e,i){var r=t("awayjs-stagegl/lib/base/ContextGLTextureFormat");var a=function(){function t(){}t.getTex2DSampleCode=function(e,i,r,a,s,n,o,h,l){if(h===void 0){h=null}if(l===void 0){l=null}var u=l||(n?"wrap":"clamp");var p=t.getFormatStringForTexture(a);var c=o&&a.hasMipmaps;var d=s?c?"linear,miplinear":"linear":c?"nearest,mipnearest":"nearest";if(h==null)h=i.uvVarying;return"tex "+e+", "+h+", "+r+" <2d,"+d+","+p+u+">\n"};t.getTexCubeSampleCode=function(e,i,r,a,s,n){var o;var h=t.getFormatStringForTexture(r);var l=s&&r.hasMipmaps;var o=a?l?"linear,miplinear":"linear":l?"nearest,mipnearest":"nearest";return"tex "+e+", "+n+", "+i+" <cube,"+h+o+">\n"};t.getFormatStringForTexture=function(t){switch(t.format){case r.COMPRESSED:return"dxt1,";break;case r.COMPRESSED_ALPHA:return"dxt5,";break;default:return""}};return t}();e.exports=a},{"awayjs-stagegl/lib/base/ContextGLTextureFormat":undefined}],"awayjs-stagegl/lib/pool/BillboardRenderable":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/base/TriangleSubGeometry");var s=t("awayjs-stagegl/lib/pool/RenderableBase");var n=function(t){r(e,t);function e(e,i){t.call(this,e,i,i);this._billboard=i}e.prototype._pGetSubGeometry=function(){var t=this._billboard.material;var i=e._materialGeometry[t.id];if(!i){i=e._materialGeometry[t.id]=new a(true);i.autoDeriveNormals=false;i.autoDeriveTangents=false;i.updateIndices(Array(0,1,2,0,2,3));i.updatePositions(Array(0,t.height,0,t.width,t.height,0,t.width,0,0,0,0,0));i.updateVertexNormals(Array(1,0,0,1,0,0,1,0,0,1,0,0));i.updateVertexTangents(Array(0,0,-1,0,0,-1,0,0,-1,0,0,-1));i.updateUVs(Array(0,0,1,0,1,1,0,1))}else{i.updatePositions(Array(0,t.height,0,t.width,t.height,0,t.width,0,0,0,0,0))}this._pVertexDataDirty[a.POSITION_DATA]=true;this._pVertexDataDirty[a.NORMAL_DATA]=true;this._pVertexDataDirty[a.TANGENT_DATA]=true;this._pVertexDataDirty[a.UV_DATA]=true;return i};e._materialGeometry=new Object;e.id="billboard";return e}(s);e.exports=n},{"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-stagegl/lib/pool/RenderableBase":undefined}],"awayjs-stagegl/lib/pool/IndexDataPool":[function(t,e,i){var r=t("awayjs-stagegl/lib/pool/IndexData");var a=function(){function t(){}t.getItem=function(e,i,a){var s=t._pool[e.id]||(t._pool[e.id]=new Array);var n=s[i]||(s[i]=new r(i));n.updateData(a,e.indices,e.numVertices);return n};t.disposeItem=function(t,e){var i=this._pool[t];i[e].dispose();i[e]=null};t.prototype.disposeData=function(e){var i=t._pool[e];var r=i.length;for(var a=0;a<r;a++){i[a].dispose();i[a]=null}t._pool[e]=null};t._pool=new Object;return t}();e.exports=a},{"awayjs-stagegl/lib/pool/IndexData":undefined}],"awayjs-stagegl/lib/pool/IndexData":[function(t,e,i){var r=function(){function t(t){this._dataDirty=true;this.invalid=new Array(8);this.contexts=new Array(8);this.buffers=new Array(8);this.level=t}t.prototype.updateData=function(e,i,r){if(this._dataDirty){this._dataDirty=false;if(i.length<t.LIMIT_INDICES&&r<t.LIMIT_VERTS){this.indexMappings=null;this.originalIndices=null;this.setData(i);this.offset=i.length}else{var a;var s;var n;var o;var h;var l=new Array;this.indexMappings=new Array(i.length);this.originalIndices=new Array;a=this.indexMappings.length;while(a--)this.indexMappings[a]=-1;var u;var p;n=0;s=i.length;a=e;h=0;while(a<s&&n+3<t.LIMIT_INDICES&&h+3<t.LIMIT_VERTS){for(o=0;o<3;o++){u=i[a+o];if(this.indexMappings[u]>=0){p=this.indexMappings[u]}else{p=h++;this.indexMappings[u]=p;this.originalIndices.push(u)}l[n+o]=p}n+=3;a+=3}this.setData(l);this.offset=a}}};t.prototype.invalidateData=function(){this._dataDirty=true};t.prototype.dispose=function(){for(var t=0;t<8;++t){if(this.contexts[t]){this.contexts[t].disposeIndexData(this);this.contexts[t]=null}}};t.prototype.disposeBuffers=function(){for(var t=0;t<8;++t){if(this.buffers[t]){this.buffers[t].dispose();this.buffers[t]=null}}};t.prototype.invalidateBuffers=function(){for(var t=0;t<8;++t)this.invalid[t]=true};t.prototype.setData=function(t){if(this.data&&this.data.length!=t.length)this.disposeBuffers();else this.invalidateBuffers();this.data=t};t.LIMIT_VERTS=65535;t.LIMIT_INDICES=16777215;return t}();e.exports=r},{}],"awayjs-stagegl/lib/pool/LineSubMeshRenderable":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/base/LineSubGeometry");var s=t("awayjs-stagegl/lib/pool/RenderableBase");var n=function(t){r(e,t);function e(e,i,r,a){if(r===void 0){r=0}if(a===void 0){a=0}t.call(this,e,i.parentMesh,i,r,a);this.subMesh=i}e.prototype._pGetSubGeometry=function(){var t=this.subMesh.subGeometry;this._pVertexDataDirty[a.START_POSITION_DATA]=true;this._pVertexDataDirty[a.END_POSITION_DATA]=true;if(t.thickness)this._pVertexDataDirty[a.THICKNESS_DATA]=true;if(t.startColors)this._pVertexDataDirty[a.COLOR_DATA]=true;return t};e.prototype._pGetOverflowRenderable=function(t,i,r,a){return new e(t,i,r,a)};e.id="linesubmesh";return e}(s);e.exports=n},{"awayjs-display/lib/base/LineSubGeometry":undefined,"awayjs-stagegl/lib/pool/RenderableBase":undefined}],"awayjs-stagegl/lib/pool/MaterialDataPool":[function(t,e,i){var r=t("awayjs-stagegl/lib/pool/MaterialData");var a=function(){function t(t){this._pool=new Object;this._context=t}t.prototype.getItem=function(t){return this._pool[t.id]||(this._pool[t.id]=t._iAddMaterialData(new r(this,this._context,t)))};t.prototype.disposeItem=function(t){t._iRemoveMaterialData(this._pool[t.id]);this._pool[t.id]=null};return t}();e.exports=a},{"awayjs-stagegl/lib/pool/MaterialData":undefined}],"awayjs-stagegl/lib/pool/MaterialData":[function(t,e,i){var r=t("awayjs-stagegl/lib/pool/MaterialPassDataPool");var a=function(){function t(t,e,i){this.invalidAnimation=true;this._pool=t;this.context=e;this.material=i;this._materialPassDataPool=new r(i)}t.prototype.getMaterialPass=function(t,e){var i=this._materialPassDataPool.getItem(t);if(!i.shaderObject){i.shaderObject=t.createShaderObject(e);i.invalid=true}if(i.invalid){i.invalid=false;var r=i.shaderObject.createCompiler(this.material,t);r.compile();i.shadedTarget=r.shadedTarget;i.vertexCode=r.vertexCode;i.fragmentCode=r.fragmentCode;i.postAnimationFragmentCode=r.postAnimationFragmentCode;i.key=""}return i};t.prototype.getMaterialPasses=function(t){if(this._passes==null){var e=this.material._iScreenPasses;var i=e.length;this._passes=new Array(i);for(var r=0;r<i;r++)this._passes[r]=this.getMaterialPass(e[r],t)}return this._passes};t.prototype.dispose=function(){this._materialPassDataPool.disposePool();this._materialPassDataPool=null;this._pool.disposeItem(this.material);this._passes=null};t.prototype.invalidateMaterial=function(){this._passes=null;this.invalidateAnimation()};t.prototype.invalidateAnimation=function(){this.invalidAnimation=true};return t}();e.exports=a},{"awayjs-stagegl/lib/pool/MaterialPassDataPool":undefined}],"awayjs-stagegl/lib/pool/MaterialPassDataPool":[function(t,e,i){var r=t("awayjs-stagegl/lib/pool/MaterialPassData");var a=function(){function t(t){this._pool=new Object;this._material=t}t.prototype.getItem=function(t){return this._pool[t.id]||(this._pool[t.id]=this._material._iAddMaterialPassData(t._iAddMaterialPassData(new r(this,this._material,t))))};t.prototype.disposeItem=function(t){t._iRemoveMaterialPassData(this._pool[t.id]);delete this._pool[t.id]};t.prototype.disposePool=function(){for(var t in this._pool)this._pool[t].materialPass._iRemoveMaterialPassData(this._pool[t]);delete this._pool};return t}();e.exports=a},{"awayjs-stagegl/lib/pool/MaterialPassData":undefined}],"awayjs-stagegl/lib/pool/MaterialPassData":[function(t,e,i){var r=function(){function t(t,e,i){this.animationVertexCode="";this.animationFragmentCode="";this._pool=t;this.material=e;this.materialPass=i}t.prototype.dispose=function(){this._pool.disposeItem(this.materialPass);this.shaderObject.dispose();this.shaderObject=null;this.programData.dispose();this.programData=null};t.prototype.invalidate=function(){this.invalid=true};return t}();e.exports=r},{}],"awayjs-stagegl/lib/pool/ProgramDataPool":[function(t,e,i){var r=t("awayjs-stagegl/lib/pool/ProgramData");var a=function(){function t(t){this._pool=new Object;this._context=t}t.prototype.getItem=function(t){return this._pool[t]||(this._pool[t]=new r(this,this._context,t))};t.prototype.disposeItem=function(t){this._pool[t]=null};return t}();e.exports=a},{"awayjs-stagegl/lib/pool/ProgramData":undefined}],"awayjs-stagegl/lib/pool/ProgramData":[function(t,e,i){var r=function(){function t(t,e,i){this.usages=0;this._pool=t;this.context=e;this._key=i;this.context.registerProgram(this)}t.prototype.dispose=function(){this.usages--;if(!this.usages){this._pool.disposeItem(this._key);this.context.unRegisterProgram(this);if(this.program)this.program.dispose()}this.program=null};t.PROGRAMDATA_ID_COUNT=0;return t}();e.exports=r},{}],"awayjs-stagegl/lib/pool/RenderableBase":[function(t,e,i){var r=t("awayjs-core/lib/errors/AbstractMethodError");var a=t("awayjs-display/lib/base/SubGeometryBase");var s=t("awayjs-display/lib/base/TriangleSubGeometry");var n=t("awayjs-display/lib/events/SubGeometryEvent");var o=t("awayjs-stagegl/lib/pool/IndexDataPool");var h=t("awayjs-stagegl/lib/pool/VertexDataPool");var l=function(){function t(t,e,i,r,a){var s=this;if(r===void 0){r=0}if(a===void 0){a=0}this._geometryDirty=true;this._indexDataDirty=true;this._vertexData=new Object;this._pVertexDataDirty=new Object;this._vertexOffset=new Object;this._onIndicesUpdatedDelegate=function(t){return s._onIndicesUpdated(t)};this._onVerticesUpdatedDelegate=function(t){return s._onVerticesUpdated(t)};this._pool=t;this._level=r;this._indexOffset=a;this.sourceEntity=e;this.materialOwner=i}Object.defineProperty(t.prototype,"overflow",{get:function(){if(this._indexDataDirty)this._updateIndexData();return this._overflow},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"numTriangles",{get:function(){return this._numTriangles},enumerable:true,configurable:true});t.prototype.getIndexData=function(){if(this._indexDataDirty)this._updateIndexData();return this._indexData};t.prototype.getVertexData=function(t){if(this._indexDataDirty)this._updateIndexData();if(this._pVertexDataDirty[t])this._updateVertexData(t);return this._vertexData[this._concatenateArrays?s.VERTEX_DATA:t]};t.prototype.getVertexOffset=function(t){if(this._indexDataDirty)this._updateIndexData();if(this._pVertexDataDirty[t])this._updateVertexData(t);return this._vertexOffset[t]};t.prototype.dispose=function(){this._pool.disposeItem(this.materialOwner);this._indexData.dispose();this._indexData=null;for(var t in this._vertexData){this._vertexData[t].dispose();this._vertexData[t]=null}if(this._overflow){this._overflow.dispose();this._overflow=null}};t.prototype.invalidateGeometry=function(){this._geometryDirty=true;if(this._level==0)this._indexDataDirty=true;if(this._overflow)this._overflow.invalidateGeometry()};t.prototype.invalidateIndexData=function(){this._indexDataDirty=true};t.prototype.invalidateVertexData=function(t){this._pVertexDataDirty[t]=true
};t.prototype._pGetSubGeometry=function(){throw new r};t.prototype._iFillIndexData=function(t){if(this._geometryDirty)this._updateGeometry();this._indexData=o.getItem(this._subGeometry,this._level,t);this._numTriangles=this._indexData.data.length/3;t=this._indexData.offset;if(t<this._subGeometry.indices.length){if(!this._overflow)this._overflow=this._pGetOverflowRenderable(this._pool,this.materialOwner,t,this._level+1);this._overflow._iFillIndexData(t)}else if(this._overflow){this._overflow.dispose();this._overflow=null}};t.prototype._pGetOverflowRenderable=function(t,e,i,a){throw new r};t.prototype._updateGeometry=function(){if(this._subGeometry){if(this._level==0)this._subGeometry.removeEventListener(n.INDICES_UPDATED,this._onIndicesUpdatedDelegate);this._subGeometry.removeEventListener(n.VERTICES_UPDATED,this._onVerticesUpdatedDelegate)}this._subGeometry=this._pGetSubGeometry();this._concatenateArrays=this._subGeometry.concatenateArrays;if(this._subGeometry){if(this._level==0)this._subGeometry.addEventListener(n.INDICES_UPDATED,this._onIndicesUpdatedDelegate);this._subGeometry.addEventListener(n.VERTICES_UPDATED,this._onVerticesUpdatedDelegate)}this._geometryDirty=false};t.prototype._updateIndexData=function(){this._iFillIndexData(this._indexOffset);this._indexDataDirty=false};t.prototype._updateVertexData=function(t){this._vertexOffset[t]=this._subGeometry.getOffset(t);if(this._subGeometry.concatenateArrays)t=a.VERTEX_DATA;this._vertexData[t]=h.getItem(this._subGeometry,this.getIndexData(),t);this._pVertexDataDirty[t]=false};t.prototype._onIndicesUpdated=function(t){this.invalidateIndexData()};t.prototype._onVerticesUpdated=function(t){this._concatenateArrays=t.target.concatenateArrays;this.invalidateVertexData(t.dataType)};return t}();e.exports=l},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-display/lib/base/SubGeometryBase":undefined,"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-display/lib/events/SubGeometryEvent":undefined,"awayjs-stagegl/lib/pool/IndexDataPool":undefined,"awayjs-stagegl/lib/pool/VertexDataPool":undefined}],"awayjs-stagegl/lib/pool/SkyboxRenderable":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/base/TriangleSubGeometry");var s=t("awayjs-stagegl/lib/pool/RenderableBase");var n=function(t){r(e,t);function e(e,i){t.call(this,e,i,i)}e.prototype._pGetSubGeometry=function(){var t=e._geometry;if(!t){t=e._geometry=new a(true);t.autoDeriveNormals=false;t.autoDeriveTangents=false;t.updateIndices(Array(0,1,2,2,3,0,6,5,4,4,7,6,2,6,7,7,3,2,4,5,1,1,0,4,4,0,3,3,7,4,2,1,5,5,6,2));t.updatePositions(Array(-1,1,-1,1,1,-1,1,1,1,-1,1,1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1))}this._pVertexDataDirty[a.POSITION_DATA]=true;return t};e.id="skybox";return e}(s);e.exports=n},{"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-stagegl/lib/pool/RenderableBase":undefined}],"awayjs-stagegl/lib/pool/TextureDataPool":[function(t,e,i){var r=t("awayjs-stagegl/lib/pool/TextureData");var a=function(){function t(t){this._pool=new Object;this._context=t}t.prototype.getItem=function(t){return this._pool[t.id]||(this._pool[t.id]=t._iAddTextureData(new r(this,this._context,t)))};t.prototype.disposeItem=function(t){t._iRemoveTextureData(this._pool[t.id]);this._pool[t.id]=null};return t}();e.exports=a},{"awayjs-stagegl/lib/pool/TextureData":undefined}],"awayjs-stagegl/lib/pool/TextureData":[function(t,e,i){var r=function(){function t(t,e,i){this._pool=t;this.context=e;this.textureProxy=i}t.prototype.dispose=function(){this._pool.disposeItem(this.textureProxy);this.texture.dispose();this.texture=null};t.prototype.invalidate=function(){this.invalid=true};return t}();e.exports=r},{}],"awayjs-stagegl/lib/pool/TriangleSubMeshRenderable":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-display/lib/base/TriangleSubGeometry");var s=t("awayjs-stagegl/lib/pool/RenderableBase");var n=t("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var o=function(t){r(e,t);function e(e,i,r,a){if(r===void 0){r=0}if(a===void 0){a=0}t.call(this,e,i.parentMesh,i,r,a);this.subMesh=i}e.prototype._pGetSubGeometry=function(){var t;if(this.subMesh.animator)t=this.subMesh.animator.getRenderableSubGeometry(this,this.subMesh.subGeometry);else t=this.subMesh.subGeometry;this._pVertexDataDirty[a.POSITION_DATA]=true;if(t.vertexNormals)this._pVertexDataDirty[a.NORMAL_DATA]=true;if(t.vertexTangents)this._pVertexDataDirty[a.TANGENT_DATA]=true;if(t.uvs)this._pVertexDataDirty[a.UV_DATA]=true;if(t.secondaryUVs)this._pVertexDataDirty[a.SECONDARY_UV_DATA]=true;if(t.jointIndices)this._pVertexDataDirty[a.JOINT_INDEX_DATA]=true;if(t.jointWeights)this._pVertexDataDirty[a.JOINT_WEIGHT_DATA]=true;switch(t.jointsPerVertex){case 1:this.JOINT_INDEX_FORMAT=this.JOINT_WEIGHT_FORMAT=n.FLOAT_1;break;case 2:this.JOINT_INDEX_FORMAT=this.JOINT_WEIGHT_FORMAT=n.FLOAT_2;break;case 3:this.JOINT_INDEX_FORMAT=this.JOINT_WEIGHT_FORMAT=n.FLOAT_3;break;case 4:this.JOINT_INDEX_FORMAT=this.JOINT_WEIGHT_FORMAT=n.FLOAT_4;break;default:}return t};e.prototype._pGetOverflowRenderable=function(t,i,r,a){return new e(t,i,r,a)};e.id="trianglesubmesh";return e}(s);e.exports=o},{"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined,"awayjs-stagegl/lib/pool/RenderableBase":undefined}],"awayjs-stagegl/lib/pool/VertexDataPool":[function(t,e,i){var r=t("awayjs-display/lib/base/SubGeometryBase");var a=t("awayjs-stagegl/lib/pool/VertexData");var s=function(){function t(){}t.getItem=function(e,i,s){if(e.concatenateArrays)s=r.VERTEX_DATA;var n=t._pool[e.id]||(t._pool[e.id]=new Object);var o=n[s]||(n[s]=new Array);var h=o[i.level]||(o[i.level]=new a(e,s));h.updateData(i.originalIndices,i.indexMappings);return h};t.disposeItem=function(e,i,r){var a=t._pool[e.id];var s=a[r];s[i].dispose();s[i]=null};t.prototype.disposeData=function(e){var i=t._pool[e.id];for(var r in i){var a=i[r];var s=a.length;for(var n=0;n<s;n++){a[n].dispose();a[n]=null}}t._pool[e.id]=null};t._pool=new Object;return t}();e.exports=s},{"awayjs-display/lib/base/SubGeometryBase":undefined,"awayjs-stagegl/lib/pool/VertexData":undefined}],"awayjs-stagegl/lib/pool/VertexData":[function(t,e,i){var r=t("awayjs-display/lib/base/SubGeometryBase");var a=t("awayjs-display/lib/events/SubGeometryEvent");var s=function(){function t(t,e){var i=this;this._dataDirty=true;this.invalid=new Array(8);this.buffers=new Array(8);this.contexts=new Array(8);this._subGeometry=t;this._dataType=e;this._onVerticesUpdatedDelegate=function(t){return i._onVerticesUpdated(t)};this._subGeometry.addEventListener(a.VERTICES_UPDATED,this._onVerticesUpdatedDelegate)}t.prototype.updateData=function(t,e){if(t===void 0){t=null}if(e===void 0){e=null}if(this._dataDirty){this._dataDirty=false;this.dataPerVertex=this._subGeometry.getStride(this._dataType);var i=this._subGeometry[this._dataType];if(e==null){this.setData(i)}else{var r=new Array(t.length*this.dataPerVertex);var a;var s;var n=0;var o=0;while(n<t.length){a=t[n];s=e[a]*this.dataPerVertex;a*=this.dataPerVertex;for(o=0;o<this.dataPerVertex;o++)r[s+o]=i[a+o];n++}this.setData(r)}}};t.prototype.dispose=function(){for(var t=0;t<8;++t){if(this.contexts[t]){this.contexts[t].disposeVertexData(this);this.contexts[t]=null}}};t.prototype.disposeBuffers=function(){for(var t=0;t<8;++t){if(this.buffers[t]){this.buffers[t].dispose();this.buffers[t]=null}}};t.prototype.invalidateBuffers=function(){for(var t=0;t<8;++t)this.invalid[t]=true};t.prototype.setData=function(t){if(this.data&&this.data.length!=t.length)this.disposeBuffers();else this.invalidateBuffers();this.data=t};t.prototype._onVerticesUpdated=function(t){var e=this._subGeometry.concatenateArrays?r.VERTEX_DATA:t.dataType;if(e==this._dataType)this._dataDirty=true};return t}();e.exports=s},{"awayjs-display/lib/base/SubGeometryBase":undefined,"awayjs-display/lib/events/SubGeometryEvent":undefined}],"awayjs-stagegl/lib/render/DefaultRenderer":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Matrix3D");var s=t("awayjs-core/lib/geom/Vector3D");var n=t("awayjs-core/lib/textures/RenderTexture");var o=t("awayjs-display/lib/pool/RenderablePool");var h=t("awayjs-stagegl/lib/pool/SkyboxRenderable");var l=t("awayjs-stagegl/lib/render/DepthRenderer");var u=t("awayjs-stagegl/lib/render/Filter3DRenderer");var p=t("awayjs-stagegl/lib/render/RendererBase");var c=t("awayjs-stagegl/lib/base/ContextGLBlendFactor");var d=t("awayjs-stagegl/lib/base/ContextGLCompareMode");var f=t("awayjs-stagegl/lib/base/ContextGLClearMask");var _=t("awayjs-stagegl/lib/managers/RTTBufferManager");var y=t("awayjs-stagegl/lib/managers/StageManager");var g=t("awayjs-stagegl/lib/materials/passes/DepthMapPass");var m=t("awayjs-stagegl/lib/materials/passes/DistanceMapPass");var b=function(t){r(e,t);function e(e,i,r){if(e===void 0){e=false}if(i===void 0){i="baseline"}if(r===void 0){r="auto"}t.call(this);this._skyboxProjection=new a;this._skyboxRenderablePool=o.getPool(h);this._pDepthRenderer=new l(new g);this._pDistanceRenderer=new l(new m);if(this._pStage==null)this.stage=y.getInstance().getFreeStage(e,i,r);this._pRttBufferManager=_.getInstance(this._pStage);if(this._width==0)this.width=window.innerWidth;else this._pRttBufferManager.viewWidth=this._width;if(this._height==0)this.height=window.innerHeight;else this._pRttBufferManager.viewHeight=this._height}Object.defineProperty(e.prototype,"antiAlias",{get:function(){return this._antiAlias},set:function(t){if(this._antiAlias==t)return;this._antiAlias=t;this._pBackBufferInvalid=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"depthPrepass",{get:function(){return this._depthPrepass},set:function(t){this._depthPrepass=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"filters3d",{get:function(){return this._pFilter3DRenderer?this._pFilter3DRenderer.filters:null},set:function(t){if(t&&t.length==0)t=null;if(this._pFilter3DRenderer&&!t){this._pFilter3DRenderer.dispose();this._pFilter3DRenderer=null}else if(!this._pFilter3DRenderer&&t){this._pFilter3DRenderer=new u(this._pStage);this._pFilter3DRenderer.filters=t}if(this._pFilter3DRenderer){this._pFilter3DRenderer.filters=t;this._pRequireDepthRender=this._pFilter3DRenderer.requireDepthRender}else{this._pRequireDepthRender=false;if(this._pDepthRender){this._pDepthRender.dispose();this._pDepthRender=null}}},enumerable:true,configurable:true});e.prototype.render=function(e){t.prototype.render.call(this,e);if(!this._pStage.recoverFromDisposal()){this._pBackBufferInvalid=true;return}if(this._pBackBufferInvalid)this.pUpdateBackBuffer();if(this._shareContext&&this._pContext)this._pContext.clear(0,0,0,1,1,0,f.DEPTH);if(this._pFilter3DRenderer){this.textureRatioX=this._pRttBufferManager.textureRatioX;this.textureRatioY=this._pRttBufferManager.textureRatioY}else{this.textureRatioX=1;this.textureRatioY=1}if(this._pRequireDepthRender)this.pRenderSceneDepthToTexture(e);if(this._depthPrepass)this.pRenderDepthPrepass(e);if(this._pFilter3DRenderer&&this._pContext){}else{if(this._shareContext)this._iRender(e,null,this._pScissorRect);else this._iRender(e)}t.prototype.render.call(this,e);if(!this._shareContext&&this._pContext)this._pContext.present();this._pStage.bufferClear=false};e.prototype.pExecuteRender=function(e,i,r,a){if(i===void 0){i=null}if(r===void 0){r=null}if(a===void 0){a=0}this.updateLights(e);if(i){this.pCollectRenderables(e);this.drawRenderables(this._pOpaqueRenderableHead,e);this.drawRenderables(this._pBlendedRenderableHead,e)}t.prototype.pExecuteRender.call(this,e,i,r,a)};e.prototype.updateLights=function(t){var e=t.directionalLights;var i=t.pointLights;var r,a;var s;var n;r=e.length;for(a=0;a<r;++a){s=e[a];n=s.shadowMapper;if(s.castsShadows&&(n.autoUpdateShadows||n._iShadowsInvalid))n.iRenderDepthMap(t,this._pDepthRenderer)}r=i.length;for(a=0;a<r;++a){s=i[a];n=s.shadowMapper;if(s.castsShadows&&(n.autoUpdateShadows||n._iShadowsInvalid))n.iRenderDepthMap(t,this._pDistanceRenderer)}};e.prototype.pDraw=function(t,e){if(!e)this.pCollectRenderables(t);this._pContext.setBlendFactors(c.ONE,c.ZERO);if(t.skyBox){this._pContext.setDepthTest(false,d.ALWAYS);this.drawSkybox(t)}this._pContext.setDepthTest(true,d.LESS_EQUAL);this.drawRenderables(this._pOpaqueRenderableHead,t);this.drawRenderables(this._pBlendedRenderableHead,t)};e.prototype.drawSkybox=function(t){var e=this._skyboxRenderablePool.getItem(t.skyBox);var i=t.skyBox.material;var r=t.camera;this.updateSkyboxProjection(r);var a=this._pStage.context.getMaterial(i,this._pStage.profile).getMaterialPass(i._iScreenPasses[0],this._pStage.profile);i._iActivatePass(a,this._pStage,r);i._iRenderPass(a,e,this._pStage,r,this._skyboxProjection);i._iDeactivatePass(a,this._pStage)};e.prototype.updateSkyboxProjection=function(t){var e=new s;this._skyboxProjection.copyFrom(this._pRttViewProjectionMatrix);this._skyboxProjection.copyRowTo(2,e);var i=t.scenePosition;var r=e.x;var a=e.y;var n=e.z;var o=-(e.x*i.x+e.y*i.y+e.z*i.z+Math.sqrt(r*r+a*a+n*n));var h=r>=0?1:-1;var l=a>=0?1:-1;var u=new s(h,l,1,1);var p=this._skyboxProjection.clone();p.invert();var c=p.transformVector(u);this._skyboxProjection.copyRowTo(3,u);var d=(c.x*u.x+c.y*u.y+c.z*u.z+c.w*u.w)/(r*c.x+a*c.y+n*c.z+o*c.w);this._skyboxProjection.copyRowFrom(2,new s(r*d,a*d,n*d,o*d))};e.prototype.drawRenderables=function(t,e){var i;var r;var a;var s;var n;var o=this._pStage.context;var h=e.camera;var l;while(t){n=o.getMaterial(t.material,this._pStage.profile);a=t.material._iScreenPasses;r=t.material._iNumScreenPasses();for(i=0;i<r;i++){l=t;s=n.getMaterialPass(a[i],this._pStage.profile);t.material._iActivatePass(s,this._pStage,h);do{t.material._iRenderPass(s,l,this._pStage,h,this._pRttViewProjectionMatrix);l=l.next}while(l&&l.material==t.material);n.material._iDeactivatePass(s,this._pStage)}t=l}};e.prototype.dispose=function(){if(!this._shareContext)this._pStage.dispose();this._pDepthRenderer.dispose();this._pDistanceRenderer.dispose();this._pDepthRenderer=null;this._pDistanceRenderer=null;this._pDepthRender=null;t.prototype.dispose.call(this)};e.prototype.pRenderDepthPrepass=function(t){this._pDepthRenderer.disableColor=true;if(this._pFilter3DRenderer){}else{this._pDepthRenderer.textureRatioX=1;this._pDepthRenderer.textureRatioY=1;this._pDepthRenderer._iRender(t)}this._pDepthRenderer.disableColor=false};e.prototype.pRenderSceneDepthToTexture=function(t){if(this._pDepthTextureInvalid||!this._pDepthRender)this.initDepthTexture(this._pStage.context);this._pDepthRenderer.textureRatioX=this._pRttBufferManager.textureRatioX;this._pDepthRenderer.textureRatioY=this._pRttBufferManager.textureRatioY;this._pDepthRenderer._iRender(t,this._pDepthRender)};e.prototype.pUpdateBackBuffer=function(){if(this._pStage.context&&!this._shareContext){if(this._width&&this._height){this._pStage.configureBackBuffer(this._width,this._height,this._antiAlias,true);this._pBackBufferInvalid=false}}};e.prototype.iSetStage=function(e){t.prototype.iSetStage.call(this,e);this._pDistanceRenderer.iSetStage(e);this._pDepthRenderer.iSetStage(e)};e.prototype.initDepthTexture=function(t){this._pDepthTextureInvalid=false;if(this._pDepthRender)this._pDepthRender.dispose();this._pDepthRender=new n(this._pRttBufferManager.textureWidth,this._pRttBufferManager.textureHeight)};return e}(p);e.exports=b},{"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/textures/RenderTexture":undefined,"awayjs-display/lib/pool/RenderablePool":undefined,"awayjs-stagegl/lib/base/ContextGLBlendFactor":undefined,"awayjs-stagegl/lib/base/ContextGLClearMask":undefined,"awayjs-stagegl/lib/base/ContextGLCompareMode":undefined,"awayjs-stagegl/lib/managers/RTTBufferManager":undefined,"awayjs-stagegl/lib/managers/StageManager":undefined,"awayjs-stagegl/lib/materials/passes/DepthMapPass":undefined,"awayjs-stagegl/lib/materials/passes/DistanceMapPass":undefined,"awayjs-stagegl/lib/pool/SkyboxRenderable":undefined,"awayjs-stagegl/lib/render/DepthRenderer":undefined,"awayjs-stagegl/lib/render/Filter3DRenderer":undefined,"awayjs-stagegl/lib/render/RendererBase":undefined}],"awayjs-stagegl/lib/render/DepthRenderer":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-stagegl/lib/render/RendererBase");var s=t("awayjs-stagegl/lib/base/ContextGLBlendFactor");var n=t("awayjs-stagegl/lib/base/ContextGLCompareMode");var o=function(t){r(e,t);function e(e,i){if(i===void 0){i=false}t.call(this);this._pass=e;this._renderBlended=i;this._iBackgroundR=1;this._iBackgroundG=1;this._iBackgroundB=1}Object.defineProperty(e.prototype,"disableColor",{get:function(){return this._disableColor},set:function(t){this._disableColor=t},enumerable:true,configurable:true});e.prototype._iRenderCascades=function(t,e,i,r,a){this.pCollectRenderables(t);this._pContext.setRenderTarget(e,true,0);this._pContext.clear(1,1,1,1,1,0);this._pContext.setBlendFactors(s.ONE,s.ZERO);this._pContext.setDepthTest(true,n.LESS);var o=this._pOpaqueRenderableHead;var h=true;for(var l=i-1;l>=0;--l){this._pStage.scissorRect=r[l];this.drawCascadeRenderables(o,a[l],h?null:a[l].frustumPlanes);h=false}this._pContext.setDepthTest(false,n.LESS_EQUAL);this._pStage.scissorRect=null};e.prototype.drawCascadeRenderables=function(t,e,i){var r;var a;var s=this._pStage.context;var n;while(t){a=s.getMaterial(t.material,this._pStage.profile);n=t;r=a.getMaterialPass(this._pass,this._pStage.profile);if(r.key=="")this._pContext.calcAnimationCode(t.material,r);t.material._iActivatePass(r,this._pStage,e);do{if(!i||n.sourceEntity.worldBounds.isInFrustum(i,4)){n.material._iRenderPass(r,n,this._pStage,e,this._pRttViewProjectionMatrix)}else{n.cascaded=true}n=n.next}while(n&&n.material==t.material&&!n.cascaded);t.material._iDeactivatePass(r,this._pStage);t=n}};e.prototype.pDraw=function(t,e){this.pCollectRenderables(t);this._pContext.setBlendFactors(s.ONE,s.ZERO);this._pContext.setDepthTest(true,n.LESS);this.drawRenderables(this._pOpaqueRenderableHead,t);if(this._disableColor)this._pContext.setColorMask(false,false,false,false);if(this._renderBlended)this.drawRenderables(this._pBlendedRenderableHead,t);if(this._disableColor)this._pContext.setColorMask(true,true,true,true)};e.prototype.drawRenderables=function(t,e){var i;var r;var a=this._pStage.context;var s=e.camera;var n;while(t){r=a.getMaterial(t.material,this._pStage.profile);if(this._disableColor&&t.material.alphaThreshold!=0){n=t;do{n=n.next}while(n&&n.material==t.material)}else{n=t;i=r.getMaterialPass(this._pass,this._pStage.profile);if(i.key=="")this._pContext.calcAnimationCode(t.material,i);t.material._iActivatePass(i,this._pStage,s);do{n.material._iRenderPass(i,n,this._pStage,s,this._pRttViewProjectionMatrix);n=n.next}while(n&&n.material==t.material);t.material._iDeactivatePass(i,this._pStage)}t=n}};return e}(a);e.exports=o},{"awayjs-stagegl/lib/base/ContextGLBlendFactor":undefined,"awayjs-stagegl/lib/base/ContextGLCompareMode":undefined,"awayjs-stagegl/lib/render/RendererBase":undefined}],"awayjs-stagegl/lib/render/Filter3DRenderer":[function(t,e,i){var r=t("awayjs-core/lib/events/Event");var a=t("awayjs-stagegl/lib/base/ContextGLBlendFactor");var s=t("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var n=t("awayjs-stagegl/lib/managers/RTTBufferManager");var o=function(){function t(t){var e=this;this._filterSizesInvalid=true;this._onRTTResizeDelegate=function(t){return e.onRTTResize(t)};this._stage=t;this._rttManager=n.getInstance(t);this._rttManager.addEventListener(r.RESIZE,this._onRTTResizeDelegate)}t.prototype.onRTTResize=function(t){this._filterSizesInvalid=true};Object.defineProperty(t.prototype,"requireDepthRender",{get:function(){return this._requireDepthRender},enumerable:true,configurable:true});t.prototype.getMainInputTexture=function(t){if(this._filterTasksInvalid){this.updateFilterTasks(t)}return this._mainInputTexture};Object.defineProperty(t.prototype,"filters",{get:function(){return this._filters},set:function(t){this._filters=t;this._filterTasksInvalid=true;this._requireDepthRender=false;if(!this._filters){return}for(var e=0;e<this._filters.length;++e){var i=this._filters[e];var r=i.requireDepthRender==null?false:i.requireDepthRender;this._requireDepthRender=this._requireDepthRender||r}this._filterSizesInvalid=true},enumerable:true,configurable:true});t.prototype.updateFilterTasks=function(t){var e;if(this._filterSizesInvalid){this.updateFilterSizes()}if(!this._filters){this._tasks=null;return}this._tasks=new Array;e=this._filters.length-1;var i;for(var r=0;r<=e;++r){i=this._filters[r];i.setRenderTargets(r==e?null:this._filters[r+1].getMainInputTexture(t),t);this._tasks=this._tasks.concat(i.tasks)}this._mainInputTexture=this._filters[0].getMainInputTexture(t)};t.prototype.render=function(t,e,i){var r;var n;var o;var h=t.context;var l=this._rttManager.indexBuffer;var u=this._rttManager.renderToTextureVertexBuffer;if(!this._filters){return}if(this._filterSizesInvalid){this.updateFilterSizes()}if(this._filterTasksInvalid){this.updateFilterTasks(t)}r=this._filters.length;for(n=0;n<r;++n){this._filters[n].update(t,e)}r=this._tasks.length;if(r>1){h.setVertexBufferAt(0,u,0,s.FLOAT_2);h.setVertexBufferAt(1,u,2,s.FLOAT_2)}for(n=0;n<r;++n){o=this._tasks[n];if(!o.target){t.scissorRect=null;u=this._rttManager.renderToScreenVertexBuffer;h.setVertexBufferAt(0,u,0,s.FLOAT_2);h.setVertexBufferAt(1,u,2,s.FLOAT_2)}h.setTextureAt(0,o.getMainInputTexture(t));h.setProgram(o.getProgram(t));h.clear(0,0,0,0);o.activate(t,e,i);h.setBlendFactors(a.ONE,a.ZERO);h.drawTriangles(l,0,2);o.deactivate(t)}h.setTextureAt(0,null);h.setVertexBufferAt(0,null);h.setVertexBufferAt(1,null)};t.prototype.updateFilterSizes=function(){for(var t=0;t<this._filters.length;++t){this._filters[t].textureWidth=this._rttManager.textureWidth;this._filters[t].textureHeight=this._rttManager.textureHeight}this._filterSizesInvalid=true};t.prototype.dispose=function(){this._rttManager.removeEventListener(r.RESIZE,this._onRTTResizeDelegate);this._rttManager=null;this._stage=null};return t}();e.exports=o},{"awayjs-core/lib/events/Event":undefined,"awayjs-stagegl/lib/base/ContextGLBlendFactor":undefined,"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined,"awayjs-stagegl/lib/managers/RTTBufferManager":undefined}],"awayjs-stagegl/lib/render/RendererBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Matrix3D");var s=t("awayjs-core/lib/geom/Point");var n=t("awayjs-core/lib/geom/Rectangle");var o=t("awayjs-core/lib/errors/AbstractMethodError");var h=t("awayjs-core/lib/events/EventDispatcher");var l=t("awayjs-display/lib/pool/RenderablePool");var u=t("awayjs-display/lib/sort/RenderableMergeSort");var p=t("awayjs-display/lib/events/RendererEvent");var c=t("awayjs-display/lib/events/StageEvent");var d=t("awayjs-display/lib/traverse/EntityCollector");var f=t("awayjs-stagegl/lib/pool/BillboardRenderable");var _=t("awayjs-stagegl/lib/pool/LineSubMeshRenderable");var y=t("awayjs-stagegl/lib/pool/TriangleSubMeshRenderable");var g=t("awayjs-stagegl/lib/base/ContextGLCompareMode");var m=t("awayjs-stagegl/lib/materials/utils/DefaultMaterialManager");var b=function(t){r(e,t);function e(){var e=this;t.call(this);this._viewPort=new n;this._pBackBufferInvalid=true;this._pDepthTextureInvalid=true;this._depthPrepass=false;this._backgroundR=0;this._backgroundG=0;this._backgroundB=0;this._backgroundAlpha=1;this._shareContext=false;this.textureRatioX=1;this.textureRatioY=1;this._pRttViewProjectionMatrix=new a;this._localPos=new s;this._globalPos=new s;this._pScissorRect=new n;this._pNumTriangles=0;this._onViewportUpdatedDelegate=function(t){return e.onViewportUpdated(t)};this._billboardRenderablePool=l.getPool(f);this._triangleSubMeshRenderablePool=l.getPool(y);this._lineSubMeshRenderablePool=l.getPool(_);this._onContextUpdateDelegate=function(t){return e.onContextUpdate(t)};this.renderableSorter=new u}Object.defineProperty(e.prototype,"numTriangles",{get:function(){return this._pNumTriangles},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"viewPort",{get:function(){return this._viewPort},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scissorRect",{get:function(){return this._pScissorRect},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"x",{get:function(){return this._localPos.x},set:function(t){if(this.x==t)return;this._globalPos.x=this._localPos.x=t;this.updateGlobalPos()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"y",{get:function(){return this._localPos.y},set:function(t){if(this.y==t)return;this._globalPos.y=this._localPos.y=t;this.updateGlobalPos()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){if(this._width==t)return;this._width=t;this._pScissorRect.width=t;if(this._pRttBufferManager)this._pRttBufferManager.viewWidth=t;this._pBackBufferInvalid=true;this._pDepthTextureInvalid=true;this.notifyScissorUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){if(this._height==t)return;this._height=t;this._pScissorRect.height=t;if(this._pRttBufferManager)this._pRttBufferManager.viewHeight=t;this._pBackBufferInvalid=true;this._pDepthTextureInvalid=true;this.notifyScissorUpdate()},enumerable:true,configurable:true});e.prototype._iCreateEntityCollector=function(){return new d};Object.defineProperty(e.prototype,"_iBackgroundR",{get:function(){return this._backgroundR},set:function(t){if(this._backgroundR==t)return;this._backgroundR=t;this._pBackBufferInvalid=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"_iBackgroundG",{get:function(){return this._backgroundG},set:function(t){if(this._backgroundG==t)return;this._backgroundG=t;this._pBackBufferInvalid=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"_iBackgroundB",{get:function(){return this._backgroundB},set:function(t){if(this._backgroundB==t)return;this._backgroundB=t;this._pBackBufferInvalid=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"stage",{get:function(){return this._pStage},set:function(t){if(t==this._pStage)return;this.iSetStage(t)},enumerable:true,configurable:true});e.prototype.iSetStage=function(t){if(this._pStage){this._pStage.removeEventListener(c.CONTEXT_CREATED,this._onContextUpdateDelegate);this._pStage.removeEventListener(c.CONTEXT_RECREATED,this._onContextUpdateDelegate);this._pStage.removeEventListener(c.VIEWPORT_UPDATED,this._onViewportUpdatedDelegate)}if(!t){this._pStage=null;this._pContext=null}else{this._pStage=t;this._pStage.addEventListener(c.CONTEXT_CREATED,this._onContextUpdateDelegate);this._pStage.addEventListener(c.CONTEXT_RECREATED,this._onContextUpdateDelegate);this._pStage.addEventListener(c.VIEWPORT_UPDATED,this._onViewportUpdatedDelegate);if(this._pStage.context)this._pContext=this._pStage.context}this._pBackBufferInvalid=true;this.updateGlobalPos()};Object.defineProperty(e.prototype,"shareContext",{get:function(){return this._shareContext},set:function(t){if(this._shareContext==t)return;this._shareContext=t;this.updateGlobalPos()},enumerable:true,configurable:true});e.prototype.dispose=function(){if(this._pRttBufferManager)this._pRttBufferManager.dispose();this._pRttBufferManager=null;this._pStage.removeEventListener(c.CONTEXT_CREATED,this._onContextUpdateDelegate);this._pStage.removeEventListener(c.CONTEXT_RECREATED,this._onContextUpdateDelegate);this._pStage.removeEventListener(c.VIEWPORT_UPDATED,this._onViewportUpdatedDelegate);this._pStage=null};e.prototype.render=function(t){this._viewportDirty=false;this._scissorDirty=false};e.prototype._iRender=function(t,e,i,r){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=0}if(!this._pStage||!this._pContext)return;this._pRttViewProjectionMatrix.copyFrom(t.camera.viewProjection);this._pRttViewProjectionMatrix.appendScale(this.textureRatioX,this.textureRatioY,1);this.pExecuteRender(t,e,i,r);for(var a=0;a<8;++a){this._pContext.setVertexBufferAt(a,null);this._pContext.setTextureAt(a,null)}};e.prototype._iRenderCascades=function(t,e,i,r,a){};e.prototype.pCollectRenderables=function(t){this._pBlendedRenderableHead=null;this._pOpaqueRenderableHead=null;this._pNumTriangles=0;var e=t.entityHead;this._pCamera=t.camera;this._iEntryPoint=this._pCamera.scenePosition;this._pCameraForward=this._pCamera.transform.forwardVector;while(e){e.entity._iCollectRenderables(this);e=e.next}this._pOpaqueRenderableHead=this.renderableSorter.sortOpaqueRenderables(this._pOpaqueRenderableHead);this._pBlendedRenderableHead=this.renderableSorter.sortBlendedRenderables(this._pBlendedRenderableHead)};e.prototype.pExecuteRender=function(t,e,i,r){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=0}this._pContext.setRenderTarget(e,true,r);if((e||!this._shareContext)&&!this._depthPrepass)this._pContext.clear(this._backgroundR,this._backgroundG,this._backgroundB,this._backgroundAlpha,1,0);this._pContext.setDepthTest(false,g.ALWAYS);this._pStage.scissorRect=i;this.pDraw(t,e);if(!this._shareContext){if(this._snapshotRequired&&this._snapshotBitmapData){this._pContext.drawToBitmapData(this._snapshotBitmapData);this._snapshotRequired=false}}this._pStage.scissorRect=null};e.prototype.queueSnapshot=function(t){this._snapshotRequired=true;this._snapshotBitmapData=t};e.prototype.pDraw=function(t,e){throw new o};e.prototype.onContextUpdate=function(t){this._pContext=this._pStage.context};Object.defineProperty(e.prototype,"_iBackgroundAlpha",{get:function(){return this._backgroundAlpha},set:function(t){if(this._backgroundAlpha==t)return;this._backgroundAlpha=t;this._pBackBufferInvalid=true},enumerable:true,configurable:true});e.prototype.notifyScissorUpdate=function(){if(this._scissorDirty)return;this._scissorDirty=true;if(!this._scissorUpdated)this._scissorUpdated=new p(p.SCISSOR_UPDATED);this.dispatchEvent(this._scissorUpdated)};e.prototype.notifyViewportUpdate=function(){if(this._viewportDirty)return;this._viewportDirty=true;if(!this._viewPortUpdated)this._viewPortUpdated=new p(p.VIEWPORT_UPDATED);this.dispatchEvent(this._viewPortUpdated)};e.prototype.onViewportUpdated=function(t){this._viewPort=this._pStage.viewPort;if(this._shareContext){this._pScissorRect.x=this._globalPos.x-this._pStage.x;this._pScissorRect.y=this._globalPos.y-this._pStage.y;this.notifyScissorUpdate()}this.notifyViewportUpdate()};e.prototype.updateGlobalPos=function(){if(this._shareContext){this._pScissorRect.x=this._globalPos.x-this._viewPort.x;this._pScissorRect.y=this._globalPos.y-this._viewPort.y}else{this._pScissorRect.x=0;this._pScissorRect.y=0;this._viewPort.x=this._globalPos.x;this._viewPort.y=this._globalPos.y}this.notifyScissorUpdate()};e.prototype.applyBillboard=function(t){this._applyRenderable(this._billboardRenderablePool.getItem(t))};e.prototype.applyTriangleSubMesh=function(t){this._applyRenderable(this._triangleSubMeshRenderablePool.getItem(t))};e.prototype.applyLineSubMesh=function(t){this._applyRenderable(this._lineSubMeshRenderablePool.getItem(t))};e.prototype._applyRenderable=function(t){var e=t.materialOwner.material;var i=t.sourceEntity;var r=i.scenePosition;if(!e)e=m.getDefaultMaterial(t.materialOwner);e._iUpdateMaterial();t.material=e;t.materialId=e._iMaterialId;t.renderOrderId=this._pContext.getMaterial(e,this._pStage.profile).renderOrderId;
t.cascaded=false;r=this._iEntryPoint.subtract(r);t.zIndex=i.zOffset+r.dotProduct(this._pCameraForward);t.renderSceneTransform=t.sourceEntity.getRenderSceneTransform(this._pCamera);if(e.requiresBlending){t.next=this._pBlendedRenderableHead;this._pBlendedRenderableHead=t}else{t.next=this._pOpaqueRenderableHead;this._pOpaqueRenderableHead=t}this._pNumTriangles+=t.numTriangles;if(t.overflow)this._applyRenderable(t.overflow)};return e}(h);e.exports=b},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/events/EventDispatcher":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Point":undefined,"awayjs-core/lib/geom/Rectangle":undefined,"awayjs-display/lib/events/RendererEvent":undefined,"awayjs-display/lib/events/StageEvent":undefined,"awayjs-display/lib/pool/RenderablePool":undefined,"awayjs-display/lib/sort/RenderableMergeSort":undefined,"awayjs-display/lib/traverse/EntityCollector":undefined,"awayjs-stagegl/lib/base/ContextGLCompareMode":undefined,"awayjs-stagegl/lib/materials/utils/DefaultMaterialManager":undefined,"awayjs-stagegl/lib/pool/BillboardRenderable":undefined,"awayjs-stagegl/lib/pool/LineSubMeshRenderable":undefined,"awayjs-stagegl/lib/pool/TriangleSubMeshRenderable":undefined}],"awayjs-stagegl/lib/swfobject":[function(t,e,i){var r=function(){var t="undefined",e="object",i="Shockwave Flash",a="ShockwaveFlash.ShockwaveFlash",s="application/x-shockwave-flash",n="SWFObjectExprInst",o="onreadystatechange",h=window,l=document,u=navigator,p=false,c=[O],d=[],f=[],_=[],y,g,m,b,v=false,w=false,x,P,D=true,C=function(){var r=typeof l.getElementById!=t&&typeof l.getElementsByTagName!=t&&typeof l.createElement!=t,n=u.userAgent.toLowerCase(),o=u.platform.toLowerCase(),c=o?/win/.test(o):/win/.test(n),d=o?/mac/.test(o):/mac/.test(n),f=/webkit/.test(n)?parseFloat(n.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,_=!+"1",y=[0,0,0],g=null;if(typeof u.plugins!=t&&typeof u.plugins[i]==e){g=u.plugins[i].description;if(g&&!(typeof u.mimeTypes!=t&&u.mimeTypes[s]&&!u.mimeTypes[s].enabledPlugin)){p=true;_=false;g=g.replace(/^.*\s+(\S+\s+\S+$)/,"$1");y[0]=parseInt(g.replace(/^(.*)\..*$/,"$1"),10);y[1]=parseInt(g.replace(/^.*\.(.*)\s.*$/,"$1"),10);y[2]=/[a-zA-Z]/.test(g)?parseInt(g.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else if(typeof h.ActiveXObject!=t){try{var m=new ActiveXObject(a);if(m){g=m.GetVariable("$version");if(g){_=true;g=g.split(" ")[1].split(",");y=[parseInt(g[0],10),parseInt(g[1],10),parseInt(g[2],10)]}}}catch(b){}}return{w3:r,pv:y,wk:f,ie:_,win:c,mac:d}}(),T=function(){if(!C.w3){return}if(typeof l.readyState!=t&&l.readyState=="complete"||typeof l.readyState==t&&(l.getElementsByTagName("body")[0]||l.body)){A()}if(!v){if(typeof l.addEventListener!=t){l.addEventListener("DOMContentLoaded",A,false)}if(C.ie&&C.win){l.attachEvent(o,function(){if(l.readyState=="complete"){l.detachEvent(o,arguments.callee);A()}});if(h==top){(function(){if(v){return}try{l.documentElement.doScroll("left")}catch(t){setTimeout(arguments.callee,0);return}A()})()}}if(C.wk){(function(){if(v){return}if(!/loaded|complete/.test(l.readyState)){setTimeout(arguments.callee,0);return}A()})()}j(A)}}();function A(){if(v){return}try{var t=l.getElementsByTagName("body")[0].appendChild(G("span"));t.parentNode.removeChild(t)}catch(e){return}v=true;var i=c.length;for(var r=0;r<i;r++){c[r]()}}function S(t){if(v){t()}else{c[c.length]=t}}function j(e){if(typeof h.addEventListener!=t){h.addEventListener("load",e,false)}else if(typeof l.addEventListener!=t){l.addEventListener("load",e,false)}else if(typeof h.attachEvent!=t){H(h,"onload",e)}else if(typeof h.onload=="function"){var i=h.onload;h.onload=function(){i();e()}}else{h.onload=e}}function O(){if(p){E()}else{M()}}function E(){var i=l.getElementsByTagName("body")[0];var r=G(e);r.setAttribute("type",s);var a=i.appendChild(r);if(a){var n=0;(function(){if(typeof a.GetVariable!=t){var e=a.GetVariable("$version");if(e){e=e.split(" ")[1].split(",");C.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)]}}else if(n<10){n++;setTimeout(arguments.callee,10);return}i.removeChild(r);a=null;M()})()}else{M()}}function M(){var e=d.length;if(e>0){for(var i=0;i<e;i++){var r=d[i].id;var a=d[i].callbackFn;var s={success:false,id:r};if(C.pv[0]>0){var n=z(r);if(n){if(X(d[i].swfVersion)&&!(C.wk&&C.wk<312)){Y(r,true);if(a){s.success=true;s.ref=R(r);a(s)}}else if(d[i].expressInstall&&I()){var o={};o.data=d[i].expressInstall;o.width=n.getAttribute("width")||"0";o.height=n.getAttribute("height")||"0";if(n.getAttribute("class")){o.styleclass=n.getAttribute("class")}if(n.getAttribute("align")){o.align=n.getAttribute("align")}var h={};var l=n.getElementsByTagName("param");var u=l.length;for(var p=0;p<u;p++){if(l[p].getAttribute("name").toLowerCase()!="movie"){h[l[p].getAttribute("name")]=l[p].getAttribute("value")}}N(o,h,r,a)}else{L(n);if(a){a(s)}}}}else{Y(r,true);if(a){var c=R(r);if(c&&typeof c.SetVariable!=t){s.success=true;s.ref=c}a(s)}}}}}function R(i){var r=null;var a=z(i);if(a&&a.nodeName=="OBJECT"){if(typeof a.SetVariable!=t){r=a}else{var s=a.getElementsByTagName(e)[0];if(s){r=s}}}return r}function I(){return!w&&X("6.0.65")&&(C.win||C.mac)&&!(C.wk&&C.wk<312)}function N(e,i,r,a){w=true;m=a||null;b={success:false,id:r};var s=z(r);if(s){if(s.nodeName=="OBJECT"){y=F(s);g=null}else{y=s;g=r}e.id=n;if(typeof e.width==t||!/%$/.test(e.width)&&parseInt(e.width,10)<310){e.width="310"}if(typeof e.height==t||!/%$/.test(e.height)&&parseInt(e.height,10)<137){e.height="137"}l.title=l.title.slice(0,47)+" - Flash Player Installation";var o=C.ie&&C.win?"ActiveX":"PlugIn",h="MMredirectURL="+encodeURI(window.location).toString().replace(/&/g,"%26")+"&MMplayerType="+o+"&MMdoctitle="+l.title;if(typeof i.flashvars!=t){i.flashvars+="&"+h}else{i.flashvars=h}if(C.ie&&C.win&&s.readyState!=4){var u=G("div");r+="SWFObjectNew";u.setAttribute("id",r);s.parentNode.insertBefore(u,s);s.style.display="none";(function(){if(s.readyState==4){s.parentNode.removeChild(s)}else{setTimeout(arguments.callee,10)}})()}V(e,i,r)}}function L(t){if(C.ie&&C.win&&t.readyState!=4){var e=G("div");t.parentNode.insertBefore(e,t);e.parentNode.replaceChild(F(t),e);t.style.display="none";(function(){if(t.readyState==4){t.parentNode.removeChild(t)}else{setTimeout(arguments.callee,10)}})()}else{t.parentNode.replaceChild(F(t),t)}}function F(t){var i=G("div");if(C.win&&C.ie){i.innerHTML=t.innerHTML}else{var r=t.getElementsByTagName(e)[0];if(r){var a=r.childNodes;if(a){var s=a.length;for(var n=0;n<s;n++){if(!(a[n].nodeType==1&&a[n].nodeName=="PARAM")&&!(a[n].nodeType==8)){i.appendChild(a[n].cloneNode(true))}}}}}return i}function V(i,r,a){var n,o=z(a);if(C.wk&&C.wk<312){return n}if(o){if(typeof i.id==t){i.id=a}if(C.ie&&C.win){var h="";for(var l in i){if(i[l]!=Object.prototype[l]){if(l.toLowerCase()=="data"){r.movie=i[l]}else if(l.toLowerCase()=="styleclass"){h+=' class="'+i[l]+'"'}else if(l.toLowerCase()!="classid"){h+=" "+l+'="'+i[l]+'"'}}}var u="";for(var p in r){if(r[p]!=Object.prototype[p]){u+='<param name="'+p+'" value="'+r[p]+'" />'}}o.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+h+">"+u+"</object>";f[f.length]=i.id;n=z(i.id)}else{var c=G(e);c.setAttribute("type",s);for(var d in i){if(i[d]!=Object.prototype[d]){if(d.toLowerCase()=="styleclass"){c.setAttribute("class",i[d])}else if(d.toLowerCase()!="classid"){c.setAttribute(d,i[d])}}}for(var _ in r){if(r[_]!=Object.prototype[_]&&_.toLowerCase()!="movie"){B(c,_,r[_])}}o.parentNode.replaceChild(c,o);n=c}}return n}function B(t,e,i){var r=G("param");r.setAttribute("name",e);r.setAttribute("value",i);t.appendChild(r)}function U(t){var e=z(t);if(e&&e.nodeName=="OBJECT"){if(C.ie&&C.win){e.style.display="none";(function(){if(e.readyState==4){k(t)}else{setTimeout(arguments.callee,10)}})()}else{e.parentNode.removeChild(e)}}}function k(t){var e=z(t);if(e){for(var i in e){if(typeof e[i]=="function"){e[i]=null}}e.parentNode.removeChild(e)}}function z(t){var e=null;try{e=l.getElementById(t)}catch(i){}return e}function G(t){return l.createElement(t)}function H(t,e,i){t.attachEvent(e,i);_[_.length]=[t,e,i]}function X(t){var e=C.pv,i=t.split(".");i[0]=parseInt(i[0],10);i[1]=parseInt(i[1],10)||0;i[2]=parseInt(i[2],10)||0;return e[0]>i[0]||e[0]==i[0]&&e[1]>i[1]||e[0]==i[0]&&e[1]==i[1]&&e[2]>=i[2]?true:false}function W(i,r,a,s){if(C.ie&&C.mac){return}var n=l.getElementsByTagName("head")[0];if(!n){return}var o=a&&typeof a=="string"?a:"screen";if(s){x=null;P=null}if(!x||P!=o){var h=G("style");h.setAttribute("type","text/css");h.setAttribute("media",o);x=n.appendChild(h);if(C.ie&&C.win&&typeof l.styleSheets!=t&&l.styleSheets.length>0){x=l.styleSheets[l.styleSheets.length-1]}P=o}if(C.ie&&C.win){if(x&&typeof x.addRule==e){x.addRule(i,r)}}else{if(x&&typeof l.createTextNode!=t){x.appendChild(l.createTextNode(i+" {"+r+"}"))}}}function Y(t,e){if(!D){return}var i=e?"visible":"hidden";if(v&&z(t)){z(t).style.visibility=i}else{W("#"+t,"visibility:"+i)}}function Z(e){var i=/[\\\"<>\.;]/;var r=i.exec(e)!=null;return r&&typeof encodeURIComponent!=t?encodeURIComponent(e):e}var q=function(){if(C.ie&&C.win){window.attachEvent("onunload",function(){var t=_.length;for(var e=0;e<t;e++){_[e][0].detachEvent(_[e][1],_[e][2])}var i=f.length;for(var a=0;a<i;a++){U(f[a])}for(var s in C){C[s]=null}C=null;for(var n in r){r[n]=null}r=null})}}();return{registerObject:function(t,e,i,r){if(C.w3&&t&&e){var a={};a.id=t;a.swfVersion=e;a.expressInstall=i;a.callbackFn=r;d[d.length]=a;Y(t,false)}else if(r){r({success:false,id:t})}},getObjectById:function(t){if(C.w3){return R(t)}},embedSWF:function(i,r,a,s,n,o,h,l,u,p){var c={success:false,id:r};if(C.w3&&!(C.wk&&C.wk<312)&&i&&r&&a&&s&&n){Y(r,false);S(function(){a+="";s+="";var d={};if(u&&typeof u===e){for(var f in u){d[f]=u[f]}}d.data=i;d.width=a;d.height=s;var _={};if(l&&typeof l===e){for(var y in l){_[y]=l[y]}}if(h&&typeof h===e){for(var g in h){if(typeof _.flashvars!=t){_.flashvars+="&"+g+"="+h[g]}else{_.flashvars=g+"="+h[g]}}}if(X(n)){var m=V(d,_,r);if(d.id==r){Y(r,true)}c.success=true;c.ref=m}else if(o&&I()){d.data=o;N(d,_,r,p);return}else{Y(r,true)}if(p){p(c)}})}else if(p){p(c)}},switchOffAutoHideShow:function(){D=false},ua:C,getFlashPlayerVersion:function(){return{major:C.pv[0],minor:C.pv[1],release:C.pv[2]}},hasFlashPlayerVersion:X,createSWF:function(t,e,i){if(C.w3){return V(t,e,i)}else{return undefined}},showExpressInstall:function(t,e,i,r){if(C.w3&&I()){N(t,e,i,r)}},removeSWF:function(t){if(C.w3){U(t)}},createCSS:function(t,e,i,r){if(C.w3){W(t,e,i,r)}},addDomLoadEvent:S,addLoadEvent:j,getQueryParamValue:function(t){var e=l.location.search||l.location.hash;if(e){if(/\?/.test(e)){e=e.split("?")[1]}if(t==null){return Z(e)}var i=e.split("&");for(var r=0;r<i.length;r++){if(i[r].substring(0,i[r].indexOf("="))==t){return Z(i[r].substring(i[r].indexOf("=")+1))}}}return""},expressInstallCallback:function(){if(w){var t=z(n);if(t&&y){t.parentNode.replaceChild(y,t);if(g){Y(g,true);if(C.ie&&C.win){y.style.display="block"}}if(m){m(b)}}w=false}}}}();e.exports=r},{}]},{},[]);
//# sourceMappingURL=awayjs-dist-require.js.map